Rank =    0  Free Memory = 68725 MB
Rank =    1  Free Memory = 68725 MB
Rank =    2  Free Memory = 68725 MB
Rank =    3  Free Memory = 68725 MB
Rank =    4  Free Memory = 68725 MB
Rank =    5  Free Memory = 68725 MB
Rank =    6  Free Memory = 68725 MB
Rank =    7  Free Memory = 68725 MB
Rank =    8  Free Memory = 68725 MB
Rank =    9  Free Memory = 68725 MB
Rank =   10  Free Memory = 68725 MB
Rank =   11  Free Memory = 68725 MB
Rank =   12  Free Memory = 68725 MB
Rank =   13  Free Memory = 68725 MB
Rank =   14  Free Memory = 68725 MB
Rank =   15  Free Memory = 68712 MB
Rank =   16  Free Memory = 68711 MB
Rank =   17  Free Memory = 68711 MB
Rank =   18  Free Memory = 68711 MB
Rank =   19  Free Memory = 68711 MB
Rank =   20  Free Memory = 68711 MB
Rank =   21  Free Memory = 68711 MB
Rank =   22  Free Memory = 68711 MB
Rank =   23  Free Memory = 68711 MB
Rank =   24  Free Memory = 68711 MB
Rank =   25  Free Memory = 68711 MB
Rank =   26  Free Memory = 68711 MB
Rank =   27  Free Memory = 68711 MB
Rank =   28  Free Memory = 68711 MB
Rank =   29  Free Memory = 68711 MB
Rank =   30  Free Memory = 68711 MB
Rank =   31  Free Memory = 68711 MB
Rank =   32  Free Memory = 90365 MB
Rank =   33  Free Memory = 90365 MB
Rank =   34  Free Memory = 90365 MB
Rank =   35  Free Memory = 90365 MB
Rank =   36  Free Memory = 90365 MB
Rank =   37  Free Memory = 90365 MB
Rank =   38  Free Memory = 90365 MB
Rank =   39  Free Memory = 90365 MB
Rank =   40  Free Memory = 90365 MB
Rank =   41  Free Memory = 90365 MB
Rank =   42  Free Memory = 90365 MB
Rank =   43  Free Memory = 90365 MB
Rank =   44  Free Memory = 90365 MB
Rank =   45  Free Memory = 90365 MB
Rank =   46  Free Memory = 90365 MB
Rank =   47  Free Memory = 90365 MB
Rank =   48  Free Memory = 90365 MB
Rank =   49  Free Memory = 90365 MB
Rank =   50  Free Memory = 90365 MB
Rank =   51  Free Memory = 90365 MB
Rank =   52  Free Memory = 90365 MB
Rank =   53  Free Memory = 90365 MB
Rank =   54  Free Memory = 90365 MB
Rank =   55  Free Memory = 90365 MB
Rank =   56  Free Memory = 90365 MB
Rank =   57  Free Memory = 90365 MB
Rank =   58  Free Memory = 90365 MB
Rank =   59  Free Memory = 90365 MB
Rank =   60  Free Memory = 90365 MB
Rank =   61  Free Memory = 90365 MB
Rank =   62  Free Memory = 90365 MB
Rank =   63  Free Memory = 90365 MB
Rank =   64  Free Memory = 90860 MB
Rank =   65  Free Memory = 90860 MB
Rank =   66  Free Memory = 90859 MB
Rank =   67  Free Memory = 90859 MB
Rank =   68  Free Memory = 90859 MB
Rank =   69  Free Memory = 90859 MB
Rank =   70  Free Memory = 90859 MB
Rank =   71  Free Memory = 90859 MB
Rank =   72  Free Memory = 90859 MB
Rank =   73  Free Memory = 90858 MB
Rank =   74  Free Memory = 90858 MB
Rank =   75  Free Memory = 90858 MB
Rank =   76  Free Memory = 90858 MB
Rank =   77  Free Memory = 90858 MB
Rank =   78  Free Memory = 90858 MB
Rank =   79  Free Memory = 90858 MB
Rank =   80  Free Memory = 90858 MB
Rank =   81  Free Memory = 90858 MB
Rank =   82  Free Memory = 90858 MB
Rank =   83  Free Memory = 90858 MB
Rank =   84  Free Memory = 90858 MB
Rank =   85  Free Memory = 90858 MB
Rank =   86  Free Memory = 90858 MB
Rank =   87  Free Memory = 90858 MB
Rank =   88  Free Memory = 90858 MB
Rank =   89  Free Memory = 90858 MB
Rank =   90  Free Memory = 90858 MB
Rank =   91  Free Memory = 90858 MB
Rank =   92  Free Memory = 90858 MB
Rank =   93  Free Memory = 90858 MB
Rank =   94  Free Memory = 90858 MB
Rank =   95  Free Memory = 90858 MB
Rank =   96  Free Memory = 88590 MB
Rank =   97  Free Memory = 88590 MB
Rank =   98  Free Memory = 88590 MB
Rank =   99  Free Memory = 88590 MB
Rank =  100  Free Memory = 88590 MB
Rank =  101  Free Memory = 88590 MB
Rank =  102  Free Memory = 88590 MB
Rank =  103  Free Memory = 88590 MB
Rank =  104  Free Memory = 88590 MB
Rank =  105  Free Memory = 88590 MB
Rank =  106  Free Memory = 88590 MB
Rank =  107  Free Memory = 88590 MB
Rank =  108  Free Memory = 88590 MB
Rank =  109  Free Memory = 88590 MB
Rank =  110  Free Memory = 88590 MB
Rank =  111  Free Memory = 88590 MB
Rank =  112  Free Memory = 88590 MB
Rank =  113  Free Memory = 88590 MB
Rank =  114  Free Memory = 88590 MB
Rank =  115  Free Memory = 88590 MB
Rank =  116  Free Memory = 88590 MB
Rank =  117  Free Memory = 88590 MB
Rank =  118  Free Memory = 88590 MB
Rank =  119  Free Memory = 88590 MB
Rank =  120  Free Memory = 88590 MB
Rank =  121  Free Memory = 88590 MB
Rank =  122  Free Memory = 88590 MB
Rank =  123  Free Memory = 88590 MB
Rank =  124  Free Memory = 88590 MB
Rank =  125  Free Memory = 88590 MB
Rank =  126  Free Memory = 88590 MB
Rank =  127  Free Memory = 88590 MB
  Input file(s): opt_h2o_1b1_lmc_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmc_run001c.xml

  Project = H2O
  date    = 2023-03-03 14:06:04 PST
  host    = n0068.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 844

  Range of prime numbers to use as seeds over processors and threads = 6551-7681


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.123012e-01    1         1  ON     0
     uu_1                 1.451246e-01    1         1  ON     1
     uu_2                 4.323384e-02    1         1  ON     2
     uu_3                -1.931156e-02    1         1  ON     3
     uu_4                -6.504874e-02    1         1  ON     4
     uu_5                -1.000818e-01    1         1  ON     5
     uu_6                -1.276646e-01    1         1  ON     6
     uu_7                -1.411859e-01    1         1  ON     7
     uu_8                -1.339686e-01    1         1  ON     8
     uu_9                -1.024297e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.467481e-01    1         1  ON     0
     ud_1                 1.810944e-01    1         1  ON     1
     ud_2                 6.077585e-02    1         1  ON     2
     ud_3                -1.007794e-02    1         1  ON     3
     ud_4                -6.682635e-02    1         1  ON     4
     ud_5                -1.082279e-01    1         1  ON     5
     ud_6                -1.350234e-01    1         1  ON     6
     ud_7                -1.508640e-01    1         1  ON     7
     ud_8                -1.511156e-01    1         1  ON     8
     ud_9                -1.401974e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.496821e-01    1         1  ON     0
     eO_1                -4.292632e-01    1         1  ON     1
     eO_2                -1.980893e-02    1         1  ON     2
     eO_3                 2.911379e-01    1         1  ON     3
     eO_4                 5.151693e-01    1         1  ON     4
     eO_5                 4.767251e-01    1         1  ON     5
     eO_6                 2.500538e-01    1         1  ON     6
     eO_7                -4.636961e-02    1         1  ON     7
     eO_8                -2.141809e-01    1         1  ON     8
     eO_9                -7.452792e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.521366e-01    1         1  ON     0
     eH1_1                -1.455463e-01    1         1  ON     1
     eH1_2                -9.554946e-02    1         1  ON     2
     eH1_3                -4.022421e-02    1         1  ON     3
     eH1_4                 8.953759e-03    1         1  ON     4
     eH1_5                 4.366640e-02    1         1  ON     5
     eH1_6                 1.011305e-01    1         1  ON     6
     eH1_7                 1.543277e-01    1         1  ON     7
     eH1_8                 1.715913e-01    1         1  ON     8
     eH1_9                 5.705223e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.497609e-01    1         1  ON     0
     eH2_1                -1.422525e-01    1         1  ON     1
     eH2_2                -9.244371e-02    1         1  ON     2
     eH2_3                -3.694097e-02    1         1  ON     3
     eH2_4                 1.246861e-02    1         1  ON     4
     eH2_5                 4.746844e-02    1         1  ON     5
     eH2_6                 1.043273e-01    1         1  ON     6
     eH2_7                 1.546907e-01    1         1  ON     7
     eH2_8                 1.751962e-01    1         1  ON     8
     eH2_9                 4.361230e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.936133e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0231e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 124
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9875
    reference variance = 0.29134
====================================================
  Execution time = 2.1761e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3445e-01
  Total weights = 1.951815888e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322498764237
                                         uncertainty =       0.002057610755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322498764237
                                         uncertainty =       0.002057610755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401616980
  error estimate for blocks of size 2^( 2) =       0.000414474234
  error estimate for blocks of size 2^( 3) =       0.000428605808
  error estimate for blocks of size 2^( 4) =       0.000441770244
  error estimate for blocks of size 2^( 5) =       0.000454040269
  error estimate for blocks of size 2^( 6) =       0.000465494520
  error estimate for blocks of size 2^( 7) =       0.000472293285

      target function =                  N/A
              le_mean =     -16.906156282906
             les_mean =     286.152571275171
             stat err =       0.000458399579
             autocorr =       1.302759619119
              std dev =       0.567972180193
             le_variance =       0.322592397473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690615628291e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156282917       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906178349233       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906178958826       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906176419342       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906177778573       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906177387946       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906177914265       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906178309075       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906178192509       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906177922564       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906178081370       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906178276146       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.129300e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156282917       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164758725       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165054937       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906164230386       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906164674877       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906164542172       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906164564488       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906164523794       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906164580214       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906164585987       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 4.313493e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906156282917       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906158730041       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906158829393       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906158652307       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906158709859       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906158665533       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158684819       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906158652882       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906158667292       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906158671799       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 4.0000e+00 is 1.245093e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7973e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0    3.124130e-01                 1 1 ON  0
uu_1    1.451469e-01                 1 1 ON  1
uu_2    4.327135e-02                 1 1 ON  2
uu_3    -1.933128e-02                1 1 ON  3
uu_4    -6.510561e-02                1 1 ON  4
uu_5    -1.002201e-01                1 1 ON  5
uu_6    -1.278222e-01                1 1 ON  6
uu_7    -1.411916e-01                1 1 ON  7
uu_8    -1.340028e-01                1 1 ON  8
uu_9    -1.024297e-01                1 1 ON  9
ud_0    4.467362e-01                 1 1 ON  10
ud_1    1.809755e-01                 1 1 ON  11
ud_2    6.080001e-02                 1 1 ON  12
ud_3    -1.008653e-02                1 1 ON  13
ud_4    -6.681118e-02                1 1 ON  14
ud_5    -1.081661e-01                1 1 ON  15
ud_6    -1.350418e-01                1 1 ON  16
ud_7    -1.508612e-01                1 1 ON  17
ud_8    -1.510461e-01                1 1 ON  18
ud_9    -1.401984e-01                1 1 ON  19
eO_0    -7.496437e-01                1 1 ON  20
eO_1    -4.293394e-01                1 1 ON  21
eO_2    -1.984660e-02                1 1 ON  22
eO_3    2.910951e-01                 1 1 ON  23
eO_4    5.151866e-01                 1 1 ON  24
eO_5    4.768857e-01                 1 1 ON  25
eO_6    2.501411e-01                 1 1 ON  26
eO_7    -4.631228e-02                1 1 ON  27
eO_8    -2.142617e-01                1 1 ON  28
eO_9    -7.463812e-02                1 1 ON  29
eH1_0   -2.523042e-01                1 1 ON  30
eH1_1   -1.455824e-01                1 1 ON  31
eH1_2   -9.561146e-02                1 1 ON  32
eH1_3   -4.038737e-02                1 1 ON  33
eH1_4   8.906920e-03                 1 1 ON  34
eH1_5   4.362421e-02                 1 1 ON  35
eH1_6   1.012120e-01                 1 1 ON  36
eH1_7   1.543823e-01                 1 1 ON  37
eH1_8   1.717666e-01                 1 1 ON  38
eH1_9   5.723538e-02                 1 1 ON  39
eH2_0   -2.499188e-01                1 1 ON  40
eH2_1   -1.423146e-01                1 1 ON  41
eH2_2   -9.242275e-02                1 1 ON  42
eH2_3   -3.701698e-02                1 1 ON  43
eH2_4   1.233032e-02                 1 1 ON  44
eH2_5   4.732021e-02                 1 1 ON  45
eH2_6   1.042622e-01                 1 1 ON  46
eH2_7   1.547690e-01                 1 1 ON  47
eH2_8   1.754528e-01                 1 1 ON  48
eH2_9   4.388504e-02                 1 1 ON  49
ci_0001 7.011646e-01                 3 1 ON  50
ci_0002 7.005963e-01                 3 1 ON  51
ci_0003 -2.734047e-02                3 1 ON  52
ci_0004 -2.722146e-02                3 1 ON  53
ci_0005 -3.618743e-02                3 1 ON  54
ci_0006 -3.636236e-02                3 1 ON  55
ci_0007 -2.120703e-02                3 1 ON  56
ci_0008 -2.167811e-02                3 1 ON  57
ci_0009 -1.725174e-02                3 1 ON  58
ci_0010 -1.733029e-02                3 1 ON  59
ci_0011 -1.159353e-02                3 1 ON  60
ci_0012 -1.243256e-02                3 1 ON  61
ci_0013 1.316923e-02                 3 1 ON  62
ci_0014 1.357782e-02                 3 1 ON  63
ci_0015 1.312062e-02                 3 1 ON  64
ci_0016 1.334345e-02                 3 1 ON  65
ci_0017 1.150434e-02                 3 1 ON  66
ci_0018 1.094293e-02                 3 1 ON  67
ci_0019 1.209850e-02                 3 1 ON  68
ci_0020 1.117664e-02                 3 1 ON  69
ci_0021 -1.536850e-03                3 1 ON  70
ci_0022 -7.646388e-04                3 1 ON  71
ci_0023 -1.081014e-02                3 1 ON  72
ci_0024 -1.040994e-02                3 1 ON  73
ci_0025 -1.041813e-02                3 1 ON  74
ci_0026 -1.082483e-02                3 1 ON  75
ci_0027 -1.151179e-02                3 1 ON  76
ci_0028 -1.153960e-02                3 1 ON  77
ci_0029 -1.081027e-02                3 1 ON  78
ci_0030 -1.056846e-02                3 1 ON  79
ci_0031 2.041556e-02                 3 1 ON  80
ci_0032 2.125616e-02                 3 1 ON  81
ci_0033 1.053503e-02                 3 1 ON  82
ci_0034 9.980950e-03                 3 1 ON  83
ci_0035 7.379170e-03                 3 1 ON  84
ci_0036 7.134323e-03                 3 1 ON  85
ci_0037 -1.004692e-02                3 1 ON  86
ci_0038 -1.101661e-02                3 1 ON  87
ci_0039 -2.703550e-03                3 1 ON  88
ci_0040 -2.614926e-03                3 1 ON  89
ci_0041 6.621566e-03                 3 1 ON  90
ci_0042 7.243205e-03                 3 1 ON  91
ci_0043 -1.870618e-02                3 1 ON  92
ci_0044 -1.920924e-02                3 1 ON  93
ci_0045 7.786889e-03                 3 1 ON  94
ci_0046 8.709340e-03                 3 1 ON  95
ci_0047 -1.925689e-03                3 1 ON  96
ci_0048 -1.941791e-03                3 1 ON  97
ci_0049 -5.874217e-03                3 1 ON  98
ci_0050 -5.918667e-03                3 1 ON  99
ci_0051 -3.402725e-03                3 1 ON  100
ci_0052 -3.507561e-03                3 1 ON  101
ci_0053 -4.574503e-03                3 1 ON  102
ci_0054 -4.556694e-03                3 1 ON  103
ci_0055 5.673985e-03                 3 1 ON  104
ci_0056 6.487271e-03                 3 1 ON  105
ci_0057 4.461144e-03                 3 1 ON  106
ci_0058 5.115356e-03                 3 1 ON  107
ci_0059 -4.797062e-03                3 1 ON  108
ci_0060 -4.342079e-03                3 1 ON  109
ci_0061 -4.523572e-03                3 1 ON  110
ci_0062 -3.815798e-03                3 1 ON  111
ci_0063 -8.182365e-03                3 1 ON  112
ci_0064 -8.828892e-03                3 1 ON  113
ci_0065 -5.357701e-03                3 1 ON  114
ci_0066 -5.467013e-03                3 1 ON  115
ci_0067 -4.544848e-03                3 1 ON  116
ci_0068 -5.044770e-03                3 1 ON  117
ci_0069 4.628990e-03                 3 1 ON  118
ci_0070 4.484218e-03                 3 1 ON  119
ci_0071 3.850072e-04                 3 1 ON  120
ci_0072 -4.811296e-04                3 1 ON  121
ci_0073 4.355683e-03                 3 1 ON  122
ci_0074 4.247431e-03                 3 1 ON  123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9401
    reference variance = 0.242513
====================================================
  Execution time = 2.1078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3550e-01
  Total weights = 1.9516e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323956562843
                                         uncertainty =       0.002232313551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323956562843
                                         uncertainty =       0.002232313551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402450671
  error estimate for blocks of size 2^( 2) =       0.000415334993
  error estimate for blocks of size 2^( 3) =       0.000427773656
  error estimate for blocks of size 2^( 4) =       0.000439076725
  error estimate for blocks of size 2^( 5) =       0.000447156617
  error estimate for blocks of size 2^( 6) =       0.000452257884
  error estimate for blocks of size 2^( 7) =       0.000457388934

      target function =                  N/A
              le_mean =     -16.906376186148
             les_mean =     286.163091440130
             stat err =       0.000448970040
             autocorr =       1.244541581835
              std dev =       0.569151196496
             le_variance =       0.323933084473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323765122082
                                         uncertainty =       0.002214230075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323765122082
                                         uncertainty =       0.002214230075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402329512
  error estimate for blocks of size 2^( 2) =       0.000415220210
  error estimate for blocks of size 2^( 3) =       0.000427642698
  error estimate for blocks of size 2^( 4) =       0.000438924461
  error estimate for blocks of size 2^( 5) =       0.000447012434
  error estimate for blocks of size 2^( 6) =       0.000452112297
  error estimate for blocks of size 2^( 7) =       0.000457152727

      target function =                  N/A
              le_mean =     -16.906378686003
             les_mean =     286.162445354909
             stat err =       0.000448800480
             autocorr =       1.244350837833
              std dev =       0.568979852360
             le_variance =       0.323738072391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323808882622
                                         uncertainty =       0.002217106323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323808882622
                                         uncertainty =       0.002217106323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402357349
  error estimate for blocks of size 2^( 2) =       0.000415246451
  error estimate for blocks of size 2^( 3) =       0.000427671070
  error estimate for blocks of size 2^( 4) =       0.000438956704
  error estimate for blocks of size 2^( 5) =       0.000447043575
  error estimate for blocks of size 2^( 6) =       0.000452139844
  error estimate for blocks of size 2^( 7) =       0.000457201398

      target function =                  N/A
              le_mean =     -16.906376183141
             les_mean =     286.161677159292
             stat err =       0.000448835380
             autocorr =       1.244372174056
              std dev =       0.569019220117
             le_variance =       0.323782872863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323930407770
                                         uncertainty =       0.002229761215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323930407770
                                         uncertainty =       0.002229761215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402434194
  error estimate for blocks of size 2^( 2) =       0.000415318112
  error estimate for blocks of size 2^( 3) =       0.000427754262
  error estimate for blocks of size 2^( 4) =       0.000439053789
  error estimate for blocks of size 2^( 5) =       0.000447133462
  error estimate for blocks of size 2^( 6) =       0.000452235910
  error estimate for blocks of size 2^( 7) =       0.000457353948

      target function =                  N/A
              le_mean =     -16.906374082169
             les_mean =     286.177831329178
             stat err =       0.000448944277
             autocorr =       1.244500654621
              std dev =       0.569127895609
             le_variance =       0.323906561560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906376186148        initial
     2.5000e-01     2.5000e+00             1.1293e-03       -16.906378686003  <--
     1.0000e+00     1.0000e+01             4.3135e-04       -16.906376183141
     4.0000e+00     4.0000e+01             1.2451e-04       -16.906374082169

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0634e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
   uu_0                 3.125977e-01 1 1  ON 0
   uu_1                 1.451855e-01 1 1  ON 1
   uu_2                 4.332344e-02 1 1  ON 2
   uu_3                -1.936165e-02 1 1  ON 3
   uu_4                -6.524989e-02 1 1  ON 4
   uu_5                -1.004869e-01 1 1  ON 5
   uu_6                -1.281612e-01 1 1  ON 6
   uu_7                -1.412891e-01 1 1  ON 7
   uu_8                -1.341320e-01 1 1  ON 8
   uu_9                -1.024305e-01 1 1  ON 9
   ud_0                 4.466611e-01 1 1  ON 10
   ud_1                 1.808316e-01 1 1  ON 11
   ud_2                 6.081779e-02 1 1  ON 12
   ud_3                -1.007685e-02 1 1  ON 13
   ud_4                -6.676968e-02 1 1  ON 14
   ud_5                -1.081010e-01 1 1  ON 15
   ud_6                -1.350548e-01 1 1  ON 16
   ud_7                -1.508768e-01 1 1  ON 17
   ud_8                -1.508868e-01 1 1  ON 18
   ud_9                -1.402016e-01 1 1  ON 19
   eO_0                -7.496847e-01 1 1  ON 20
   eO_1                -4.294669e-01 1 1  ON 21
   eO_2                -1.993767e-02 1 1  ON 22
   eO_3                 2.910366e-01 1 1  ON 23
   eO_4                 5.152511e-01 1 1  ON 24
   eO_5                 4.773321e-01 1 1  ON 25
   eO_6                 2.504106e-01 1 1  ON 26
   eO_7                -4.615213e-02 1 1  ON 27
   eO_8                -2.145102e-01 1 1  ON 28
   eO_9                -7.497157e-02 1 1  ON 29
  eH1_0                -2.527624e-01 1 1  ON 30
  eH1_1                -1.457663e-01 1 1  ON 31
  eH1_2                -9.584863e-02 1 1  ON 32
  eH1_3                -4.074217e-02 1 1  ON 33
  eH1_4                 8.709593e-03 1 1  ON 34
  eH1_5                 4.350643e-02 1 1  ON 35
  eH1_6                 1.014277e-01 1 1  ON 36
  eH1_7                 1.545543e-01 1 1  ON 37
  eH1_8                 1.723008e-01 1 1  ON 38
  eH1_9                 5.779163e-02 1 1  ON 39
  eH2_0                -2.503374e-01 1 1  ON 40
  eH2_1                -1.424936e-01 1 1  ON 41
  eH2_2                -9.250037e-02 1 1  ON 42
  eH2_3                -3.723591e-02 1 1  ON 43
  eH2_4                 1.196932e-02 1 1  ON 44
  eH2_5                 4.691304e-02 1 1  ON 45
  eH2_6                 1.040496e-01 1 1  ON 46
  eH2_7                 1.549896e-01 1 1  ON 47
  eH2_8                 1.762216e-01 1 1  ON 48
  eH2_9                 4.471189e-02 1 1  ON 49
ci_0001                 7.010290e-01 3 1  ON 50
ci_0002                 7.007512e-01 3 1  ON 51
ci_0003                -2.734543e-02 3 1  ON 52
ci_0004                -2.743606e-02 3 1  ON 53
ci_0005                -3.605987e-02 3 1  ON 54
ci_0006                -3.630555e-02 3 1  ON 55
ci_0007                -2.097342e-02 3 1  ON 56
ci_0008                -2.183072e-02 3 1  ON 57
ci_0009                -1.708127e-02 3 1  ON 58
ci_0010                -1.744475e-02 3 1  ON 59
ci_0011                -1.194067e-02 3 1  ON 60
ci_0012                -1.228350e-02 3 1  ON 61
ci_0013                 1.343447e-02 3 1  ON 62
ci_0014                 1.318962e-02 3 1  ON 63
ci_0015                 1.315116e-02 3 1  ON 64
ci_0016                 1.360725e-02 3 1  ON 65
ci_0017                 1.158704e-02 3 1  ON 66
ci_0018                 1.117197e-02 3 1  ON 67
ci_0019                 1.183893e-02 3 1  ON 68
ci_0020                 1.133851e-02 3 1  ON 69
ci_0021                -1.334499e-03 3 1  ON 70
ci_0022                -6.423766e-04 3 1  ON 71
ci_0023                -1.098129e-02 3 1  ON 72
ci_0024                -1.043690e-02 3 1  ON 73
ci_0025                -9.720183e-03 3 1  ON 74
ci_0026                -1.067121e-02 3 1  ON 75
ci_0027                -1.150613e-02 3 1  ON 76
ci_0028                -1.118990e-02 3 1  ON 77
ci_0029                -1.069117e-02 3 1  ON 78
ci_0030                -1.073309e-02 3 1  ON 79
ci_0031                 2.009888e-02 3 1  ON 80
ci_0032                 2.133691e-02 3 1  ON 81
ci_0033                 1.060124e-02 3 1  ON 82
ci_0034                 9.955104e-03 3 1  ON 83
ci_0035                 7.276989e-03 3 1  ON 84
ci_0036                 6.903713e-03 3 1  ON 85
ci_0037                -1.002580e-02 3 1  ON 86
ci_0038                -1.093773e-02 3 1  ON 87
ci_0039                -2.883511e-03 3 1  ON 88
ci_0040                -2.643350e-03 3 1  ON 89
ci_0041                 6.770363e-03 3 1  ON 90
ci_0042                 7.062825e-03 3 1  ON 91
ci_0043                -1.934015e-02 3 1  ON 92
ci_0044                -1.909391e-02 3 1  ON 93
ci_0045                 7.576974e-03 3 1  ON 94
ci_0046                 8.352241e-03 3 1  ON 95
ci_0047                -2.005808e-03 3 1  ON 96
ci_0048                -1.944941e-03 3 1  ON 97
ci_0049                -5.938212e-03 3 1  ON 98
ci_0050                -5.830373e-03 3 1  ON 99
ci_0051                -3.506970e-03 3 1  ON 100
ci_0052                -3.443126e-03 3 1  ON 101
ci_0053                -4.711502e-03 3 1  ON 102
ci_0054                -4.249914e-03 3 1  ON 103
ci_0055                 5.862582e-03 3 1  ON 104
ci_0056                 6.380120e-03 3 1  ON 105
ci_0057                 4.570866e-03 3 1  ON 106
ci_0058                 5.003366e-03 3 1  ON 107
ci_0059                -4.755500e-03 3 1  ON 108
ci_0060                -4.275314e-03 3 1  ON 109
ci_0061                -4.154669e-03 3 1  ON 110
ci_0062                -3.628792e-03 3 1  ON 111
ci_0063                -8.273623e-03 3 1  ON 112
ci_0064                -8.666447e-03 3 1  ON 113
ci_0065                -5.410161e-03 3 1  ON 114
ci_0066                -5.585232e-03 3 1  ON 115
ci_0067                -4.432829e-03 3 1  ON 116
ci_0068                -5.034613e-03 3 1  ON 117
ci_0069                 4.497041e-03 3 1  ON 118
ci_0070                 4.727121e-03 3 1  ON 119
ci_0071                 5.539893e-05 3 1  ON 120
ci_0072                -4.256439e-04 3 1  ON 121
ci_0073                 4.663121e-03 3 1  ON 122
ci_0074                 4.406734e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8614e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6964e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.806
    reference variance = 0.256389
====================================================
  Execution time = 2.1270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2936e-01
  Total weights = 1.951424235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318848343684
                                         uncertainty =       0.001778964385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318848343684
                                         uncertainty =       0.001778964385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399381859
  error estimate for blocks of size 2^( 2) =       0.000412388810
  error estimate for blocks of size 2^( 3) =       0.000425693706
  error estimate for blocks of size 2^( 4) =       0.000438204918
  error estimate for blocks of size 2^( 5) =       0.000447852857
  error estimate for blocks of size 2^( 6) =       0.000455913538
  error estimate for blocks of size 2^( 7) =       0.000460229350

      target function =                  N/A
              le_mean =     -16.905886496870
             les_mean =     286.138361834675
             stat err =       0.000450550166
             autocorr =       1.272651929292
              std dev =       0.564811241010
             le_variance =       0.319011737971


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588649687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886496855       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905907093938       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905911239549       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905905580686       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905904568320       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905903765704       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905902596091       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905904415642       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905905605620       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905905437948       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905906611096       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905906208778       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905906350818       residual = 9.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905906750217       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905907303560       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905907391299       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905907494608       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905907495366       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 2.818418e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886496855       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898964246       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901188400       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898944498       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898023866       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898438572       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905897754914       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905898001142       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905898192109       residual = 8.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905898522090       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905898663213       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905898661877       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 9.565502e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905886496855       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891331408       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905892171761       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891764805       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891192847       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891304657       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891323849       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891291501       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905891303583       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905891326591       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 3.610962e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150907 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7520e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.127204e-01 1 1  ON 0
   uu_1                 1.450882e-01 1 1  ON 1
   uu_2                 4.327500e-02 1 1  ON 2
   uu_3                -1.944503e-02 1 1  ON 3
   uu_4                -6.530060e-02 1 1  ON 4
   uu_5                -1.002712e-01 1 1  ON 5
   uu_6                -1.278562e-01 1 1  ON 6
   uu_7                -1.414493e-01 1 1  ON 7
   uu_8                -1.346661e-01 1 1  ON 8
   uu_9                -1.028756e-01 1 1  ON 9
   ud_0                 4.472221e-01 1 1  ON 10
   ud_1                 1.813184e-01 1 1  ON 11
   ud_2                 6.110018e-02 1 1  ON 12
   ud_3                -9.974664e-03 1 1  ON 13
   ud_4                -6.667933e-02 1 1  ON 14
   ud_5                -1.080090e-01 1 1  ON 15
   ud_6                -1.352999e-01 1 1  ON 16
   ud_7                -1.512050e-01 1 1  ON 17
   ud_8                -1.514766e-01 1 1  ON 18
   ud_9                -1.405400e-01 1 1  ON 19
   eO_0                -7.497179e-01 1 1  ON 20
   eO_1                -4.296993e-01 1 1  ON 21
   eO_2                -1.980458e-02 1 1  ON 22
   eO_3                 2.913653e-01 1 1  ON 23
   eO_4                 5.155206e-01 1 1  ON 24
   eO_5                 4.775244e-01 1 1  ON 25
   eO_6                 2.509095e-01 1 1  ON 26
   eO_7                -4.603403e-02 1 1  ON 27
   eO_8                -2.151639e-01 1 1  ON 28
   eO_9                -7.549047e-02 1 1  ON 29
  eH1_0                -2.534136e-01 1 1  ON 30
  eH1_1                -1.458574e-01 1 1  ON 31
  eH1_2                -9.632709e-02 1 1  ON 32
  eH1_3                -4.099535e-02 1 1  ON 33
  eH1_4                 8.605025e-03 1 1  ON 34
  eH1_5                 4.338489e-02 1 1  ON 35
  eH1_6                 1.014029e-01 1 1  ON 36
  eH1_7                 1.548867e-01 1 1  ON 37
  eH1_8                 1.729543e-01 1 1  ON 38
  eH1_9                 5.848113e-02 1 1  ON 39
  eH2_0                -2.504678e-01 1 1  ON 40
  eH2_1                -1.425035e-01 1 1  ON 41
  eH2_2                -9.292402e-02 1 1  ON 42
  eH2_3                -3.776635e-02 1 1  ON 43
  eH2_4                 1.171766e-02 1 1  ON 44
  eH2_5                 4.676746e-02 1 1  ON 45
  eH2_6                 1.041799e-01 1 1  ON 46
  eH2_7                 1.553827e-01 1 1  ON 47
  eH2_8                 1.766244e-01 1 1  ON 48
  eH2_9                 4.525423e-02 1 1  ON 49
ci_0001                 7.009200e-01 3 1  ON 50
ci_0002                 7.009221e-01 3 1  ON 51
ci_0003                -2.717438e-02 3 1  ON 52
ci_0004                -2.740785e-02 3 1  ON 53
ci_0005                -3.571601e-02 3 1  ON 54
ci_0006                -3.657992e-02 3 1  ON 55
ci_0007                -2.123689e-02 3 1  ON 56
ci_0008                -2.129134e-02 3 1  ON 57
ci_0009                -1.769120e-02 3 1  ON 58
ci_0010                -1.683446e-02 3 1  ON 59
ci_0011                -1.186100e-02 3 1  ON 60
ci_0012                -1.237350e-02 3 1  ON 61
ci_0013                 1.323332e-02 3 1  ON 62
ci_0014                 1.309522e-02 3 1  ON 63
ci_0015                 1.314672e-02 3 1  ON 64
ci_0016                 1.293489e-02 3 1  ON 65
ci_0017                 1.154506e-02 3 1  ON 66
ci_0018                 1.102103e-02 3 1  ON 67
ci_0019                 1.088238e-02 3 1  ON 68
ci_0020                 1.153051e-02 3 1  ON 69
ci_0021                -1.187379e-03 3 1  ON 70
ci_0022                -9.339268e-04 3 1  ON 71
ci_0023                -1.121708e-02 3 1  ON 72
ci_0024                -1.082991e-02 3 1  ON 73
ci_0025                -1.020910e-02 3 1  ON 74
ci_0026                -1.084939e-02 3 1  ON 75
ci_0027                -1.124986e-02 3 1  ON 76
ci_0028                -1.138651e-02 3 1  ON 77
ci_0029                -1.045005e-02 3 1  ON 78
ci_0030                -1.069223e-02 3 1  ON 79
ci_0031                 1.954305e-02 3 1  ON 80
ci_0032                 2.098931e-02 3 1  ON 81
ci_0033                 1.097417e-02 3 1  ON 82
ci_0034                 1.026191e-02 3 1  ON 83
ci_0035                 7.153419e-03 3 1  ON 84
ci_0036                 6.664591e-03 3 1  ON 85
ci_0037                -9.901746e-03 3 1  ON 86
ci_0038                -1.072209e-02 3 1  ON 87
ci_0039                -2.727554e-03 3 1  ON 88
ci_0040                -2.459693e-03 3 1  ON 89
ci_0041                 6.918780e-03 3 1  ON 90
ci_0042                 6.985749e-03 3 1  ON 91
ci_0043                -1.969654e-02 3 1  ON 92
ci_0044                -1.923149e-02 3 1  ON 93
ci_0045                 7.560503e-03 3 1  ON 94
ci_0046                 8.088796e-03 3 1  ON 95
ci_0047                -1.643971e-03 3 1  ON 96
ci_0048                -1.828462e-03 3 1  ON 97
ci_0049                -5.749843e-03 3 1  ON 98
ci_0050                -5.740820e-03 3 1  ON 99
ci_0051                -3.158007e-03 3 1  ON 100
ci_0052                -3.353663e-03 3 1  ON 101
ci_0053                -4.741926e-03 3 1  ON 102
ci_0054                -4.541505e-03 3 1  ON 103
ci_0055                 5.853963e-03 3 1  ON 104
ci_0056                 6.523199e-03 3 1  ON 105
ci_0057                 4.051772e-03 3 1  ON 106
ci_0058                 4.726751e-03 3 1  ON 107
ci_0059                -4.667353e-03 3 1  ON 108
ci_0060                -4.692443e-03 3 1  ON 109
ci_0061                -4.022302e-03 3 1  ON 110
ci_0062                -4.036366e-03 3 1  ON 111
ci_0063                -8.537405e-03 3 1  ON 112
ci_0064                -8.568604e-03 3 1  ON 113
ci_0065                -5.451091e-03 3 1  ON 114
ci_0066                -5.589991e-03 3 1  ON 115
ci_0067                -4.778989e-03 3 1  ON 116
ci_0068                -4.824389e-03 3 1  ON 117
ci_0069                 4.329587e-03 3 1  ON 118
ci_0070                 4.647660e-03 3 1  ON 119
ci_0071                 1.122442e-04 3 1  ON 120
ci_0072                 1.106222e-04 3 1  ON 121
ci_0073                 4.245185e-03 3 1  ON 122
ci_0074                 4.706014e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9745
    reference variance = 0.295213
====================================================
  Execution time = 2.2827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3691e-01
  Total weights = 1.9516e+06
  Execution time = 1.8995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321003517340
                                         uncertainty =       0.002053723689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321003517340
                                         uncertainty =       0.002053723689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400602745
  error estimate for blocks of size 2^( 2) =       0.000413691618
  error estimate for blocks of size 2^( 3) =       0.000427362472
  error estimate for blocks of size 2^( 4) =       0.000439385676
  error estimate for blocks of size 2^( 5) =       0.000448113662
  error estimate for blocks of size 2^( 6) =       0.000455842028
  error estimate for blocks of size 2^( 7) =       0.000461536115

      target function =                  N/A
              le_mean =     -16.905906375653
             les_mean =     286.158078554539
             stat err =       0.000451219370
             autocorr =       1.268666958787
              std dev =       0.566537834440
             le_variance =       0.320965117852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321949696130
                                         uncertainty =       0.002065936002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321949696130
                                         uncertainty =       0.002065936002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401191031
  error estimate for blocks of size 2^( 2) =       0.000414268600
  error estimate for blocks of size 2^( 3) =       0.000427934998
  error estimate for blocks of size 2^( 4) =       0.000439963293
  error estimate for blocks of size 2^( 5) =       0.000448729502
  error estimate for blocks of size 2^( 6) =       0.000456413030
  error estimate for blocks of size 2^( 7) =       0.000462071664

      target function =                  N/A
              le_mean =     -16.905900166608
             les_mean =     286.543686682631
             stat err =       0.000451794372
             autocorr =       1.268175044423
              std dev =       0.567369797298
             le_variance =       0.321908486886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321613004698
                                         uncertainty =       0.002029799942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321613004698
                                         uncertainty =       0.002029799942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400981931
  error estimate for blocks of size 2^( 2) =       0.000414084505
  error estimate for blocks of size 2^( 3) =       0.000427781699
  error estimate for blocks of size 2^( 4) =       0.000439834915
  error estimate for blocks of size 2^( 5) =       0.000448587720
  error estimate for blocks of size 2^( 6) =       0.000456299944
  error estimate for blocks of size 2^( 7) =       0.000462078680

      target function =                  N/A
              le_mean =     -16.905892838465
             les_mean =     286.163521791784
             stat err =       0.000451700315
             autocorr =       1.268969488116
              std dev =       0.567074085441
             le_variance =       0.321573018379

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341802140581
                                         uncertainty =       0.020674544739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341802140581
                                         uncertainty =       0.020674544739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413387875
  error estimate for blocks of size 2^( 2) =       0.000426041406
  error estimate for blocks of size 2^( 3) =       0.000439358596
  error estimate for blocks of size 2^( 4) =       0.000450989779
  error estimate for blocks of size 2^( 5) =       0.000459831360
  error estimate for blocks of size 2^( 6) =       0.000467376247
  error estimate for blocks of size 2^( 7) =       0.000473068766

      target function =                  N/A
              le_mean =     -16.905997099531
             les_mean =     292.603090309608
             stat err =       0.000462816538
             autocorr =       1.253436303045
              std dev =       0.584618739757
             le_variance =       0.341779070875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905906375653        initial
     6.2500e-02     6.2500e-01             2.8184e-03       -16.905900166608
     2.5000e-01     2.5000e+00             9.5655e-04       -16.905892838465
     1.0000e+00     1.0000e+01             3.6110e-04       -16.905997099531  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 3.2413e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.126586e-01 1 1  ON 0
   uu_1                 1.451302e-01 1 1  ON 1
   uu_2                 4.330678e-02 1 1  ON 2
   uu_3                -1.939158e-02 1 1  ON 3
   uu_4                -6.527071e-02 1 1  ON 4
   uu_5                -1.004107e-01 1 1  ON 5
   uu_6                -1.280423e-01 1 1  ON 6
   uu_7                -1.413495e-01 1 1  ON 7
   uu_8                -1.342843e-01 1 1  ON 8
   uu_9                -1.025427e-01 1 1  ON 9
   ud_0                 4.468408e-01 1 1  ON 10
   ud_1                 1.809849e-01 1 1  ON 11
   ud_2                 6.089445e-02 1 1  ON 12
   ud_3                -1.007365e-02 1 1  ON 13
   ud_4                -6.674588e-02 1 1  ON 14
   ud_5                -1.080801e-01 1 1  ON 15
   ud_6                -1.351414e-01 1 1  ON 16
   ud_7                -1.509738e-01 1 1  ON 17
   ud_8                -1.510485e-01 1 1  ON 18
   ud_9                -1.402868e-01 1 1  ON 19
   eO_0                -7.496690e-01 1 1  ON 20
   eO_1                -4.295636e-01 1 1  ON 21
   eO_2                -1.989916e-02 1 1  ON 22
   eO_3                 2.911388e-01 1 1  ON 23
   eO_4                 5.153121e-01 1 1  ON 24
   eO_5                 4.773758e-01 1 1  ON 25
   eO_6                 2.505381e-01 1 1  ON 26
   eO_7                -4.612794e-02 1 1  ON 27
   eO_8                -2.146738e-01 1 1  ON 28
   eO_9                -7.509889e-02 1 1  ON 29
  eH1_0                -2.529431e-01 1 1  ON 30
  eH1_1                -1.457524e-01 1 1  ON 31
  eH1_2                -9.599100e-02 1 1  ON 32
  eH1_3                -4.080173e-02 1 1  ON 33
  eH1_4                 8.697718e-03 1 1  ON 34
  eH1_5                 4.346970e-02 1 1  ON 35
  eH1_6                 1.014201e-01 1 1  ON 36
  eH1_7                 1.546377e-01 1 1  ON 37
  eH1_8                 1.724616e-01 1 1  ON 38
  eH1_9                 5.796044e-02 1 1  ON 39
  eH2_0                -2.503586e-01 1 1  ON 40
  eH2_1                -1.424470e-01 1 1  ON 41
  eH2_2                -9.262040e-02 1 1  ON 42
  eH2_3                -3.740753e-02 1 1  ON 43
  eH2_4                 1.191776e-02 1 1  ON 44
  eH2_5                 4.686983e-02 1 1  ON 45
  eH2_6                 1.040800e-01 1 1  ON 46
  eH2_7                 1.550858e-01 1 1  ON 47
  eH2_8                 1.763184e-01 1 1  ON 48
  eH2_9                 4.484408e-02 1 1  ON 49
ci_0001                 7.010090e-01 3 1  ON 50
ci_0002                 7.007945e-01 3 1  ON 51
ci_0003                -2.728041e-02 3 1  ON 52
ci_0004                -2.742470e-02 3 1  ON 53
ci_0005                -3.594660e-02 3 1  ON 54
ci_0006                -3.639684e-02 3 1  ON 55
ci_0007                -2.105508e-02 3 1  ON 56
ci_0008                -2.166432e-02 3 1  ON 57
ci_0009                -1.732385e-02 3 1  ON 58
ci_0010                -1.720150e-02 3 1  ON 59
ci_0011                -1.190349e-02 3 1  ON 60
ci_0012                -1.232020e-02 3 1  ON 61
ci_0013                 1.335791e-02 3 1  ON 62
ci_0014                 1.315562e-02 3 1  ON 63
ci_0015                 1.314662e-02 3 1  ON 64
ci_0016                 1.335086e-02 3 1  ON 65
ci_0017                 1.157047e-02 3 1  ON 66
ci_0018                 1.111291e-02 3 1  ON 67
ci_0019                 1.147783e-02 3 1  ON 68
ci_0020                 1.141193e-02 3 1  ON 69
ci_0021                -1.288004e-03 3 1  ON 70
ci_0022                -7.338933e-04 3 1  ON 71
ci_0023                -1.107432e-02 3 1  ON 72
ci_0024                -1.058987e-02 3 1  ON 73
ci_0025                -9.912377e-03 3 1  ON 74
ci_0026                -1.074232e-02 3 1  ON 75
ci_0027                -1.140770e-02 3 1  ON 76
ci_0028                -1.126108e-02 3 1  ON 77
ci_0029                -1.060096e-02 3 1  ON 78
ci_0030                -1.071038e-02 3 1  ON 79
ci_0031                 1.991061e-02 3 1  ON 80
ci_0032                 2.122004e-02 3 1  ON 81
ci_0033                 1.072216e-02 3 1  ON 82
ci_0034                 1.005632e-02 3 1  ON 83
ci_0035                 7.228208e-03 3 1  ON 84
ci_0036                 6.814962e-03 3 1  ON 85
ci_0037                -9.986234e-03 3 1  ON 86
ci_0038                -1.086095e-02 3 1  ON 87
ci_0039                -2.814198e-03 3 1  ON 88
ci_0040                -2.562404e-03 3 1  ON 89
ci_0041                 6.824838e-03 3 1  ON 90
ci_0042                 7.031267e-03 3 1  ON 91
ci_0043                -1.943764e-02 3 1  ON 92
ci_0044                -1.913358e-02 3 1  ON 93
ci_0045                 7.571411e-03 3 1  ON 94
ci_0046                 8.262819e-03 3 1  ON 95
ci_0047                -1.846158e-03 3 1  ON 96
ci_0048                -1.893272e-03 3 1  ON 97
ci_0049                -5.865926e-03 3 1  ON 98
ci_0050                -5.794788e-03 3 1  ON 99
ci_0051                -3.357704e-03 3 1  ON 100
ci_0052                -3.404700e-03 3 1  ON 101
ci_0053                -4.723613e-03 3 1  ON 102
ci_0054                -4.371276e-03 3 1  ON 103
ci_0055                 5.858512e-03 3 1  ON 104
ci_0056                 6.428703e-03 3 1  ON 105
ci_0057                 4.381017e-03 3 1  ON 106
ci_0058                 4.904822e-03 3 1  ON 107
ci_0059                -4.716718e-03 3 1  ON 108
ci_0060                -4.453441e-03 3 1  ON 109
ci_0061                -4.106485e-03 3 1  ON 110
ci_0062                -3.779874e-03 3 1  ON 111
ci_0063                -8.383884e-03 3 1  ON 112
ci_0064                -8.623247e-03 3 1  ON 113
ci_0065                -5.426293e-03 3 1  ON 114
ci_0066                -5.584296e-03 3 1  ON 115
ci_0067                -4.581714e-03 3 1  ON 116
ci_0068                -4.942855e-03 3 1  ON 117
ci_0069                 4.426000e-03 3 1  ON 118
ci_0070                 4.691957e-03 3 1  ON 119
ci_0071                 7.368347e-05 3 1  ON 120
ci_0072                -2.208270e-04 3 1  ON 121
ci_0073                 4.480598e-03 3 1  ON 122
ci_0074                 4.538583e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9961e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9039
    reference variance = 0.240192
====================================================
  Execution time = 2.1856e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5228e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4300e-01
  Total weights = 1.951661549e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326898632917
                                         uncertainty =       0.006545908958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326898632917
                                         uncertainty =       0.006545908958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404294072
  error estimate for blocks of size 2^( 2) =       0.000416935524
  error estimate for blocks of size 2^( 3) =       0.000430405611
  error estimate for blocks of size 2^( 4) =       0.000442063713
  error estimate for blocks of size 2^( 5) =       0.000452870732
  error estimate for blocks of size 2^( 6) =       0.000460622248
  error estimate for blocks of size 2^( 7) =       0.000464588424

      target function =                  N/A
              le_mean =     -16.906386740002
             les_mean =     286.168915856922
             stat err =       0.000455036279
             autocorr =       1.266768630434
              std dev =       0.571758159669
             le_variance =       0.326907393148


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638674000e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386740015       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906390851803       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906391245992       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906391895818       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906391224193       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906391900251       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906393322530       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906393051710       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906393275549       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906393625801       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906393503208       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906393491002       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 9.804424e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386740015       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906388295332       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906388160641       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906388550003       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906388437915       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906388549263       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906388719002       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906388920174       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906388904011       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906388945248       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 3.747178e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906386740015       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906387186052       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906387126043       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906387238526       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906387210291       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906387228986       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906387248866       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906387315397       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906387316271       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906387324622       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 4.0000e+00 is 1.099684e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8088e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.126130e-01 1 1  ON 0
   uu_1                 1.451022e-01 1 1  ON 1
   uu_2                 4.325088e-02 1 1  ON 2
   uu_3                -1.936566e-02 1 1  ON 3
   uu_4                -6.523174e-02 1 1  ON 4
   uu_5                -1.003441e-01 1 1  ON 5
   uu_6                -1.279477e-01 1 1  ON 6
   uu_7                -1.414851e-01 1 1  ON 7
   uu_8                -1.343547e-01 1 1  ON 8
   uu_9                -1.026233e-01 1 1  ON 9
   ud_0                 4.469091e-01 1 1  ON 10
   ud_1                 1.811792e-01 1 1  ON 11
   ud_2                 6.091610e-02 1 1  ON 12
   ud_3                -1.003693e-02 1 1  ON 13
   ud_4                -6.673859e-02 1 1  ON 14
   ud_5                -1.080223e-01 1 1  ON 15
   ud_6                -1.351612e-01 1 1  ON 16
   ud_7                -1.511518e-01 1 1  ON 17
   ud_8                -1.511478e-01 1 1  ON 18
   ud_9                -1.402940e-01 1 1  ON 19
   eO_0                -7.497694e-01 1 1  ON 20
   eO_1                -4.295569e-01 1 1  ON 21
   eO_2                -1.979295e-02 1 1  ON 22
   eO_3                 2.911744e-01 1 1  ON 23
   eO_4                 5.153134e-01 1 1  ON 24
   eO_5                 4.774206e-01 1 1  ON 25
   eO_6                 2.506890e-01 1 1  ON 26
   eO_7                -4.609059e-02 1 1  ON 27
   eO_8                -2.148157e-01 1 1  ON 28
   eO_9                -7.522727e-02 1 1  ON 29
  eH1_0                -2.530790e-01 1 1  ON 30
  eH1_1                -1.457683e-01 1 1  ON 31
  eH1_2                -9.610447e-02 1 1  ON 32
  eH1_3                -4.092685e-02 1 1  ON 33
  eH1_4                 8.645265e-03 1 1  ON 34
  eH1_5                 4.347158e-02 1 1  ON 35
  eH1_6                 1.014357e-01 1 1  ON 36
  eH1_7                 1.546885e-01 1 1  ON 37
  eH1_8                 1.726452e-01 1 1  ON 38
  eH1_9                 5.815014e-02 1 1  ON 39
  eH2_0                -2.504160e-01 1 1  ON 40
  eH2_1                -1.424444e-01 1 1  ON 41
  eH2_2                -9.267309e-02 1 1  ON 42
  eH2_3                -3.749572e-02 1 1  ON 43
  eH2_4                 1.186110e-02 1 1  ON 44
  eH2_5                 4.686645e-02 1 1  ON 45
  eH2_6                 1.040012e-01 1 1  ON 46
  eH2_7                 1.551067e-01 1 1  ON 47
  eH2_8                 1.764553e-01 1 1  ON 48
  eH2_9                 4.500873e-02 1 1  ON 49
ci_0001                 7.010702e-01 3 1  ON 50
ci_0002                 7.007293e-01 3 1  ON 51
ci_0003                -2.692154e-02 3 1  ON 52
ci_0004                -2.720819e-02 3 1  ON 53
ci_0005                -3.605480e-02 3 1  ON 54
ci_0006                -3.643750e-02 3 1  ON 55
ci_0007                -2.108953e-02 3 1  ON 56
ci_0008                -2.188162e-02 3 1  ON 57
ci_0009                -1.741236e-02 3 1  ON 58
ci_0010                -1.724415e-02 3 1  ON 59
ci_0011                -1.197124e-02 3 1  ON 60
ci_0012                -1.232357e-02 3 1  ON 61
ci_0013                 1.319016e-02 3 1  ON 62
ci_0014                 1.325156e-02 3 1  ON 63
ci_0015                 1.320562e-02 3 1  ON 64
ci_0016                 1.322428e-02 3 1  ON 65
ci_0017                 1.155354e-02 3 1  ON 66
ci_0018                 1.119839e-02 3 1  ON 67
ci_0019                 1.151970e-02 3 1  ON 68
ci_0020                 1.124682e-02 3 1  ON 69
ci_0021                -1.282683e-03 3 1  ON 70
ci_0022                -7.559973e-04 3 1  ON 71
ci_0023                -1.118545e-02 3 1  ON 72
ci_0024                -1.096459e-02 3 1  ON 73
ci_0025                -9.862301e-03 3 1  ON 74
ci_0026                -1.081372e-02 3 1  ON 75
ci_0027                -1.135529e-02 3 1  ON 76
ci_0028                -1.132922e-02 3 1  ON 77
ci_0029                -1.064820e-02 3 1  ON 78
ci_0030                -1.078067e-02 3 1  ON 79
ci_0031                 1.975252e-02 3 1  ON 80
ci_0032                 2.113689e-02 3 1  ON 81
ci_0033                 1.060352e-02 3 1  ON 82
ci_0034                 1.023166e-02 3 1  ON 83
ci_0035                 7.395896e-03 3 1  ON 84
ci_0036                 6.987634e-03 3 1  ON 85
ci_0037                -9.960449e-03 3 1  ON 86
ci_0038                -1.089227e-02 3 1  ON 87
ci_0039                -2.805312e-03 3 1  ON 88
ci_0040                -2.550227e-03 3 1  ON 89
ci_0041                 6.982735e-03 3 1  ON 90
ci_0042                 7.172336e-03 3 1  ON 91
ci_0043                -1.947572e-02 3 1  ON 92
ci_0044                -1.919810e-02 3 1  ON 93
ci_0045                 7.667509e-03 3 1  ON 94
ci_0046                 8.069432e-03 3 1  ON 95
ci_0047                -1.667489e-03 3 1  ON 96
ci_0048                -1.909375e-03 3 1  ON 97
ci_0049                -5.699027e-03 3 1  ON 98
ci_0050                -5.938864e-03 3 1  ON 99
ci_0051                -3.413627e-03 3 1  ON 100
ci_0052                -3.408339e-03 3 1  ON 101
ci_0053                -4.838422e-03 3 1  ON 102
ci_0054                -4.330732e-03 3 1  ON 103
ci_0055                 5.966239e-03 3 1  ON 104
ci_0056                 6.392017e-03 3 1  ON 105
ci_0057                 4.331043e-03 3 1  ON 106
ci_0058                 4.823657e-03 3 1  ON 107
ci_0059                -4.837021e-03 3 1  ON 108
ci_0060                -4.497433e-03 3 1  ON 109
ci_0061                -4.077165e-03 3 1  ON 110
ci_0062                -3.734796e-03 3 1  ON 111
ci_0063                -8.407382e-03 3 1  ON 112
ci_0064                -8.557584e-03 3 1  ON 113
ci_0065                -5.410384e-03 3 1  ON 114
ci_0066                -5.503508e-03 3 1  ON 115
ci_0067                -4.737967e-03 3 1  ON 116
ci_0068                -4.880634e-03 3 1  ON 117
ci_0069                 4.336903e-03 3 1  ON 118
ci_0070                 4.677272e-03 3 1  ON 119
ci_0071                 1.330313e-04 3 1  ON 120
ci_0072                -1.148062e-04 3 1  ON 121
ci_0073                 4.466712e-03 3 1  ON 122
ci_0074                 4.498706e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.6988
    reference variance = 5.2343
====================================================
  Execution time = 2.1435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6909e+01
  VMC Evar = 3.6402e-01
  Total weights = 1.9518e+06
  Execution time = 1.8898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349986882493
                                         uncertainty =       0.017731167339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349986882493
                                         uncertainty =       0.017731167339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418565674
  error estimate for blocks of size 2^( 2) =       0.000446473147
  error estimate for blocks of size 2^( 3) =       0.000487678658
  error estimate for blocks of size 2^( 4) =       0.000550451575
  error estimate for blocks of size 2^( 5) =       0.000647212462
  error estimate for blocks of size 2^( 6) =       0.000797887681
  error estimate for blocks of size 2^( 7) =       0.001017169485

      target function =                  N/A
              le_mean =     -16.909036725014
             les_mean =     286.280128802630
             stat err =       0.000753180301
             autocorr =       3.237954088130
              std dev =       0.591941252643
             le_variance =       0.350394446580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350023267184
                                         uncertainty =       0.017719536222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350023267184
                                         uncertainty =       0.017719536222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418587652
  error estimate for blocks of size 2^( 2) =       0.000446489962
  error estimate for blocks of size 2^( 3) =       0.000487688285
  error estimate for blocks of size 2^( 4) =       0.000550442269
  error estimate for blocks of size 2^( 5) =       0.000647212639
  error estimate for blocks of size 2^( 6) =       0.000797845255
  error estimate for blocks of size 2^( 7) =       0.001017096868

      target function =                  N/A
              le_mean =     -16.909050375568
             les_mean =     286.287031522105
             stat err =       0.000753149258
             autocorr =       3.237347191677
              std dev =       0.591972335198
             le_variance =       0.350431245640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349932254267
                                         uncertainty =       0.017722409368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349932254267
                                         uncertainty =       0.017722409368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418533201
  error estimate for blocks of size 2^( 2) =       0.000446438546
  error estimate for blocks of size 2^( 3) =       0.000487641449
  error estimate for blocks of size 2^( 4) =       0.000550406836
  error estimate for blocks of size 2^( 5) =       0.000647175227
  error estimate for blocks of size 2^( 6) =       0.000797824276
  error estimate for blocks of size 2^( 7) =       0.001017087380

      target function =                  N/A
              le_mean =     -16.909045425672
             les_mean =     286.280027418534
             stat err =       0.000753123430
             autocorr =       3.237967507977
              std dev =       0.591895329850
             le_variance =       0.350340081498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349961984027
                                         uncertainty =       0.017729858839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349961984027
                                         uncertainty =       0.017729858839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418550827
  error estimate for blocks of size 2^( 2) =       0.000446458561
  error estimate for blocks of size 2^( 3) =       0.000487664196
  error estimate for blocks of size 2^( 4) =       0.000550436989
  error estimate for blocks of size 2^( 5) =       0.000647199717
  error estimate for blocks of size 2^( 6) =       0.000797872720
  error estimate for blocks of size 2^( 7) =       0.001017152765

      target function =                  N/A
              le_mean =     -16.909036595211
             les_mean =     286.279797344210
             stat err =       0.000753165548
             autocorr =       3.238056957223
              std dev =       0.591920255430
             le_variance =       0.350369588788


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909036725014        initial
     2.5000e-01     2.5000e+00             9.8044e-04       -16.909050375568  <--
     1.0000e+00     1.0000e+01             3.7472e-04       -16.909045425672
     4.0000e+00     4.0000e+01             1.0997e-04       -16.909036595211

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0985e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.125260e-01 1 1  ON 0
   uu_1                 1.450550e-01 1 1  ON 1
   uu_2                 4.319451e-02 1 1  ON 2
   uu_3                -1.933977e-02 1 1  ON 3
   uu_4                -6.514418e-02 1 1  ON 4
   uu_5                -1.002264e-01 1 1  ON 5
   uu_6                -1.278189e-01 1 1  ON 6
   uu_7                -1.417757e-01 1 1  ON 7
   uu_8                -1.345492e-01 1 1  ON 8
   uu_9                -1.028799e-01 1 1  ON 9
   ud_0                 4.471815e-01 1 1  ON 10
   ud_1                 1.815137e-01 1 1  ON 11
   ud_2                 6.105409e-02 1 1  ON 12
   ud_3                -9.932128e-03 1 1  ON 13
   ud_4                -6.667928e-02 1 1  ON 14
   ud_5                -1.079008e-01 1 1  ON 15
   ud_6                -1.352120e-01 1 1  ON 16
   ud_7                -1.515355e-01 1 1  ON 17
   ud_8                -1.514388e-01 1 1  ON 18
   ud_9                -1.403412e-01 1 1  ON 19
   eO_0                -7.498935e-01 1 1  ON 20
   eO_1                -4.295762e-01 1 1  ON 21
   eO_2                -1.964268e-02 1 1  ON 22
   eO_3                 2.912613e-01 1 1  ON 23
   eO_4                 5.153619e-01 1 1  ON 24
   eO_5                 4.775730e-01 1 1  ON 25
   eO_6                 2.511350e-01 1 1  ON 26
   eO_7                -4.596524e-02 1 1  ON 27
   eO_8                -2.152491e-01 1 1  ON 28
   eO_9                -7.562240e-02 1 1  ON 29
  eH1_0                -2.534471e-01 1 1  ON 30
  eH1_1                -1.459427e-01 1 1  ON 31
  eH1_2                -9.640544e-02 1 1  ON 32
  eH1_3                -4.122227e-02 1 1  ON 33
  eH1_4                 8.459174e-03 1 1  ON 34
  eH1_5                 4.345785e-02 1 1  ON 35
  eH1_6                 1.014810e-01 1 1  ON 36
  eH1_7                 1.548433e-01 1 1  ON 37
  eH1_8                 1.732018e-01 1 1  ON 38
  eH1_9                 5.872934e-02 1 1  ON 39
  eH2_0                -2.505819e-01 1 1  ON 40
  eH2_1                -1.425329e-01 1 1  ON 41
  eH2_2                -9.282977e-02 1 1  ON 42
  eH2_3                -3.768668e-02 1 1  ON 43
  eH2_4                 1.168766e-02 1 1  ON 44
  eH2_5                 4.684027e-02 1 1  ON 45
  eH2_6                 1.037901e-01 1 1  ON 46
  eH2_7                 1.551715e-01 1 1  ON 47
  eH2_8                 1.768671e-01 1 1  ON 48
  eH2_9                 4.550973e-02 1 1  ON 49
ci_0001                 7.012428e-01 3 1  ON 50
ci_0002                 7.005470e-01 3 1  ON 51
ci_0003                -2.629997e-02 3 1  ON 52
ci_0004                -2.682944e-02 3 1  ON 53
ci_0005                -3.627431e-02 3 1  ON 54
ci_0006                -3.652019e-02 3 1  ON 55
ci_0007                -2.114766e-02 3 1  ON 56
ci_0008                -2.235750e-02 3 1  ON 57
ci_0009                -1.755288e-02 3 1  ON 58
ci_0010                -1.729684e-02 3 1  ON 59
ci_0011                -1.208284e-02 3 1  ON 60
ci_0012                -1.231684e-02 3 1  ON 61
ci_0013                 1.292648e-02 3 1  ON 62
ci_0014                 1.339436e-02 3 1  ON 63
ci_0015                 1.330617e-02 3 1  ON 64
ci_0016                 1.301833e-02 3 1  ON 65
ci_0017                 1.151715e-02 3 1  ON 66
ci_0018                 1.132050e-02 3 1  ON 67
ci_0019                 1.158580e-02 3 1  ON 68
ci_0020                 1.097239e-02 3 1  ON 69
ci_0021                -1.269627e-03 3 1  ON 70
ci_0022                -8.169665e-04 3 1  ON 71
ci_0023                -1.135540e-02 3 1  ON 72
ci_0024                -1.152899e-02 3 1  ON 73
ci_0025                -9.780329e-03 3 1  ON 74
ci_0026                -1.092964e-02 3 1  ON 75
ci_0027                -1.127721e-02 3 1  ON 76
ci_0028                -1.144076e-02 3 1  ON 77
ci_0029                -1.073071e-02 3 1  ON 78
ci_0030                -1.089627e-02 3 1  ON 79
ci_0031                 1.943657e-02 3 1  ON 80
ci_0032                 2.098682e-02 3 1  ON 81
ci_0033                 1.035594e-02 3 1  ON 82
ci_0034                 1.059179e-02 3 1  ON 83
ci_0035                 7.690243e-03 3 1  ON 84
ci_0036                 7.272683e-03 3 1  ON 85
ci_0037                -9.915657e-03 3 1  ON 86
ci_0038                -1.095260e-02 3 1  ON 87
ci_0039                -2.795162e-03 3 1  ON 88
ci_0040                -2.533771e-03 3 1  ON 89
ci_0041                 7.243661e-03 3 1  ON 90
ci_0042                 7.404644e-03 3 1  ON 91
ci_0043                -1.956907e-02 3 1  ON 92
ci_0044                -1.935985e-02 3 1  ON 93
ci_0045                 7.847555e-03 3 1  ON 94
ci_0046                 7.698624e-03 3 1  ON 95
ci_0047                -1.442145e-03 3 1  ON 96
ci_0048                -1.926339e-03 3 1  ON 97
ci_0049                -5.416538e-03 3 1  ON 98
ci_0050                -6.168523e-03 3 1  ON 99
ci_0051                -3.481497e-03 3 1  ON 100
ci_0052                -3.411228e-03 3 1  ON 101
ci_0053                -4.999901e-03 3 1  ON 102
ci_0054                -4.279860e-03 3 1  ON 103
ci_0055                 6.165469e-03 3 1  ON 104
ci_0056                 6.319478e-03 3 1  ON 105
ci_0057                 4.229160e-03 3 1  ON 106
ci_0058                 4.670828e-03 3 1  ON 107
ci_0059                -5.000163e-03 3 1  ON 108
ci_0060                -4.554978e-03 3 1  ON 109
ci_0061                -4.029627e-03 3 1  ON 110
ci_0062                -3.652002e-03 3 1  ON 111
ci_0063                -8.451144e-03 3 1  ON 112
ci_0064                -8.466593e-03 3 1  ON 113
ci_0065                -5.388165e-03 3 1  ON 114
ci_0066                -5.381730e-03 3 1  ON 115
ci_0067                -4.944609e-03 3 1  ON 116
ci_0068                -4.800271e-03 3 1  ON 117
ci_0069                 4.221690e-03 3 1  ON 118
ci_0070                 4.654188e-03 3 1  ON 119
ci_0071                 2.394103e-04 3 1  ON 120
ci_0072                 5.213193e-05 3 1  ON 121
ci_0073                 4.448663e-03 3 1  ON 122
ci_0074                 4.442871e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.865
    reference variance = 0.363269
====================================================
  Execution time = 2.1503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3241e-01
  Total weights = 1.951572088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321304774366
                                         uncertainty =       0.002380825565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321304774366
                                         uncertainty =       0.002380825565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400811967
  error estimate for blocks of size 2^( 2) =       0.000413867166
  error estimate for blocks of size 2^( 3) =       0.000426783651
  error estimate for blocks of size 2^( 4) =       0.000438204313
  error estimate for blocks of size 2^( 5) =       0.000448955204
  error estimate for blocks of size 2^( 6) =       0.000456021720
  error estimate for blocks of size 2^( 7) =       0.000458385233

      target function =                  N/A
              le_mean =     -16.906642240869
             les_mean =     286.166963211176
             stat err =       0.000450391618
             autocorr =       1.262697260444
              std dev =       0.566833720105
             le_variance =       0.321300466248


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664224087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906642240854       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906639372949       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641011862       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906644515299       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906643532125       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906643742733       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906641202540       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906640214847       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906640476905       residual = 6.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906642801043       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906643847203       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906644689591       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906645020662       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906645642672       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906645558689       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906645817939       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906645240353       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 3.899247e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906642240854       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906640510403       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906640823358       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906642501139       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640505810       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640275121       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906639540328       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639677365       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906639959206       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906640281979       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906640545714       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906640747916       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906640754533       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.110889e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906642240854       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906641571811       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906641517225       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906641998327       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640878109       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640858655       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906640777802       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906640808016       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906640848009       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906640933420       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906640963826       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 4.168913e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162555 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7843e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.126998e-01 1 1  ON 0
   uu_1                 1.450668e-01 1 1  ON 1
   uu_2                 4.321216e-02 1 1  ON 2
   uu_3                -1.936364e-02 1 1  ON 3
   uu_4                -6.523077e-02 1 1  ON 4
   uu_5                -1.004755e-01 1 1  ON 5
   uu_6                -1.281826e-01 1 1  ON 6
   uu_7                -1.420099e-01 1 1  ON 7
   uu_8                -1.346266e-01 1 1  ON 8
   uu_9                -1.030660e-01 1 1  ON 9
   ud_0                 4.471019e-01 1 1  ON 10
   ud_1                 1.812077e-01 1 1  ON 11
   ud_2                 6.108982e-02 1 1  ON 12
   ud_3                -9.795263e-03 1 1  ON 13
   ud_4                -6.657307e-02 1 1  ON 14
   ud_5                -1.078244e-01 1 1  ON 15
   ud_6                -1.353349e-01 1 1  ON 16
   ud_7                -1.517767e-01 1 1  ON 17
   ud_8                -1.513879e-01 1 1  ON 18
   ud_9                -1.401873e-01 1 1  ON 19
   eO_0                -7.497387e-01 1 1  ON 20
   eO_1                -4.298300e-01 1 1  ON 21
   eO_2                -1.975535e-02 1 1  ON 22
   eO_3                 2.913478e-01 1 1  ON 23
   eO_4                 5.155711e-01 1 1  ON 24
   eO_5                 4.779660e-01 1 1  ON 25
   eO_6                 2.513822e-01 1 1  ON 26
   eO_7                -4.587175e-02 1 1  ON 27
   eO_8                -2.155333e-01 1 1  ON 28
   eO_9                -7.608007e-02 1 1  ON 29
  eH1_0                -2.531912e-01 1 1  ON 30
  eH1_1                -1.458081e-01 1 1  ON 31
  eH1_2                -9.682017e-02 1 1  ON 32
  eH1_3                -4.159099e-02 1 1  ON 33
  eH1_4                 7.954227e-03 1 1  ON 34
  eH1_5                 4.346057e-02 1 1  ON 35
  eH1_6                 1.010465e-01 1 1  ON 36
  eH1_7                 1.545523e-01 1 1  ON 37
  eH1_8                 1.736898e-01 1 1  ON 38
  eH1_9                 5.971032e-02 1 1  ON 39
  eH2_0                -2.503303e-01 1 1  ON 40
  eH2_1                -1.426775e-01 1 1  ON 41
  eH2_2                -9.370920e-02 1 1  ON 42
  eH2_3                -3.804301e-02 1 1  ON 43
  eH2_4                 1.140287e-02 1 1  ON 44
  eH2_5                 4.664430e-02 1 1  ON 45
  eH2_6                 1.036424e-01 1 1  ON 46
  eH2_7                 1.553664e-01 1 1  ON 47
  eH2_8                 1.775866e-01 1 1  ON 48
  eH2_9                 4.632213e-02 1 1  ON 49
ci_0001                 7.013315e-01 3 1  ON 50
ci_0002                 7.004770e-01 3 1  ON 51
ci_0003                -2.655632e-02 3 1  ON 52
ci_0004                -2.696864e-02 3 1  ON 53
ci_0005                -3.590845e-02 3 1  ON 54
ci_0006                -3.628145e-02 3 1  ON 55
ci_0007                -2.166496e-02 3 1  ON 56
ci_0008                -2.179947e-02 3 1  ON 57
ci_0009                -1.755683e-02 3 1  ON 58
ci_0010                -1.771269e-02 3 1  ON 59
ci_0011                -1.210971e-02 3 1  ON 60
ci_0012                -1.229054e-02 3 1  ON 61
ci_0013                 1.282031e-02 3 1  ON 62
ci_0014                 1.387694e-02 3 1  ON 63
ci_0015                 1.327939e-02 3 1  ON 64
ci_0016                 1.293833e-02 3 1  ON 65
ci_0017                 1.161463e-02 3 1  ON 66
ci_0018                 1.088244e-02 3 1  ON 67
ci_0019                 1.129867e-02 3 1  ON 68
ci_0020                 1.116295e-02 3 1  ON 69
ci_0021                -1.216464e-03 3 1  ON 70
ci_0022                -3.771030e-04 3 1  ON 71
ci_0023                -1.118904e-02 3 1  ON 72
ci_0024                -1.161897e-02 3 1  ON 73
ci_0025                -9.981485e-03 3 1  ON 74
ci_0026                -1.118510e-02 3 1  ON 75
ci_0027                -1.157797e-02 3 1  ON 76
ci_0028                -1.109954e-02 3 1  ON 77
ci_0029                -1.093259e-02 3 1  ON 78
ci_0030                -1.105349e-02 3 1  ON 79
ci_0031                 1.954225e-02 3 1  ON 80
ci_0032                 2.069480e-02 3 1  ON 81
ci_0033                 1.012480e-02 3 1  ON 82
ci_0034                 1.080092e-02 3 1  ON 83
ci_0035                 7.072628e-03 3 1  ON 84
ci_0036                 7.238920e-03 3 1  ON 85
ci_0037                -1.033816e-02 3 1  ON 86
ci_0038                -1.155556e-02 3 1  ON 87
ci_0039                -2.633598e-03 3 1  ON 88
ci_0040                -2.507419e-03 3 1  ON 89
ci_0041                 7.420140e-03 3 1  ON 90
ci_0042                 7.730955e-03 3 1  ON 91
ci_0043                -1.893242e-02 3 1  ON 92
ci_0044                -1.931827e-02 3 1  ON 93
ci_0045                 7.514482e-03 3 1  ON 94
ci_0046                 7.583348e-03 3 1  ON 95
ci_0047                -1.827163e-03 3 1  ON 96
ci_0048                -1.993039e-03 3 1  ON 97
ci_0049                -5.973454e-03 3 1  ON 98
ci_0050                -5.609715e-03 3 1  ON 99
ci_0051                -3.481519e-03 3 1  ON 100
ci_0052                -3.453979e-03 3 1  ON 101
ci_0053                -5.055367e-03 3 1  ON 102
ci_0054                -4.676762e-03 3 1  ON 103
ci_0055                 6.167991e-03 3 1  ON 104
ci_0056                 6.267158e-03 3 1  ON 105
ci_0057                 4.431829e-03 3 1  ON 106
ci_0058                 4.692027e-03 3 1  ON 107
ci_0059                -4.870983e-03 3 1  ON 108
ci_0060                -4.662632e-03 3 1  ON 109
ci_0061                -3.471364e-03 3 1  ON 110
ci_0062                -3.738109e-03 3 1  ON 111
ci_0063                -8.398160e-03 3 1  ON 112
ci_0064                -8.043442e-03 3 1  ON 113
ci_0065                -5.443126e-03 3 1  ON 114
ci_0066                -5.373501e-03 3 1  ON 115
ci_0067                -4.776297e-03 3 1  ON 116
ci_0068                -4.861853e-03 3 1  ON 117
ci_0069                 4.612688e-03 3 1  ON 118
ci_0070                 4.699297e-03 3 1  ON 119
ci_0071                 5.883694e-04 3 1  ON 120
ci_0072                 1.163020e-03 3 1  ON 121
ci_0073                 4.429038e-03 3 1  ON 122
ci_0074                 4.592655e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9293
    reference variance = 0.146386
====================================================
  Execution time = 2.0904e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3769e-01
  Total weights = 1.9517e+06
  Execution time = 1.8916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448975867
                                         uncertainty =       0.002442248440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448975867
                                         uncertainty =       0.002442248440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403320318
  error estimate for blocks of size 2^( 2) =       0.000416183467
  error estimate for blocks of size 2^( 3) =       0.000429063195
  error estimate for blocks of size 2^( 4) =       0.000441018503
  error estimate for blocks of size 2^( 5) =       0.000450831870
  error estimate for blocks of size 2^( 6) =       0.000457735775
  error estimate for blocks of size 2^( 7) =       0.000462148975

      target function =                  N/A
              le_mean =     -16.906262837194
             les_mean =     286.159586720917
             stat err =       0.000452933781
             autocorr =       1.261157200569
              std dev =       0.570381063125
             le_variance =       0.325334557171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325778067252
                                         uncertainty =       0.002443262425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325778067252
                                         uncertainty =       0.002443262425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403522726
  error estimate for blocks of size 2^( 2) =       0.000416383726
  error estimate for blocks of size 2^( 3) =       0.000429248948
  error estimate for blocks of size 2^( 4) =       0.000441176466
  error estimate for blocks of size 2^( 5) =       0.000450946269
  error estimate for blocks of size 2^( 6) =       0.000457832070
  error estimate for blocks of size 2^( 7) =       0.000462190184

      target function =                  N/A
              le_mean =     -16.906256889625
             les_mean =     286.161563734654
             stat err =       0.000453036247
             autocorr =       1.260462429213
              std dev =       0.570667311661
             le_variance =       0.325661180598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325957588997
                                         uncertainty =       0.002440354279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325957588997
                                         uncertainty =       0.002440354279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403633695
  error estimate for blocks of size 2^( 2) =       0.000416492569
  error estimate for blocks of size 2^( 3) =       0.000429354665
  error estimate for blocks of size 2^( 4) =       0.000441278464
  error estimate for blocks of size 2^( 5) =       0.000451039846
  error estimate for blocks of size 2^( 6) =       0.000457927400
  error estimate for blocks of size 2^( 7) =       0.000462282808

      target function =                  N/A
              le_mean =     -16.906261004688
             les_mean =     286.161090850633
             stat err =       0.000453132129
             autocorr =       1.260302757173
              std dev =       0.570824246048
             le_variance =       0.325840319876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325518027971
                                         uncertainty =       0.002440812558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325518027971
                                         uncertainty =       0.002440812558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403362799
  error estimate for blocks of size 2^( 2) =       0.000416223882
  error estimate for blocks of size 2^( 3) =       0.000429098968
  error estimate for blocks of size 2^( 4) =       0.000441047724
  error estimate for blocks of size 2^( 5) =       0.000450849381
  error estimate for blocks of size 2^( 6) =       0.000457752423
  error estimate for blocks of size 2^( 7) =       0.000462154435

      target function =                  N/A
              le_mean =     -16.906254158881
             les_mean =     286.159005103645
             stat err =       0.000452950991
             autocorr =       1.260987388989
              std dev =       0.570441141399
             le_variance =       0.325403095801


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906262837194        initial  <--
     6.2500e-02     6.2500e-01             3.8992e-03       -16.906256889625
     2.5000e-01     2.5000e+00             1.1109e-03       -16.906261004688
     1.0000e+00     1.0000e+01             4.1689e-04       -16.906254158881

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4675
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.125260e-01 1 1  ON 0
   uu_1                 1.450550e-01 1 1  ON 1
   uu_2                 4.319451e-02 1 1  ON 2
   uu_3                -1.933977e-02 1 1  ON 3
   uu_4                -6.514418e-02 1 1  ON 4
   uu_5                -1.002264e-01 1 1  ON 5
   uu_6                -1.278189e-01 1 1  ON 6
   uu_7                -1.417757e-01 1 1  ON 7
   uu_8                -1.345492e-01 1 1  ON 8
   uu_9                -1.028799e-01 1 1  ON 9
   ud_0                 4.471815e-01 1 1  ON 10
   ud_1                 1.815137e-01 1 1  ON 11
   ud_2                 6.105409e-02 1 1  ON 12
   ud_3                -9.932128e-03 1 1  ON 13
   ud_4                -6.667928e-02 1 1  ON 14
   ud_5                -1.079008e-01 1 1  ON 15
   ud_6                -1.352120e-01 1 1  ON 16
   ud_7                -1.515355e-01 1 1  ON 17
   ud_8                -1.514388e-01 1 1  ON 18
   ud_9                -1.403412e-01 1 1  ON 19
   eO_0                -7.498935e-01 1 1  ON 20
   eO_1                -4.295762e-01 1 1  ON 21
   eO_2                -1.964268e-02 1 1  ON 22
   eO_3                 2.912613e-01 1 1  ON 23
   eO_4                 5.153619e-01 1 1  ON 24
   eO_5                 4.775730e-01 1 1  ON 25
   eO_6                 2.511350e-01 1 1  ON 26
   eO_7                -4.596524e-02 1 1  ON 27
   eO_8                -2.152491e-01 1 1  ON 28
   eO_9                -7.562240e-02 1 1  ON 29
  eH1_0                -2.534471e-01 1 1  ON 30
  eH1_1                -1.459427e-01 1 1  ON 31
  eH1_2                -9.640544e-02 1 1  ON 32
  eH1_3                -4.122227e-02 1 1  ON 33
  eH1_4                 8.459174e-03 1 1  ON 34
  eH1_5                 4.345785e-02 1 1  ON 35
  eH1_6                 1.014810e-01 1 1  ON 36
  eH1_7                 1.548433e-01 1 1  ON 37
  eH1_8                 1.732018e-01 1 1  ON 38
  eH1_9                 5.872934e-02 1 1  ON 39
  eH2_0                -2.505819e-01 1 1  ON 40
  eH2_1                -1.425329e-01 1 1  ON 41
  eH2_2                -9.282977e-02 1 1  ON 42
  eH2_3                -3.768668e-02 1 1  ON 43
  eH2_4                 1.168766e-02 1 1  ON 44
  eH2_5                 4.684027e-02 1 1  ON 45
  eH2_6                 1.037901e-01 1 1  ON 46
  eH2_7                 1.551715e-01 1 1  ON 47
  eH2_8                 1.768671e-01 1 1  ON 48
  eH2_9                 4.550973e-02 1 1  ON 49
ci_0001                 7.012428e-01 3 1  ON 50
ci_0002                 7.005470e-01 3 1  ON 51
ci_0003                -2.629997e-02 3 1  ON 52
ci_0004                -2.682944e-02 3 1  ON 53
ci_0005                -3.627431e-02 3 1  ON 54
ci_0006                -3.652019e-02 3 1  ON 55
ci_0007                -2.114766e-02 3 1  ON 56
ci_0008                -2.235750e-02 3 1  ON 57
ci_0009                -1.755288e-02 3 1  ON 58
ci_0010                -1.729684e-02 3 1  ON 59
ci_0011                -1.208284e-02 3 1  ON 60
ci_0012                -1.231684e-02 3 1  ON 61
ci_0013                 1.292648e-02 3 1  ON 62
ci_0014                 1.339436e-02 3 1  ON 63
ci_0015                 1.330617e-02 3 1  ON 64
ci_0016                 1.301833e-02 3 1  ON 65
ci_0017                 1.151715e-02 3 1  ON 66
ci_0018                 1.132050e-02 3 1  ON 67
ci_0019                 1.158580e-02 3 1  ON 68
ci_0020                 1.097239e-02 3 1  ON 69
ci_0021                -1.269627e-03 3 1  ON 70
ci_0022                -8.169665e-04 3 1  ON 71
ci_0023                -1.135540e-02 3 1  ON 72
ci_0024                -1.152899e-02 3 1  ON 73
ci_0025                -9.780329e-03 3 1  ON 74
ci_0026                -1.092964e-02 3 1  ON 75
ci_0027                -1.127721e-02 3 1  ON 76
ci_0028                -1.144076e-02 3 1  ON 77
ci_0029                -1.073071e-02 3 1  ON 78
ci_0030                -1.089627e-02 3 1  ON 79
ci_0031                 1.943657e-02 3 1  ON 80
ci_0032                 2.098682e-02 3 1  ON 81
ci_0033                 1.035594e-02 3 1  ON 82
ci_0034                 1.059179e-02 3 1  ON 83
ci_0035                 7.690243e-03 3 1  ON 84
ci_0036                 7.272683e-03 3 1  ON 85
ci_0037                -9.915657e-03 3 1  ON 86
ci_0038                -1.095260e-02 3 1  ON 87
ci_0039                -2.795162e-03 3 1  ON 88
ci_0040                -2.533771e-03 3 1  ON 89
ci_0041                 7.243661e-03 3 1  ON 90
ci_0042                 7.404644e-03 3 1  ON 91
ci_0043                -1.956907e-02 3 1  ON 92
ci_0044                -1.935985e-02 3 1  ON 93
ci_0045                 7.847555e-03 3 1  ON 94
ci_0046                 7.698624e-03 3 1  ON 95
ci_0047                -1.442145e-03 3 1  ON 96
ci_0048                -1.926339e-03 3 1  ON 97
ci_0049                -5.416538e-03 3 1  ON 98
ci_0050                -6.168523e-03 3 1  ON 99
ci_0051                -3.481497e-03 3 1  ON 100
ci_0052                -3.411228e-03 3 1  ON 101
ci_0053                -4.999901e-03 3 1  ON 102
ci_0054                -4.279860e-03 3 1  ON 103
ci_0055                 6.165469e-03 3 1  ON 104
ci_0056                 6.319478e-03 3 1  ON 105
ci_0057                 4.229160e-03 3 1  ON 106
ci_0058                 4.670828e-03 3 1  ON 107
ci_0059                -5.000163e-03 3 1  ON 108
ci_0060                -4.554978e-03 3 1  ON 109
ci_0061                -4.029627e-03 3 1  ON 110
ci_0062                -3.652002e-03 3 1  ON 111
ci_0063                -8.451144e-03 3 1  ON 112
ci_0064                -8.466593e-03 3 1  ON 113
ci_0065                -5.388165e-03 3 1  ON 114
ci_0066                -5.381730e-03 3 1  ON 115
ci_0067                -4.944609e-03 3 1  ON 116
ci_0068                -4.800271e-03 3 1  ON 117
ci_0069                 4.221690e-03 3 1  ON 118
ci_0070                 4.654188e-03 3 1  ON 119
ci_0071                 2.394103e-04 3 1  ON 120
ci_0072                 5.213193e-05 3 1  ON 121
ci_0073                 4.448663e-03 3 1  ON 122
ci_0074                 4.442871e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8705
    reference variance = 0.280474
====================================================
  Execution time = 2.1414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5198e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4263e-01
  Total weights = 1.951650502e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326755503298
                                         uncertainty =       0.002948619117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326755503298
                                         uncertainty =       0.002948619117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404176420
  error estimate for blocks of size 2^( 2) =       0.000416861719
  error estimate for blocks of size 2^( 3) =       0.000430013412
  error estimate for blocks of size 2^( 4) =       0.000442629019
  error estimate for blocks of size 2^( 5) =       0.000453129090
  error estimate for blocks of size 2^( 6) =       0.000460748557
  error estimate for blocks of size 2^( 7) =       0.000465778986

      target function =                  N/A
              le_mean =     -16.907114534291
             les_mean =     286.193149455348
             stat err =       0.000455571413
             autocorr =       1.270489215817
              std dev =       0.571591775117
             le_variance =       0.326717157381


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690711453429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907114534320       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907116392313       residual = 7.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907117799934       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907117826128       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907117551121       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907117622196       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907117758331       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907117953709       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907117977075       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907117846215       residual = 6.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 3.830557e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907114534320       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907115106615       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907115524254       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907115476715       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907115379727       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907115424898       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907115506644       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907115501843       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907115508300       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907115495195       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 1.185293e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907114534320       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907114686206       residual = 8.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907114796053       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907114780292       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907114752968       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907114766787       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907114791254       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907114787217       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907114787594       residual = 8.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+01 is 3.138651e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166313 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7503e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.125540e-01 1 1  ON 0
   uu_1                 1.450593e-01 1 1  ON 1
   uu_2                 4.322441e-02 1 1  ON 2
   uu_3                -1.934004e-02 1 1  ON 3
   uu_4                -6.515819e-02 1 1  ON 4
   uu_5                -1.002194e-01 1 1  ON 5
   uu_6                -1.278319e-01 1 1  ON 6
   uu_7                -1.418301e-01 1 1  ON 7
   uu_8                -1.345897e-01 1 1  ON 8
   uu_9                -1.029011e-01 1 1  ON 9
   ud_0                 4.471764e-01 1 1  ON 10
   ud_1                 1.815091e-01 1 1  ON 11
   ud_2                 6.105247e-02 1 1  ON 12
   ud_3                -9.891788e-03 1 1  ON 13
   ud_4                -6.663807e-02 1 1  ON 14
   ud_5                -1.079053e-01 1 1  ON 15
   ud_6                -1.352097e-01 1 1  ON 16
   ud_7                -1.515280e-01 1 1  ON 17
   ud_8                -1.514373e-01 1 1  ON 18
   ud_9                -1.403556e-01 1 1  ON 19
   eO_0                -7.498846e-01 1 1  ON 20
   eO_1                -4.295445e-01 1 1  ON 21
   eO_2                -1.968074e-02 1 1  ON 22
   eO_3                 2.912584e-01 1 1  ON 23
   eO_4                 5.153838e-01 1 1  ON 24
   eO_5                 4.775895e-01 1 1  ON 25
   eO_6                 2.511740e-01 1 1  ON 26
   eO_7                -4.594699e-02 1 1  ON 27
   eO_8                -2.152870e-01 1 1  ON 28
   eO_9                -7.567069e-02 1 1  ON 29
  eH1_0                -2.534727e-01 1 1  ON 30
  eH1_1                -1.459798e-01 1 1  ON 31
  eH1_2                -9.642191e-02 1 1  ON 32
  eH1_3                -4.124582e-02 1 1  ON 33
  eH1_4                 8.467794e-03 1 1  ON 34
  eH1_5                 4.346380e-02 1 1  ON 35
  eH1_6                 1.014981e-01 1 1  ON 36
  eH1_7                 1.548511e-01 1 1  ON 37
  eH1_8                 1.732253e-01 1 1  ON 38
  eH1_9                 5.877095e-02 1 1  ON 39
  eH2_0                -2.505943e-01 1 1  ON 40
  eH2_1                -1.425903e-01 1 1  ON 41
  eH2_2                -9.284682e-02 1 1  ON 42
  eH2_3                -3.773546e-02 1 1  ON 43
  eH2_4                 1.167338e-02 1 1  ON 44
  eH2_5                 4.677068e-02 1 1  ON 45
  eH2_6                 1.038262e-01 1 1  ON 46
  eH2_7                 1.552084e-01 1 1  ON 47
  eH2_8                 1.769243e-01 1 1  ON 48
  eH2_9                 4.559245e-02 1 1  ON 49
ci_0001                 7.012589e-01 3 1  ON 50
ci_0002                 7.005312e-01 3 1  ON 51
ci_0003                -2.639184e-02 3 1  ON 52
ci_0004                -2.692839e-02 3 1  ON 53
ci_0005                -3.633341e-02 3 1  ON 54
ci_0006                -3.651785e-02 3 1  ON 55
ci_0007                -2.119649e-02 3 1  ON 56
ci_0008                -2.231763e-02 3 1  ON 57
ci_0009                -1.747066e-02 3 1  ON 58
ci_0010                -1.726416e-02 3 1  ON 59
ci_0011                -1.196431e-02 3 1  ON 60
ci_0012                -1.222288e-02 3 1  ON 61
ci_0013                 1.297116e-02 3 1  ON 62
ci_0014                 1.335980e-02 3 1  ON 63
ci_0015                 1.332787e-02 3 1  ON 64
ci_0016                 1.305974e-02 3 1  ON 65
ci_0017                 1.149829e-02 3 1  ON 66
ci_0018                 1.126955e-02 3 1  ON 67
ci_0019                 1.156415e-02 3 1  ON 68
ci_0020                 1.096610e-02 3 1  ON 69
ci_0021                -1.300312e-03 3 1  ON 70
ci_0022                -8.465852e-04 3 1  ON 71
ci_0023                -1.132434e-02 3 1  ON 72
ci_0024                -1.146192e-02 3 1  ON 73
ci_0025                -9.843600e-03 3 1  ON 74
ci_0026                -1.082799e-02 3 1  ON 75
ci_0027                -1.121844e-02 3 1  ON 76
ci_0028                -1.142544e-02 3 1  ON 77
ci_0029                -1.069545e-02 3 1  ON 78
ci_0030                -1.088467e-02 3 1  ON 79
ci_0031                 1.951362e-02 3 1  ON 80
ci_0032                 2.091955e-02 3 1  ON 81
ci_0033                 1.031129e-02 3 1  ON 82
ci_0034                 1.056910e-02 3 1  ON 83
ci_0035                 7.626623e-03 3 1  ON 84
ci_0036                 7.215883e-03 3 1  ON 85
ci_0037                -9.899872e-03 3 1  ON 86
ci_0038                -1.094150e-02 3 1  ON 87
ci_0039                -2.795641e-03 3 1  ON 88
ci_0040                -2.498585e-03 3 1  ON 89
ci_0041                 7.198103e-03 3 1  ON 90
ci_0042                 7.414028e-03 3 1  ON 91
ci_0043                -1.958924e-02 3 1  ON 92
ci_0044                -1.938397e-02 3 1  ON 93
ci_0045                 7.830174e-03 3 1  ON 94
ci_0046                 7.650795e-03 3 1  ON 95
ci_0047                -1.511487e-03 3 1  ON 96
ci_0048                -1.891104e-03 3 1  ON 97
ci_0049                -5.375553e-03 3 1  ON 98
ci_0050                -6.139230e-03 3 1  ON 99
ci_0051                -3.523169e-03 3 1  ON 100
ci_0052                -3.433198e-03 3 1  ON 101
ci_0053                -5.027661e-03 3 1  ON 102
ci_0054                -4.301608e-03 3 1  ON 103
ci_0055                 6.258393e-03 3 1  ON 104
ci_0056                 6.343831e-03 3 1  ON 105
ci_0057                 4.181339e-03 3 1  ON 106
ci_0058                 4.621824e-03 3 1  ON 107
ci_0059                -4.913511e-03 3 1  ON 108
ci_0060                -4.610339e-03 3 1  ON 109
ci_0061                -4.033677e-03 3 1  ON 110
ci_0062                -3.635411e-03 3 1  ON 111
ci_0063                -8.540689e-03 3 1  ON 112
ci_0064                -8.526824e-03 3 1  ON 113
ci_0065                -5.454967e-03 3 1  ON 114
ci_0066                -5.389101e-03 3 1  ON 115
ci_0067                -4.972359e-03 3 1  ON 116
ci_0068                -4.874155e-03 3 1  ON 117
ci_0069                 4.302270e-03 3 1  ON 118
ci_0070                 4.609085e-03 3 1  ON 119
ci_0071                 2.490987e-04 3 1  ON 120
ci_0072                 4.048507e-05 3 1  ON 121
ci_0073                 4.349549e-03 3 1  ON 122
ci_0074                 4.443585e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8704
    reference variance = 0.195236
====================================================
  Execution time = 2.0921e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3777e-01
  Total weights = 1.9514e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325948622340
                                         uncertainty =       0.002314147718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325948622340
                                         uncertainty =       0.002314147718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404032145
  error estimate for blocks of size 2^( 2) =       0.000416712177
  error estimate for blocks of size 2^( 3) =       0.000429551761
  error estimate for blocks of size 2^( 4) =       0.000441468524
  error estimate for blocks of size 2^( 5) =       0.000452358753
  error estimate for blocks of size 2^( 6) =       0.000460844075
  error estimate for blocks of size 2^( 7) =       0.000467493533

      target function =                  N/A
              le_mean =     -16.906162681174
             les_mean =     286.156025646459
             stat err =       0.000455541221
             autocorr =       1.271228219828
              std dev =       0.571387738763
             le_variance =       0.326483948009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325871802888
                                         uncertainty =       0.002303534507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325871802888
                                         uncertainty =       0.002303534507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403984613
  error estimate for blocks of size 2^( 2) =       0.000416662005
  error estimate for blocks of size 2^( 3) =       0.000429500179
  error estimate for blocks of size 2^( 4) =       0.000441407630
  error estimate for blocks of size 2^( 5) =       0.000452303031
  error estimate for blocks of size 2^( 6) =       0.000460793584
  error estimate for blocks of size 2^( 7) =       0.000467433252

      target function =                  N/A
              le_mean =     -16.906164719508
             les_mean =     286.173709733869
             stat err =       0.000455484374
             autocorr =       1.271210048823
              std dev =       0.571320518846
             le_variance =       0.326407135254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325896726925
                                         uncertainty =       0.002308207012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325896726925
                                         uncertainty =       0.002308207012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404000084
  error estimate for blocks of size 2^( 2) =       0.000416679081
  error estimate for blocks of size 2^( 3) =       0.000429517494
  error estimate for blocks of size 2^( 4) =       0.000441429904
  error estimate for blocks of size 2^( 5) =       0.000452323274
  error estimate for blocks of size 2^( 6) =       0.000460807313
  error estimate for blocks of size 2^( 7) =       0.000467450224

      target function =                  N/A
              le_mean =     -16.906162691505
             les_mean =     286.156490695376
             stat err =       0.000455502679
             autocorr =       1.271214854978
              std dev =       0.571342398207
             le_variance =       0.326432135989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325940138748
                                         uncertainty =       0.002313372554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325940138748
                                         uncertainty =       0.002313372554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404026904
  error estimate for blocks of size 2^( 2) =       0.000416706759
  error estimate for blocks of size 2^( 3) =       0.000429546200
  error estimate for blocks of size 2^( 4) =       0.000441462335
  error estimate for blocks of size 2^( 5) =       0.000452353011
  error estimate for blocks of size 2^( 6) =       0.000460838211
  error estimate for blocks of size 2^( 7) =       0.000467486934

      target function =                  N/A
              le_mean =     -16.906162448189
             les_mean =     286.156087523774
             stat err =       0.000455535123
             autocorr =       1.271227161079
              std dev =       0.571380327531
             le_variance =       0.326475478689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906162681174        initial
     6.2500e-01     6.2500e+00             3.8306e-04       -16.906164719508  <--
     2.5000e+00     2.5000e+01             1.1853e-04       -16.906162691505
     1.0000e+01     1.0000e+02             3.1387e-05       -16.906162448189

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0474e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.126366e-01 1 1  ON 0
   uu_1                 1.450830e-01 1 1  ON 1
   uu_2                 4.328473e-02 1 1  ON 2
   uu_3                -1.933258e-02 1 1  ON 3
   uu_4                -6.518128e-02 1 1  ON 4
   uu_5                -1.002161e-01 1 1  ON 5
   uu_6                -1.278706e-01 1 1  ON 6
   uu_7                -1.419799e-01 1 1  ON 7
   uu_8                -1.347087e-01 1 1  ON 8
   uu_9                -1.029645e-01 1 1  ON 9
   ud_0                 4.471649e-01 1 1  ON 10
   ud_1                 1.815082e-01 1 1  ON 11
   ud_2                 6.106986e-02 1 1  ON 12
   ud_3                -9.796773e-03 1 1  ON 13
   ud_4                -6.653608e-02 1 1  ON 14
   ud_5                -1.078990e-01 1 1  ON 15
   ud_6                -1.352077e-01 1 1  ON 16
   ud_7                -1.515128e-01 1 1  ON 17
   ud_8                -1.514361e-01 1 1  ON 18
   ud_9                -1.403989e-01 1 1  ON 19
   eO_0                -7.498570e-01 1 1  ON 20
   eO_1                -4.294733e-01 1 1  ON 21
   eO_2                -1.977089e-02 1 1  ON 22
   eO_3                 2.912559e-01 1 1  ON 23
   eO_4                 5.154527e-01 1 1  ON 24
   eO_5                 4.776329e-01 1 1  ON 25
   eO_6                 2.512832e-01 1 1  ON 26
   eO_7                -4.589516e-02 1 1  ON 27
   eO_8                -2.153989e-01 1 1  ON 28
   eO_9                -7.581194e-02 1 1  ON 29
  eH1_0                -2.535484e-01 1 1  ON 30
  eH1_1                -1.460830e-01 1 1  ON 31
  eH1_2                -9.647461e-02 1 1  ON 32
  eH1_3                -4.131317e-02 1 1  ON 33
  eH1_4                 8.489036e-03 1 1  ON 34
  eH1_5                 4.348530e-02 1 1  ON 35
  eH1_6                 1.015501e-01 1 1  ON 36
  eH1_7                 1.548726e-01 1 1  ON 37
  eH1_8                 1.732924e-01 1 1  ON 38
  eH1_9                 5.889157e-02 1 1  ON 39
  eH2_0                -2.506354e-01 1 1  ON 40
  eH2_1                -1.427469e-01 1 1  ON 41
  eH2_2                -9.291552e-02 1 1  ON 42
  eH2_3                -3.787105e-02 1 1  ON 43
  eH2_4                 1.162809e-02 1 1  ON 44
  eH2_5                 4.657511e-02 1 1  ON 45
  eH2_6                 1.039306e-01 1 1  ON 46
  eH2_7                 1.553180e-01 1 1  ON 47
  eH2_8                 1.770926e-01 1 1  ON 48
  eH2_9                 4.583401e-02 1 1  ON 49
ci_0001                 7.013107e-01 3 1  ON 50
ci_0002                 7.004779e-01 3 1  ON 51
ci_0003                -2.660391e-02 3 1  ON 52
ci_0004                -2.715654e-02 3 1  ON 53
ci_0005                -3.648611e-02 3 1  ON 54
ci_0006                -3.651188e-02 3 1  ON 55
ci_0007                -2.133258e-02 3 1  ON 56
ci_0008                -2.220969e-02 3 1  ON 57
ci_0009                -1.729669e-02 3 1  ON 58
ci_0010                -1.719690e-02 3 1  ON 59
ci_0011                -1.169979e-02 3 1  ON 60
ci_0012                -1.201135e-02 3 1  ON 61
ci_0013                 1.307708e-02 3 1  ON 62
ci_0014                 1.328612e-02 3 1  ON 63
ci_0015                 1.337905e-02 3 1  ON 64
ci_0016                 1.315345e-02 3 1  ON 65
ci_0017                 1.146228e-02 3 1  ON 66
ci_0018                 1.116278e-02 3 1  ON 67
ci_0019                 1.151837e-02 3 1  ON 68
ci_0020                 1.095309e-02 3 1  ON 69
ci_0021                -1.383597e-03 3 1  ON 70
ci_0022                -9.253126e-04 3 1  ON 71
ci_0023                -1.126140e-02 3 1  ON 72
ci_0024                -1.132137e-02 3 1  ON 73
ci_0025                -9.987081e-03 3 1  ON 74
ci_0026                -1.059836e-02 3 1  ON 75
ci_0027                -1.108285e-02 3 1  ON 76
ci_0028                -1.138993e-02 3 1  ON 77
ci_0029                -1.061785e-02 3 1  ON 78
ci_0030                -1.085854e-02 3 1  ON 79
ci_0031                 1.971011e-02 3 1  ON 80
ci_0032                 2.074305e-02 3 1  ON 81
ci_0033                 1.019614e-02 3 1  ON 82
ci_0034                 1.051247e-02 3 1  ON 83
ci_0035                 7.479952e-03 3 1  ON 84
ci_0036                 7.085173e-03 3 1  ON 85
ci_0037                -9.857676e-03 3 1  ON 86
ci_0038                -1.091205e-02 3 1  ON 87
ci_0039                -2.797910e-03 3 1  ON 88
ci_0040                -2.431279e-03 3 1  ON 89
ci_0041                 7.096081e-03 3 1  ON 90
ci_0042                 7.435135e-03 3 1  ON 91
ci_0043                -1.963793e-02 3 1  ON 92
ci_0044                -1.944263e-02 3 1  ON 93
ci_0045                 7.788789e-03 3 1  ON 94
ci_0046                 7.534407e-03 3 1  ON 95
ci_0047                -1.648281e-03 3 1  ON 96
ci_0048                -1.824205e-03 3 1  ON 97
ci_0049                -5.284381e-03 3 1  ON 98
ci_0050                -6.077079e-03 3 1  ON 99
ci_0051                -3.603354e-03 3 1  ON 100
ci_0052                -3.476022e-03 3 1  ON 101
ci_0053                -5.086033e-03 3 1  ON 102
ci_0054                -4.346868e-03 3 1  ON 103
ci_0055                 6.481532e-03 3 1  ON 104
ci_0056                 6.404834e-03 3 1  ON 105
ci_0057                 4.071359e-03 3 1  ON 106
ci_0058                 4.509514e-03 3 1  ON 107
ci_0059                -4.741062e-03 3 1  ON 108
ci_0060                -4.723961e-03 3 1  ON 109
ci_0061                -4.042349e-03 3 1  ON 110
ci_0062                -3.597336e-03 3 1  ON 111
ci_0063                -8.720281e-03 3 1  ON 112
ci_0064                -8.649413e-03 3 1  ON 113
ci_0065                -5.599897e-03 3 1  ON 114
ci_0066                -5.405244e-03 3 1  ON 115
ci_0067                -5.027243e-03 3 1  ON 116
ci_0068                -5.024083e-03 3 1  ON 117
ci_0069                 4.459575e-03 3 1  ON 118
ci_0070                 4.520433e-03 3 1  ON 119
ci_0071                 2.760103e-04 3 1  ON 120
ci_0072                 1.887619e-05 3 1  ON 121
ci_0073                 4.159890e-03 3 1  ON 122
ci_0074                 4.445521e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8678
    reference variance = 0.212602
====================================================
  Execution time = 2.1187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3636e-01
  Total weights = 1.951604803e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324360631169
                                         uncertainty =       0.003010416773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324360631169
                                         uncertainty =       0.003010416773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402808280
  error estimate for blocks of size 2^( 2) =       0.000415586041
  error estimate for blocks of size 2^( 3) =       0.000429396094
  error estimate for blocks of size 2^( 4) =       0.000442321484
  error estimate for blocks of size 2^( 5) =       0.000452321307
  error estimate for blocks of size 2^( 6) =       0.000460389532
  error estimate for blocks of size 2^( 7) =       0.000466105817

      target function =                  N/A
              le_mean =     -16.905438431819
             les_mean =     286.130205899781
             stat err =       0.000455284535
             autocorr =       1.277523857668
              std dev =       0.569656932052
             le_variance =       0.324509020235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690543843182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905438431821       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905448403854       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905448044689       residual = 4.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905452052369       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905451290519       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905452401121       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905453078693       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905452296208       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905453879878       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905453168876       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905453043601       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905453195362       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905453303061       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905453158965       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 1.455061e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905438431821       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905442836326       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905442296741       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905443021845       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905442993635       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905443285388       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905443574336       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905443287551       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905443432511       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905443305305       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905443366390       residual = 4.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 4.388623e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905438431821       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905439794070       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905439572020       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905439604947       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905439601657       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905439755102       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905439795701       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905439730669       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905439762386       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905439727024       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 1.446021e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171545 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7300e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.127115e-01 1 1  ON 0
   uu_1                 1.450934e-01 1 1  ON 1
   uu_2                 4.335813e-02 1 1  ON 2
   uu_3                -1.924525e-02 1 1  ON 3
   uu_4                -6.521020e-02 1 1  ON 4
   uu_5                -1.003419e-01 1 1  ON 5
   uu_6                -1.279693e-01 1 1  ON 6
   uu_7                -1.419251e-01 1 1  ON 7
   uu_8                -1.349011e-01 1 1  ON 8
   uu_9                -1.031580e-01 1 1  ON 9
   ud_0                 4.471823e-01 1 1  ON 10
   ud_1                 1.814516e-01 1 1  ON 11
   ud_2                 6.111998e-02 1 1  ON 12
   ud_3                -9.724951e-03 1 1  ON 13
   ud_4                -6.649678e-02 1 1  ON 14
   ud_5                -1.078416e-01 1 1  ON 15
   ud_6                -1.350213e-01 1 1  ON 16
   ud_7                -1.515329e-01 1 1  ON 17
   ud_8                -1.515886e-01 1 1  ON 18
   ud_9                -1.405143e-01 1 1  ON 19
   eO_0                -7.498244e-01 1 1  ON 20
   eO_1                -4.296482e-01 1 1  ON 21
   eO_2                -1.983367e-02 1 1  ON 22
   eO_3                 2.912367e-01 1 1  ON 23
   eO_4                 5.156620e-01 1 1  ON 24
   eO_5                 4.778126e-01 1 1  ON 25
   eO_6                 2.514859e-01 1 1  ON 26
   eO_7                -4.578274e-02 1 1  ON 27
   eO_8                -2.156295e-01 1 1  ON 28
   eO_9                -7.603362e-02 1 1  ON 29
  eH1_0                -2.534412e-01 1 1  ON 30
  eH1_1                -1.461122e-01 1 1  ON 31
  eH1_2                -9.653471e-02 1 1  ON 32
  eH1_3                -4.136982e-02 1 1  ON 33
  eH1_4                 8.282727e-03 1 1  ON 34
  eH1_5                 4.327330e-02 1 1  ON 35
  eH1_6                 1.015774e-01 1 1  ON 36
  eH1_7                 1.549590e-01 1 1  ON 37
  eH1_8                 1.733924e-01 1 1  ON 38
  eH1_9                 5.913023e-02 1 1  ON 39
  eH2_0                -2.507111e-01 1 1  ON 40
  eH2_1                -1.428368e-01 1 1  ON 41
  eH2_2                -9.306212e-02 1 1  ON 42
  eH2_3                -3.824297e-02 1 1  ON 43
  eH2_4                 1.143860e-02 1 1  ON 44
  eH2_5                 4.653894e-02 1 1  ON 45
  eH2_6                 1.040321e-01 1 1  ON 46
  eH2_7                 1.554573e-01 1 1  ON 47
  eH2_8                 1.773772e-01 1 1  ON 48
  eH2_9                 4.619508e-02 1 1  ON 49
ci_0001                 7.012048e-01 3 1  ON 50
ci_0002                 7.005795e-01 3 1  ON 51
ci_0003                -2.657291e-02 3 1  ON 52
ci_0004                -2.731973e-02 3 1  ON 53
ci_0005                -3.644008e-02 3 1  ON 54
ci_0006                -3.643715e-02 3 1  ON 55
ci_0007                -2.109132e-02 3 1  ON 56
ci_0008                -2.212705e-02 3 1  ON 57
ci_0009                -1.745729e-02 3 1  ON 58
ci_0010                -1.731114e-02 3 1  ON 59
ci_0011                -1.168157e-02 3 1  ON 60
ci_0012                -1.196230e-02 3 1  ON 61
ci_0013                 1.321070e-02 3 1  ON 62
ci_0014                 1.331870e-02 3 1  ON 63
ci_0015                 1.342287e-02 3 1  ON 64
ci_0016                 1.332060e-02 3 1  ON 65
ci_0017                 1.147587e-02 3 1  ON 66
ci_0018                 1.109025e-02 3 1  ON 67
ci_0019                 1.145656e-02 3 1  ON 68
ci_0020                 1.087831e-02 3 1  ON 69
ci_0021                -1.475440e-03 3 1  ON 70
ci_0022                -6.038358e-04 3 1  ON 71
ci_0023                -1.158584e-02 3 1  ON 72
ci_0024                -1.125288e-02 3 1  ON 73
ci_0025                -1.014721e-02 3 1  ON 74
ci_0026                -1.081066e-02 3 1  ON 75
ci_0027                -1.133308e-02 3 1  ON 76
ci_0028                -1.153976e-02 3 1  ON 77
ci_0029                -1.038894e-02 3 1  ON 78
ci_0030                -1.111894e-02 3 1  ON 79
ci_0031                 1.994407e-02 3 1  ON 80
ci_0032                 2.060991e-02 3 1  ON 81
ci_0033                 1.029884e-02 3 1  ON 82
ci_0034                 1.040907e-02 3 1  ON 83
ci_0035                 7.277710e-03 3 1  ON 84
ci_0036                 6.983782e-03 3 1  ON 85
ci_0037                -1.005096e-02 3 1  ON 86
ci_0038                -1.082370e-02 3 1  ON 87
ci_0039                -2.671919e-03 3 1  ON 88
ci_0040                -2.579117e-03 3 1  ON 89
ci_0041                 7.166800e-03 3 1  ON 90
ci_0042                 7.235848e-03 3 1  ON 91
ci_0043                -1.949683e-02 3 1  ON 92
ci_0044                -1.918617e-02 3 1  ON 93
ci_0045                 7.968545e-03 3 1  ON 94
ci_0046                 7.549849e-03 3 1  ON 95
ci_0047                -1.722714e-03 3 1  ON 96
ci_0048                -1.841106e-03 3 1  ON 97
ci_0049                -5.322730e-03 3 1  ON 98
ci_0050                -5.986104e-03 3 1  ON 99
ci_0051                -3.563908e-03 3 1  ON 100
ci_0052                -3.453844e-03 3 1  ON 101
ci_0053                -4.874671e-03 3 1  ON 102
ci_0054                -4.256281e-03 3 1  ON 103
ci_0055                 6.330976e-03 3 1  ON 104
ci_0056                 6.352073e-03 3 1  ON 105
ci_0057                 4.340542e-03 3 1  ON 106
ci_0058                 4.625471e-03 3 1  ON 107
ci_0059                -4.661728e-03 3 1  ON 108
ci_0060                -4.846282e-03 3 1  ON 109
ci_0061                -3.869058e-03 3 1  ON 110
ci_0062                -3.521654e-03 3 1  ON 111
ci_0063                -9.159143e-03 3 1  ON 112
ci_0064                -8.631437e-03 3 1  ON 113
ci_0065                -5.335500e-03 3 1  ON 114
ci_0066                -5.227492e-03 3 1  ON 115
ci_0067                -5.265533e-03 3 1  ON 116
ci_0068                -5.061038e-03 3 1  ON 117
ci_0069                 4.549040e-03 3 1  ON 118
ci_0070                 4.396730e-03 3 1  ON 119
ci_0071                 1.137087e-04 3 1  ON 120
ci_0072                 6.689503e-05 3 1  ON 121
ci_0073                 4.098301e-03 3 1  ON 122
ci_0074                 4.362446e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9257
    reference variance = 0.215651
====================================================
  Execution time = 2.1342e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3188e-01
  Total weights = 1.9520e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320807673020
                                         uncertainty =       0.002410093633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320807673020
                                         uncertainty =       0.002410093633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400565592
  error estimate for blocks of size 2^( 2) =       0.000413490784
  error estimate for blocks of size 2^( 3) =       0.000426869283
  error estimate for blocks of size 2^( 4) =       0.000438745353
  error estimate for blocks of size 2^( 5) =       0.000448537955
  error estimate for blocks of size 2^( 6) =       0.000455083252
  error estimate for blocks of size 2^( 7) =       0.000457104156

      target function =                  N/A
              le_mean =     -16.905932023029
             les_mean =     286.146951665003
             stat err =       0.000449867679
             autocorr =       1.261311345992
              std dev =       0.566485292176
             le_variance =       0.320905586251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027485490
                                         uncertainty =       0.002415787848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027485490
                                         uncertainty =       0.002415787848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400703513
  error estimate for blocks of size 2^( 2) =       0.000413614054
  error estimate for blocks of size 2^( 3) =       0.000426976239
  error estimate for blocks of size 2^( 4) =       0.000438824528
  error estimate for blocks of size 2^( 5) =       0.000448587087
  error estimate for blocks of size 2^( 6) =       0.000455173727
  error estimate for blocks of size 2^( 7) =       0.000457271168

      target function =                  N/A
              le_mean =     -16.905940833186
             les_mean =     286.143175237931
             stat err =       0.000449964127
             autocorr =       1.260983729711
              std dev =       0.566680342967
             le_variance =       0.321126611105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320986595848
                                         uncertainty =       0.002412241486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320986595848
                                         uncertainty =       0.002412241486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400677959
  error estimate for blocks of size 2^( 2) =       0.000413589997
  error estimate for blocks of size 2^( 3) =       0.000426958171
  error estimate for blocks of size 2^( 4) =       0.000438812685
  error estimate for blocks of size 2^( 5) =       0.000448576808
  error estimate for blocks of size 2^( 6) =       0.000455158100
  error estimate for blocks of size 2^( 7) =       0.000457239612

      target function =                  N/A
              le_mean =     -16.905932149099
             les_mean =     286.173813846518
             stat err =       0.000449946801
             autocorr =       1.261047458924
              std dev =       0.566644203879
             le_variance =       0.321085653789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321177780036
                                         uncertainty =       0.002441224897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321177780036
                                         uncertainty =       0.002441224897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400796505
  error estimate for blocks of size 2^( 2) =       0.000413715477
  error estimate for blocks of size 2^( 3) =       0.000427117059
  error estimate for blocks of size 2^( 4) =       0.000438975985
  error estimate for blocks of size 2^( 5) =       0.000448781149
  error estimate for blocks of size 2^( 6) =       0.000455295623
  error estimate for blocks of size 2^( 7) =       0.000457315800

      target function =                  N/A
              le_mean =     -16.905918724551
             les_mean =     286.482391842051
             stat err =       0.000450092139
             autocorr =       1.261115911468
              std dev =       0.566811852740
             le_variance =       0.321275676407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905932023029        initial
     1.5625e-01     1.5625e+00             1.4551e-03       -16.905940833186  <--
     6.2500e-01     6.2500e+00             4.3886e-04       -16.905932149099
     2.5000e+00     2.5000e+01             1.4460e-04       -16.905918724551

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0870e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.128033e-01 1 1  ON 0
   uu_1                 1.451737e-01 1 1  ON 1
   uu_2                 4.348634e-02 1 1  ON 2
   uu_3                -1.914513e-02 1 1  ON 3
   uu_4                -6.524474e-02 1 1  ON 4
   uu_5                -1.005443e-01 1 1  ON 5
   uu_6                -1.281850e-01 1 1  ON 6
   uu_7                -1.419002e-01 1 1  ON 7
   uu_8                -1.353576e-01 1 1  ON 8
   uu_9                -1.036904e-01 1 1  ON 9
   ud_0                 4.472232e-01 1 1  ON 10
   ud_1                 1.814874e-01 1 1  ON 11
   ud_2                 6.124815e-02 1 1  ON 12
   ud_3                -9.564911e-03 1 1  ON 13
   ud_4                -6.637852e-02 1 1  ON 14
   ud_5                -1.077010e-01 1 1  ON 15
   ud_6                -1.347849e-01 1 1  ON 16
   ud_7                -1.515212e-01 1 1  ON 17
   ud_8                -1.518978e-01 1 1  ON 18
   ud_9                -1.408348e-01 1 1  ON 19
   eO_0                -7.500265e-01 1 1  ON 20
   eO_1                -4.299470e-01 1 1  ON 21
   eO_2                -1.992579e-02 1 1  ON 22
   eO_3                 2.913296e-01 1 1  ON 23
   eO_4                 5.161370e-01 1 1  ON 24
   eO_5                 4.783189e-01 1 1  ON 25
   eO_6                 2.520731e-01 1 1  ON 26
   eO_7                -4.543036e-02 1 1  ON 27
   eO_8                -2.162993e-01 1 1  ON 28
   eO_9                -7.670030e-02 1 1  ON 29
  eH1_0                -2.532464e-01 1 1  ON 30
  eH1_1                -1.462324e-01 1 1  ON 31
  eH1_2                -9.672548e-02 1 1  ON 32
  eH1_3                -4.160052e-02 1 1  ON 33
  eH1_4                 7.883813e-03 1 1  ON 34
  eH1_5                 4.271819e-02 1 1  ON 35
  eH1_6                 1.015850e-01 1 1  ON 36
  eH1_7                 1.551995e-01 1 1  ON 37
  eH1_8                 1.737032e-01 1 1  ON 38
  eH1_9                 5.985671e-02 1 1  ON 39
  eH2_0                -2.510080e-01 1 1  ON 40
  eH2_1                -1.432758e-01 1 1  ON 41
  eH2_2                -9.357690e-02 1 1  ON 42
  eH2_3                -3.902508e-02 1 1  ON 43
  eH2_4                 1.090781e-02 1 1  ON 44
  eH2_5                 4.636182e-02 1 1  ON 45
  eH2_6                 1.042966e-01 1 1  ON 46
  eH2_7                 1.558980e-01 1 1  ON 47
  eH2_8                 1.782456e-01 1 1  ON 48
  eH2_9                 4.728907e-02 1 1  ON 49
ci_0001                 7.009087e-01 3 1  ON 50
ci_0002                 7.008877e-01 3 1  ON 51
ci_0003                -2.649650e-02 3 1  ON 52
ci_0004                -2.755268e-02 3 1  ON 53
ci_0005                -3.634183e-02 3 1  ON 54
ci_0006                -3.634158e-02 3 1  ON 55
ci_0007                -2.063353e-02 3 1  ON 56
ci_0008                -2.196999e-02 3 1  ON 57
ci_0009                -1.763200e-02 3 1  ON 58
ci_0010                -1.744361e-02 3 1  ON 59
ci_0011                -1.165620e-02 3 1  ON 60
ci_0012                -1.191035e-02 3 1  ON 61
ci_0013                 1.337301e-02 3 1  ON 62
ci_0014                 1.334821e-02 3 1  ON 63
ci_0015                 1.347776e-02 3 1  ON 64
ci_0016                 1.352149e-02 3 1  ON 65
ci_0017                 1.148476e-02 3 1  ON 66
ci_0018                 1.100033e-02 3 1  ON 67
ci_0019                 1.137232e-02 3 1  ON 68
ci_0020                 1.079484e-02 3 1  ON 69
ci_0021                -1.672368e-03 3 1  ON 70
ci_0022                 1.835762e-05 3 1  ON 71
ci_0023                -1.195772e-02 3 1  ON 72
ci_0024                -1.117716e-02 3 1  ON 73
ci_0025                -1.034709e-02 3 1  ON 74
ci_0026                -1.106414e-02 3 1  ON 75
ci_0027                -1.163389e-02 3 1  ON 76
ci_0028                -1.172917e-02 3 1  ON 77
ci_0029                -1.008261e-02 3 1  ON 78
ci_0030                -1.145836e-02 3 1  ON 79
ci_0031                 2.037191e-02 3 1  ON 80
ci_0032                 2.036343e-02 3 1  ON 81
ci_0033                 1.049272e-02 3 1  ON 82
ci_0034                 1.021868e-02 3 1  ON 83
ci_0035                 6.985485e-03 3 1  ON 84
ci_0036                 6.861357e-03 3 1  ON 85
ci_0037                -1.031424e-02 3 1  ON 86
ci_0038                -1.070082e-02 3 1  ON 87
ci_0039                -2.556938e-03 3 1  ON 88
ci_0040                -2.718452e-03 3 1  ON 89
ci_0041                 7.277071e-03 3 1  ON 90
ci_0042                 6.978910e-03 3 1  ON 91
ci_0043                -1.920287e-02 3 1  ON 92
ci_0044                -1.871907e-02 3 1  ON 93
ci_0045                 8.258228e-03 3 1  ON 94
ci_0046                 7.580071e-03 3 1  ON 95
ci_0047                -1.795696e-03 3 1  ON 96
ci_0048                -1.857933e-03 3 1  ON 97
ci_0049                -5.368871e-03 3 1  ON 98
ci_0050                -5.869190e-03 3 1  ON 99
ci_0051                -3.536633e-03 3 1  ON 100
ci_0052                -3.440804e-03 3 1  ON 101
ci_0053                -4.648936e-03 3 1  ON 102
ci_0054                -4.167722e-03 3 1  ON 103
ci_0055                 6.109530e-03 3 1  ON 104
ci_0056                 6.265363e-03 3 1  ON 105
ci_0057                 4.724404e-03 3 1  ON 106
ci_0058                 4.788210e-03 3 1  ON 107
ci_0059                -4.585635e-03 3 1  ON 108
ci_0060                -4.971158e-03 3 1  ON 109
ci_0061                -3.628555e-03 3 1  ON 110
ci_0062                -3.415386e-03 3 1  ON 111
ci_0063                -9.619467e-03 3 1  ON 112
ci_0064                -8.619485e-03 3 1  ON 113
ci_0065                -5.026472e-03 3 1  ON 114
ci_0066                -5.015074e-03 3 1  ON 115
ci_0067                -5.492049e-03 3 1  ON 116
ci_0068                -5.103609e-03 3 1  ON 117
ci_0069                 4.626567e-03 3 1  ON 118
ci_0070                 4.277820e-03 3 1  ON 119
ci_0071                -9.018023e-05 3 1  ON 120
ci_0072                 1.206714e-04 3 1  ON 121
ci_0073                 4.037238e-03 3 1  ON 122
ci_0074                 4.275289e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9574
    reference variance = 0.24448
====================================================
  Execution time = 2.1224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3852e-01
  Total weights = 1.951930298e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326369345983
                                         uncertainty =       0.002552878574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326369345983
                                         uncertainty =       0.002552878574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403910383
  error estimate for blocks of size 2^( 2) =       0.000416571147
  error estimate for blocks of size 2^( 3) =       0.000429711105
  error estimate for blocks of size 2^( 4) =       0.000442385189
  error estimate for blocks of size 2^( 5) =       0.000453639856
  error estimate for blocks of size 2^( 6) =       0.000462091828
  error estimate for blocks of size 2^( 7) =       0.000467376049

      target function =                  N/A
              le_mean =     -16.905673709889
             les_mean =     286.140322969185
             stat err =       0.000456373231
             autocorr =       1.276645416696
              std dev =       0.571215541023
             le_variance =       0.326287194306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567370989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673709884       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905709688871       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905703152385       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905704025786       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706418347       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905705563211       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905712218252       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905714711085       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905714008943       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905712312326       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905713982605       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905712519513       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905713343475       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905713408652       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905714649390       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905714591779       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905714666455       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905714648129       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905714813222       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905714841620       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-02 is 5.216476e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673709884       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905697835037       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905694286092       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905694002207       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905695540809       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905695558726       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905697540226       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905698542631       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905697931535       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905697860072       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905697846612       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905697362895       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905697554484       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905697664417       residual = 3.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 1.353552e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673709884       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905684118211       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683217321       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683010970       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905683527616       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905683570336       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905683856216       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905684232552       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905684170550       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905684050279       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905684058500       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 4.638019e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7484e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.128261e-01 1 1  ON 0
   uu_1                 1.453189e-01 1 1  ON 1
   uu_2                 4.342631e-02 1 1  ON 2
   uu_3                -1.906185e-02 1 1  ON 3
   uu_4                -6.500269e-02 1 1  ON 4
   uu_5                -1.000623e-01 1 1  ON 5
   uu_6                -1.284381e-01 1 1  ON 6
   uu_7                -1.420831e-01 1 1  ON 7
   uu_8                -1.356458e-01 1 1  ON 8
   uu_9                -1.046536e-01 1 1  ON 9
   ud_0                 4.480026e-01 1 1  ON 10
   ud_1                 1.820651e-01 1 1  ON 11
   ud_2                 6.184683e-02 1 1  ON 12
   ud_3                -9.132887e-03 1 1  ON 13
   ud_4                -6.603282e-02 1 1  ON 14
   ud_5                -1.077056e-01 1 1  ON 15
   ud_6                -1.350422e-01 1 1  ON 16
   ud_7                -1.515104e-01 1 1  ON 17
   ud_8                -1.525565e-01 1 1  ON 18
   ud_9                -1.416954e-01 1 1  ON 19
   eO_0                -7.498744e-01 1 1  ON 20
   eO_1                -4.295740e-01 1 1  ON 21
   eO_2                -1.964319e-02 1 1  ON 22
   eO_3                 2.913200e-01 1 1  ON 23
   eO_4                 5.163501e-01 1 1  ON 24
   eO_5                 4.791875e-01 1 1  ON 25
   eO_6                 2.524120e-01 1 1  ON 26
   eO_7                -4.533118e-02 1 1  ON 27
   eO_8                -2.174744e-01 1 1  ON 28
   eO_9                -7.769556e-02 1 1  ON 29
  eH1_0                -2.540405e-01 1 1  ON 30
  eH1_1                -1.468475e-01 1 1  ON 31
  eH1_2                -9.722299e-02 1 1  ON 32
  eH1_3                -4.192285e-02 1 1  ON 33
  eH1_4                 7.935902e-03 1 1  ON 34
  eH1_5                 4.273499e-02 1 1  ON 35
  eH1_6                 1.014574e-01 1 1  ON 36
  eH1_7                 1.557053e-01 1 1  ON 37
  eH1_8                 1.745537e-01 1 1  ON 38
  eH1_9                 6.078916e-02 1 1  ON 39
  eH2_0                -2.513904e-01 1 1  ON 40
  eH2_1                -1.439751e-01 1 1  ON 41
  eH2_2                -9.429551e-02 1 1  ON 42
  eH2_3                -3.929905e-02 1 1  ON 43
  eH2_4                 1.037627e-02 1 1  ON 44
  eH2_5                 4.602206e-02 1 1  ON 45
  eH2_6                 1.046670e-01 1 1  ON 46
  eH2_7                 1.562435e-01 1 1  ON 47
  eH2_8                 1.791434e-01 1 1  ON 48
  eH2_9                 4.860106e-02 1 1  ON 49
ci_0001                 7.010473e-01 3 1  ON 50
ci_0002                 7.007661e-01 3 1  ON 51
ci_0003                -2.650511e-02 3 1  ON 52
ci_0004                -2.769231e-02 3 1  ON 53
ci_0005                -3.639917e-02 3 1  ON 54
ci_0006                -3.647689e-02 3 1  ON 55
ci_0007                -2.197574e-02 3 1  ON 56
ci_0008                -2.174752e-02 3 1  ON 57
ci_0009                -1.715831e-02 3 1  ON 58
ci_0010                -1.767218e-02 3 1  ON 59
ci_0011                -1.199751e-02 3 1  ON 60
ci_0012                -1.158965e-02 3 1  ON 61
ci_0013                 1.325088e-02 3 1  ON 62
ci_0014                 1.305235e-02 3 1  ON 63
ci_0015                 1.368512e-02 3 1  ON 64
ci_0016                 1.366509e-02 3 1  ON 65
ci_0017                 1.156808e-02 3 1  ON 66
ci_0018                 1.097652e-02 3 1  ON 67
ci_0019                 1.136884e-02 3 1  ON 68
ci_0020                 1.103147e-02 3 1  ON 69
ci_0021                -1.252193e-03 3 1  ON 70
ci_0022                -1.335195e-03 3 1  ON 71
ci_0023                -1.140936e-02 3 1  ON 72
ci_0024                -1.160685e-02 3 1  ON 73
ci_0025                -9.889799e-03 3 1  ON 74
ci_0026                -1.067827e-02 3 1  ON 75
ci_0027                -1.067617e-02 3 1  ON 76
ci_0028                -1.139168e-02 3 1  ON 77
ci_0029                -1.048682e-02 3 1  ON 78
ci_0030                -1.088994e-02 3 1  ON 79
ci_0031                 2.023488e-02 3 1  ON 80
ci_0032                 2.036360e-02 3 1  ON 81
ci_0033                 9.835043e-03 3 1  ON 82
ci_0034                 9.599512e-03 3 1  ON 83
ci_0035                 7.131985e-03 3 1  ON 84
ci_0036                 6.615690e-03 3 1  ON 85
ci_0037                -1.119687e-02 3 1  ON 86
ci_0038                -1.038629e-02 3 1  ON 87
ci_0039                -2.534924e-03 3 1  ON 88
ci_0040                -2.550615e-03 3 1  ON 89
ci_0041                 6.787189e-03 3 1  ON 90
ci_0042                 6.867495e-03 3 1  ON 91
ci_0043                -1.886031e-02 3 1  ON 92
ci_0044                -1.890533e-02 3 1  ON 93
ci_0045                 8.100167e-03 3 1  ON 94
ci_0046                 7.863159e-03 3 1  ON 95
ci_0047                -1.501940e-03 3 1  ON 96
ci_0048                -1.879793e-03 3 1  ON 97
ci_0049                -5.309862e-03 3 1  ON 98
ci_0050                -5.441597e-03 3 1  ON 99
ci_0051                -3.856004e-03 3 1  ON 100
ci_0052                -3.673213e-03 3 1  ON 101
ci_0053                -4.816325e-03 3 1  ON 102
ci_0054                -4.134245e-03 3 1  ON 103
ci_0055                 6.043169e-03 3 1  ON 104
ci_0056                 6.534605e-03 3 1  ON 105
ci_0057                 5.089012e-03 3 1  ON 106
ci_0058                 4.714935e-03 3 1  ON 107
ci_0059                -4.400805e-03 3 1  ON 108
ci_0060                -4.703640e-03 3 1  ON 109
ci_0061                -3.752555e-03 3 1  ON 110
ci_0062                -3.530255e-03 3 1  ON 111
ci_0063                -9.602198e-03 3 1  ON 112
ci_0064                -8.603102e-03 3 1  ON 113
ci_0065                -5.258176e-03 3 1  ON 114
ci_0066                -5.724973e-03 3 1  ON 115
ci_0067                -5.098397e-03 3 1  ON 116
ci_0068                -4.955967e-03 3 1  ON 117
ci_0069                 4.119782e-03 3 1  ON 118
ci_0070                 4.598207e-03 3 1  ON 119
ci_0071                 8.634084e-05 3 1  ON 120
ci_0072                 5.654136e-04 3 1  ON 121
ci_0073                 4.404061e-03 3 1  ON 122
ci_0074                 4.366212e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0443
    reference variance = 0.257751
====================================================
  Execution time = 2.2886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4600e-01
  Total weights = 1.9516e+06
  Execution time = 1.8990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330252864881
                                         uncertainty =       0.004139949618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330252864881
                                         uncertainty =       0.004139949618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406366615
  error estimate for blocks of size 2^( 2) =       0.000418853573
  error estimate for blocks of size 2^( 3) =       0.000431718171
  error estimate for blocks of size 2^( 4) =       0.000444096723
  error estimate for blocks of size 2^( 5) =       0.000455720902
  error estimate for blocks of size 2^( 6) =       0.000463565283
  error estimate for blocks of size 2^( 7) =       0.000468796411

      target function =                  N/A
              le_mean =     -16.906570406417
             les_mean =     286.188288807551
             stat err =       0.000458044830
             autocorr =       1.270515381906
              std dev =       0.574689178612
             le_variance =       0.330267652014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330259148561
                                         uncertainty =       0.004116810095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330259148561
                                         uncertainty =       0.004116810095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406369657
  error estimate for blocks of size 2^( 2) =       0.000418861174
  error estimate for blocks of size 2^( 3) =       0.000431707329
  error estimate for blocks of size 2^( 4) =       0.000444065927
  error estimate for blocks of size 2^( 5) =       0.000455670000
  error estimate for blocks of size 2^( 6) =       0.000463517417
  error estimate for blocks of size 2^( 7) =       0.000468740996

      target function =                  N/A
              le_mean =     -16.906537684302
             les_mean =     286.203420302919
             stat err =       0.000457998585
             autocorr =       1.270239831556
              std dev =       0.574693480263
             le_variance =       0.330272596257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330315985391
                                         uncertainty =       0.004112366256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330315985391
                                         uncertainty =       0.004112366256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406404052
  error estimate for blocks of size 2^( 2) =       0.000418897442
  error estimate for blocks of size 2^( 3) =       0.000431742907
  error estimate for blocks of size 2^( 4) =       0.000444096937
  error estimate for blocks of size 2^( 5) =       0.000455682241
  error estimate for blocks of size 2^( 6) =       0.000463529660
  error estimate for blocks of size 2^( 7) =       0.000468730492

      target function =                  N/A
              le_mean =     -16.906542094633
             les_mean =     286.214848581954
             stat err =       0.000458009832
             autocorr =       1.270087213973
              std dev =       0.574742122293
             le_variance =       0.330328507138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330076971574
                                         uncertainty =       0.004130843359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330076971574
                                         uncertainty =       0.004130843359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406258413
  error estimate for blocks of size 2^( 2) =       0.000418749195
  error estimate for blocks of size 2^( 3) =       0.000431604836
  error estimate for blocks of size 2^( 4) =       0.000443984687
  error estimate for blocks of size 2^( 5) =       0.000455612413
  error estimate for blocks of size 2^( 6) =       0.000463475231
  error estimate for blocks of size 2^( 7) =       0.000468727153

      target function =                  N/A
              le_mean =     -16.906556130824
             les_mean =     286.182984859931
             stat err =       0.000457949871
             autocorr =       1.270665233221
              std dev =       0.574536156883
             le_variance =       0.330091795566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906570406417        initial  <--
     3.9062e-02     3.9062e-01             5.2165e-03       -16.906537684302
     1.5625e-01     1.5625e+00             1.3536e-03       -16.906542094633
     6.2500e-01     6.2500e+00             4.6380e-04       -16.906556130824

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.4656
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.128033e-01 1 1  ON 0
   uu_1                 1.451737e-01 1 1  ON 1
   uu_2                 4.348634e-02 1 1  ON 2
   uu_3                -1.914513e-02 1 1  ON 3
   uu_4                -6.524474e-02 1 1  ON 4
   uu_5                -1.005443e-01 1 1  ON 5
   uu_6                -1.281850e-01 1 1  ON 6
   uu_7                -1.419002e-01 1 1  ON 7
   uu_8                -1.353576e-01 1 1  ON 8
   uu_9                -1.036904e-01 1 1  ON 9
   ud_0                 4.472232e-01 1 1  ON 10
   ud_1                 1.814874e-01 1 1  ON 11
   ud_2                 6.124815e-02 1 1  ON 12
   ud_3                -9.564911e-03 1 1  ON 13
   ud_4                -6.637852e-02 1 1  ON 14
   ud_5                -1.077010e-01 1 1  ON 15
   ud_6                -1.347849e-01 1 1  ON 16
   ud_7                -1.515212e-01 1 1  ON 17
   ud_8                -1.518978e-01 1 1  ON 18
   ud_9                -1.408348e-01 1 1  ON 19
   eO_0                -7.500265e-01 1 1  ON 20
   eO_1                -4.299470e-01 1 1  ON 21
   eO_2                -1.992579e-02 1 1  ON 22
   eO_3                 2.913296e-01 1 1  ON 23
   eO_4                 5.161370e-01 1 1  ON 24
   eO_5                 4.783189e-01 1 1  ON 25
   eO_6                 2.520731e-01 1 1  ON 26
   eO_7                -4.543036e-02 1 1  ON 27
   eO_8                -2.162993e-01 1 1  ON 28
   eO_9                -7.670030e-02 1 1  ON 29
  eH1_0                -2.532464e-01 1 1  ON 30
  eH1_1                -1.462324e-01 1 1  ON 31
  eH1_2                -9.672548e-02 1 1  ON 32
  eH1_3                -4.160052e-02 1 1  ON 33
  eH1_4                 7.883813e-03 1 1  ON 34
  eH1_5                 4.271819e-02 1 1  ON 35
  eH1_6                 1.015850e-01 1 1  ON 36
  eH1_7                 1.551995e-01 1 1  ON 37
  eH1_8                 1.737032e-01 1 1  ON 38
  eH1_9                 5.985671e-02 1 1  ON 39
  eH2_0                -2.510080e-01 1 1  ON 40
  eH2_1                -1.432758e-01 1 1  ON 41
  eH2_2                -9.357690e-02 1 1  ON 42
  eH2_3                -3.902508e-02 1 1  ON 43
  eH2_4                 1.090781e-02 1 1  ON 44
  eH2_5                 4.636182e-02 1 1  ON 45
  eH2_6                 1.042966e-01 1 1  ON 46
  eH2_7                 1.558980e-01 1 1  ON 47
  eH2_8                 1.782456e-01 1 1  ON 48
  eH2_9                 4.728907e-02 1 1  ON 49
ci_0001                 7.009087e-01 3 1  ON 50
ci_0002                 7.008877e-01 3 1  ON 51
ci_0003                -2.649650e-02 3 1  ON 52
ci_0004                -2.755268e-02 3 1  ON 53
ci_0005                -3.634183e-02 3 1  ON 54
ci_0006                -3.634158e-02 3 1  ON 55
ci_0007                -2.063353e-02 3 1  ON 56
ci_0008                -2.196999e-02 3 1  ON 57
ci_0009                -1.763200e-02 3 1  ON 58
ci_0010                -1.744361e-02 3 1  ON 59
ci_0011                -1.165620e-02 3 1  ON 60
ci_0012                -1.191035e-02 3 1  ON 61
ci_0013                 1.337301e-02 3 1  ON 62
ci_0014                 1.334821e-02 3 1  ON 63
ci_0015                 1.347776e-02 3 1  ON 64
ci_0016                 1.352149e-02 3 1  ON 65
ci_0017                 1.148476e-02 3 1  ON 66
ci_0018                 1.100033e-02 3 1  ON 67
ci_0019                 1.137232e-02 3 1  ON 68
ci_0020                 1.079484e-02 3 1  ON 69
ci_0021                -1.672368e-03 3 1  ON 70
ci_0022                 1.835762e-05 3 1  ON 71
ci_0023                -1.195772e-02 3 1  ON 72
ci_0024                -1.117716e-02 3 1  ON 73
ci_0025                -1.034709e-02 3 1  ON 74
ci_0026                -1.106414e-02 3 1  ON 75
ci_0027                -1.163389e-02 3 1  ON 76
ci_0028                -1.172917e-02 3 1  ON 77
ci_0029                -1.008261e-02 3 1  ON 78
ci_0030                -1.145836e-02 3 1  ON 79
ci_0031                 2.037191e-02 3 1  ON 80
ci_0032                 2.036343e-02 3 1  ON 81
ci_0033                 1.049272e-02 3 1  ON 82
ci_0034                 1.021868e-02 3 1  ON 83
ci_0035                 6.985485e-03 3 1  ON 84
ci_0036                 6.861357e-03 3 1  ON 85
ci_0037                -1.031424e-02 3 1  ON 86
ci_0038                -1.070082e-02 3 1  ON 87
ci_0039                -2.556938e-03 3 1  ON 88
ci_0040                -2.718452e-03 3 1  ON 89
ci_0041                 7.277071e-03 3 1  ON 90
ci_0042                 6.978910e-03 3 1  ON 91
ci_0043                -1.920287e-02 3 1  ON 92
ci_0044                -1.871907e-02 3 1  ON 93
ci_0045                 8.258228e-03 3 1  ON 94
ci_0046                 7.580071e-03 3 1  ON 95
ci_0047                -1.795696e-03 3 1  ON 96
ci_0048                -1.857933e-03 3 1  ON 97
ci_0049                -5.368871e-03 3 1  ON 98
ci_0050                -5.869190e-03 3 1  ON 99
ci_0051                -3.536633e-03 3 1  ON 100
ci_0052                -3.440804e-03 3 1  ON 101
ci_0053                -4.648936e-03 3 1  ON 102
ci_0054                -4.167722e-03 3 1  ON 103
ci_0055                 6.109530e-03 3 1  ON 104
ci_0056                 6.265363e-03 3 1  ON 105
ci_0057                 4.724404e-03 3 1  ON 106
ci_0058                 4.788210e-03 3 1  ON 107
ci_0059                -4.585635e-03 3 1  ON 108
ci_0060                -4.971158e-03 3 1  ON 109
ci_0061                -3.628555e-03 3 1  ON 110
ci_0062                -3.415386e-03 3 1  ON 111
ci_0063                -9.619467e-03 3 1  ON 112
ci_0064                -8.619485e-03 3 1  ON 113
ci_0065                -5.026472e-03 3 1  ON 114
ci_0066                -5.015074e-03 3 1  ON 115
ci_0067                -5.492049e-03 3 1  ON 116
ci_0068                -5.103609e-03 3 1  ON 117
ci_0069                 4.626567e-03 3 1  ON 118
ci_0070                 4.277820e-03 3 1  ON 119
ci_0071                -9.018023e-05 3 1  ON 120
ci_0072                 1.206714e-04 3 1  ON 121
ci_0073                 4.037238e-03 3 1  ON 122
ci_0074                 4.275289e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9956e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8659
    reference variance = 0.202994
====================================================
  Execution time = 2.1344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3598e-01
  Total weights = 1.951707243e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322936212617
                                         uncertainty =       0.002093704848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322936212617
                                         uncertainty =       0.002093704848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401836904
  error estimate for blocks of size 2^( 2) =       0.000415073806
  error estimate for blocks of size 2^( 3) =       0.000428430954
  error estimate for blocks of size 2^( 4) =       0.000440484510
  error estimate for blocks of size 2^( 5) =       0.000452011182
  error estimate for blocks of size 2^( 6) =       0.000461175111
  error estimate for blocks of size 2^( 7) =       0.000466044157

      target function =                  N/A
              le_mean =     -16.905702104230
             les_mean =     286.138745670104
             stat err =       0.000454928740
             autocorr =       1.281702140515
              std dev =       0.568283199872
             le_variance =       0.322945795257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570210423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905702104213       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905707186323       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905707613572       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905708497782       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905708876976       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905708118376       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905707228253       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905708108286       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905708001800       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905708108445       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905708105470       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 8.256861e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905702104213       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905703838897       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905703830044       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905703997017       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905704119871       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905703893662       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905703665974       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905703913157       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905703895236       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905703921677       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 2.807130e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905702104213       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905702581473       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905702567288       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905702600638       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905702622054       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905702566786       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905702516967       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905702572394       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905702572332       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905702581705       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 7.719497e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7469e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.129059e-01 1 1  ON 0
   uu_1                 1.452519e-01 1 1  ON 1
   uu_2                 4.348963e-02 1 1  ON 2
   uu_3                -1.915772e-02 1 1  ON 3
   uu_4                -6.526281e-02 1 1  ON 4
   uu_5                -1.006147e-01 1 1  ON 5
   uu_6                -1.283075e-01 1 1  ON 6
   uu_7                -1.419819e-01 1 1  ON 7
   uu_8                -1.353381e-01 1 1  ON 8
   uu_9                -1.036881e-01 1 1  ON 9
   ud_0                 4.472627e-01 1 1  ON 10
   ud_1                 1.814790e-01 1 1  ON 11
   ud_2                 6.125372e-02 1 1  ON 12
   ud_3                -9.547790e-03 1 1  ON 13
   ud_4                -6.641284e-02 1 1  ON 14
   ud_5                -1.076761e-01 1 1  ON 15
   ud_6                -1.347512e-01 1 1  ON 16
   ud_7                -1.514885e-01 1 1  ON 17
   ud_8                -1.519312e-01 1 1  ON 18
   ud_9                -1.408824e-01 1 1  ON 19
   eO_0                -7.500563e-01 1 1  ON 20
   eO_1                -4.299220e-01 1 1  ON 21
   eO_2                -1.994519e-02 1 1  ON 22
   eO_3                 2.913651e-01 1 1  ON 23
   eO_4                 5.161167e-01 1 1  ON 24
   eO_5                 4.783894e-01 1 1  ON 25
   eO_6                 2.521221e-01 1 1  ON 26
   eO_7                -4.539336e-02 1 1  ON 27
   eO_8                -2.163519e-01 1 1  ON 28
   eO_9                -7.678252e-02 1 1  ON 29
  eH1_0                -2.533535e-01 1 1  ON 30
  eH1_1                -1.462630e-01 1 1  ON 31
  eH1_2                -9.676912e-02 1 1  ON 32
  eH1_3                -4.162444e-02 1 1  ON 33
  eH1_4                 7.853248e-03 1 1  ON 34
  eH1_5                 4.270999e-02 1 1  ON 35
  eH1_6                 1.015999e-01 1 1  ON 36
  eH1_7                 1.552313e-01 1 1  ON 37
  eH1_8                 1.737808e-01 1 1  ON 38
  eH1_9                 5.995512e-02 1 1  ON 39
  eH2_0                -2.510904e-01 1 1  ON 40
  eH2_1                -1.433235e-01 1 1  ON 41
  eH2_2                -9.369909e-02 1 1  ON 42
  eH2_3                -3.901976e-02 1 1  ON 43
  eH2_4                 1.089195e-02 1 1  ON 44
  eH2_5                 4.633412e-02 1 1  ON 45
  eH2_6                 1.042707e-01 1 1  ON 46
  eH2_7                 1.559166e-01 1 1  ON 47
  eH2_8                 1.783709e-01 1 1  ON 48
  eH2_9                 4.744108e-02 1 1  ON 49
ci_0001                 7.009257e-01 3 1  ON 50
ci_0002                 7.008817e-01 3 1  ON 51
ci_0003                -2.649905e-02 3 1  ON 52
ci_0004                -2.756065e-02 3 1  ON 53
ci_0005                -3.626061e-02 3 1  ON 54
ci_0006                -3.639727e-02 3 1  ON 55
ci_0007                -2.067977e-02 3 1  ON 56
ci_0008                -2.193723e-02 3 1  ON 57
ci_0009                -1.757820e-02 3 1  ON 58
ci_0010                -1.735033e-02 3 1  ON 59
ci_0011                -1.179986e-02 3 1  ON 60
ci_0012                -1.194917e-02 3 1  ON 61
ci_0013                 1.340000e-02 3 1  ON 62
ci_0014                 1.339261e-02 3 1  ON 63
ci_0015                 1.343861e-02 3 1  ON 64
ci_0016                 1.346837e-02 3 1  ON 65
ci_0017                 1.144518e-02 3 1  ON 66
ci_0018                 1.107855e-02 3 1  ON 67
ci_0019                 1.135648e-02 3 1  ON 68
ci_0020                 1.085012e-02 3 1  ON 69
ci_0021                -1.632802e-03 3 1  ON 70
ci_0022                 7.606683e-06 3 1  ON 71
ci_0023                -1.184498e-02 3 1  ON 72
ci_0024                -1.123220e-02 3 1  ON 73
ci_0025                -1.029026e-02 3 1  ON 74
ci_0026                -1.078342e-02 3 1  ON 75
ci_0027                -1.157600e-02 3 1  ON 76
ci_0028                -1.161715e-02 3 1  ON 77
ci_0029                -1.001236e-02 3 1  ON 78
ci_0030                -1.133821e-02 3 1  ON 79
ci_0031                 2.047214e-02 3 1  ON 80
ci_0032                 2.036331e-02 3 1  ON 81
ci_0033                 1.044006e-02 3 1  ON 82
ci_0034                 1.022196e-02 3 1  ON 83
ci_0035                 6.908615e-03 3 1  ON 84
ci_0036                 6.845916e-03 3 1  ON 85
ci_0037                -1.029194e-02 3 1  ON 86
ci_0038                -1.058438e-02 3 1  ON 87
ci_0039                -2.421805e-03 3 1  ON 88
ci_0040                -2.697205e-03 3 1  ON 89
ci_0041                 7.287241e-03 3 1  ON 90
ci_0042                 6.994651e-03 3 1  ON 91
ci_0043                -1.931356e-02 3 1  ON 92
ci_0044                -1.887423e-02 3 1  ON 93
ci_0045                 8.111837e-03 3 1  ON 94
ci_0046                 7.530607e-03 3 1  ON 95
ci_0047                -1.747655e-03 3 1  ON 96
ci_0048                -1.841491e-03 3 1  ON 97
ci_0049                -5.348210e-03 3 1  ON 98
ci_0050                -5.718651e-03 3 1  ON 99
ci_0051                -3.483128e-03 3 1  ON 100
ci_0052                -3.426154e-03 3 1  ON 101
ci_0053                -4.690159e-03 3 1  ON 102
ci_0054                -4.183897e-03 3 1  ON 103
ci_0055                 6.138640e-03 3 1  ON 104
ci_0056                 6.262998e-03 3 1  ON 105
ci_0057                 4.822914e-03 3 1  ON 106
ci_0058                 4.909972e-03 3 1  ON 107
ci_0059                -4.605381e-03 3 1  ON 108
ci_0060                -4.844849e-03 3 1  ON 109
ci_0061                -3.512803e-03 3 1  ON 110
ci_0062                -3.453421e-03 3 1  ON 111
ci_0063                -9.531570e-03 3 1  ON 112
ci_0064                -8.747760e-03 3 1  ON 113
ci_0065                -5.015384e-03 3 1  ON 114
ci_0066                -5.017504e-03 3 1  ON 115
ci_0067                -5.357721e-03 3 1  ON 116
ci_0068                -5.108811e-03 3 1  ON 117
ci_0069                 4.557356e-03 3 1  ON 118
ci_0070                 4.347861e-03 3 1  ON 119
ci_0071                -6.229252e-05 3 1  ON 120
ci_0072                 1.487595e-04 3 1  ON 121
ci_0073                 4.015522e-03 3 1  ON 122
ci_0074                 4.219356e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9539
    reference variance = 0.268245
====================================================
  Execution time = 2.1007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5096e-01
  Total weights = 1.9517e+06
  Execution time = 1.8981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327506639814
                                         uncertainty =       0.002921930976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327506639814
                                         uncertainty =       0.002921930976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404660999
  error estimate for blocks of size 2^( 2) =       0.000417672896
  error estimate for blocks of size 2^( 3) =       0.000430730061
  error estimate for blocks of size 2^( 4) =       0.000443200114
  error estimate for blocks of size 2^( 5) =       0.000453615033
  error estimate for blocks of size 2^( 6) =       0.000462239567
  error estimate for blocks of size 2^( 7) =       0.000465392947

      target function =                  N/A
              le_mean =     -16.905511780551
             les_mean =     286.147524734913
             stat err =       0.000456111915
             autocorr =       1.270457484032
              std dev =       0.572277073521
             le_variance =       0.327501048878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327414090985
                                         uncertainty =       0.002929616822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327414090985
                                         uncertainty =       0.002929616822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404603862
  error estimate for blocks of size 2^( 2) =       0.000417614777
  error estimate for blocks of size 2^( 3) =       0.000430673857
  error estimate for blocks of size 2^( 4) =       0.000443141620
  error estimate for blocks of size 2^( 5) =       0.000453557632
  error estimate for blocks of size 2^( 6) =       0.000462156968
  error estimate for blocks of size 2^( 7) =       0.000465281940

      target function =                  N/A
              le_mean =     -16.905513089458
             les_mean =     286.153255966132
             stat err =       0.000456034540
             autocorr =       1.270385205705
              std dev =       0.572196268612
             le_variance =       0.327408569813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327429359106
                                         uncertainty =       0.002926998053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327429359106
                                         uncertainty =       0.002926998053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404613334
  error estimate for blocks of size 2^( 2) =       0.000417624136
  error estimate for blocks of size 2^( 3) =       0.000430682452
  error estimate for blocks of size 2^( 4) =       0.000443150810
  error estimate for blocks of size 2^( 5) =       0.000453567545
  error estimate for blocks of size 2^( 6) =       0.000462174561
  error estimate for blocks of size 2^( 7) =       0.000465310416

      target function =                  N/A
              le_mean =     -16.905512511995
             les_mean =     286.147930858242
             stat err =       0.000456050833
             autocorr =       1.270416498801
              std dev =       0.572209664424
             le_variance =       0.327423900060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327492390211
                                         uncertainty =       0.002922495796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327492390211
                                         uncertainty =       0.002922495796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404652210
  error estimate for blocks of size 2^( 2) =       0.000417663829
  error estimate for blocks of size 2^( 3) =       0.000430721059
  error estimate for blocks of size 2^( 4) =       0.000443191292
  error estimate for blocks of size 2^( 5) =       0.000453606887
  error estimate for blocks of size 2^( 6) =       0.000462228510
  error estimate for blocks of size 2^( 7) =       0.000465379789

      target function =                  N/A
              le_mean =     -16.905511550118
             les_mean =     286.149291580534
             stat err =       0.000456101620
             autocorr =       1.270455318853
              std dev =       0.572264643164
             le_variance =       0.327486821815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905511780551        initial
     3.9062e-01     3.9062e+00             8.2569e-04       -16.905513089458  <--
     1.5625e+00     1.5625e+01             2.8071e-04       -16.905512511995
     6.2500e+00     6.2500e+01             7.7195e-05       -16.905511550118

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.0563e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.131751e-01 1 1  ON 0
   uu_1                 1.453919e-01 1 1  ON 1
   uu_2                 4.351524e-02 1 1  ON 2
   uu_3                -1.919272e-02 1 1  ON 3
   uu_4                -6.531068e-02 1 1  ON 4
   uu_5                -1.007797e-01 1 1  ON 5
   uu_6                -1.285970e-01 1 1  ON 6
   uu_7                -1.422190e-01 1 1  ON 7
   uu_8                -1.353011e-01 1 1  ON 8
   uu_9                -1.036827e-01 1 1  ON 9
   ud_0                 4.473289e-01 1 1  ON 10
   ud_1                 1.815008e-01 1 1  ON 11
   ud_2                 6.127761e-02 1 1  ON 12
   ud_3                -9.515643e-03 1 1  ON 13
   ud_4                -6.645014e-02 1 1  ON 14
   ud_5                -1.076347e-01 1 1  ON 15
   ud_6                -1.346768e-01 1 1  ON 16
   ud_7                -1.514018e-01 1 1  ON 17
   ud_8                -1.520164e-01 1 1  ON 18
   ud_9                -1.410179e-01 1 1  ON 19
   eO_0                -7.501298e-01 1 1  ON 20
   eO_1                -4.298937e-01 1 1  ON 21
   eO_2                -1.996554e-02 1 1  ON 22
   eO_3                 2.914417e-01 1 1  ON 23
   eO_4                 5.160760e-01 1 1  ON 24
   eO_5                 4.785931e-01 1 1  ON 25
   eO_6                 2.522756e-01 1 1  ON 26
   eO_7                -4.528216e-02 1 1  ON 27
   eO_8                -2.165081e-01 1 1  ON 28
   eO_9                -7.702735e-02 1 1  ON 29
  eH1_0                -2.536488e-01 1 1  ON 30
  eH1_1                -1.463678e-01 1 1  ON 31
  eH1_2                -9.690086e-02 1 1  ON 32
  eH1_3                -4.169933e-02 1 1  ON 33
  eH1_4                 7.758995e-03 1 1  ON 34
  eH1_5                 4.267895e-02 1 1  ON 35
  eH1_6                 1.016429e-01 1 1  ON 36
  eH1_7                 1.553291e-01 1 1  ON 37
  eH1_8                 1.740137e-01 1 1  ON 38
  eH1_9                 6.024955e-02 1 1  ON 39
  eH2_0                -2.513375e-01 1 1  ON 40
  eH2_1                -1.434912e-01 1 1  ON 41
  eH2_2                -9.398343e-02 1 1  ON 42
  eH2_3                -3.906154e-02 1 1  ON 43
  eH2_4                 1.084124e-02 1 1  ON 44
  eH2_5                 4.625946e-02 1 1  ON 45
  eH2_6                 1.041962e-01 1 1  ON 46
  eH2_7                 1.559705e-01 1 1  ON 47
  eH2_8                 1.787427e-01 1 1  ON 48
  eH2_9                 4.789466e-02 1 1  ON 49
ci_0001                 7.009560e-01 3 1  ON 50
ci_0002                 7.008702e-01 3 1  ON 51
ci_0003                -2.651265e-02 3 1  ON 52
ci_0004                -2.757787e-02 3 1  ON 53
ci_0005                -3.607589e-02 3 1  ON 54
ci_0006                -3.650893e-02 3 1  ON 55
ci_0007                -2.078306e-02 3 1  ON 56
ci_0008                -2.184105e-02 3 1  ON 57
ci_0009                -1.748369e-02 3 1  ON 58
ci_0010                -1.717956e-02 3 1  ON 59
ci_0011                -1.208688e-02 3 1  ON 60
ci_0012                -1.202296e-02 3 1  ON 61
ci_0013                 1.345272e-02 3 1  ON 62
ci_0014                 1.348238e-02 3 1  ON 63
ci_0015                 1.336427e-02 3 1  ON 64
ci_0016                 1.336459e-02 3 1  ON 65
ci_0017                 1.137367e-02 3 1  ON 66
ci_0018                 1.122576e-02 3 1  ON 67
ci_0019                 1.132481e-02 3 1  ON 68
ci_0020                 1.095402e-02 3 1  ON 69
ci_0021                -1.528333e-03 3 1  ON 70
ci_0022                -7.422840e-06 3 1  ON 71
ci_0023                -1.163779e-02 3 1  ON 72
ci_0024                -1.133365e-02 3 1  ON 73
ci_0025                -1.018122e-02 3 1  ON 74
ci_0026                -1.023845e-02 3 1  ON 75
ci_0027                -1.146653e-02 3 1  ON 76
ci_0028                -1.139392e-02 3 1  ON 77
ci_0029                -9.876483e-03 3 1  ON 78
ci_0030                -1.110247e-02 3 1  ON 79
ci_0031                 2.069686e-02 3 1  ON 80
ci_0032                 2.035421e-02 3 1  ON 81
ci_0033                 1.031637e-02 3 1  ON 82
ci_0034                 1.023197e-02 3 1  ON 83
ci_0035                 6.749500e-03 3 1  ON 84
ci_0036                 6.813875e-03 3 1  ON 85
ci_0037                -1.024639e-02 3 1  ON 86
ci_0038                -1.033122e-02 3 1  ON 87
ci_0039                -2.211726e-03 3 1  ON 88
ci_0040                -2.664505e-03 3 1  ON 89
ci_0041                 7.303855e-03 3 1  ON 90
ci_0042                 7.019389e-03 3 1  ON 91
ci_0043                -1.958776e-02 3 1  ON 92
ci_0044                -1.924275e-02 3 1  ON 93
ci_0045                 7.790610e-03 3 1  ON 94
ci_0046                 7.422589e-03 3 1  ON 95
ci_0047                -1.674028e-03 3 1  ON 96
ci_0048                -1.817586e-03 3 1  ON 97
ci_0049                -5.306377e-03 3 1  ON 98
ci_0050                -5.422012e-03 3 1  ON 99
ci_0051                -3.394429e-03 3 1  ON 100
ci_0052                -3.399550e-03 3 1  ON 101
ci_0053                -4.757499e-03 3 1  ON 102
ci_0054                -4.209714e-03 3 1  ON 103
ci_0055                 6.203565e-03 3 1  ON 104
ci_0056                 6.262346e-03 3 1  ON 105
ci_0057                 5.026250e-03 3 1  ON 106
ci_0058                 5.159506e-03 3 1  ON 107
ci_0059                -4.637425e-03 3 1  ON 108
ci_0060                -4.636192e-03 3 1  ON 109
ci_0061                -3.281507e-03 3 1  ON 110
ci_0062                -3.525984e-03 3 1  ON 111
ci_0063                -9.379948e-03 3 1  ON 112
ci_0064                -8.968979e-03 3 1  ON 113
ci_0065                -4.994213e-03 3 1  ON 114
ci_0066                -5.018958e-03 3 1  ON 115
ci_0067                -5.141667e-03 3 1  ON 116
ci_0068                -5.118347e-03 3 1  ON 117
ci_0069                 4.450173e-03 3 1  ON 118
ci_0070                 4.460087e-03 3 1  ON 119
ci_0071                -1.544562e-05 3 1  ON 120
ci_0072                 2.103863e-04 3 1  ON 121
ci_0073                 3.980713e-03 3 1  ON 122
ci_0074                 4.131812e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8811
    reference variance = 0.157886
====================================================
  Execution time = 2.1577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3551e-01
  Total weights = 1.951783781e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322391886364
                                         uncertainty =       0.003547444602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322391886364
                                         uncertainty =       0.003547444602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401512851
  error estimate for blocks of size 2^( 2) =       0.000414552201
  error estimate for blocks of size 2^( 3) =       0.000427897443
  error estimate for blocks of size 2^( 4) =       0.000440711474
  error estimate for blocks of size 2^( 5) =       0.000452368991
  error estimate for blocks of size 2^( 6) =       0.000461553047
  error estimate for blocks of size 2^( 7) =       0.000465835898

      target function =                  N/A
              le_mean =     -16.906194440928
             les_mean =     286.154923716078
             stat err =       0.000455117352
             autocorr =       1.284836565796
              std dev =       0.567824919834
             le_variance =       0.322425139584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619444093e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194440933       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906192757612       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906184919525       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906190147461       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906190301989       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906190854610       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906190791953       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191832197       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191075587       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906192412785       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906191990905       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906191751950       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906191808307       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906191743679       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906191929978       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-02 is 2.439400e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194440933       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193591020       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189677476       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906191153636       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906191140583       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906191398652       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906191416674       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906191413875       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906191499139       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906191491272       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906191533152       residual = 8.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 1.011324e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194440933       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194155765       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906192820450       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193049055       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906193196973       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906193238634       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906193230673       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906193154312       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906193184749       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906193183886       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 3.051182e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7626e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.128326e-01 1 1  ON 0
   uu_1                 1.451913e-01 1 1  ON 1
   uu_2                 4.345817e-02 1 1  ON 2
   uu_3                -1.922618e-02 1 1  ON 3
   uu_4                -6.536480e-02 1 1  ON 4
   uu_5                -1.006930e-01 1 1  ON 5
   uu_6                -1.285185e-01 1 1  ON 6
   uu_7                -1.422960e-01 1 1  ON 7
   uu_8                -1.352631e-01 1 1  ON 8
   uu_9                -1.037474e-01 1 1  ON 9
   ud_0                 4.471610e-01 1 1  ON 10
   ud_1                 1.815350e-01 1 1  ON 11
   ud_2                 6.138157e-02 1 1  ON 12
   ud_3                -9.403606e-03 1 1  ON 13
   ud_4                -6.632456e-02 1 1  ON 14
   ud_5                -1.077317e-01 1 1  ON 15
   ud_6                -1.348129e-01 1 1  ON 16
   ud_7                -1.513977e-01 1 1  ON 17
   ud_8                -1.521345e-01 1 1  ON 18
   ud_9                -1.409299e-01 1 1  ON 19
   eO_0                -7.504549e-01 1 1  ON 20
   eO_1                -4.301275e-01 1 1  ON 21
   eO_2                -2.013275e-02 1 1  ON 22
   eO_3                 2.916979e-01 1 1  ON 23
   eO_4                 5.164579e-01 1 1  ON 24
   eO_5                 4.788364e-01 1 1  ON 25
   eO_6                 2.524677e-01 1 1  ON 26
   eO_7                -4.518446e-02 1 1  ON 27
   eO_8                -2.166113e-01 1 1  ON 28
   eO_9                -7.730876e-02 1 1  ON 29
  eH1_0                -2.538751e-01 1 1  ON 30
  eH1_1                -1.464936e-01 1 1  ON 31
  eH1_2                -9.701733e-02 1 1  ON 32
  eH1_3                -4.194627e-02 1 1  ON 33
  eH1_4                 7.441973e-03 1 1  ON 34
  eH1_5                 4.251266e-02 1 1  ON 35
  eH1_6                 1.017287e-01 1 1  ON 36
  eH1_7                 1.554967e-01 1 1  ON 37
  eH1_8                 1.743746e-01 1 1  ON 38
  eH1_9                 6.074474e-02 1 1  ON 39
  eH2_0                -2.513612e-01 1 1  ON 40
  eH2_1                -1.437478e-01 1 1  ON 41
  eH2_2                -9.429148e-02 1 1  ON 42
  eH2_3                -3.924397e-02 1 1  ON 43
  eH2_4                 1.067414e-02 1 1  ON 44
  eH2_5                 4.592927e-02 1 1  ON 45
  eH2_6                 1.040881e-01 1 1  ON 46
  eH2_7                 1.561992e-01 1 1  ON 47
  eH2_8                 1.791965e-01 1 1  ON 48
  eH2_9                 4.849489e-02 1 1  ON 49
ci_0001                 7.008270e-01 3 1  ON 50
ci_0002                 7.010111e-01 3 1  ON 51
ci_0003                -2.660372e-02 3 1  ON 52
ci_0004                -2.794626e-02 3 1  ON 53
ci_0005                -3.598562e-02 3 1  ON 54
ci_0006                -3.658982e-02 3 1  ON 55
ci_0007                -2.116656e-02 3 1  ON 56
ci_0008                -2.195229e-02 3 1  ON 57
ci_0009                -1.756231e-02 3 1  ON 58
ci_0010                -1.715245e-02 3 1  ON 59
ci_0011                -1.237583e-02 3 1  ON 60
ci_0012                -1.198819e-02 3 1  ON 61
ci_0013                 1.331526e-02 3 1  ON 62
ci_0014                 1.314751e-02 3 1  ON 63
ci_0015                 1.278506e-02 3 1  ON 64
ci_0016                 1.325266e-02 3 1  ON 65
ci_0017                 1.107648e-02 3 1  ON 66
ci_0018                 1.122377e-02 3 1  ON 67
ci_0019                 1.119641e-02 3 1  ON 68
ci_0020                 1.134391e-02 3 1  ON 69
ci_0021                -1.123705e-03 3 1  ON 70
ci_0022                -1.253537e-04 3 1  ON 71
ci_0023                -1.171436e-02 3 1  ON 72
ci_0024                -1.069273e-02 3 1  ON 73
ci_0025                -1.009426e-02 3 1  ON 74
ci_0026                -1.059215e-02 3 1  ON 75
ci_0027                -1.145370e-02 3 1  ON 76
ci_0028                -1.145997e-02 3 1  ON 77
ci_0029                -1.027686e-02 3 1  ON 78
ci_0030                -1.066760e-02 3 1  ON 79
ci_0031                 2.079024e-02 3 1  ON 80
ci_0032                 2.072038e-02 3 1  ON 81
ci_0033                 9.305048e-03 3 1  ON 82
ci_0034                 1.037773e-02 3 1  ON 83
ci_0035                 6.731196e-03 3 1  ON 84
ci_0036                 6.799457e-03 3 1  ON 85
ci_0037                -1.049875e-02 3 1  ON 86
ci_0038                -1.044914e-02 3 1  ON 87
ci_0039                -2.444742e-03 3 1  ON 88
ci_0040                -2.663466e-03 3 1  ON 89
ci_0041                 6.871261e-03 3 1  ON 90
ci_0042                 6.914762e-03 3 1  ON 91
ci_0043                -1.893056e-02 3 1  ON 92
ci_0044                -1.878772e-02 3 1  ON 93
ci_0045                 7.330727e-03 3 1  ON 94
ci_0046                 7.748403e-03 3 1  ON 95
ci_0047                -1.675279e-03 3 1  ON 96
ci_0048                -1.702110e-03 3 1  ON 97
ci_0049                -5.062374e-03 3 1  ON 98
ci_0050                -5.231943e-03 3 1  ON 99
ci_0051                -3.512002e-03 3 1  ON 100
ci_0052                -3.413761e-03 3 1  ON 101
ci_0053                -4.791232e-03 3 1  ON 102
ci_0054                -4.370970e-03 3 1  ON 103
ci_0055                 6.874494e-03 3 1  ON 104
ci_0056                 6.691463e-03 3 1  ON 105
ci_0057                 4.728284e-03 3 1  ON 106
ci_0058                 5.035465e-03 3 1  ON 107
ci_0059                -4.376845e-03 3 1  ON 108
ci_0060                -4.716605e-03 3 1  ON 109
ci_0061                -2.612982e-03 3 1  ON 110
ci_0062                -3.467711e-03 3 1  ON 111
ci_0063                -1.013040e-02 3 1  ON 112
ci_0064                -8.717520e-03 3 1  ON 113
ci_0065                -5.134232e-03 3 1  ON 114
ci_0066                -5.213427e-03 3 1  ON 115
ci_0067                -4.961038e-03 3 1  ON 116
ci_0068                -5.191371e-03 3 1  ON 117
ci_0069                 4.997284e-03 3 1  ON 118
ci_0070                 4.266727e-03 3 1  ON 119
ci_0071                 6.376448e-05 3 1  ON 120
ci_0072                 2.274440e-04 3 1  ON 121
ci_0073                 4.020308e-03 3 1  ON 122
ci_0074                 4.130864e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8498
    reference variance = 0.285398
====================================================
  Execution time = 2.1306e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3609e-01
  Total weights = 1.9518e+06
  Execution time = 1.8972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323543618719
                                         uncertainty =       0.003124143570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323543618719
                                         uncertainty =       0.003124143570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402197131
  error estimate for blocks of size 2^( 2) =       0.000414763532
  error estimate for blocks of size 2^( 3) =       0.000428222424
  error estimate for blocks of size 2^( 4) =       0.000440989692
  error estimate for blocks of size 2^( 5) =       0.000451908481
  error estimate for blocks of size 2^( 6) =       0.000460614954
  error estimate for blocks of size 2^( 7) =       0.000465214434

      target function =                  N/A
              le_mean =     -16.905512815755
             les_mean =     286.139582752270
             stat err =       0.000454681890
             autocorr =       1.278019192919
              std dev =       0.568792637888
             le_variance =       0.323525064916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323829900154
                                         uncertainty =       0.003248004521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323829900154
                                         uncertainty =       0.003248004521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402376378
  error estimate for blocks of size 2^( 2) =       0.000414969139
  error estimate for blocks of size 2^( 3) =       0.000428426671
  error estimate for blocks of size 2^( 4) =       0.000441218715
  error estimate for blocks of size 2^( 5) =       0.000452131138
  error estimate for blocks of size 2^( 6) =       0.000460871720
  error estimate for blocks of size 2^( 7) =       0.000465340704

      target function =                  N/A
              le_mean =     -16.905529997487
             les_mean =     286.148418517129
             stat err =       0.000454890569
             autocorr =       1.278053145155
              std dev =       0.569046130395
             le_variance =       0.323813498517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681045451
                                         uncertainty =       0.003238849579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681045451
                                         uncertainty =       0.003238849579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402283496
  error estimate for blocks of size 2^( 2) =       0.000414880260
  error estimate for blocks of size 2^( 3) =       0.000428347518
  error estimate for blocks of size 2^( 4) =       0.000441144683
  error estimate for blocks of size 2^( 5) =       0.000452073805
  error estimate for blocks of size 2^( 6) =       0.000460811839
  error estimate for blocks of size 2^( 7) =       0.000465280777

      target function =                  N/A
              le_mean =     -16.905514296485
             les_mean =     286.165082996547
             stat err =       0.000454827776
             autocorr =       1.278290396752
              std dev =       0.568914776240
             le_variance =       0.323664022625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323470161750
                                         uncertainty =       0.003135718916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323470161750
                                         uncertainty =       0.003135718916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151644
  error estimate for blocks of size 2^( 2) =       0.000414722463
  error estimate for blocks of size 2^( 3) =       0.000428180462
  error estimate for blocks of size 2^( 4) =       0.000440943746
  error estimate for blocks of size 2^( 5) =       0.000451874383
  error estimate for blocks of size 2^( 6) =       0.000460597799
  error estimate for blocks of size 2^( 7) =       0.000465196993

      target function =                  N/A
              le_mean =     -16.905515420181
             les_mean =     286.144320487815
             stat err =       0.000454653230
             autocorr =       1.278147180557
              std dev =       0.568728308400
             le_variance =       0.323451888775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905512815755        initial
     9.7656e-02     9.7656e-01             2.4394e-03       -16.905529997487  <--
     3.9062e-01     3.9062e+00             1.0113e-03       -16.905514296485
     1.5625e+00     1.5625e+01             3.0512e-04       -16.905515420181

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.0896e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.124220e-01 1 1  ON 0
   uu_1                 1.449054e-01 1 1  ON 1
   uu_2                 4.323131e-02 1 1  ON 2
   uu_3                -1.943745e-02 1 1  ON 3
   uu_4                -6.559107e-02 1 1  ON 4
   uu_5                -1.007691e-01 1 1  ON 5
   uu_6                -1.285498e-01 1 1  ON 6
   uu_7                -1.424897e-01 1 1  ON 7
   uu_8                -1.352712e-01 1 1  ON 8
   uu_9                -1.039783e-01 1 1  ON 9
   ud_0                 4.472357e-01 1 1  ON 10
   ud_1                 1.817548e-01 1 1  ON 11
   ud_2                 6.160689e-02 1 1  ON 12
   ud_3                -9.196553e-03 1 1  ON 13
   ud_4                -6.620737e-02 1 1  ON 14
   ud_5                -1.078501e-01 1 1  ON 15
   ud_6                -1.350698e-01 1 1  ON 16
   ud_7                -1.516396e-01 1 1  ON 17
   ud_8                -1.526279e-01 1 1  ON 18
   ud_9                -1.407861e-01 1 1  ON 19
   eO_0                -7.512891e-01 1 1  ON 20
   eO_1                -4.307862e-01 1 1  ON 21
   eO_2                -2.036310e-02 1 1  ON 22
   eO_3                 2.922902e-01 1 1  ON 23
   eO_4                 5.174830e-01 1 1  ON 24
   eO_5                 4.795840e-01 1 1  ON 25
   eO_6                 2.530033e-01 1 1  ON 26
   eO_7                -4.496050e-02 1 1  ON 27
   eO_8                -2.169614e-01 1 1  ON 28
   eO_9                -7.817441e-02 1 1  ON 29
  eH1_0                -2.542994e-01 1 1  ON 30
  eH1_1                -1.470085e-01 1 1  ON 31
  eH1_2                -9.758591e-02 1 1  ON 32
  eH1_3                -4.263615e-02 1 1  ON 33
  eH1_4                 6.734133e-03 1 1  ON 34
  eH1_5                 4.193120e-02 1 1  ON 35
  eH1_6                 1.018534e-01 1 1  ON 36
  eH1_7                 1.559977e-01 1 1  ON 37
  eH1_8                 1.754637e-01 1 1  ON 38
  eH1_9                 6.224487e-02 1 1  ON 39
  eH2_0                -2.515859e-01 1 1  ON 40
  eH2_1                -1.444421e-01 1 1  ON 41
  eH2_2                -9.501828e-02 1 1  ON 42
  eH2_3                -3.992749e-02 1 1  ON 43
  eH2_4                 1.011960e-02 1 1  ON 44
  eH2_5                 4.513340e-02 1 1  ON 45
  eH2_6                 1.037380e-01 1 1  ON 46
  eH2_7                 1.568001e-01 1 1  ON 47
  eH2_8                 1.805241e-01 1 1  ON 48
  eH2_9                 5.030988e-02 1 1  ON 49
ci_0001                 7.003426e-01 3 1  ON 50
ci_0002                 7.015076e-01 3 1  ON 51
ci_0003                -2.668325e-02 3 1  ON 52
ci_0004                -2.837183e-02 3 1  ON 53
ci_0005                -3.588395e-02 3 1  ON 54
ci_0006                -3.673208e-02 3 1  ON 55
ci_0007                -2.183512e-02 3 1  ON 56
ci_0008                -2.220820e-02 3 1  ON 57
ci_0009                -1.762375e-02 3 1  ON 58
ci_0010                -1.715894e-02 3 1  ON 59
ci_0011                -1.266430e-02 3 1  ON 60
ci_0012                -1.196923e-02 3 1  ON 61
ci_0013                 1.315495e-02 3 1  ON 62
ci_0014                 1.285259e-02 3 1  ON 63
ci_0015                 1.221547e-02 3 1  ON 64
ci_0016                 1.315545e-02 3 1  ON 65
ci_0017                 1.079360e-02 3 1  ON 66
ci_0018                 1.125242e-02 3 1  ON 67
ci_0019                 1.110134e-02 3 1  ON 68
ci_0020                 1.174180e-02 3 1  ON 69
ci_0021                -4.624946e-04 3 1  ON 70
ci_0022                -3.392699e-04 3 1  ON 71
ci_0023                -1.178504e-02 3 1  ON 72
ci_0024                -1.013288e-02 3 1  ON 73
ci_0025                -1.001772e-02 3 1  ON 74
ci_0026                -1.095516e-02 3 1  ON 75
ci_0027                -1.145259e-02 3 1  ON 76
ci_0028                -1.153688e-02 3 1  ON 77
ci_0029                -1.070050e-02 3 1  ON 78
ci_0030                -1.024378e-02 3 1  ON 79
ci_0031                 2.090070e-02 3 1  ON 80
ci_0032                 2.123553e-02 3 1  ON 81
ci_0033                 7.876972e-03 3 1  ON 82
ci_0034                 1.061361e-02 3 1  ON 83
ci_0035                 6.733642e-03 3 1  ON 84
ci_0036                 6.773140e-03 3 1  ON 85
ci_0037                -1.072451e-02 3 1  ON 86
ci_0038                -1.059561e-02 3 1  ON 87
ci_0039                -2.594563e-03 3 1  ON 88
ci_0040                -2.667432e-03 3 1  ON 89
ci_0041                 6.462825e-03 3 1  ON 90
ci_0042                 6.804336e-03 3 1  ON 91
ci_0043                -1.785963e-02 3 1  ON 92
ci_0044                -1.799752e-02 3 1  ON 93
ci_0045                 6.755517e-03 3 1  ON 94
ci_0046                 8.135441e-03 3 1  ON 95
ci_0047                -1.674508e-03 3 1  ON 96
ci_0048                -1.619433e-03 3 1  ON 97
ci_0049                -4.822841e-03 3 1  ON 98
ci_0050                -5.039060e-03 3 1  ON 99
ci_0051                -3.593265e-03 3 1  ON 100
ci_0052                -3.422413e-03 3 1  ON 101
ci_0053                -4.820581e-03 3 1  ON 102
ci_0054                -4.488831e-03 3 1  ON 103
ci_0055                 7.663791e-03 3 1  ON 104
ci_0056                 7.196186e-03 3 1  ON 105
ci_0057                 4.412951e-03 3 1  ON 106
ci_0058                 4.920675e-03 3 1  ON 107
ci_0059                -4.163307e-03 3 1  ON 108
ci_0060                -4.773400e-03 3 1  ON 109
ci_0061                -1.941567e-03 3 1  ON 110
ci_0062                -3.399169e-03 3 1  ON 111
ci_0063                -1.071839e-02 3 1  ON 112
ci_0064                -8.521128e-03 3 1  ON 113
ci_0065                -5.250344e-03 3 1  ON 114
ci_0066                -5.379964e-03 3 1  ON 115
ci_0067                -4.835177e-03 3 1  ON 116
ci_0068                -5.252698e-03 3 1  ON 117
ci_0069                 5.369985e-03 3 1  ON 118
ci_0070                 4.138453e-03 3 1  ON 119
ci_0071                 1.882808e-04 3 1  ON 120
ci_0072                 2.743883e-04 3 1  ON 121
ci_0073                 4.046995e-03 3 1  ON 122
ci_0074                 4.133016e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9162
    reference variance = 0.276054
====================================================
  Execution time = 2.1319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2840e-01
  Total weights = 1.951788270e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1677e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316858747713
                                         uncertainty =       0.001932175403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316858747713
                                         uncertainty =       0.001932175403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398176714
  error estimate for blocks of size 2^( 2) =       0.000410996393
  error estimate for blocks of size 2^( 3) =       0.000424429819
  error estimate for blocks of size 2^( 4) =       0.000436422644
  error estimate for blocks of size 2^( 5) =       0.000448621568
  error estimate for blocks of size 2^( 6) =       0.000456834074
  error estimate for blocks of size 2^( 7) =       0.000461601961

      target function =                  N/A
              le_mean =     -16.905550757385
             les_mean =     286.126051031640
             stat err =       0.000450870062
             autocorr =       1.282186151452
              std dev =       0.563106908477
             le_variance =       0.317089390375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555075739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550757411       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905606276419       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905614139840       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905616108719       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905614094763       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905617965408       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905615106631       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905616778723       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905616781649       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905620624729       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905624724897       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905624102965       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905625399675       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905625349341       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905625026854       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905626502222       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905624718544       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905624919263       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905624639159       residual = 6.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905625135296       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905624904978       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905625104807       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905625386664       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905625417136       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905625136738       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-02 is 7.945861e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550757411       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905594185222       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905598980122       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905600272075       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905598257870       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905600074867       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905597665729       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905598947760       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598842400       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905600433196       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905600599732       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905601021944       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905600997598       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905601079759       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905600909537       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-02 is 1.902146e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905550757411       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905573966606       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905575777522       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905576328128       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905575103905       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905575260878       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905574431132       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905574999384       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905575058241       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905575187720       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905575349780       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 1.037813e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7503e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.128254e-01 1 1  ON 0
   uu_1                 1.450303e-01 1 1  ON 1
   uu_2                 4.297578e-02 1 1  ON 2
   uu_3                -1.977567e-02 1 1  ON 3
   uu_4                -6.551265e-02 1 1  ON 4
   uu_5                -1.009107e-01 1 1  ON 5
   uu_6                -1.289971e-01 1 1  ON 6
   uu_7                -1.425054e-01 1 1  ON 7
   uu_8                -1.351310e-01 1 1  ON 8
   uu_9                -1.048675e-01 1 1  ON 9
   ud_0                 4.481484e-01 1 1  ON 10
   ud_1                 1.824802e-01 1 1  ON 11
   ud_2                 6.210926e-02 1 1  ON 12
   ud_3                -9.024250e-03 1 1  ON 13
   ud_4                -6.603901e-02 1 1  ON 14
   ud_5                -1.079274e-01 1 1  ON 15
   ud_6                -1.353292e-01 1 1  ON 16
   ud_7                -1.517847e-01 1 1  ON 17
   ud_8                -1.533320e-01 1 1  ON 18
   ud_9                -1.414820e-01 1 1  ON 19
   eO_0                -7.516765e-01 1 1  ON 20
   eO_1                -4.310483e-01 1 1  ON 21
   eO_2                -2.046900e-02 1 1  ON 22
   eO_3                 2.920437e-01 1 1  ON 23
   eO_4                 5.183965e-01 1 1  ON 24
   eO_5                 4.807911e-01 1 1  ON 25
   eO_6                 2.542501e-01 1 1  ON 26
   eO_7                -4.409169e-02 1 1  ON 27
   eO_8                -2.184611e-01 1 1  ON 28
   eO_9                -7.966548e-02 1 1  ON 29
  eH1_0                -2.550769e-01 1 1  ON 30
  eH1_1                -1.476995e-01 1 1  ON 31
  eH1_2                -9.814084e-02 1 1  ON 32
  eH1_3                -4.284131e-02 1 1  ON 33
  eH1_4                 6.563097e-03 1 1  ON 34
  eH1_5                 4.180845e-02 1 1  ON 35
  eH1_6                 1.010212e-01 1 1  ON 36
  eH1_7                 1.559255e-01 1 1  ON 37
  eH1_8                 1.768526e-01 1 1  ON 38
  eH1_9                 6.409663e-02 1 1  ON 39
  eH2_0                -2.530347e-01 1 1  ON 40
  eH2_1                -1.454926e-01 1 1  ON 41
  eH2_2                -9.608796e-02 1 1  ON 42
  eH2_3                -4.068216e-02 1 1  ON 43
  eH2_4                 9.367462e-03 1 1  ON 44
  eH2_5                 4.529255e-02 1 1  ON 45
  eH2_6                 1.041588e-01 1 1  ON 46
  eH2_7                 1.578363e-01 1 1  ON 47
  eH2_8                 1.819185e-01 1 1  ON 48
  eH2_9                 5.221202e-02 1 1  ON 49
ci_0001                 7.008414e-01 3 1  ON 50
ci_0002                 7.010680e-01 3 1  ON 51
ci_0003                -2.662717e-02 3 1  ON 52
ci_0004                -2.764920e-02 3 1  ON 53
ci_0005                -3.628094e-02 3 1  ON 54
ci_0006                -3.612862e-02 3 1  ON 55
ci_0007                -2.229985e-02 3 1  ON 56
ci_0008                -2.206800e-02 3 1  ON 57
ci_0009                -1.736778e-02 3 1  ON 58
ci_0010                -1.720779e-02 3 1  ON 59
ci_0011                -1.160475e-02 3 1  ON 60
ci_0012                -1.224583e-02 3 1  ON 61
ci_0013                 1.286839e-02 3 1  ON 62
ci_0014                 1.267354e-02 3 1  ON 63
ci_0015                 1.320790e-02 3 1  ON 64
ci_0016                 1.329033e-02 3 1  ON 65
ci_0017                 1.158107e-02 3 1  ON 66
ci_0018                 1.123643e-02 3 1  ON 67
ci_0019                 1.094475e-02 3 1  ON 68
ci_0020                 1.109496e-02 3 1  ON 69
ci_0021                -1.702501e-03 3 1  ON 70
ci_0022                -2.989756e-04 3 1  ON 71
ci_0023                -1.091245e-02 3 1  ON 72
ci_0024                -1.087542e-02 3 1  ON 73
ci_0025                -9.719536e-03 3 1  ON 74
ci_0026                -1.061667e-02 3 1  ON 75
ci_0027                -1.104459e-02 3 1  ON 76
ci_0028                -1.139144e-02 3 1  ON 77
ci_0029                -1.047064e-02 3 1  ON 78
ci_0030                -1.023127e-02 3 1  ON 79
ci_0031                 2.121873e-02 3 1  ON 80
ci_0032                 2.027486e-02 3 1  ON 81
ci_0033                 8.740799e-03 3 1  ON 82
ci_0034                 1.006292e-02 3 1  ON 83
ci_0035                 6.803388e-03 3 1  ON 84
ci_0036                 7.233174e-03 3 1  ON 85
ci_0037                -9.895005e-03 3 1  ON 86
ci_0038                -1.027920e-02 3 1  ON 87
ci_0039                -2.599492e-03 3 1  ON 88
ci_0040                -2.217141e-03 3 1  ON 89
ci_0041                 7.260427e-03 3 1  ON 90
ci_0042                 7.311572e-03 3 1  ON 91
ci_0043                -1.835154e-02 3 1  ON 92
ci_0044                -1.880137e-02 3 1  ON 93
ci_0045                 7.288066e-03 3 1  ON 94
ci_0046                 7.485684e-03 3 1  ON 95
ci_0047                -1.892623e-03 3 1  ON 96
ci_0048                -1.591749e-03 3 1  ON 97
ci_0049                -4.861827e-03 3 1  ON 98
ci_0050                -6.249669e-03 3 1  ON 99
ci_0051                -3.692518e-03 3 1  ON 100
ci_0052                -2.892011e-03 3 1  ON 101
ci_0053                -4.951262e-03 3 1  ON 102
ci_0054                -4.779624e-03 3 1  ON 103
ci_0055                 7.536243e-03 3 1  ON 104
ci_0056                 6.880848e-03 3 1  ON 105
ci_0057                 4.804597e-03 3 1  ON 106
ci_0058                 4.563179e-03 3 1  ON 107
ci_0059                -4.453756e-03 3 1  ON 108
ci_0060                -4.737558e-03 3 1  ON 109
ci_0061                -2.561508e-03 3 1  ON 110
ci_0062                -3.620610e-03 3 1  ON 111
ci_0063                -8.876732e-03 3 1  ON 112
ci_0064                -9.588821e-03 3 1  ON 113
ci_0065                -5.381295e-03 3 1  ON 114
ci_0066                -5.777674e-03 3 1  ON 115
ci_0067                -4.751701e-03 3 1  ON 116
ci_0068                -5.255848e-03 3 1  ON 117
ci_0069                 4.693872e-03 3 1  ON 118
ci_0070                 4.561109e-03 3 1  ON 119
ci_0071                 2.515438e-04 3 1  ON 120
ci_0072                -2.349115e-05 3 1  ON 121
ci_0073                 4.381516e-03 3 1  ON 122
ci_0074                 4.430766e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8817
    reference variance = 0.235582
====================================================
  Execution time = 2.1167e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4561e-01
  Total weights = 1.9516e+06
  Execution time = 1.8951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329733797925
                                         uncertainty =       0.003816783483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329733797925
                                         uncertainty =       0.003816783483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406011802
  error estimate for blocks of size 2^( 2) =       0.000418311382
  error estimate for blocks of size 2^( 3) =       0.000431774938
  error estimate for blocks of size 2^( 4) =       0.000443746780
  error estimate for blocks of size 2^( 5) =       0.000454241869
  error estimate for blocks of size 2^( 6) =       0.000461380161
  error estimate for blocks of size 2^( 7) =       0.000465634008

      target function =                  N/A
              le_mean =     -16.906393564215
             les_mean =     286.182888405145
             stat err =       0.000456250704
             autocorr =       1.262786065557
              std dev =       0.574187396402
             le_variance =       0.329691166187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330391694559
                                         uncertainty =       0.004056058342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330391694559
                                         uncertainty =       0.004056058342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406415087
  error estimate for blocks of size 2^( 2) =       0.000418677969
  error estimate for blocks of size 2^( 3) =       0.000432103060
  error estimate for blocks of size 2^( 4) =       0.000444018903
  error estimate for blocks of size 2^( 5) =       0.000454541458
  error estimate for blocks of size 2^( 6) =       0.000461607677
  error estimate for blocks of size 2^( 7) =       0.000465796288

      target function =                  N/A
              le_mean =     -16.906340473811
             les_mean =     286.173636847942
             stat err =       0.000456491082
             autocorr =       1.261609505206
              std dev =       0.574757727632
             le_variance =       0.330346445473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331543560480
                                         uncertainty =       0.004098379891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331543560480
                                         uncertainty =       0.004098379891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407121610
  error estimate for blocks of size 2^( 2) =       0.000419356682
  error estimate for blocks of size 2^( 3) =       0.000432749529
  error estimate for blocks of size 2^( 4) =       0.000444651375
  error estimate for blocks of size 2^( 5) =       0.000455180290
  error estimate for blocks of size 2^( 6) =       0.000462170235
  error estimate for blocks of size 2^( 7) =       0.000466205450

      target function =                  N/A
              le_mean =     -16.906385164965
             les_mean =     286.277631107479
             stat err =       0.000457051837
             autocorr =       1.260325166566
              std dev =       0.575756902011
             le_variance =       0.331496010213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329589398713
                                         uncertainty =       0.003831613557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329589398713
                                         uncertainty =       0.003831613557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405922772
  error estimate for blocks of size 2^( 2) =       0.000418208802
  error estimate for blocks of size 2^( 3) =       0.000431667030
  error estimate for blocks of size 2^( 4) =       0.000443615688
  error estimate for blocks of size 2^( 5) =       0.000454147289
  error estimate for blocks of size 2^( 6) =       0.000461272786
  error estimate for blocks of size 2^( 7) =       0.000465510421

      target function =                  N/A
              le_mean =     -16.906345852246
             les_mean =     286.175457787081
             stat err =       0.000456136546
             autocorr =       1.262707931560
              std dev =       0.574061489176
             le_variance =       0.329546593354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906393564215        initial  <--
     2.4414e-02     2.4414e-01             7.9459e-03       -16.906340473811
     9.7656e-02     9.7656e-01             1.9021e-03       -16.906385164965
     3.9062e-01     3.9062e+00             1.0378e-03       -16.906345852246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7052
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.124220e-01 1 1  ON 0
   uu_1                 1.449054e-01 1 1  ON 1
   uu_2                 4.323131e-02 1 1  ON 2
   uu_3                -1.943745e-02 1 1  ON 3
   uu_4                -6.559107e-02 1 1  ON 4
   uu_5                -1.007691e-01 1 1  ON 5
   uu_6                -1.285498e-01 1 1  ON 6
   uu_7                -1.424897e-01 1 1  ON 7
   uu_8                -1.352712e-01 1 1  ON 8
   uu_9                -1.039783e-01 1 1  ON 9
   ud_0                 4.472357e-01 1 1  ON 10
   ud_1                 1.817548e-01 1 1  ON 11
   ud_2                 6.160689e-02 1 1  ON 12
   ud_3                -9.196553e-03 1 1  ON 13
   ud_4                -6.620737e-02 1 1  ON 14
   ud_5                -1.078501e-01 1 1  ON 15
   ud_6                -1.350698e-01 1 1  ON 16
   ud_7                -1.516396e-01 1 1  ON 17
   ud_8                -1.526279e-01 1 1  ON 18
   ud_9                -1.407861e-01 1 1  ON 19
   eO_0                -7.512891e-01 1 1  ON 20
   eO_1                -4.307862e-01 1 1  ON 21
   eO_2                -2.036310e-02 1 1  ON 22
   eO_3                 2.922902e-01 1 1  ON 23
   eO_4                 5.174830e-01 1 1  ON 24
   eO_5                 4.795840e-01 1 1  ON 25
   eO_6                 2.530033e-01 1 1  ON 26
   eO_7                -4.496050e-02 1 1  ON 27
   eO_8                -2.169614e-01 1 1  ON 28
   eO_9                -7.817441e-02 1 1  ON 29
  eH1_0                -2.542994e-01 1 1  ON 30
  eH1_1                -1.470085e-01 1 1  ON 31
  eH1_2                -9.758591e-02 1 1  ON 32
  eH1_3                -4.263615e-02 1 1  ON 33
  eH1_4                 6.734133e-03 1 1  ON 34
  eH1_5                 4.193120e-02 1 1  ON 35
  eH1_6                 1.018534e-01 1 1  ON 36
  eH1_7                 1.559977e-01 1 1  ON 37
  eH1_8                 1.754637e-01 1 1  ON 38
  eH1_9                 6.224487e-02 1 1  ON 39
  eH2_0                -2.515859e-01 1 1  ON 40
  eH2_1                -1.444421e-01 1 1  ON 41
  eH2_2                -9.501828e-02 1 1  ON 42
  eH2_3                -3.992749e-02 1 1  ON 43
  eH2_4                 1.011960e-02 1 1  ON 44
  eH2_5                 4.513340e-02 1 1  ON 45
  eH2_6                 1.037380e-01 1 1  ON 46
  eH2_7                 1.568001e-01 1 1  ON 47
  eH2_8                 1.805241e-01 1 1  ON 48
  eH2_9                 5.030988e-02 1 1  ON 49
ci_0001                 7.003426e-01 3 1  ON 50
ci_0002                 7.015076e-01 3 1  ON 51
ci_0003                -2.668325e-02 3 1  ON 52
ci_0004                -2.837183e-02 3 1  ON 53
ci_0005                -3.588395e-02 3 1  ON 54
ci_0006                -3.673208e-02 3 1  ON 55
ci_0007                -2.183512e-02 3 1  ON 56
ci_0008                -2.220820e-02 3 1  ON 57
ci_0009                -1.762375e-02 3 1  ON 58
ci_0010                -1.715894e-02 3 1  ON 59
ci_0011                -1.266430e-02 3 1  ON 60
ci_0012                -1.196923e-02 3 1  ON 61
ci_0013                 1.315495e-02 3 1  ON 62
ci_0014                 1.285259e-02 3 1  ON 63
ci_0015                 1.221547e-02 3 1  ON 64
ci_0016                 1.315545e-02 3 1  ON 65
ci_0017                 1.079360e-02 3 1  ON 66
ci_0018                 1.125242e-02 3 1  ON 67
ci_0019                 1.110134e-02 3 1  ON 68
ci_0020                 1.174180e-02 3 1  ON 69
ci_0021                -4.624946e-04 3 1  ON 70
ci_0022                -3.392699e-04 3 1  ON 71
ci_0023                -1.178504e-02 3 1  ON 72
ci_0024                -1.013288e-02 3 1  ON 73
ci_0025                -1.001772e-02 3 1  ON 74
ci_0026                -1.095516e-02 3 1  ON 75
ci_0027                -1.145259e-02 3 1  ON 76
ci_0028                -1.153688e-02 3 1  ON 77
ci_0029                -1.070050e-02 3 1  ON 78
ci_0030                -1.024378e-02 3 1  ON 79
ci_0031                 2.090070e-02 3 1  ON 80
ci_0032                 2.123553e-02 3 1  ON 81
ci_0033                 7.876972e-03 3 1  ON 82
ci_0034                 1.061361e-02 3 1  ON 83
ci_0035                 6.733642e-03 3 1  ON 84
ci_0036                 6.773140e-03 3 1  ON 85
ci_0037                -1.072451e-02 3 1  ON 86
ci_0038                -1.059561e-02 3 1  ON 87
ci_0039                -2.594563e-03 3 1  ON 88
ci_0040                -2.667432e-03 3 1  ON 89
ci_0041                 6.462825e-03 3 1  ON 90
ci_0042                 6.804336e-03 3 1  ON 91
ci_0043                -1.785963e-02 3 1  ON 92
ci_0044                -1.799752e-02 3 1  ON 93
ci_0045                 6.755517e-03 3 1  ON 94
ci_0046                 8.135441e-03 3 1  ON 95
ci_0047                -1.674508e-03 3 1  ON 96
ci_0048                -1.619433e-03 3 1  ON 97
ci_0049                -4.822841e-03 3 1  ON 98
ci_0050                -5.039060e-03 3 1  ON 99
ci_0051                -3.593265e-03 3 1  ON 100
ci_0052                -3.422413e-03 3 1  ON 101
ci_0053                -4.820581e-03 3 1  ON 102
ci_0054                -4.488831e-03 3 1  ON 103
ci_0055                 7.663791e-03 3 1  ON 104
ci_0056                 7.196186e-03 3 1  ON 105
ci_0057                 4.412951e-03 3 1  ON 106
ci_0058                 4.920675e-03 3 1  ON 107
ci_0059                -4.163307e-03 3 1  ON 108
ci_0060                -4.773400e-03 3 1  ON 109
ci_0061                -1.941567e-03 3 1  ON 110
ci_0062                -3.399169e-03 3 1  ON 111
ci_0063                -1.071839e-02 3 1  ON 112
ci_0064                -8.521128e-03 3 1  ON 113
ci_0065                -5.250344e-03 3 1  ON 114
ci_0066                -5.379964e-03 3 1  ON 115
ci_0067                -4.835177e-03 3 1  ON 116
ci_0068                -5.252698e-03 3 1  ON 117
ci_0069                 5.369985e-03 3 1  ON 118
ci_0070                 4.138453e-03 3 1  ON 119
ci_0071                 1.882808e-04 3 1  ON 120
ci_0072                 2.743883e-04 3 1  ON 121
ci_0073                 4.046995e-03 3 1  ON 122
ci_0074                 4.133016e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8281
    reference variance = 0.261465
====================================================
  Execution time = 2.1465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4394e-01
  Total weights = 1.952048610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0995e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325414716376
                                         uncertainty =       0.002819245946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325414716376
                                         uncertainty =       0.002819245946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403333009
  error estimate for blocks of size 2^( 2) =       0.000416501672
  error estimate for blocks of size 2^( 3) =       0.000430066759
  error estimate for blocks of size 2^( 4) =       0.000441785435
  error estimate for blocks of size 2^( 5) =       0.000452180762
  error estimate for blocks of size 2^( 6) =       0.000459857089
  error estimate for blocks of size 2^( 7) =       0.000463456327

      target function =                  N/A
              le_mean =     -16.904964548689
             les_mean =     286.121770420854
             stat err =       0.000454319903
             autocorr =       1.268808247839
              std dev =       0.570399011787
             le_variance =       0.325355032647


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690496454869e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904964548640       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904977266725       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904982805768       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904982634811       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904982987114       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904984694443       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904983837065       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904985296422       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904985150415       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904984404666       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904984666680       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904984598577       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904984718039       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 1.116473e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904964548640       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904969434731       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904971086440       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904970969448       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904971424038       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904970892021       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904971477348       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904971465947       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904971638778       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904971567992       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904971539135       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 4.085316e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904964548640       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904965959474       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904966394057       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904966337086       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904966476492       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904966285349       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904966414733       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.904966434367       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.904966483313       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.904966481876       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 1.165404e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7574e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.124988e-01 1 1  ON 0
   uu_1                 1.451013e-01 1 1  ON 1
   uu_2                 4.320627e-02 1 1  ON 2
   uu_3                -1.939669e-02 1 1  ON 3
   uu_4                -6.556562e-02 1 1  ON 4
   uu_5                -1.007691e-01 1 1  ON 5
   uu_6                -1.286970e-01 1 1  ON 6
   uu_7                -1.425468e-01 1 1  ON 7
   uu_8                -1.353527e-01 1 1  ON 8
   uu_9                -1.041274e-01 1 1  ON 9
   ud_0                 4.474850e-01 1 1  ON 10
   ud_1                 1.818972e-01 1 1  ON 11
   ud_2                 6.167475e-02 1 1  ON 12
   ud_3                -9.181317e-03 1 1  ON 13
   ud_4                -6.616440e-02 1 1  ON 14
   ud_5                -1.078168e-01 1 1  ON 15
   ud_6                -1.351303e-01 1 1  ON 16
   ud_7                -1.517150e-01 1 1  ON 17
   ud_8                -1.527742e-01 1 1  ON 18
   ud_9                -1.409548e-01 1 1  ON 19
   eO_0                -7.512212e-01 1 1  ON 20
   eO_1                -4.307116e-01 1 1  ON 21
   eO_2                -2.034085e-02 1 1  ON 22
   eO_3                 2.922514e-01 1 1  ON 23
   eO_4                 5.174942e-01 1 1  ON 24
   eO_5                 4.796971e-01 1 1  ON 25
   eO_6                 2.530785e-01 1 1  ON 26
   eO_7                -4.490432e-02 1 1  ON 27
   eO_8                -2.171496e-01 1 1  ON 28
   eO_9                -7.834058e-02 1 1  ON 29
  eH1_0                -2.543622e-01 1 1  ON 30
  eH1_1                -1.471896e-01 1 1  ON 31
  eH1_2                -9.769657e-02 1 1  ON 32
  eH1_3                -4.259531e-02 1 1  ON 33
  eH1_4                 6.719213e-03 1 1  ON 34
  eH1_5                 4.192119e-02 1 1  ON 35
  eH1_6                 1.018406e-01 1 1  ON 36
  eH1_7                 1.559938e-01 1 1  ON 37
  eH1_8                 1.756189e-01 1 1  ON 38
  eH1_9                 6.242827e-02 1 1  ON 39
  eH2_0                -2.517168e-01 1 1  ON 40
  eH2_1                -1.446581e-01 1 1  ON 41
  eH2_2                -9.509023e-02 1 1  ON 42
  eH2_3                -3.989426e-02 1 1  ON 43
  eH2_4                 1.006640e-02 1 1  ON 44
  eH2_5                 4.523841e-02 1 1  ON 45
  eH2_6                 1.037326e-01 1 1  ON 46
  eH2_7                 1.568316e-01 1 1  ON 47
  eH2_8                 1.806776e-01 1 1  ON 48
  eH2_9                 5.049018e-02 1 1  ON 49
ci_0001                 7.003404e-01 3 1  ON 50
ci_0002                 7.015052e-01 3 1  ON 51
ci_0003                -2.680811e-02 3 1  ON 52
ci_0004                -2.814608e-02 3 1  ON 53
ci_0005                -3.616501e-02 3 1  ON 54
ci_0006                -3.675334e-02 3 1  ON 55
ci_0007                -2.168274e-02 3 1  ON 56
ci_0008                -2.215572e-02 3 1  ON 57
ci_0009                -1.756879e-02 3 1  ON 58
ci_0010                -1.715738e-02 3 1  ON 59
ci_0011                -1.225577e-02 3 1  ON 60
ci_0012                -1.232224e-02 3 1  ON 61
ci_0013                 1.316867e-02 3 1  ON 62
ci_0014                 1.284247e-02 3 1  ON 63
ci_0015                 1.240233e-02 3 1  ON 64
ci_0016                 1.310746e-02 3 1  ON 65
ci_0017                 1.066196e-02 3 1  ON 66
ci_0018                 1.116320e-02 3 1  ON 67
ci_0019                 1.121441e-02 3 1  ON 68
ci_0020                 1.173054e-02 3 1  ON 69
ci_0021                -8.120747e-04 3 1  ON 70
ci_0022                -3.252943e-04 3 1  ON 71
ci_0023                -1.158476e-02 3 1  ON 72
ci_0024                -1.037979e-02 3 1  ON 73
ci_0025                -1.016120e-02 3 1  ON 74
ci_0026                -1.093939e-02 3 1  ON 75
ci_0027                -1.140741e-02 3 1  ON 76
ci_0028                -1.142690e-02 3 1  ON 77
ci_0029                -1.096943e-02 3 1  ON 78
ci_0030                -1.029334e-02 3 1  ON 79
ci_0031                 2.094707e-02 3 1  ON 80
ci_0032                 2.113404e-02 3 1  ON 81
ci_0033                 7.927479e-03 3 1  ON 82
ci_0034                 1.051172e-02 3 1  ON 83
ci_0035                 6.635098e-03 3 1  ON 84
ci_0036                 6.938844e-03 3 1  ON 85
ci_0037                -1.052193e-02 3 1  ON 86
ci_0038                -1.049386e-02 3 1  ON 87
ci_0039                -2.713734e-03 3 1  ON 88
ci_0040                -2.583761e-03 3 1  ON 89
ci_0041                 6.584212e-03 3 1  ON 90
ci_0042                 6.810050e-03 3 1  ON 91
ci_0043                -1.800471e-02 3 1  ON 92
ci_0044                -1.815344e-02 3 1  ON 93
ci_0045                 6.845626e-03 3 1  ON 94
ci_0046                 8.119626e-03 3 1  ON 95
ci_0047                -1.737641e-03 3 1  ON 96
ci_0048                -1.733964e-03 3 1  ON 97
ci_0049                -4.965020e-03 3 1  ON 98
ci_0050                -5.228935e-03 3 1  ON 99
ci_0051                -3.448401e-03 3 1  ON 100
ci_0052                -3.475785e-03 3 1  ON 101
ci_0053                -4.841812e-03 3 1  ON 102
ci_0054                -4.457499e-03 3 1  ON 103
ci_0055                 7.455740e-03 3 1  ON 104
ci_0056                 7.104040e-03 3 1  ON 105
ci_0057                 4.231363e-03 3 1  ON 106
ci_0058                 4.893387e-03 3 1  ON 107
ci_0059                -4.229562e-03 3 1  ON 108
ci_0060                -4.687889e-03 3 1  ON 109
ci_0061                -2.317587e-03 3 1  ON 110
ci_0062                -3.285070e-03 3 1  ON 111
ci_0063                -1.051778e-02 3 1  ON 112
ci_0064                -8.421586e-03 3 1  ON 113
ci_0065                -5.375997e-03 3 1  ON 114
ci_0066                -5.357629e-03 3 1  ON 115
ci_0067                -4.941458e-03 3 1  ON 116
ci_0068                -5.109508e-03 3 1  ON 117
ci_0069                 5.136224e-03 3 1  ON 118
ci_0070                 4.248062e-03 3 1  ON 119
ci_0071                 4.070013e-04 3 1  ON 120
ci_0072                 2.197706e-04 3 1  ON 121
ci_0073                 4.195166e-03 3 1  ON 122
ci_0074                 4.249306e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9752
    reference variance = 0.737991
====================================================
  Execution time = 2.0835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3555e-01
  Total weights = 1.9514e+06
  Execution time = 1.8974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323479965628
                                         uncertainty =       0.002285122093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323479965628
                                         uncertainty =       0.002285122093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402135959
  error estimate for blocks of size 2^( 2) =       0.000415281990
  error estimate for blocks of size 2^( 3) =       0.000428151843
  error estimate for blocks of size 2^( 4) =       0.000440303483
  error estimate for blocks of size 2^( 5) =       0.000449804674
  error estimate for blocks of size 2^( 6) =       0.000457067461
  error estimate for blocks of size 2^( 7) =       0.000461119923

      target function =                  N/A
              le_mean =     -16.906704127498
             les_mean =     286.220029540353
             stat err =       0.000452073885
             autocorr =       1.263784493301
              std dev =       0.568706126722
             le_variance =       0.323426658571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324017774663
                                         uncertainty =       0.002271170185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324017774663
                                         uncertainty =       0.002271170185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402468242
  error estimate for blocks of size 2^( 2) =       0.000415610749
  error estimate for blocks of size 2^( 3) =       0.000428462998
  error estimate for blocks of size 2^( 4) =       0.000440600286
  error estimate for blocks of size 2^( 5) =       0.000450077232
  error estimate for blocks of size 2^( 6) =       0.000457283510
  error estimate for blocks of size 2^( 7) =       0.000461364798

      target function =                  N/A
              le_mean =     -16.906692568473
             les_mean =     286.173569879255
             stat err =       0.000452331456
             autocorr =       1.263136681691
              std dev =       0.569176046861
             le_variance =       0.323961372321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323890480036
                                         uncertainty =       0.002277354583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323890480036
                                         uncertainty =       0.002277354583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402389644
  error estimate for blocks of size 2^( 2) =       0.000415530583
  error estimate for blocks of size 2^( 3) =       0.000428387199
  error estimate for blocks of size 2^( 4) =       0.000440527625
  error estimate for blocks of size 2^( 5) =       0.000450004930
  error estimate for blocks of size 2^( 6) =       0.000457234958
  error estimate for blocks of size 2^( 7) =       0.000461309056

      target function =                  N/A
              le_mean =     -16.906690794788
             les_mean =     286.176695880239
             stat err =       0.000452269142
             autocorr =       1.263282046748
              std dev =       0.569064892485
             le_variance =       0.323834851858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323545775847
                                         uncertainty =       0.002283216606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323545775847
                                         uncertainty =       0.002283216606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402176647
  error estimate for blocks of size 2^( 2) =       0.000415319432
  error estimate for blocks of size 2^( 3) =       0.000428186782
  error estimate for blocks of size 2^( 4) =       0.000440339853
  error estimate for blocks of size 2^( 5) =       0.000449838352
  error estimate for blocks of size 2^( 6) =       0.000457081956
  error estimate for blocks of size 2^( 7) =       0.000461126669

      target function =                  N/A
              le_mean =     -16.906703390345
             les_mean =     286.190498023510
             stat err =       0.000452096707
             autocorr =       1.263656368153
              std dev =       0.568763668464
             le_variance =       0.323492110565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906704127498        initial  <--
     2.4414e-01     2.4414e+00             1.1165e-03       -16.906692568473
     9.7656e-01     9.7656e+00             4.0853e-04       -16.906690794788
     3.9062e+00     3.9062e+01             1.1654e-04       -16.906703390345

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4035
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.124220e-01 1 1  ON 0
   uu_1                 1.449054e-01 1 1  ON 1
   uu_2                 4.323131e-02 1 1  ON 2
   uu_3                -1.943745e-02 1 1  ON 3
   uu_4                -6.559107e-02 1 1  ON 4
   uu_5                -1.007691e-01 1 1  ON 5
   uu_6                -1.285498e-01 1 1  ON 6
   uu_7                -1.424897e-01 1 1  ON 7
   uu_8                -1.352712e-01 1 1  ON 8
   uu_9                -1.039783e-01 1 1  ON 9
   ud_0                 4.472357e-01 1 1  ON 10
   ud_1                 1.817548e-01 1 1  ON 11
   ud_2                 6.160689e-02 1 1  ON 12
   ud_3                -9.196553e-03 1 1  ON 13
   ud_4                -6.620737e-02 1 1  ON 14
   ud_5                -1.078501e-01 1 1  ON 15
   ud_6                -1.350698e-01 1 1  ON 16
   ud_7                -1.516396e-01 1 1  ON 17
   ud_8                -1.526279e-01 1 1  ON 18
   ud_9                -1.407861e-01 1 1  ON 19
   eO_0                -7.512891e-01 1 1  ON 20
   eO_1                -4.307862e-01 1 1  ON 21
   eO_2                -2.036310e-02 1 1  ON 22
   eO_3                 2.922902e-01 1 1  ON 23
   eO_4                 5.174830e-01 1 1  ON 24
   eO_5                 4.795840e-01 1 1  ON 25
   eO_6                 2.530033e-01 1 1  ON 26
   eO_7                -4.496050e-02 1 1  ON 27
   eO_8                -2.169614e-01 1 1  ON 28
   eO_9                -7.817441e-02 1 1  ON 29
  eH1_0                -2.542994e-01 1 1  ON 30
  eH1_1                -1.470085e-01 1 1  ON 31
  eH1_2                -9.758591e-02 1 1  ON 32
  eH1_3                -4.263615e-02 1 1  ON 33
  eH1_4                 6.734133e-03 1 1  ON 34
  eH1_5                 4.193120e-02 1 1  ON 35
  eH1_6                 1.018534e-01 1 1  ON 36
  eH1_7                 1.559977e-01 1 1  ON 37
  eH1_8                 1.754637e-01 1 1  ON 38
  eH1_9                 6.224487e-02 1 1  ON 39
  eH2_0                -2.515859e-01 1 1  ON 40
  eH2_1                -1.444421e-01 1 1  ON 41
  eH2_2                -9.501828e-02 1 1  ON 42
  eH2_3                -3.992749e-02 1 1  ON 43
  eH2_4                 1.011960e-02 1 1  ON 44
  eH2_5                 4.513340e-02 1 1  ON 45
  eH2_6                 1.037380e-01 1 1  ON 46
  eH2_7                 1.568001e-01 1 1  ON 47
  eH2_8                 1.805241e-01 1 1  ON 48
  eH2_9                 5.030988e-02 1 1  ON 49
ci_0001                 7.003426e-01 3 1  ON 50
ci_0002                 7.015076e-01 3 1  ON 51
ci_0003                -2.668325e-02 3 1  ON 52
ci_0004                -2.837183e-02 3 1  ON 53
ci_0005                -3.588395e-02 3 1  ON 54
ci_0006                -3.673208e-02 3 1  ON 55
ci_0007                -2.183512e-02 3 1  ON 56
ci_0008                -2.220820e-02 3 1  ON 57
ci_0009                -1.762375e-02 3 1  ON 58
ci_0010                -1.715894e-02 3 1  ON 59
ci_0011                -1.266430e-02 3 1  ON 60
ci_0012                -1.196923e-02 3 1  ON 61
ci_0013                 1.315495e-02 3 1  ON 62
ci_0014                 1.285259e-02 3 1  ON 63
ci_0015                 1.221547e-02 3 1  ON 64
ci_0016                 1.315545e-02 3 1  ON 65
ci_0017                 1.079360e-02 3 1  ON 66
ci_0018                 1.125242e-02 3 1  ON 67
ci_0019                 1.110134e-02 3 1  ON 68
ci_0020                 1.174180e-02 3 1  ON 69
ci_0021                -4.624946e-04 3 1  ON 70
ci_0022                -3.392699e-04 3 1  ON 71
ci_0023                -1.178504e-02 3 1  ON 72
ci_0024                -1.013288e-02 3 1  ON 73
ci_0025                -1.001772e-02 3 1  ON 74
ci_0026                -1.095516e-02 3 1  ON 75
ci_0027                -1.145259e-02 3 1  ON 76
ci_0028                -1.153688e-02 3 1  ON 77
ci_0029                -1.070050e-02 3 1  ON 78
ci_0030                -1.024378e-02 3 1  ON 79
ci_0031                 2.090070e-02 3 1  ON 80
ci_0032                 2.123553e-02 3 1  ON 81
ci_0033                 7.876972e-03 3 1  ON 82
ci_0034                 1.061361e-02 3 1  ON 83
ci_0035                 6.733642e-03 3 1  ON 84
ci_0036                 6.773140e-03 3 1  ON 85
ci_0037                -1.072451e-02 3 1  ON 86
ci_0038                -1.059561e-02 3 1  ON 87
ci_0039                -2.594563e-03 3 1  ON 88
ci_0040                -2.667432e-03 3 1  ON 89
ci_0041                 6.462825e-03 3 1  ON 90
ci_0042                 6.804336e-03 3 1  ON 91
ci_0043                -1.785963e-02 3 1  ON 92
ci_0044                -1.799752e-02 3 1  ON 93
ci_0045                 6.755517e-03 3 1  ON 94
ci_0046                 8.135441e-03 3 1  ON 95
ci_0047                -1.674508e-03 3 1  ON 96
ci_0048                -1.619433e-03 3 1  ON 97
ci_0049                -4.822841e-03 3 1  ON 98
ci_0050                -5.039060e-03 3 1  ON 99
ci_0051                -3.593265e-03 3 1  ON 100
ci_0052                -3.422413e-03 3 1  ON 101
ci_0053                -4.820581e-03 3 1  ON 102
ci_0054                -4.488831e-03 3 1  ON 103
ci_0055                 7.663791e-03 3 1  ON 104
ci_0056                 7.196186e-03 3 1  ON 105
ci_0057                 4.412951e-03 3 1  ON 106
ci_0058                 4.920675e-03 3 1  ON 107
ci_0059                -4.163307e-03 3 1  ON 108
ci_0060                -4.773400e-03 3 1  ON 109
ci_0061                -1.941567e-03 3 1  ON 110
ci_0062                -3.399169e-03 3 1  ON 111
ci_0063                -1.071839e-02 3 1  ON 112
ci_0064                -8.521128e-03 3 1  ON 113
ci_0065                -5.250344e-03 3 1  ON 114
ci_0066                -5.379964e-03 3 1  ON 115
ci_0067                -4.835177e-03 3 1  ON 116
ci_0068                -5.252698e-03 3 1  ON 117
ci_0069                 5.369985e-03 3 1  ON 118
ci_0070                 4.138453e-03 3 1  ON 119
ci_0071                 1.882808e-04 3 1  ON 120
ci_0072                 2.743883e-04 3 1  ON 121
ci_0073                 4.046995e-03 3 1  ON 122
ci_0074                 4.133016e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9574
    reference variance = 0.264344
====================================================
  Execution time = 2.1220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3552e-01
  Total weights = 1.951961674e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323476896248
                                         uncertainty =       0.002372217683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323476896248
                                         uncertainty =       0.002372217683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402100427
  error estimate for blocks of size 2^( 2) =       0.000414502221
  error estimate for blocks of size 2^( 3) =       0.000427283490
  error estimate for blocks of size 2^( 4) =       0.000439347839
  error estimate for blocks of size 2^( 5) =       0.000448727396
  error estimate for blocks of size 2^( 6) =       0.000454176148
  error estimate for blocks of size 2^( 7) =       0.000458429943

      target function =                  N/A
              le_mean =     -16.906769832475
             les_mean =     286.174388397907
             stat err =       0.000450170332
             autocorr =       1.253385509615
              std dev =       0.568655877926
             le_variance =       0.323369507500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676983248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906769832444       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906771571114       residual = 8.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906771509568       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906771921408       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906772402118       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906772495356       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906772566576       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906772539898       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906772466042       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906772477331       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.907438e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906769832444       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906770294556       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906770278331       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906770384614       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906770514836       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906770545010       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906770557870       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906770546229       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906770533965       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906770536237       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 5.176029e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906769832444       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906769949825       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906769945720       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906769972546       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906770005603       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906770013788       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906770016770       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906770013459       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906770010816       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906770011361       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+01 is 1.322349e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212586 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7396e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.124273e-01 1 1  ON 0
   uu_1                 1.449284e-01 1 1  ON 1
   uu_2                 4.324091e-02 1 1  ON 2
   uu_3                -1.943188e-02 1 1  ON 3
   uu_4                -6.558433e-02 1 1  ON 4
   uu_5                -1.007827e-01 1 1  ON 5
   uu_6                -1.285551e-01 1 1  ON 6
   uu_7                -1.424991e-01 1 1  ON 7
   uu_8                -1.352875e-01 1 1  ON 8
   uu_9                -1.039963e-01 1 1  ON 9
   ud_0                 4.472561e-01 1 1  ON 10
   ud_1                 1.817588e-01 1 1  ON 11
   ud_2                 6.161061e-02 1 1  ON 12
   ud_3                -9.189583e-03 1 1  ON 13
   ud_4                -6.620826e-02 1 1  ON 14
   ud_5                -1.078364e-01 1 1  ON 15
   ud_6                -1.350652e-01 1 1  ON 16
   ud_7                -1.516464e-01 1 1  ON 17
   ud_8                -1.526496e-01 1 1  ON 18
   ud_9                -1.408015e-01 1 1  ON 19
   eO_0                -7.512708e-01 1 1  ON 20
   eO_1                -4.307921e-01 1 1  ON 21
   eO_2                -2.035952e-02 1 1  ON 22
   eO_3                 2.922892e-01 1 1  ON 23
   eO_4                 5.174885e-01 1 1  ON 24
   eO_5                 4.795876e-01 1 1  ON 25
   eO_6                 2.530123e-01 1 1  ON 26
   eO_7                -4.495765e-02 1 1  ON 27
   eO_8                -2.169797e-01 1 1  ON 28
   eO_9                -7.818951e-02 1 1  ON 29
  eH1_0                -2.543035e-01 1 1  ON 30
  eH1_1                -1.470185e-01 1 1  ON 31
  eH1_2                -9.759564e-02 1 1  ON 32
  eH1_3                -4.263996e-02 1 1  ON 33
  eH1_4                 6.746319e-03 1 1  ON 34
  eH1_5                 4.192388e-02 1 1  ON 35
  eH1_6                 1.018389e-01 1 1  ON 36
  eH1_7                 1.559996e-01 1 1  ON 37
  eH1_8                 1.754816e-01 1 1  ON 38
  eH1_9                 6.226102e-02 1 1  ON 39
  eH2_0                -2.515877e-01 1 1  ON 40
  eH2_1                -1.444474e-01 1 1  ON 41
  eH2_2                -9.502872e-02 1 1  ON 42
  eH2_3                -3.991962e-02 1 1  ON 43
  eH2_4                 1.010677e-02 1 1  ON 44
  eH2_5                 4.513060e-02 1 1  ON 45
  eH2_6                 1.037414e-01 1 1  ON 46
  eH2_7                 1.567998e-01 1 1  ON 47
  eH2_8                 1.805298e-01 1 1  ON 48
  eH2_9                 5.032475e-02 1 1  ON 49
ci_0001                 7.003424e-01 3 1  ON 50
ci_0002                 7.015055e-01 3 1  ON 51
ci_0003                -2.671942e-02 3 1  ON 52
ci_0004                -2.835619e-02 3 1  ON 53
ci_0005                -3.588456e-02 3 1  ON 54
ci_0006                -3.673790e-02 3 1  ON 55
ci_0007                -2.185253e-02 3 1  ON 56
ci_0008                -2.220469e-02 3 1  ON 57
ci_0009                -1.762427e-02 3 1  ON 58
ci_0010                -1.715659e-02 3 1  ON 59
ci_0011                -1.265839e-02 3 1  ON 60
ci_0012                -1.197144e-02 3 1  ON 61
ci_0013                 1.317032e-02 3 1  ON 62
ci_0014                 1.288725e-02 3 1  ON 63
ci_0015                 1.221949e-02 3 1  ON 64
ci_0016                 1.316044e-02 3 1  ON 65
ci_0017                 1.080443e-02 3 1  ON 66
ci_0018                 1.125596e-02 3 1  ON 67
ci_0019                 1.111982e-02 3 1  ON 68
ci_0020                 1.173577e-02 3 1  ON 69
ci_0021                -4.639753e-04 3 1  ON 70
ci_0022                -3.485642e-04 3 1  ON 71
ci_0023                -1.178219e-02 3 1  ON 72
ci_0024                -1.015708e-02 3 1  ON 73
ci_0025                -1.000746e-02 3 1  ON 74
ci_0026                -1.093903e-02 3 1  ON 75
ci_0027                -1.144568e-02 3 1  ON 76
ci_0028                -1.152368e-02 3 1  ON 77
ci_0029                -1.069597e-02 3 1  ON 78
ci_0030                -1.025022e-02 3 1  ON 79
ci_0031                 2.088632e-02 3 1  ON 80
ci_0032                 2.122801e-02 3 1  ON 81
ci_0033                 7.921668e-03 3 1  ON 82
ci_0034                 1.061008e-02 3 1  ON 83
ci_0035                 6.732712e-03 3 1  ON 84
ci_0036                 6.755586e-03 3 1  ON 85
ci_0037                -1.072800e-02 3 1  ON 86
ci_0038                -1.057697e-02 3 1  ON 87
ci_0039                -2.609350e-03 3 1  ON 88
ci_0040                -2.672554e-03 3 1  ON 89
ci_0041                 6.490411e-03 3 1  ON 90
ci_0042                 6.811766e-03 3 1  ON 91
ci_0043                -1.786183e-02 3 1  ON 92
ci_0044                -1.803176e-02 3 1  ON 93
ci_0045                 6.758196e-03 3 1  ON 94
ci_0046                 8.143334e-03 3 1  ON 95
ci_0047                -1.697486e-03 3 1  ON 96
ci_0048                -1.625356e-03 3 1  ON 97
ci_0049                -4.844579e-03 3 1  ON 98
ci_0050                -5.041126e-03 3 1  ON 99
ci_0051                -3.581864e-03 3 1  ON 100
ci_0052                -3.428027e-03 3 1  ON 101
ci_0053                -4.813703e-03 3 1  ON 102
ci_0054                -4.490511e-03 3 1  ON 103
ci_0055                 7.643263e-03 3 1  ON 104
ci_0056                 7.193332e-03 3 1  ON 105
ci_0057                 4.426512e-03 3 1  ON 106
ci_0058                 4.946354e-03 3 1  ON 107
ci_0059                -4.187949e-03 3 1  ON 108
ci_0060                -4.790706e-03 3 1  ON 109
ci_0061                -1.974805e-03 3 1  ON 110
ci_0062                -3.370242e-03 3 1  ON 111
ci_0063                -1.066663e-02 3 1  ON 112
ci_0064                -8.528747e-03 3 1  ON 113
ci_0065                -5.230879e-03 3 1  ON 114
ci_0066                -5.382481e-03 3 1  ON 115
ci_0067                -4.822502e-03 3 1  ON 116
ci_0068                -5.235921e-03 3 1  ON 117
ci_0069                 5.327573e-03 3 1  ON 118
ci_0070                 4.137857e-03 3 1  ON 119
ci_0071                 2.062242e-04 3 1  ON 120
ci_0072                 2.949485e-04 3 1  ON 121
ci_0073                 4.053353e-03 3 1  ON 122
ci_0074                 4.116619e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9361
    reference variance = 0.201681
====================================================
  Execution time = 2.1392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4534e-01
  Total weights = 1.9516e+06
  Execution time = 1.8883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325609307314
                                         uncertainty =       0.002436083921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325609307314
                                         uncertainty =       0.002436083921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403437554
  error estimate for blocks of size 2^( 2) =       0.000416872244
  error estimate for blocks of size 2^( 3) =       0.000430976612
  error estimate for blocks of size 2^( 4) =       0.000444024306
  error estimate for blocks of size 2^( 5) =       0.000453668945
  error estimate for blocks of size 2^( 6) =       0.000462776755
  error estimate for blocks of size 2^( 7) =       0.000466512905

      target function =                  N/A
              le_mean =     -16.906098958710
             les_mean =     286.165839307199
             stat err =       0.000456745728
             autocorr =       1.281729387390
              std dev =       0.570546861137
             le_variance =       0.325523720753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325575212133
                                         uncertainty =       0.002428005366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325575212133
                                         uncertainty =       0.002428005366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403416544
  error estimate for blocks of size 2^( 2) =       0.000416849083
  error estimate for blocks of size 2^( 3) =       0.000430951818
  error estimate for blocks of size 2^( 4) =       0.000443997351
  error estimate for blocks of size 2^( 5) =       0.000453642496
  error estimate for blocks of size 2^( 6) =       0.000462749071
  error estimate for blocks of size 2^( 7) =       0.000466484018

      target function =                  N/A
              le_mean =     -16.906101266153
             les_mean =     286.166806781858
             stat err =       0.000456718234
             autocorr =       1.281708579644
              std dev =       0.570517147963
             le_variance =       0.325489816120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325591569187
                                         uncertainty =       0.002431650355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325591569187
                                         uncertainty =       0.002431650355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403426626
  error estimate for blocks of size 2^( 2) =       0.000416860180
  error estimate for blocks of size 2^( 3) =       0.000430963583
  error estimate for blocks of size 2^( 4) =       0.000444010040
  error estimate for blocks of size 2^( 5) =       0.000453654906
  error estimate for blocks of size 2^( 6) =       0.000462761694
  error estimate for blocks of size 2^( 7) =       0.000466497505

      target function =                  N/A
              le_mean =     -16.906100060724
             les_mean =     286.161532370415
             stat err =       0.000456731036
             autocorr =       1.281716374688
              std dev =       0.570531405640
             le_variance =       0.325506084821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325606897169
                                         uncertainty =       0.002435500942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325606897169
                                         uncertainty =       0.002435500942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403436069
  error estimate for blocks of size 2^( 2) =       0.000416870586
  error estimate for blocks of size 2^( 3) =       0.000430974803
  error estimate for blocks of size 2^( 4) =       0.000444022269
  error estimate for blocks of size 2^( 5) =       0.000453666603
  error estimate for blocks of size 2^( 6) =       0.000462774166
  error estimate for blocks of size 2^( 7) =       0.000466510301

      target function =                  N/A
              le_mean =     -16.906099015400
             les_mean =     286.161609203284
             stat err =       0.000456743335
             autocorr =       1.281725396988
              std dev =       0.570544760480
             le_variance =       0.325521323711


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906098958710        initial
     2.4414e+00     2.4414e+01             1.9074e-04       -16.906101266153  <--
     9.7656e+00     9.7656e+01             5.1760e-05       -16.906100060724
     3.9062e+01     3.9062e+02             1.3223e-05       -16.906099015400

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.4728e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.124455e-01 1 1  ON 0
   uu_1                 1.449900e-01 1 1  ON 1
   uu_2                 4.327007e-02 1 1  ON 2
   uu_3                -1.941556e-02 1 1  ON 3
   uu_4                -6.556593e-02 1 1  ON 4
   uu_5                -1.008185e-01 1 1  ON 5
   uu_6                -1.285709e-01 1 1  ON 6
   uu_7                -1.425266e-01 1 1  ON 7
   uu_8                -1.353356e-01 1 1  ON 8
   uu_9                -1.040501e-01 1 1  ON 9
   ud_0                 4.473100e-01 1 1  ON 10
   ud_1                 1.817721e-01 1 1  ON 11
   ud_2                 6.162466e-02 1 1  ON 12
   ud_3                -9.169446e-03 1 1  ON 13
   ud_4                -6.620715e-02 1 1  ON 14
   ud_5                -1.078000e-01 1 1  ON 15
   ud_6                -1.350503e-01 1 1  ON 16
   ud_7                -1.516645e-01 1 1  ON 17
   ud_8                -1.527137e-01 1 1  ON 18
   ud_9                -1.408478e-01 1 1  ON 19
   eO_0                -7.512187e-01 1 1  ON 20
   eO_1                -4.308059e-01 1 1  ON 21
   eO_2                -2.035116e-02 1 1  ON 22
   eO_3                 2.922862e-01 1 1  ON 23
   eO_4                 5.175054e-01 1 1  ON 24
   eO_5                 4.795989e-01 1 1  ON 25
   eO_6                 2.530397e-01 1 1  ON 26
   eO_7                -4.494904e-02 1 1  ON 27
   eO_8                -2.170343e-01 1 1  ON 28
   eO_9                -7.823460e-02 1 1  ON 29
  eH1_0                -2.543172e-01 1 1  ON 30
  eH1_1                -1.470476e-01 1 1  ON 31
  eH1_2                -9.762396e-02 1 1  ON 32
  eH1_3                -4.265075e-02 1 1  ON 33
  eH1_4                 6.780727e-03 1 1  ON 34
  eH1_5                 4.190326e-02 1 1  ON 35
  eH1_6                 1.017961e-01 1 1  ON 36
  eH1_7                 1.560052e-01 1 1  ON 37
  eH1_8                 1.755347e-01 1 1  ON 38
  eH1_9                 6.230917e-02 1 1  ON 39
  eH2_0                -2.515944e-01 1 1  ON 40
  eH2_1                -1.444634e-01 1 1  ON 41
  eH2_2                -9.505833e-02 1 1  ON 42
  eH2_3                -3.989886e-02 1 1  ON 43
  eH2_4                 1.007096e-02 1 1  ON 44
  eH2_5                 4.512199e-02 1 1  ON 45
  eH2_6                 1.037514e-01 1 1  ON 46
  eH2_7                 1.567991e-01 1 1  ON 47
  eH2_8                 1.805471e-01 1 1  ON 48
  eH2_9                 5.036910e-02 1 1  ON 49
ci_0001                 7.003423e-01 3 1  ON 50
ci_0002                 7.014990e-01 3 1  ON 51
ci_0003                -2.682108e-02 3 1  ON 52
ci_0004                -2.831215e-02 3 1  ON 53
ci_0005                -3.588617e-02 3 1  ON 54
ci_0006                -3.675409e-02 3 1  ON 55
ci_0007                -2.190267e-02 3 1  ON 56
ci_0008                -2.219427e-02 3 1  ON 57
ci_0009                -1.762574e-02 3 1  ON 58
ci_0010                -1.714973e-02 3 1  ON 59
ci_0011                -1.264147e-02 3 1  ON 60
ci_0012                -1.197697e-02 3 1  ON 61
ci_0013                 1.321281e-02 3 1  ON 62
ci_0014                 1.298281e-02 3 1  ON 63
ci_0015                 1.223045e-02 3 1  ON 64
ci_0016                 1.317425e-02 3 1  ON 65
ci_0017                 1.083391e-02 3 1  ON 66
ci_0018                 1.126532e-02 3 1  ON 67
ci_0019                 1.117079e-02 3 1  ON 68
ci_0020                 1.171903e-02 3 1  ON 69
ci_0021                -4.682599e-04 3 1  ON 70
ci_0022                -3.749854e-04 3 1  ON 71
ci_0023                -1.177452e-02 3 1  ON 72
ci_0024                -1.022304e-02 3 1  ON 73
ci_0025                -9.979200e-03 3 1  ON 74
ci_0026                -1.089445e-02 3 1  ON 75
ci_0027                -1.142647e-02 3 1  ON 76
ci_0028                -1.148681e-02 3 1  ON 77
ci_0029                -1.068282e-02 3 1  ON 78
ci_0030                -1.026751e-02 3 1  ON 79
ci_0031                 2.084548e-02 3 1  ON 80
ci_0032                 2.120689e-02 3 1  ON 81
ci_0033                 8.049845e-03 3 1  ON 82
ci_0034                 1.059984e-02 3 1  ON 83
ci_0035                 6.729820e-03 3 1  ON 84
ci_0036                 6.706543e-03 3 1  ON 85
ci_0037                -1.073856e-02 3 1  ON 86
ci_0038                -1.052482e-02 3 1  ON 87
ci_0039                -2.648059e-03 3 1  ON 88
ci_0040                -2.686037e-03 3 1  ON 89
ci_0041                 6.566240e-03 3 1  ON 90
ci_0042                 6.832448e-03 3 1  ON 91
ci_0043                -1.786827e-02 3 1  ON 92
ci_0044                -1.813040e-02 3 1  ON 93
ci_0045                 6.765880e-03 3 1  ON 94
ci_0046                 8.165602e-03 3 1  ON 95
ci_0047                -1.757776e-03 3 1  ON 96
ci_0048                -1.640913e-03 3 1  ON 97
ci_0049                -4.904467e-03 3 1  ON 98
ci_0050                -5.046798e-03 3 1  ON 99
ci_0051                -3.551569e-03 3 1  ON 100
ci_0052                -3.442834e-03 3 1  ON 101
ci_0053                -4.795587e-03 3 1  ON 102
ci_0054                -4.495687e-03 3 1  ON 103
ci_0055                 7.585489e-03 3 1  ON 104
ci_0056                 7.185234e-03 3 1  ON 105
ci_0057                 4.464081e-03 3 1  ON 106
ci_0058                 5.018091e-03 3 1  ON 107
ci_0059                -4.253454e-03 3 1  ON 108
ci_0060                -4.837020e-03 3 1  ON 109
ci_0061                -2.066759e-03 3 1  ON 110
ci_0062                -3.290046e-03 3 1  ON 111
ci_0063                -1.052765e-02 3 1  ON 112
ci_0064                -8.549282e-03 3 1  ON 113
ci_0065                -5.177872e-03 3 1  ON 114
ci_0066                -5.389352e-03 3 1  ON 115
ci_0067                -4.789440e-03 3 1  ON 116
ci_0068                -5.191773e-03 3 1  ON 117
ci_0069                 5.215804e-03 3 1  ON 118
ci_0070                 4.136458e-03 3 1  ON 119
ci_0071                 2.546464e-04 3 1  ON 120
ci_0072                 3.512399e-04 3 1  ON 121
ci_0073                 4.069898e-03 3 1  ON 122
ci_0074                 4.073143e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.0182
    reference variance = 0.562159
====================================================
  Execution time = 2.1187e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5216e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4215e-01
  Total weights = 1.952087925e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1348e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327306200578
                                         uncertainty =       0.002599703136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327306200578
                                         uncertainty =       0.002599703136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404545172
  error estimate for blocks of size 2^( 2) =       0.000417351503
  error estimate for blocks of size 2^( 3) =       0.000431134256
  error estimate for blocks of size 2^( 4) =       0.000443969215
  error estimate for blocks of size 2^( 5) =       0.000456562580
  error estimate for blocks of size 2^( 6) =       0.000466145874
  error estimate for blocks of size 2^( 7) =       0.000470228758

      target function =                  N/A
              le_mean =     -16.906395342422
             les_mean =     286.168351146869
             stat err =       0.000459226607
             autocorr =       1.288605677798
              std dev =       0.572113268225
             le_variance =       0.327313591679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639534242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395342434       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409619755       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906411272976       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906412701971       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906412645082       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906412797338       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413361817       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906413277311       residual = 9.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906413089098       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906413254541       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906413228280       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 8.512649e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395342434       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906399828599       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906400289619       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906400650892       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906400725396       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906400799685       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906400813473       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906400875623       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906400802229       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906400804384       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 2.794610e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906395342434       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906396540938       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906396661560       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906396749361       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906396773337       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906396801195       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906396791984       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906396811354       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906396795522       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906396791820       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 7.591107e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7330e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.124175e-01 1 1  ON 0
   uu_1                 1.450124e-01 1 1  ON 1
   uu_2                 4.322892e-02 1 1  ON 2
   uu_3                -1.945546e-02 1 1  ON 3
   uu_4                -6.555624e-02 1 1  ON 4
   uu_5                -1.007468e-01 1 1  ON 5
   uu_6                -1.286227e-01 1 1  ON 6
   uu_7                -1.425644e-01 1 1  ON 7
   uu_8                -1.353316e-01 1 1  ON 8
   uu_9                -1.040631e-01 1 1  ON 9
   ud_0                 4.474068e-01 1 1  ON 10
   ud_1                 1.817999e-01 1 1  ON 11
   ud_2                 6.161394e-02 1 1  ON 12
   ud_3                -9.203326e-03 1 1  ON 13
   ud_4                -6.625813e-02 1 1  ON 14
   ud_5                -1.078469e-01 1 1  ON 15
   ud_6                -1.351122e-01 1 1  ON 16
   ud_7                -1.516795e-01 1 1  ON 17
   ud_8                -1.526842e-01 1 1  ON 18
   ud_9                -1.408160e-01 1 1  ON 19
   eO_0                -7.512646e-01 1 1  ON 20
   eO_1                -4.307960e-01 1 1  ON 21
   eO_2                -2.029500e-02 1 1  ON 22
   eO_3                 2.922618e-01 1 1  ON 23
   eO_4                 5.175124e-01 1 1  ON 24
   eO_5                 4.796244e-01 1 1  ON 25
   eO_6                 2.530473e-01 1 1  ON 26
   eO_7                -4.491889e-02 1 1  ON 27
   eO_8                -2.170561e-01 1 1  ON 28
   eO_9                -7.827467e-02 1 1  ON 29
  eH1_0                -2.543634e-01 1 1  ON 30
  eH1_1                -1.470604e-01 1 1  ON 31
  eH1_2                -9.766073e-02 1 1  ON 32
  eH1_3                -4.265945e-02 1 1  ON 33
  eH1_4                 6.774043e-03 1 1  ON 34
  eH1_5                 4.191736e-02 1 1  ON 35
  eH1_6                 1.017542e-01 1 1  ON 36
  eH1_7                 1.559754e-01 1 1  ON 37
  eH1_8                 1.755992e-01 1 1  ON 38
  eH1_9                 6.239726e-02 1 1  ON 39
  eH2_0                -2.516551e-01 1 1  ON 40
  eH2_1                -1.445407e-01 1 1  ON 41
  eH2_2                -9.510954e-02 1 1  ON 42
  eH2_3                -3.988089e-02 1 1  ON 43
  eH2_4                 1.001871e-02 1 1  ON 44
  eH2_5                 4.511276e-02 1 1  ON 45
  eH2_6                 1.037721e-01 1 1  ON 46
  eH2_7                 1.568345e-01 1 1  ON 47
  eH2_8                 1.806135e-01 1 1  ON 48
  eH2_9                 5.046604e-02 1 1  ON 49
ci_0001                 7.003744e-01 3 1  ON 50
ci_0002                 7.014747e-01 3 1  ON 51
ci_0003                -2.680647e-02 3 1  ON 52
ci_0004                -2.829922e-02 3 1  ON 53
ci_0005                -3.591007e-02 3 1  ON 54
ci_0006                -3.677812e-02 3 1  ON 55
ci_0007                -2.185614e-02 3 1  ON 56
ci_0008                -2.220942e-02 3 1  ON 57
ci_0009                -1.760760e-02 3 1  ON 58
ci_0010                -1.713677e-02 3 1  ON 59
ci_0011                -1.264559e-02 3 1  ON 60
ci_0012                -1.203004e-02 3 1  ON 61
ci_0013                 1.318241e-02 3 1  ON 62
ci_0014                 1.301793e-02 3 1  ON 63
ci_0015                 1.224969e-02 3 1  ON 64
ci_0016                 1.312423e-02 3 1  ON 65
ci_0017                 1.077373e-02 3 1  ON 66
ci_0018                 1.123619e-02 3 1  ON 67
ci_0019                 1.114529e-02 3 1  ON 68
ci_0020                 1.170847e-02 3 1  ON 69
ci_0021                -6.065896e-04 3 1  ON 70
ci_0022                -4.257156e-04 3 1  ON 71
ci_0023                -1.178480e-02 3 1  ON 72
ci_0024                -1.027443e-02 3 1  ON 73
ci_0025                -1.003129e-02 3 1  ON 74
ci_0026                -1.080401e-02 3 1  ON 75
ci_0027                -1.136562e-02 3 1  ON 76
ci_0028                -1.141112e-02 3 1  ON 77
ci_0029                -1.064216e-02 3 1  ON 78
ci_0030                -1.031620e-02 3 1  ON 79
ci_0031                 2.081123e-02 3 1  ON 80
ci_0032                 2.114212e-02 3 1  ON 81
ci_0033                 8.236602e-03 3 1  ON 82
ci_0034                 1.058582e-02 3 1  ON 83
ci_0035                 6.842383e-03 3 1  ON 84
ci_0036                 6.808543e-03 3 1  ON 85
ci_0037                -1.068341e-02 3 1  ON 86
ci_0038                -1.041704e-02 3 1  ON 87
ci_0039                -2.601435e-03 3 1  ON 88
ci_0040                -2.707688e-03 3 1  ON 89
ci_0041                 6.568399e-03 3 1  ON 90
ci_0042                 6.824816e-03 3 1  ON 91
ci_0043                -1.788950e-02 3 1  ON 92
ci_0044                -1.813076e-02 3 1  ON 93
ci_0045                 6.772355e-03 3 1  ON 94
ci_0046                 8.155855e-03 3 1  ON 95
ci_0047                -1.792520e-03 3 1  ON 96
ci_0048                -1.671188e-03 3 1  ON 97
ci_0049                -4.959387e-03 3 1  ON 98
ci_0050                -5.061141e-03 3 1  ON 99
ci_0051                -3.525973e-03 3 1  ON 100
ci_0052                -3.340368e-03 3 1  ON 101
ci_0053                -4.881660e-03 3 1  ON 102
ci_0054                -4.509850e-03 3 1  ON 103
ci_0055                 7.577766e-03 3 1  ON 104
ci_0056                 7.210989e-03 3 1  ON 105
ci_0057                 4.631857e-03 3 1  ON 106
ci_0058                 5.015358e-03 3 1  ON 107
ci_0059                -4.286197e-03 3 1  ON 108
ci_0060                -4.785438e-03 3 1  ON 109
ci_0061                -2.148097e-03 3 1  ON 110
ci_0062                -3.363600e-03 3 1  ON 111
ci_0063                -1.024819e-02 3 1  ON 112
ci_0064                -8.483527e-03 3 1  ON 113
ci_0065                -5.157434e-03 3 1  ON 114
ci_0066                -5.309360e-03 3 1  ON 115
ci_0067                -4.843645e-03 3 1  ON 116
ci_0068                -5.190140e-03 3 1  ON 117
ci_0069                 5.102564e-03 3 1  ON 118
ci_0070                 4.219520e-03 3 1  ON 119
ci_0071                 2.662128e-04 3 1  ON 120
ci_0072                 3.599479e-04 3 1  ON 121
ci_0073                 4.086191e-03 3 1  ON 122
ci_0074                 4.128249e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.386019
====================================================
  Execution time = 2.0727e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3852e-01
  Total weights = 1.9516e+06
  Execution time = 1.8925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213171590
                                         uncertainty =       0.002306914873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323213171590
                                         uncertainty =       0.002306914873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402009780
  error estimate for blocks of size 2^( 2) =       0.000414876667
  error estimate for blocks of size 2^( 3) =       0.000427833261
  error estimate for blocks of size 2^( 4) =       0.000439765600
  error estimate for blocks of size 2^( 5) =       0.000450359757
  error estimate for blocks of size 2^( 6) =       0.000458458566
  error estimate for blocks of size 2^( 7) =       0.000461125422

      target function =                  N/A
              le_mean =     -16.904833643251
             les_mean =     286.111815790729
             stat err =       0.000452427336
             autocorr =       1.266556124074
              std dev =       0.568527682534
             le_variance =       0.323223725807

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323564424904
                                         uncertainty =       0.002304301074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323564424904
                                         uncertainty =       0.002304301074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402227876
  error estimate for blocks of size 2^( 2) =       0.000415095909
  error estimate for blocks of size 2^( 3) =       0.000428052227
  error estimate for blocks of size 2^( 4) =       0.000439980351
  error estimate for blocks of size 2^( 5) =       0.000450560032
  error estimate for blocks of size 2^( 6) =       0.000458669868
  error estimate for blocks of size 2^( 7) =       0.000461363440

      target function =                  N/A
              le_mean =     -16.904831708007
             les_mean =     286.112606561985
             stat err =       0.000452643423
             autocorr =       1.266391821426
              std dev =       0.568836117326
             le_variance =       0.323574528375

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323434116779
                                         uncertainty =       0.002305858283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323434116779
                                         uncertainty =       0.002305858283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402146984
  error estimate for blocks of size 2^( 2) =       0.000415014670
  error estimate for blocks of size 2^( 3) =       0.000427970391
  error estimate for blocks of size 2^( 4) =       0.000439900498
  error estimate for blocks of size 2^( 5) =       0.000450486231
  error estimate for blocks of size 2^( 6) =       0.000458590792
  error estimate for blocks of size 2^( 7) =       0.000461274176

      target function =                  N/A
              le_mean =     -16.904830779217
             les_mean =     286.112496874619
             stat err =       0.000452562924
             autocorr =       1.266450765274
              std dev =       0.568721719475
             le_variance =       0.323444394203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240434540
                                         uncertainty =       0.002306739144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240434540
                                         uncertainty =       0.002306739144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402026711
  error estimate for blocks of size 2^( 2) =       0.000414893599
  error estimate for blocks of size 2^( 3) =       0.000427850398
  error estimate for blocks of size 2^( 4) =       0.000439781956
  error estimate for blocks of size 2^( 5) =       0.000450374815
  error estimate for blocks of size 2^( 6) =       0.000458474825
  error estimate for blocks of size 2^( 7) =       0.000461142015

      target function =                  N/A
              le_mean =     -16.904833341781
             les_mean =     286.116254434713
             stat err =       0.000452443403
             autocorr =       1.266539394679
              std dev =       0.568551626504
             le_variance =       0.323250952001


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904833643251        initial  <--
     6.1035e-01     6.1035e+00             8.5126e-04       -16.904831708007
     2.4414e+00     2.4414e+01             2.7946e-04       -16.904830779217
     9.7656e+00     9.7656e+01             7.5911e-05       -16.904833341781

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2784
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.124455e-01 1 1  ON 0
   uu_1                 1.449900e-01 1 1  ON 1
   uu_2                 4.327007e-02 1 1  ON 2
   uu_3                -1.941556e-02 1 1  ON 3
   uu_4                -6.556593e-02 1 1  ON 4
   uu_5                -1.008185e-01 1 1  ON 5
   uu_6                -1.285709e-01 1 1  ON 6
   uu_7                -1.425266e-01 1 1  ON 7
   uu_8                -1.353356e-01 1 1  ON 8
   uu_9                -1.040501e-01 1 1  ON 9
   ud_0                 4.473100e-01 1 1  ON 10
   ud_1                 1.817721e-01 1 1  ON 11
   ud_2                 6.162466e-02 1 1  ON 12
   ud_3                -9.169446e-03 1 1  ON 13
   ud_4                -6.620715e-02 1 1  ON 14
   ud_5                -1.078000e-01 1 1  ON 15
   ud_6                -1.350503e-01 1 1  ON 16
   ud_7                -1.516645e-01 1 1  ON 17
   ud_8                -1.527137e-01 1 1  ON 18
   ud_9                -1.408478e-01 1 1  ON 19
   eO_0                -7.512187e-01 1 1  ON 20
   eO_1                -4.308059e-01 1 1  ON 21
   eO_2                -2.035116e-02 1 1  ON 22
   eO_3                 2.922862e-01 1 1  ON 23
   eO_4                 5.175054e-01 1 1  ON 24
   eO_5                 4.795989e-01 1 1  ON 25
   eO_6                 2.530397e-01 1 1  ON 26
   eO_7                -4.494904e-02 1 1  ON 27
   eO_8                -2.170343e-01 1 1  ON 28
   eO_9                -7.823460e-02 1 1  ON 29
  eH1_0                -2.543172e-01 1 1  ON 30
  eH1_1                -1.470476e-01 1 1  ON 31
  eH1_2                -9.762396e-02 1 1  ON 32
  eH1_3                -4.265075e-02 1 1  ON 33
  eH1_4                 6.780727e-03 1 1  ON 34
  eH1_5                 4.190326e-02 1 1  ON 35
  eH1_6                 1.017961e-01 1 1  ON 36
  eH1_7                 1.560052e-01 1 1  ON 37
  eH1_8                 1.755347e-01 1 1  ON 38
  eH1_9                 6.230917e-02 1 1  ON 39
  eH2_0                -2.515944e-01 1 1  ON 40
  eH2_1                -1.444634e-01 1 1  ON 41
  eH2_2                -9.505833e-02 1 1  ON 42
  eH2_3                -3.989886e-02 1 1  ON 43
  eH2_4                 1.007096e-02 1 1  ON 44
  eH2_5                 4.512199e-02 1 1  ON 45
  eH2_6                 1.037514e-01 1 1  ON 46
  eH2_7                 1.567991e-01 1 1  ON 47
  eH2_8                 1.805471e-01 1 1  ON 48
  eH2_9                 5.036910e-02 1 1  ON 49
ci_0001                 7.003423e-01 3 1  ON 50
ci_0002                 7.014990e-01 3 1  ON 51
ci_0003                -2.682108e-02 3 1  ON 52
ci_0004                -2.831215e-02 3 1  ON 53
ci_0005                -3.588617e-02 3 1  ON 54
ci_0006                -3.675409e-02 3 1  ON 55
ci_0007                -2.190267e-02 3 1  ON 56
ci_0008                -2.219427e-02 3 1  ON 57
ci_0009                -1.762574e-02 3 1  ON 58
ci_0010                -1.714973e-02 3 1  ON 59
ci_0011                -1.264147e-02 3 1  ON 60
ci_0012                -1.197697e-02 3 1  ON 61
ci_0013                 1.321281e-02 3 1  ON 62
ci_0014                 1.298281e-02 3 1  ON 63
ci_0015                 1.223045e-02 3 1  ON 64
ci_0016                 1.317425e-02 3 1  ON 65
ci_0017                 1.083391e-02 3 1  ON 66
ci_0018                 1.126532e-02 3 1  ON 67
ci_0019                 1.117079e-02 3 1  ON 68
ci_0020                 1.171903e-02 3 1  ON 69
ci_0021                -4.682599e-04 3 1  ON 70
ci_0022                -3.749854e-04 3 1  ON 71
ci_0023                -1.177452e-02 3 1  ON 72
ci_0024                -1.022304e-02 3 1  ON 73
ci_0025                -9.979200e-03 3 1  ON 74
ci_0026                -1.089445e-02 3 1  ON 75
ci_0027                -1.142647e-02 3 1  ON 76
ci_0028                -1.148681e-02 3 1  ON 77
ci_0029                -1.068282e-02 3 1  ON 78
ci_0030                -1.026751e-02 3 1  ON 79
ci_0031                 2.084548e-02 3 1  ON 80
ci_0032                 2.120689e-02 3 1  ON 81
ci_0033                 8.049845e-03 3 1  ON 82
ci_0034                 1.059984e-02 3 1  ON 83
ci_0035                 6.729820e-03 3 1  ON 84
ci_0036                 6.706543e-03 3 1  ON 85
ci_0037                -1.073856e-02 3 1  ON 86
ci_0038                -1.052482e-02 3 1  ON 87
ci_0039                -2.648059e-03 3 1  ON 88
ci_0040                -2.686037e-03 3 1  ON 89
ci_0041                 6.566240e-03 3 1  ON 90
ci_0042                 6.832448e-03 3 1  ON 91
ci_0043                -1.786827e-02 3 1  ON 92
ci_0044                -1.813040e-02 3 1  ON 93
ci_0045                 6.765880e-03 3 1  ON 94
ci_0046                 8.165602e-03 3 1  ON 95
ci_0047                -1.757776e-03 3 1  ON 96
ci_0048                -1.640913e-03 3 1  ON 97
ci_0049                -4.904467e-03 3 1  ON 98
ci_0050                -5.046798e-03 3 1  ON 99
ci_0051                -3.551569e-03 3 1  ON 100
ci_0052                -3.442834e-03 3 1  ON 101
ci_0053                -4.795587e-03 3 1  ON 102
ci_0054                -4.495687e-03 3 1  ON 103
ci_0055                 7.585489e-03 3 1  ON 104
ci_0056                 7.185234e-03 3 1  ON 105
ci_0057                 4.464081e-03 3 1  ON 106
ci_0058                 5.018091e-03 3 1  ON 107
ci_0059                -4.253454e-03 3 1  ON 108
ci_0060                -4.837020e-03 3 1  ON 109
ci_0061                -2.066759e-03 3 1  ON 110
ci_0062                -3.290046e-03 3 1  ON 111
ci_0063                -1.052765e-02 3 1  ON 112
ci_0064                -8.549282e-03 3 1  ON 113
ci_0065                -5.177872e-03 3 1  ON 114
ci_0066                -5.389352e-03 3 1  ON 115
ci_0067                -4.789440e-03 3 1  ON 116
ci_0068                -5.191773e-03 3 1  ON 117
ci_0069                 5.215804e-03 3 1  ON 118
ci_0070                 4.136458e-03 3 1  ON 119
ci_0071                 2.546464e-04 3 1  ON 120
ci_0072                 3.512399e-04 3 1  ON 121
ci_0073                 4.069898e-03 3 1  ON 122
ci_0074                 4.073143e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7614e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.299533
====================================================
  Execution time = 2.1104e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3664e-01
  Total weights = 1.951707339e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324202495499
                                         uncertainty =       0.002403154183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324202495499
                                         uncertainty =       0.002403154183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402601526
  error estimate for blocks of size 2^( 2) =       0.000415187271
  error estimate for blocks of size 2^( 3) =       0.000428181805
  error estimate for blocks of size 2^( 4) =       0.000440549112
  error estimate for blocks of size 2^( 5) =       0.000452636356
  error estimate for blocks of size 2^( 6) =       0.000460413435
  error estimate for blocks of size 2^( 7) =       0.000463755076

      target function =                  N/A
              le_mean =     -16.905961360382
             les_mean =     286.148169012537
             stat err =       0.000454338495
             autocorr =       1.273527229817
              std dev =       0.569364538896
             le_variance =       0.324175978153


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596136038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961360390       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905962354309       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905962503740       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905962594548       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905962500299       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905962453036       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905962471805       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905962460274       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905962483332       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905962490620       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 7.295297e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961360390       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961615459       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961653796       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961677188       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961654618       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961642180       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961645392       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961642828       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905961648739       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905961650681       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+01 is 1.887744e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905961360390       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905961424583       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905961434232       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905961440121       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905961434547       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905961431399       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905961432106       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905961431487       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905961432967       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905961433463       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+01 is 4.761088e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7277e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.124510e-01 1 1  ON 0
   uu_1                 1.449939e-01 1 1  ON 1
   uu_2                 4.327057e-02 1 1  ON 2
   uu_3                -1.941845e-02 1 1  ON 3
   uu_4                -6.556681e-02 1 1  ON 4
   uu_5                -1.008224e-01 1 1  ON 5
   uu_6                -1.285734e-01 1 1  ON 6
   uu_7                -1.425252e-01 1 1  ON 7
   uu_8                -1.353359e-01 1 1  ON 8
   uu_9                -1.040560e-01 1 1  ON 9
   ud_0                 4.473195e-01 1 1  ON 10
   ud_1                 1.817751e-01 1 1  ON 11
   ud_2                 6.162964e-02 1 1  ON 12
   ud_3                -9.170089e-03 1 1  ON 13
   ud_4                -6.620520e-02 1 1  ON 14
   ud_5                -1.077966e-01 1 1  ON 15
   ud_6                -1.350527e-01 1 1  ON 16
   ud_7                -1.516700e-01 1 1  ON 17
   ud_8                -1.527208e-01 1 1  ON 18
   ud_9                -1.408526e-01 1 1  ON 19
   eO_0                -7.512138e-01 1 1  ON 20
   eO_1                -4.308083e-01 1 1  ON 21
   eO_2                -2.034981e-02 1 1  ON 22
   eO_3                 2.922842e-01 1 1  ON 23
   eO_4                 5.175089e-01 1 1  ON 24
   eO_5                 4.796017e-01 1 1  ON 25
   eO_6                 2.530436e-01 1 1  ON 26
   eO_7                -4.494800e-02 1 1  ON 27
   eO_8                -2.170407e-01 1 1  ON 28
   eO_9                -7.824037e-02 1 1  ON 29
  eH1_0                -2.543177e-01 1 1  ON 30
  eH1_1                -1.470503e-01 1 1  ON 31
  eH1_2                -9.762936e-02 1 1  ON 32
  eH1_3                -4.265327e-02 1 1  ON 33
  eH1_4                 6.780870e-03 1 1  ON 34
  eH1_5                 4.190508e-02 1 1  ON 35
  eH1_6                 1.017920e-01 1 1  ON 36
  eH1_7                 1.560043e-01 1 1  ON 37
  eH1_8                 1.755394e-01 1 1  ON 38
  eH1_9                 6.231655e-02 1 1  ON 39
  eH2_0                -2.516003e-01 1 1  ON 40
  eH2_1                -1.444718e-01 1 1  ON 41
  eH2_2                -9.506070e-02 1 1  ON 42
  eH2_3                -3.989982e-02 1 1  ON 43
  eH2_4                 1.006703e-02 1 1  ON 44
  eH2_5                 4.512252e-02 1 1  ON 45
  eH2_6                 1.037527e-01 1 1  ON 46
  eH2_7                 1.568026e-01 1 1  ON 47
  eH2_8                 1.805549e-01 1 1  ON 48
  eH2_9                 5.037764e-02 1 1  ON 49
ci_0001                 7.003443e-01 3 1  ON 50
ci_0002                 7.014971e-01 3 1  ON 51
ci_0003                -2.682308e-02 3 1  ON 52
ci_0004                -2.829510e-02 3 1  ON 53
ci_0005                -3.588762e-02 3 1  ON 54
ci_0006                -3.676140e-02 3 1  ON 55
ci_0007                -2.190415e-02 3 1  ON 56
ci_0008                -2.219392e-02 3 1  ON 57
ci_0009                -1.762636e-02 3 1  ON 58
ci_0010                -1.714494e-02 3 1  ON 59
ci_0011                -1.264309e-02 3 1  ON 60
ci_0012                -1.197735e-02 3 1  ON 61
ci_0013                 1.321467e-02 3 1  ON 62
ci_0014                 1.297594e-02 3 1  ON 63
ci_0015                 1.224107e-02 3 1  ON 64
ci_0016                 1.318022e-02 3 1  ON 65
ci_0017                 1.084302e-02 3 1  ON 66
ci_0018                 1.126520e-02 3 1  ON 67
ci_0019                 1.117329e-02 3 1  ON 68
ci_0020                 1.171531e-02 3 1  ON 69
ci_0021                -4.703779e-04 3 1  ON 70
ci_0022                -3.831972e-04 3 1  ON 71
ci_0023                -1.176729e-02 3 1  ON 72
ci_0024                -1.022712e-02 3 1  ON 73
ci_0025                -9.983500e-03 3 1  ON 74
ci_0026                -1.089215e-02 3 1  ON 75
ci_0027                -1.142308e-02 3 1  ON 76
ci_0028                -1.148154e-02 3 1  ON 77
ci_0029                -1.068408e-02 3 1  ON 78
ci_0030                -1.027038e-02 3 1  ON 79
ci_0031                 2.084170e-02 3 1  ON 80
ci_0032                 2.121100e-02 3 1  ON 81
ci_0033                 8.051287e-03 3 1  ON 82
ci_0034                 1.059754e-02 3 1  ON 83
ci_0035                 6.727250e-03 3 1  ON 84
ci_0036                 6.711340e-03 3 1  ON 85
ci_0037                -1.072777e-02 3 1  ON 86
ci_0038                -1.052404e-02 3 1  ON 87
ci_0039                -2.648254e-03 3 1  ON 88
ci_0040                -2.681895e-03 3 1  ON 89
ci_0041                 6.570916e-03 3 1  ON 90
ci_0042                 6.843366e-03 3 1  ON 91
ci_0043                -1.787169e-02 3 1  ON 92
ci_0044                -1.813559e-02 3 1  ON 93
ci_0045                 6.771962e-03 3 1  ON 94
ci_0046                 8.157547e-03 3 1  ON 95
ci_0047                -1.756220e-03 3 1  ON 96
ci_0048                -1.638309e-03 3 1  ON 97
ci_0049                -4.910849e-03 3 1  ON 98
ci_0050                -5.049127e-03 3 1  ON 99
ci_0051                -3.551919e-03 3 1  ON 100
ci_0052                -3.436886e-03 3 1  ON 101
ci_0053                -4.789388e-03 3 1  ON 102
ci_0054                -4.492266e-03 3 1  ON 103
ci_0055                 7.582641e-03 3 1  ON 104
ci_0056                 7.183402e-03 3 1  ON 105
ci_0057                 4.470875e-03 3 1  ON 106
ci_0058                 5.011437e-03 3 1  ON 107
ci_0059                -4.258050e-03 3 1  ON 108
ci_0060                -4.837318e-03 3 1  ON 109
ci_0061                -2.071117e-03 3 1  ON 110
ci_0062                -3.300795e-03 3 1  ON 111
ci_0063                -1.050877e-02 3 1  ON 112
ci_0064                -8.552421e-03 3 1  ON 113
ci_0065                -5.176976e-03 3 1  ON 114
ci_0066                -5.390993e-03 3 1  ON 115
ci_0067                -4.793905e-03 3 1  ON 116
ci_0068                -5.195553e-03 3 1  ON 117
ci_0069                 5.206306e-03 3 1  ON 118
ci_0070                 4.134101e-03 3 1  ON 119
ci_0071                 2.578224e-04 3 1  ON 120
ci_0072                 3.540370e-04 3 1  ON 121
ci_0073                 4.072886e-03 3 1  ON 122
ci_0074                 4.078290e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.384379
====================================================
  Execution time = 2.1258e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3688e-01
  Total weights = 1.9515e+06
  Execution time = 1.9139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325968954715
                                         uncertainty =       0.002250256766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325968954715
                                         uncertainty =       0.002250256766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403722406
  error estimate for blocks of size 2^( 2) =       0.000416742449
  error estimate for blocks of size 2^( 3) =       0.000430046962
  error estimate for blocks of size 2^( 4) =       0.000442438813
  error estimate for blocks of size 2^( 5) =       0.000453182594
  error estimate for blocks of size 2^( 6) =       0.000460480377
  error estimate for blocks of size 2^( 7) =       0.000466267049

      target function =                  N/A
              le_mean =     -16.906113507108
             les_mean =     286.153561855962
             stat err =       0.000455592208
             autocorr =       1.273464581309
              std dev =       0.570949701805
             le_variance =       0.325983561991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325985425365
                                         uncertainty =       0.002249579857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325985425365
                                         uncertainty =       0.002249579857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403732597
  error estimate for blocks of size 2^( 2) =       0.000416752556
  error estimate for blocks of size 2^( 3) =       0.000430056326
  error estimate for blocks of size 2^( 4) =       0.000442447704
  error estimate for blocks of size 2^( 5) =       0.000453190371
  error estimate for blocks of size 2^( 6) =       0.000460489772
  error estimate for blocks of size 2^( 7) =       0.000466277528

      target function =                  N/A
              le_mean =     -16.906113808112
             les_mean =     286.153565105015
             stat err =       0.000455601344
             autocorr =       1.273451364228
              std dev =       0.570964113780
             le_variance =       0.326000019224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325977398418
                                         uncertainty =       0.002249914341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325977398418
                                         uncertainty =       0.002249914341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403727630
  error estimate for blocks of size 2^( 2) =       0.000416747629
  error estimate for blocks of size 2^( 3) =       0.000430051757
  error estimate for blocks of size 2^( 4) =       0.000442443372
  error estimate for blocks of size 2^( 5) =       0.000453186569
  error estimate for blocks of size 2^( 6) =       0.000460485177
  error estimate for blocks of size 2^( 7) =       0.000466272394

      target function =                  N/A
              le_mean =     -16.906113646675
             les_mean =     286.153559325150
             stat err =       0.000455596878
             autocorr =       1.273457727570
              std dev =       0.570957090501
             le_variance =       0.325991999194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970004118
                                         uncertainty =       0.002250213589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970004118
                                         uncertainty =       0.002250213589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403723055
  error estimate for blocks of size 2^( 2) =       0.000416743093
  error estimate for blocks of size 2^( 3) =       0.000430047557
  error estimate for blocks of size 2^( 4) =       0.000442439379
  error estimate for blocks of size 2^( 5) =       0.000453183085
  error estimate for blocks of size 2^( 6) =       0.000460480971
  error estimate for blocks of size 2^( 7) =       0.000466267711

      target function =                  N/A
              le_mean =     -16.906113522812
             les_mean =     286.153560775357
             stat err =       0.000455592787
             autocorr =       1.273463719086
              std dev =       0.570950620102
             le_variance =       0.325984610595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906113507108        initial
     6.1035e+00     6.1035e+01             7.2953e-05       -16.906113808112  <--
     2.4414e+01     2.4414e+02             1.8877e-05       -16.906113646675
     9.7656e+01     9.7656e+02             4.7611e-06       -16.906113522812

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.0944e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.124675e-01 1 1  ON 0
   uu_1                 1.450049e-01 1 1  ON 1
   uu_2                 4.327217e-02 1 1  ON 2
   uu_3                -1.942665e-02 1 1  ON 3
   uu_4                -6.556952e-02 1 1  ON 4
   uu_5                -1.008337e-01 1 1  ON 5
   uu_6                -1.285808e-01 1 1  ON 6
   uu_7                -1.425213e-01 1 1  ON 7
   uu_8                -1.353369e-01 1 1  ON 8
   uu_9                -1.040736e-01 1 1  ON 9
   ud_0                 4.473468e-01 1 1  ON 10
   ud_1                 1.817844e-01 1 1  ON 11
   ud_2                 6.164414e-02 1 1  ON 12
   ud_3                -9.171343e-03 1 1  ON 13
   ud_4                -6.619945e-02 1 1  ON 14
   ud_5                -1.077865e-01 1 1  ON 15
   ud_6                -1.350592e-01 1 1  ON 16
   ud_7                -1.516862e-01 1 1  ON 17
   ud_8                -1.527421e-01 1 1  ON 18
   ud_9                -1.408672e-01 1 1  ON 19
   eO_0                -7.511997e-01 1 1  ON 20
   eO_1                -4.308147e-01 1 1  ON 21
   eO_2                -2.034607e-02 1 1  ON 22
   eO_3                 2.922783e-01 1 1  ON 23
   eO_4                 5.175193e-01 1 1  ON 24
   eO_5                 4.796102e-01 1 1  ON 25
   eO_6                 2.530553e-01 1 1  ON 26
   eO_7                -4.494488e-02 1 1  ON 27
   eO_8                -2.170598e-01 1 1  ON 28
   eO_9                -7.825761e-02 1 1  ON 29
  eH1_0                -2.543198e-01 1 1  ON 30
  eH1_1                -1.470587e-01 1 1  ON 31
  eH1_2                -9.764522e-02 1 1  ON 32
  eH1_3                -4.266074e-02 1 1  ON 33
  eH1_4                 6.781215e-03 1 1  ON 34
  eH1_5                 4.191058e-02 1 1  ON 35
  eH1_6                 1.017799e-01 1 1  ON 36
  eH1_7                 1.560017e-01 1 1  ON 37
  eH1_8                 1.755538e-01 1 1  ON 38
  eH1_9                 6.233862e-02 1 1  ON 39
  eH2_0                -2.516185e-01 1 1  ON 40
  eH2_1                -1.444964e-01 1 1  ON 41
  eH2_2                -9.506809e-02 1 1  ON 42
  eH2_3                -3.990283e-02 1 1  ON 43
  eH2_4                 1.005546e-02 1 1  ON 44
  eH2_5                 4.512402e-02 1 1  ON 45
  eH2_6                 1.037566e-01 1 1  ON 46
  eH2_7                 1.568131e-01 1 1  ON 47
  eH2_8                 1.805782e-01 1 1  ON 48
  eH2_9                 5.040320e-02 1 1  ON 49
ci_0001                 7.003504e-01 3 1  ON 50
ci_0002                 7.014910e-01 3 1  ON 51
ci_0003                -2.682901e-02 3 1  ON 52
ci_0004                -2.824545e-02 3 1  ON 53
ci_0005                -3.589187e-02 3 1  ON 54
ci_0006                -3.678284e-02 3 1  ON 55
ci_0007                -2.190851e-02 3 1  ON 56
ci_0008                -2.219283e-02 3 1  ON 57
ci_0009                -1.762817e-02 3 1  ON 58
ci_0010                -1.713110e-02 3 1  ON 59
ci_0011                -1.264773e-02 3 1  ON 60
ci_0012                -1.197838e-02 3 1  ON 61
ci_0013                 1.322008e-02 3 1  ON 62
ci_0014                 1.295607e-02 3 1  ON 63
ci_0015                 1.227179e-02 3 1  ON 64
ci_0016                 1.319760e-02 3 1  ON 65
ci_0017                 1.086929e-02 3 1  ON 66
ci_0018                 1.126483e-02 3 1  ON 67
ci_0019                 1.118049e-02 3 1  ON 68
ci_0020                 1.170451e-02 3 1  ON 69
ci_0021                -4.766375e-04 3 1  ON 70
ci_0022                -4.075098e-04 3 1  ON 71
ci_0023                -1.174640e-02 3 1  ON 72
ci_0024                -1.023894e-02 3 1  ON 73
ci_0025                -9.995955e-03 3 1  ON 74
ci_0026                -1.088550e-02 3 1  ON 75
ci_0027                -1.141323e-02 3 1  ON 76
ci_0028                -1.146637e-02 3 1  ON 77
ci_0029                -1.068760e-02 3 1  ON 78
ci_0030                -1.027873e-02 3 1  ON 79
ci_0031                 2.083048e-02 3 1  ON 80
ci_0032                 2.122314e-02 3 1  ON 81
ci_0033                 8.055507e-03 3 1  ON 82
ci_0034                 1.059074e-02 3 1  ON 83
ci_0035                 6.719704e-03 3 1  ON 84
ci_0036                 6.725317e-03 3 1  ON 85
ci_0037                -1.069635e-02 3 1  ON 86
ci_0038                -1.052176e-02 3 1  ON 87
ci_0039                -2.648799e-03 3 1  ON 88
ci_0040                -2.670169e-03 3 1  ON 89
ci_0041                 6.584412e-03 3 1  ON 90
ci_0042                 6.874969e-03 3 1  ON 91
ci_0043                -1.788175e-02 3 1  ON 92
ci_0044                -1.815088e-02 3 1  ON 93
ci_0045                 6.789747e-03 3 1  ON 94
ci_0046                 8.133939e-03 3 1  ON 95
ci_0047                -1.751789e-03 3 1  ON 96
ci_0048                -1.630914e-03 3 1  ON 97
ci_0049                -4.929324e-03 3 1  ON 98
ci_0050                -5.055810e-03 3 1  ON 99
ci_0051                -3.552911e-03 3 1  ON 100
ci_0052                -3.419924e-03 3 1  ON 101
ci_0053                -4.771671e-03 3 1  ON 102
ci_0054                -4.482475e-03 3 1  ON 103
ci_0055                 7.574312e-03 3 1  ON 104
ci_0056                 7.178033e-03 3 1  ON 105
ci_0057                 4.490608e-03 3 1  ON 106
ci_0058                 4.991999e-03 3 1  ON 107
ci_0059                -4.271141e-03 3 1  ON 108
ci_0060                -4.838179e-03 3 1  ON 109
ci_0061                -2.083780e-03 3 1  ON 110
ci_0062                -3.332049e-03 3 1  ON 111
ci_0063                -1.045470e-02 3 1  ON 112
ci_0064                -8.561488e-03 3 1  ON 113
ci_0065                -5.174357e-03 3 1  ON 114
ci_0066                -5.395669e-03 3 1  ON 115
ci_0067                -4.806672e-03 3 1  ON 116
ci_0068                -5.206328e-03 3 1  ON 117
ci_0069                 5.179299e-03 3 1  ON 118
ci_0070                 4.127389e-03 3 1  ON 119
ci_0071                 2.669315e-04 3 1  ON 120
ci_0072                 3.621385e-04 3 1  ON 121
ci_0073                 4.081364e-03 3 1  ON 122
ci_0074                 4.092900e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8236e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.906
    reference variance = 0.337161
====================================================
  Execution time = 2.1515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5219e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3300e-01
  Total weights = 1.951919131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320233924421
                                         uncertainty =       0.002033948326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320233924421
                                         uncertainty =       0.002033948326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400146107
  error estimate for blocks of size 2^( 2) =       0.000412961752
  error estimate for blocks of size 2^( 3) =       0.000425634899
  error estimate for blocks of size 2^( 4) =       0.000438072176
  error estimate for blocks of size 2^( 5) =       0.000448221637
  error estimate for blocks of size 2^( 6) =       0.000455850270
  error estimate for blocks of size 2^( 7) =       0.000458669522

      target function =                  N/A
              le_mean =     -16.906618024167
             les_mean =     286.166731116227
             stat err =       0.000450203401
             autocorr =       1.265844478867
              std dev =       0.565892051299
             le_variance =       0.320233813724


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661802417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618024149       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906625712052       residual = 5.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906624670950       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906624493550       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906624744299       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906624297752       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906624636531       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906624618525       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906624652390       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906624689779       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.653288e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618024149       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906620141294       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906619854483       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906619823354       residual = 9.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906619888012       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906619779250       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906619840606       residual = 9.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906619842248       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906619853323       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906619860790       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 7.532418e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906618024149       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906618567222       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906618493677       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906618486934       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906618503216       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906618476848       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906618490409       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906618490713       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906618493854       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+01 is 1.953717e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7742e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.124570e-01 1 1  ON 0
   uu_1                 1.450106e-01 1 1  ON 1
   uu_2                 4.327747e-02 1 1  ON 2
   uu_3                -1.942153e-02 1 1  ON 3
   uu_4                -6.556423e-02 1 1  ON 4
   uu_5                -1.008318e-01 1 1  ON 5
   uu_6                -1.285901e-01 1 1  ON 6
   uu_7                -1.425235e-01 1 1  ON 7
   uu_8                -1.353429e-01 1 1  ON 8
   uu_9                -1.040921e-01 1 1  ON 9
   ud_0                 4.473653e-01 1 1  ON 10
   ud_1                 1.817990e-01 1 1  ON 11
   ud_2                 6.165993e-02 1 1  ON 12
   ud_3                -9.175182e-03 1 1  ON 13
   ud_4                -6.618200e-02 1 1  ON 14
   ud_5                -1.077926e-01 1 1  ON 15
   ud_6                -1.350605e-01 1 1  ON 16
   ud_7                -1.516964e-01 1 1  ON 17
   ud_8                -1.527550e-01 1 1  ON 18
   ud_9                -1.408838e-01 1 1  ON 19
   eO_0                -7.511885e-01 1 1  ON 20
   eO_1                -4.308168e-01 1 1  ON 21
   eO_2                -2.033950e-02 1 1  ON 22
   eO_3                 2.922910e-01 1 1  ON 23
   eO_4                 5.175157e-01 1 1  ON 24
   eO_5                 4.796125e-01 1 1  ON 25
   eO_6                 2.530705e-01 1 1  ON 26
   eO_7                -4.493941e-02 1 1  ON 27
   eO_8                -2.170821e-01 1 1  ON 28
   eO_9                -7.827943e-02 1 1  ON 29
  eH1_0                -2.543141e-01 1 1  ON 30
  eH1_1                -1.470656e-01 1 1  ON 31
  eH1_2                -9.766519e-02 1 1  ON 32
  eH1_3                -4.265013e-02 1 1  ON 33
  eH1_4                 6.779541e-03 1 1  ON 34
  eH1_5                 4.189660e-02 1 1  ON 35
  eH1_6                 1.017479e-01 1 1  ON 36
  eH1_7                 1.560027e-01 1 1  ON 37
  eH1_8                 1.755801e-01 1 1  ON 38
  eH1_9                 6.236930e-02 1 1  ON 39
  eH2_0                -2.516332e-01 1 1  ON 40
  eH2_1                -1.445123e-01 1 1  ON 41
  eH2_2                -9.507375e-02 1 1  ON 42
  eH2_3                -3.989846e-02 1 1  ON 43
  eH2_4                 1.003469e-02 1 1  ON 44
  eH2_5                 4.511432e-02 1 1  ON 45
  eH2_6                 1.037563e-01 1 1  ON 46
  eH2_7                 1.568261e-01 1 1  ON 47
  eH2_8                 1.805961e-01 1 1  ON 48
  eH2_9                 5.043251e-02 1 1  ON 49
ci_0001                 7.003446e-01 3 1  ON 50
ci_0002                 7.015006e-01 3 1  ON 51
ci_0003                -2.683622e-02 3 1  ON 52
ci_0004                -2.820348e-02 3 1  ON 53
ci_0005                -3.589253e-02 3 1  ON 54
ci_0006                -3.676249e-02 3 1  ON 55
ci_0007                -2.188981e-02 3 1  ON 56
ci_0008                -2.218679e-02 3 1  ON 57
ci_0009                -1.762689e-02 3 1  ON 58
ci_0010                -1.713058e-02 3 1  ON 59
ci_0011                -1.259749e-02 3 1  ON 60
ci_0012                -1.198946e-02 3 1  ON 61
ci_0013                 1.320819e-02 3 1  ON 62
ci_0014                 1.296048e-02 3 1  ON 63
ci_0015                 1.230398e-02 3 1  ON 64
ci_0016                 1.318115e-02 3 1  ON 65
ci_0017                 1.089610e-02 3 1  ON 66
ci_0018                 1.129625e-02 3 1  ON 67
ci_0019                 1.118144e-02 3 1  ON 68
ci_0020                 1.172463e-02 3 1  ON 69
ci_0021                -4.676386e-04 3 1  ON 70
ci_0022                -4.265304e-04 3 1  ON 71
ci_0023                -1.172473e-02 3 1  ON 72
ci_0024                -1.025225e-02 3 1  ON 73
ci_0025                -1.002908e-02 3 1  ON 74
ci_0026                -1.090629e-02 3 1  ON 75
ci_0027                -1.140377e-02 3 1  ON 76
ci_0028                -1.144264e-02 3 1  ON 77
ci_0029                -1.068889e-02 3 1  ON 78
ci_0030                -1.031311e-02 3 1  ON 79
ci_0031                 2.081348e-02 3 1  ON 80
ci_0032                 2.124054e-02 3 1  ON 81
ci_0033                 8.068045e-03 3 1  ON 82
ci_0034                 1.054881e-02 3 1  ON 83
ci_0035                 6.764939e-03 3 1  ON 84
ci_0036                 6.721131e-03 3 1  ON 85
ci_0037                -1.065219e-02 3 1  ON 86
ci_0038                -1.057135e-02 3 1  ON 87
ci_0039                -2.700460e-03 3 1  ON 88
ci_0040                -2.686591e-03 3 1  ON 89
ci_0041                 6.596608e-03 3 1  ON 90
ci_0042                 6.863656e-03 3 1  ON 91
ci_0043                -1.788492e-02 3 1  ON 92
ci_0044                -1.813902e-02 3 1  ON 93
ci_0045                 6.810866e-03 3 1  ON 94
ci_0046                 8.093213e-03 3 1  ON 95
ci_0047                -1.802546e-03 3 1  ON 96
ci_0048                -1.624519e-03 3 1  ON 97
ci_0049                -4.922537e-03 3 1  ON 98
ci_0050                -5.110749e-03 3 1  ON 99
ci_0051                -3.545720e-03 3 1  ON 100
ci_0052                -3.434511e-03 3 1  ON 101
ci_0053                -4.740592e-03 3 1  ON 102
ci_0054                -4.511235e-03 3 1  ON 103
ci_0055                 7.526263e-03 3 1  ON 104
ci_0056                 7.182392e-03 3 1  ON 105
ci_0057                 4.462300e-03 3 1  ON 106
ci_0058                 5.008457e-03 3 1  ON 107
ci_0059                -4.270026e-03 3 1  ON 108
ci_0060                -4.826587e-03 3 1  ON 109
ci_0061                -2.112541e-03 3 1  ON 110
ci_0062                -3.328127e-03 3 1  ON 111
ci_0063                -1.037937e-02 3 1  ON 112
ci_0064                -8.569662e-03 3 1  ON 113
ci_0065                -5.177225e-03 3 1  ON 114
ci_0066                -5.388668e-03 3 1  ON 115
ci_0067                -4.801764e-03 3 1  ON 116
ci_0068                -5.181428e-03 3 1  ON 117
ci_0069                 5.133937e-03 3 1  ON 118
ci_0070                 4.128152e-03 3 1  ON 119
ci_0071                 2.813955e-04 3 1  ON 120
ci_0072                 3.683618e-04 3 1  ON 121
ci_0073                 4.112198e-03 3 1  ON 122
ci_0074                 4.096975e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.952
    reference variance = 0.318972
====================================================
  Execution time = 2.1261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4165e-01
  Total weights = 1.9520e+06
  Execution time = 1.9227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324846386239
                                         uncertainty =       0.002316481349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324846386239
                                         uncertainty =       0.002316481349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403016531
  error estimate for blocks of size 2^( 2) =       0.000416066968
  error estimate for blocks of size 2^( 3) =       0.000429156344
  error estimate for blocks of size 2^( 4) =       0.000441230726
  error estimate for blocks of size 2^( 5) =       0.000451879839
  error estimate for blocks of size 2^( 6) =       0.000459820242
  error estimate for blocks of size 2^( 7) =       0.000464470189

      target function =                  N/A
              le_mean =     -16.906114501226
             les_mean =     286.172729846664
             stat err =       0.000454350249
             autocorr =       1.270971522148
              std dev =       0.569951443977
             le_variance =       0.324844648492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324905087017
                                         uncertainty =       0.002315521982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324905087017
                                         uncertainty =       0.002315521982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403052803
  error estimate for blocks of size 2^( 2) =       0.000416105541
  error estimate for blocks of size 2^( 3) =       0.000429192420
  error estimate for blocks of size 2^( 4) =       0.000441265549
  error estimate for blocks of size 2^( 5) =       0.000451919706
  error estimate for blocks of size 2^( 6) =       0.000459865645
  error estimate for blocks of size 2^( 7) =       0.000464529957

      target function =                  N/A
              le_mean =     -16.906115154702
             les_mean =     286.160350431656
             stat err =       0.000454395214
             autocorr =       1.270994304619
              std dev =       0.570002740872
             le_variance =       0.324903124602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324874888342
                                         uncertainty =       0.002315859049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324874888342
                                         uncertainty =       0.002315859049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403034134
  error estimate for blocks of size 2^( 2) =       0.000416085833
  error estimate for blocks of size 2^( 3) =       0.000429173550
  error estimate for blocks of size 2^( 4) =       0.000441247085
  error estimate for blocks of size 2^( 5) =       0.000451899097
  error estimate for blocks of size 2^( 6) =       0.000459842061
  error estimate for blocks of size 2^( 7) =       0.000464497934

      target function =                  N/A
              le_mean =     -16.906114332631
             les_mean =     286.158637499094
             stat err =       0.000454371544
             autocorr =       1.270979634026
              std dev =       0.569976338211
             le_variance =       0.324873026120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849597276
                                         uncertainty =       0.002316387896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849597276
                                         uncertainty =       0.002316387896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403018513
  error estimate for blocks of size 2^( 2) =       0.000416068737
  error estimate for blocks of size 2^( 3) =       0.000429157073
  error estimate for blocks of size 2^( 4) =       0.000441230771
  error estimate for blocks of size 2^( 5) =       0.000451879815
  error estimate for blocks of size 2^( 6) =       0.000459820858
  error estimate for blocks of size 2^( 7) =       0.000464472684

      target function =                  N/A
              le_mean =     -16.906114116241
             les_mean =     286.158819125284
             stat err =       0.000454351032
             autocorr =       1.270963403492
              std dev =       0.569954246863
             le_variance =       0.324847843517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906114501226        initial
     1.5259e+00     1.5259e+01             2.6533e-04       -16.906115154702  <--
     6.1035e+00     6.1035e+01             7.5324e-05       -16.906114332631
     2.4414e+01     2.4414e+02             1.9537e-05       -16.906114116241

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 3.0988e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8753e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.17588
====================================================
  Execution time = 2.1296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3938e-01
  Total weights = 1.951338672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673379824
                                         uncertainty =       0.002494545634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673379824
                                         uncertainty =       0.002494545634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403618722
  error estimate for blocks of size 2^( 2) =       0.000416732980
  error estimate for blocks of size 2^( 3) =       0.000430406448
  error estimate for blocks of size 2^( 4) =       0.000443950821
  error estimate for blocks of size 2^( 5) =       0.000454519547
  error estimate for blocks of size 2^( 6) =       0.000462928611
  error estimate for blocks of size 2^( 7) =       0.000469042703

      target function =                  N/A
              le_mean =     -16.906521172588
             les_mean =     286.169833470828
             stat err =       0.000457610421
             autocorr =       1.285432289002
              std dev =       0.570803071063
             le_variance =       0.325816145935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652117259e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521172589       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536280466       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536757425       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906535779165       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906535506101       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906535105006       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906535685285       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906535556696       residual = 8.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906535506422       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906535591501       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906535700831       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e-01 is 8.247317e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521172589       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526356345       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526515516       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526180122       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526063066       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906525867372       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526086215       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526157010       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906526123993       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906526093165       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+00 is 2.522733e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906521172589       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906522601590       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906522647386       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906522562113       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906522521353       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906522452844       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906522510267       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906522540995       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906522542452       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906522529141       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+00 is 6.902849e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7381e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.125066e-01 1 1  ON 0
   uu_1                 1.450593e-01 1 1  ON 1
   uu_2                 4.326352e-02 1 1  ON 2
   uu_3                -1.939653e-02 1 1  ON 3
   uu_4                -6.557859e-02 1 1  ON 4
   uu_5                -1.008411e-01 1 1  ON 5
   uu_6                -1.286617e-01 1 1  ON 6
   uu_7                -1.425308e-01 1 1  ON 7
   uu_8                -1.353956e-01 1 1  ON 8
   uu_9                -1.042201e-01 1 1  ON 9
   ud_0                 4.474402e-01 1 1  ON 10
   ud_1                 1.819125e-01 1 1  ON 11
   ud_2                 6.174313e-02 1 1  ON 12
   ud_3                -9.111799e-03 1 1  ON 13
   ud_4                -6.618274e-02 1 1  ON 14
   ud_5                -1.077716e-01 1 1  ON 15
   ud_6                -1.350796e-01 1 1  ON 16
   ud_7                -1.517862e-01 1 1  ON 17
   ud_8                -1.527759e-01 1 1  ON 18
   ud_9                -1.409643e-01 1 1  ON 19
   eO_0                -7.511235e-01 1 1  ON 20
   eO_1                -4.308082e-01 1 1  ON 21
   eO_2                -2.035185e-02 1 1  ON 22
   eO_3                 2.923099e-01 1 1  ON 23
   eO_4                 5.176023e-01 1 1  ON 24
   eO_5                 4.796561e-01 1 1  ON 25
   eO_6                 2.531522e-01 1 1  ON 26
   eO_7                -4.488768e-02 1 1  ON 27
   eO_8                -2.172295e-01 1 1  ON 28
   eO_9                -7.844563e-02 1 1  ON 29
  eH1_0                -2.542613e-01 1 1  ON 30
  eH1_1                -1.472046e-01 1 1  ON 31
  eH1_2                -9.777594e-02 1 1  ON 32
  eH1_3                -4.271521e-02 1 1  ON 33
  eH1_4                 6.798670e-03 1 1  ON 34
  eH1_5                 4.188005e-02 1 1  ON 35
  eH1_6                 1.016516e-01 1 1  ON 36
  eH1_7                 1.559835e-01 1 1  ON 37
  eH1_8                 1.757512e-01 1 1  ON 38
  eH1_9                 6.258225e-02 1 1  ON 39
  eH2_0                -2.516660e-01 1 1  ON 40
  eH2_1                -1.445904e-01 1 1  ON 41
  eH2_2                -9.518888e-02 1 1  ON 42
  eH2_3                -3.991627e-02 1 1  ON 43
  eH2_4                 9.906369e-03 1 1  ON 44
  eH2_5                 4.514768e-02 1 1  ON 45
  eH2_6                 1.036960e-01 1 1  ON 46
  eH2_7                 1.568393e-01 1 1  ON 47
  eH2_8                 1.807464e-01 1 1  ON 48
  eH2_9                 5.066334e-02 1 1  ON 49
ci_0001                 7.003303e-01 3 1  ON 50
ci_0002                 7.015077e-01 3 1  ON 51
ci_0003                -2.693475e-02 3 1  ON 52
ci_0004                -2.794812e-02 3 1  ON 53
ci_0005                -3.598041e-02 3 1  ON 54
ci_0006                -3.666214e-02 3 1  ON 55
ci_0007                -2.182920e-02 3 1  ON 56
ci_0008                -2.234991e-02 3 1  ON 57
ci_0009                -1.766156e-02 3 1  ON 58
ci_0010                -1.723210e-02 3 1  ON 59
ci_0011                -1.236635e-02 3 1  ON 60
ci_0012                -1.207075e-02 3 1  ON 61
ci_0013                 1.315964e-02 3 1  ON 62
ci_0014                 1.295402e-02 3 1  ON 63
ci_0015                 1.252158e-02 3 1  ON 64
ci_0016                 1.317821e-02 3 1  ON 65
ci_0017                 1.102687e-02 3 1  ON 66
ci_0018                 1.143105e-02 3 1  ON 67
ci_0019                 1.116768e-02 3 1  ON 68
ci_0020                 1.165465e-02 3 1  ON 69
ci_0021                -5.777247e-04 3 1  ON 70
ci_0022                -5.400968e-04 3 1  ON 71
ci_0023                -1.165160e-02 3 1  ON 72
ci_0024                -1.043700e-02 3 1  ON 73
ci_0025                -1.023336e-02 3 1  ON 74
ci_0026                -1.090205e-02 3 1  ON 75
ci_0027                -1.135103e-02 3 1  ON 76
ci_0028                -1.137776e-02 3 1  ON 77
ci_0029                -1.073514e-02 3 1  ON 78
ci_0030                -1.042862e-02 3 1  ON 79
ci_0031                 2.082020e-02 3 1  ON 80
ci_0032                 2.127104e-02 3 1  ON 81
ci_0033                 8.352686e-03 3 1  ON 82
ci_0034                 1.046587e-02 3 1  ON 83
ci_0035                 6.779522e-03 3 1  ON 84
ci_0036                 6.842507e-03 3 1  ON 85
ci_0037                -1.067106e-02 3 1  ON 86
ci_0038                -1.063388e-02 3 1  ON 87
ci_0039                -2.730252e-03 3 1  ON 88
ci_0040                -2.678078e-03 3 1  ON 89
ci_0041                 6.654469e-03 3 1  ON 90
ci_0042                 6.910431e-03 3 1  ON 91
ci_0043                -1.787834e-02 3 1  ON 92
ci_0044                -1.813939e-02 3 1  ON 93
ci_0045                 6.819444e-03 3 1  ON 94
ci_0046                 7.914171e-03 3 1  ON 95
ci_0047                -1.971502e-03 3 1  ON 96
ci_0048                -1.647394e-03 3 1  ON 97
ci_0049                -4.875754e-03 3 1  ON 98
ci_0050                -5.402370e-03 3 1  ON 99
ci_0051                -3.501620e-03 3 1  ON 100
ci_0052                -3.495626e-03 3 1  ON 101
ci_0053                -4.711389e-03 3 1  ON 102
ci_0054                -4.515886e-03 3 1  ON 103
ci_0055                 7.304293e-03 3 1  ON 104
ci_0056                 7.121257e-03 3 1  ON 105
ci_0057                 4.472532e-03 3 1  ON 106
ci_0058                 5.050735e-03 3 1  ON 107
ci_0059                -4.333182e-03 3 1  ON 108
ci_0060                -4.940802e-03 3 1  ON 109
ci_0061                -2.441125e-03 3 1  ON 110
ci_0062                -3.280487e-03 3 1  ON 111
ci_0063                -9.984261e-03 3 1  ON 112
ci_0064                -8.649786e-03 3 1  ON 113
ci_0065                -5.221291e-03 3 1  ON 114
ci_0066                -5.459379e-03 3 1  ON 115
ci_0067                -4.762692e-03 3 1  ON 116
ci_0068                -5.036122e-03 3 1  ON 117
ci_0069                 4.815423e-03 3 1  ON 118
ci_0070                 4.145131e-03 3 1  ON 119
ci_0071                 4.893552e-04 3 1  ON 120
ci_0072                 4.033996e-04 3 1  ON 121
ci_0073                 4.281008e-03 3 1  ON 122
ci_0074                 4.173217e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.817
    reference variance = 0.386716
====================================================
  Execution time = 2.1015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3286e-01
  Total weights = 1.9518e+06
  Execution time = 1.9058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321648163516
                                         uncertainty =       0.002499760179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321648163516
                                         uncertainty =       0.002499760179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401117393
  error estimate for blocks of size 2^( 2) =       0.000414011107
  error estimate for blocks of size 2^( 3) =       0.000427219151
  error estimate for blocks of size 2^( 4) =       0.000439322199
  error estimate for blocks of size 2^( 5) =       0.000450358833
  error estimate for blocks of size 2^( 6) =       0.000458176036
  error estimate for blocks of size 2^( 7) =       0.000463564696

      target function =                  N/A
              le_mean =     -16.906314375624
             les_mean =     286.156367459616
             stat err =       0.000452855441
             autocorr =       1.274606683882
              std dev =       0.567265657781
             le_variance =       0.321790326498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327353742397
                                         uncertainty =       0.006421304789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327353742397
                                         uncertainty =       0.006421304789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404661821
  error estimate for blocks of size 2^( 2) =       0.000417418726
  error estimate for blocks of size 2^( 3) =       0.000430511540
  error estimate for blocks of size 2^( 4) =       0.000442483346
  error estimate for blocks of size 2^( 5) =       0.000453440728
  error estimate for blocks of size 2^( 6) =       0.000461220238
  error estimate for blocks of size 2^( 7) =       0.000466664442

      target function =                  N/A
              le_mean =     -16.906259222984
             les_mean =     326.068254783621
             stat err =       0.000455952189
             autocorr =       1.269562674455
              std dev =       0.572278236009
             le_variance =       0.327502379410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321698918607
                                         uncertainty =       0.002514095556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321698918607
                                         uncertainty =       0.002514095556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401149613
  error estimate for blocks of size 2^( 2) =       0.000414038735
  error estimate for blocks of size 2^( 3) =       0.000427239713
  error estimate for blocks of size 2^( 4) =       0.000439351465
  error estimate for blocks of size 2^( 5) =       0.000450387223
  error estimate for blocks of size 2^( 6) =       0.000458220387
  error estimate for blocks of size 2^( 7) =       0.000463633534

      target function =                  N/A
              le_mean =     -16.906308218253
             les_mean =     286.176472076787
             stat err =       0.000452898152
             autocorr =       1.274642346655
              std dev =       0.567311223107
             le_variance =       0.321842023864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321648223855
                                         uncertainty =       0.002501593124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321648223855
                                         uncertainty =       0.002501593124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401117526
  error estimate for blocks of size 2^( 2) =       0.000414010557
  error estimate for blocks of size 2^( 3) =       0.000427217498
  error estimate for blocks of size 2^( 4) =       0.000439322041
  error estimate for blocks of size 2^( 5) =       0.000450357958
  error estimate for blocks of size 2^( 6) =       0.000458176319
  error estimate for blocks of size 2^( 7) =       0.000463568385

      target function =                  N/A
              le_mean =     -16.906313291079
             les_mean =     286.156345496318
             stat err =       0.000452856176
             autocorr =       1.274609978710
              std dev =       0.567265844930
             le_variance =       0.321790538825


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906314375624        initial  <--
     3.8147e-01     3.8147e+00             8.2473e-04       -16.906259222984
     1.5259e+00     1.5259e+01             2.5227e-04       -16.906308218253
     6.1035e+00     6.1035e+01             6.9028e-05       -16.906313291079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6539
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9898
    reference variance = 0.417792
====================================================
  Execution time = 2.1194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5210e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3487e-01
  Total weights = 1.951938135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321698046048
                                         uncertainty =       0.002286016746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321698046048
                                         uncertainty =       0.002286016746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401138391
  error estimate for blocks of size 2^( 2) =       0.000413665594
  error estimate for blocks of size 2^( 3) =       0.000426794390
  error estimate for blocks of size 2^( 4) =       0.000438279330
  error estimate for blocks of size 2^( 5) =       0.000447557148
  error estimate for blocks of size 2^( 6) =       0.000455090959
  error estimate for blocks of size 2^( 7) =       0.000459252064

      target function =                  N/A
              le_mean =     -16.906272714512
             les_mean =     286.156927518840
             stat err =       0.000450044875
             autocorr =       1.258702762018
              std dev =       0.567295352941
             le_variance =       0.321824017469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627271451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272714518       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273713123       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274267102       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274454368       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274318207       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274308377       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274286812       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274235176       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906274264648       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906274318703       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+00 is 1.295430e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272714518       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272975415       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273117614       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273164103       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906273128048       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906273124029       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906273118647       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906273103820       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906273109981       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906273123843       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+01 is 3.418087e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906272714518       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272780485       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272816278       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272827862       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906272818700       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906272817584       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906272816239       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272812413       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906272813853       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906272817333       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+01 is 8.665426e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7293e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.124335e-01 1 1  ON 0
   uu_1                 1.450357e-01 1 1  ON 1
   uu_2                 4.328591e-02 1 1  ON 2
   uu_3                -1.941368e-02 1 1  ON 3
   uu_4                -6.554497e-02 1 1  ON 4
   uu_5                -1.008280e-01 1 1  ON 5
   uu_6                -1.286236e-01 1 1  ON 6
   uu_7                -1.425344e-01 1 1  ON 7
   uu_8                -1.353619e-01 1 1  ON 8
   uu_9                -1.041498e-01 1 1  ON 9
   ud_0                 4.474310e-01 1 1  ON 10
   ud_1                 1.818421e-01 1 1  ON 11
   ud_2                 6.170328e-02 1 1  ON 12
   ud_3                -9.178061e-03 1 1  ON 13
   ud_4                -6.613902e-02 1 1  ON 14
   ud_5                -1.078026e-01 1 1  ON 15
   ud_6                -1.350729e-01 1 1  ON 16
   ud_7                -1.517313e-01 1 1  ON 17
   ud_8                -1.527932e-01 1 1  ON 18
   ud_9                -1.409351e-01 1 1  ON 19
   eO_0                -7.511575e-01 1 1  ON 20
   eO_1                -4.308233e-01 1 1  ON 21
   eO_2                -2.031356e-02 1 1  ON 22
   eO_3                 2.923235e-01 1 1  ON 23
   eO_4                 5.175108e-01 1 1  ON 24
   eO_5                 4.796263e-01 1 1  ON 25
   eO_6                 2.531200e-01 1 1  ON 26
   eO_7                -4.492286e-02 1 1  ON 27
   eO_8                -2.171548e-01 1 1  ON 28
   eO_9                -7.835185e-02 1 1  ON 29
  eH1_0                -2.542982e-01 1 1  ON 30
  eH1_1                -1.470852e-01 1 1  ON 31
  eH1_2                -9.772915e-02 1 1  ON 32
  eH1_3                -4.263312e-02 1 1  ON 33
  eH1_4                 6.769826e-03 1 1  ON 34
  eH1_5                 4.185351e-02 1 1  ON 35
  eH1_6                 1.016533e-01 1 1  ON 36
  eH1_7                 1.560091e-01 1 1  ON 37
  eH1_8                 1.756679e-01 1 1  ON 38
  eH1_9                 6.247131e-02 1 1  ON 39
  eH2_0                -2.516709e-01 1 1  ON 40
  eH2_1                -1.445667e-01 1 1  ON 41
  eH2_2                -9.510318e-02 1 1  ON 42
  eH2_3                -3.988774e-02 1 1  ON 43
  eH2_4                 9.967672e-03 1 1  ON 44
  eH2_5                 4.507883e-02 1 1  ON 45
  eH2_6                 1.037508e-01 1 1  ON 46
  eH2_7                 1.568648e-01 1 1  ON 47
  eH2_8                 1.806594e-01 1 1  ON 48
  eH2_9                 5.053852e-02 1 1  ON 49
ci_0001                 7.003250e-01 3 1  ON 50
ci_0002                 7.015304e-01 3 1  ON 51
ci_0003                -2.686472e-02 3 1  ON 52
ci_0004                -2.808090e-02 3 1  ON 53
ci_0005                -3.590080e-02 3 1  ON 54
ci_0006                -3.670060e-02 3 1  ON 55
ci_0007                -2.182752e-02 3 1  ON 56
ci_0008                -2.217292e-02 3 1  ON 57
ci_0009                -1.761355e-02 3 1  ON 58
ci_0010                -1.713313e-02 3 1  ON 59
ci_0011                -1.246545e-02 3 1  ON 60
ci_0012                -1.201875e-02 3 1  ON 61
ci_0013                 1.317778e-02 3 1  ON 62
ci_0014                 1.298394e-02 3 1  ON 63
ci_0015                 1.239977e-02 3 1  ON 64
ci_0016                 1.314128e-02 3 1  ON 65
ci_0017                 1.097052e-02 3 1  ON 66
ci_0018                 1.137062e-02 3 1  ON 67
ci_0019                 1.118436e-02 3 1  ON 68
ci_0020                 1.176319e-02 3 1  ON 69
ci_0021                -4.426548e-04 3 1  ON 70
ci_0022                -4.880316e-04 3 1  ON 71
ci_0023                -1.165502e-02 3 1  ON 72
ci_0024                -1.030265e-02 3 1  ON 73
ci_0025                -1.011374e-02 3 1  ON 74
ci_0026                -1.094956e-02 3 1  ON 75
ci_0027                -1.138342e-02 3 1  ON 76
ci_0028                -1.137065e-02 3 1  ON 77
ci_0029                -1.068075e-02 3 1  ON 78
ci_0030                -1.041227e-02 3 1  ON 79
ci_0031                 2.077431e-02 3 1  ON 80
ci_0032                 2.127741e-02 3 1  ON 81
ci_0033                 8.121240e-03 3 1  ON 82
ci_0034                 1.043702e-02 3 1  ON 83
ci_0035                 6.879873e-03 3 1  ON 84
ci_0036                 6.708615e-03 3 1  ON 85
ci_0037                -1.053865e-02 3 1  ON 86
ci_0038                -1.072254e-02 3 1  ON 87
ci_0039                -2.821697e-03 3 1  ON 88
ci_0040                -2.718703e-03 3 1  ON 89
ci_0041                 6.635997e-03 3 1  ON 90
ci_0042                 6.852072e-03 3 1  ON 91
ci_0043                -1.789685e-02 3 1  ON 92
ci_0044                -1.810451e-02 3 1  ON 93
ci_0045                 6.871789e-03 3 1  ON 94
ci_0046                 7.975710e-03 3 1  ON 95
ci_0047                -1.928128e-03 3 1  ON 96
ci_0048                -1.622874e-03 3 1  ON 97
ci_0049                -4.922828e-03 3 1  ON 98
ci_0050                -5.263087e-03 3 1  ON 99
ci_0051                -3.529391e-03 3 1  ON 100
ci_0052                -3.470300e-03 3 1  ON 101
ci_0053                -4.659575e-03 3 1  ON 102
ci_0054                -4.575577e-03 3 1  ON 103
ci_0055                 7.392278e-03 3 1  ON 104
ci_0056                 7.180661e-03 3 1  ON 105
ci_0057                 4.395361e-03 3 1  ON 106
ci_0058                 5.053097e-03 3 1  ON 107
ci_0059                -4.294961e-03 3 1  ON 108
ci_0060                -4.795415e-03 3 1  ON 109
ci_0061                -2.199616e-03 3 1  ON 110
ci_0062                -3.314395e-03 3 1  ON 111
ci_0063                -1.015519e-02 3 1  ON 112
ci_0064                -8.594565e-03 3 1  ON 113
ci_0065                -5.186210e-03 3 1  ON 114
ci_0066                -5.366971e-03 3 1  ON 115
ci_0067                -4.798379e-03 3 1  ON 116
ci_0068                -5.123996e-03 3 1  ON 117
ci_0069                 5.006830e-03 3 1  ON 118
ci_0070                 4.129850e-03 3 1  ON 119
ci_0071                 3.182069e-04 3 1  ON 120
ci_0072                 4.018121e-04 3 1  ON 121
ci_0073                 4.192573e-03 3 1  ON 122
ci_0074                 4.102970e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9854
    reference variance = 0.279976
====================================================
  Execution time = 2.1385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3086e-01
  Total weights = 1.9517e+06
  Execution time = 1.9073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319365065227
                                         uncertainty =       0.002078736732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319365065227
                                         uncertainty =       0.002078736732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399585708
  error estimate for blocks of size 2^( 2) =       0.000412911960
  error estimate for blocks of size 2^( 3) =       0.000426895180
  error estimate for blocks of size 2^( 4) =       0.000440216920
  error estimate for blocks of size 2^( 5) =       0.000451237996
  error estimate for blocks of size 2^( 6) =       0.000461263082
  error estimate for blocks of size 2^( 7) =       0.000468861528

      target function =                  N/A
              le_mean =     -16.906235364849
             les_mean =     286.151635096178
             stat err =       0.000455394882
             autocorr =       1.298842218108
              std dev =       0.565099527948
             le_variance =       0.319337476487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319395343816
                                         uncertainty =       0.002077469936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319395343816
                                         uncertainty =       0.002077469936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399604640
  error estimate for blocks of size 2^( 2) =       0.000412928849
  error estimate for blocks of size 2^( 3) =       0.000426908462
  error estimate for blocks of size 2^( 4) =       0.000440227603
  error estimate for blocks of size 2^( 5) =       0.000451245390
  error estimate for blocks of size 2^( 6) =       0.000461265615
  error estimate for blocks of size 2^( 7) =       0.000468866302

      target function =                  N/A
              le_mean =     -16.906234740712
             les_mean =     286.159106400592
             stat err =       0.000455401228
             autocorr =       1.298755346050
              std dev =       0.565126302060
             le_variance =       0.319367737280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319381435594
                                         uncertainty =       0.002078075045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319381435594
                                         uncertainty =       0.002078075045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399595944
  error estimate for blocks of size 2^( 2) =       0.000412921125
  error estimate for blocks of size 2^( 3) =       0.000426902397
  error estimate for blocks of size 2^( 4) =       0.000440222731
  error estimate for blocks of size 2^( 5) =       0.000451241960
  error estimate for blocks of size 2^( 6) =       0.000461264660
  error estimate for blocks of size 2^( 7) =       0.000468864307

      target function =                  N/A
              le_mean =     -16.906234950495
             les_mean =     286.151680261965
             stat err =       0.000455398414
             autocorr =       1.298795829680
              std dev =       0.565114003431
             le_variance =       0.319353836874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319367113028
                                         uncertainty =       0.002078652413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319367113028
                                         uncertainty =       0.002078652413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399586989
  error estimate for blocks of size 2^( 2) =       0.000412913104
  error estimate for blocks of size 2^( 3) =       0.000426896075
  error estimate for blocks of size 2^( 4) =       0.000440217637
  error estimate for blocks of size 2^( 5) =       0.000451238480
  error estimate for blocks of size 2^( 6) =       0.000461263263
  error estimate for blocks of size 2^( 7) =       0.000468861863

      target function =                  N/A
              le_mean =     -16.906235305696
             les_mean =     286.151636472537
             stat err =       0.000455395311
             autocorr =       1.298836341836
              std dev =       0.565101338728
             le_variance =       0.319339523032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906235364849        initial  <--
     3.8147e+00     3.8147e+01             1.2954e-04       -16.906234740712
     1.5259e+01     1.5259e+02             3.4181e-05       -16.906234950495
     6.1035e+01     6.1035e+02             8.6654e-06       -16.906235305696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 35.0131
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8786
    reference variance = 0.242959
====================================================
  Execution time = 2.1434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3688e-01
  Total weights = 1.951555471e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116826682
                                         uncertainty =       0.003732166912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116826682
                                         uncertainty =       0.003732166912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403827734
  error estimate for blocks of size 2^( 2) =       0.000416739509
  error estimate for blocks of size 2^( 3) =       0.000430020990
  error estimate for blocks of size 2^( 4) =       0.000442457775
  error estimate for blocks of size 2^( 5) =       0.000452186798
  error estimate for blocks of size 2^( 6) =       0.000460714266
  error estimate for blocks of size 2^( 7) =       0.000465057690

      target function =                  N/A
              le_mean =     -16.906165139399
             les_mean =     286.155302712908
             stat err =       0.000455104132
             autocorr =       1.270074724698
              std dev =       0.571098658600
             le_variance =       0.326153677854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616513940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165139392       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165357037       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165355654       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165358121       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165347578       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165349347       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165344905       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165346006       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165346807       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906165347300       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+01 is 1.456163e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165139392       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165194054       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165193691       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165194278       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165191628       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165192037       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165190892       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165191181       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165191379       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906165191496       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+02 is 3.660733e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906165139392       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906165153073       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906165152981       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906165153126       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906165152463       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906165152563       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906165152275       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906165152347       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906165152398       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906165152427       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+02 is 9.164627e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.256625 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7493e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.124312e-01 1 1  ON 0
   uu_1                 1.450257e-01 1 1  ON 1
   uu_2                 4.329171e-02 1 1  ON 2
   uu_3                -1.940594e-02 1 1  ON 3
   uu_4                -6.554884e-02 1 1  ON 4
   uu_5                -1.008277e-01 1 1  ON 5
   uu_6                -1.286165e-01 1 1  ON 6
   uu_7                -1.425315e-01 1 1  ON 7
   uu_8                -1.353615e-01 1 1  ON 8
   uu_9                -1.041477e-01 1 1  ON 9
   ud_0                 4.474193e-01 1 1  ON 10
   ud_1                 1.818424e-01 1 1  ON 11
   ud_2                 6.170248e-02 1 1  ON 12
   ud_3                -9.177912e-03 1 1  ON 13
   ud_4                -6.613981e-02 1 1  ON 14
   ud_5                -1.078028e-01 1 1  ON 15
   ud_6                -1.350661e-01 1 1  ON 16
   ud_7                -1.517250e-01 1 1  ON 17
   ud_8                -1.527927e-01 1 1  ON 18
   ud_9                -1.409339e-01 1 1  ON 19
   eO_0                -7.511563e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032158e-02 1 1  ON 22
   eO_3                 2.923257e-01 1 1  ON 23
   eO_4                 5.175078e-01 1 1  ON 24
   eO_5                 4.796202e-01 1 1  ON 25
   eO_6                 2.531159e-01 1 1  ON 26
   eO_7                -4.492236e-02 1 1  ON 27
   eO_8                -2.171494e-01 1 1  ON 28
   eO_9                -7.834551e-02 1 1  ON 29
  eH1_0                -2.543008e-01 1 1  ON 30
  eH1_1                -1.470877e-01 1 1  ON 31
  eH1_2                -9.771595e-02 1 1  ON 32
  eH1_3                -4.262480e-02 1 1  ON 33
  eH1_4                 6.774942e-03 1 1  ON 34
  eH1_5                 4.185559e-02 1 1  ON 35
  eH1_6                 1.016527e-01 1 1  ON 36
  eH1_7                 1.560050e-01 1 1  ON 37
  eH1_8                 1.756596e-01 1 1  ON 38
  eH1_9                 6.246181e-02 1 1  ON 39
  eH2_0                -2.516788e-01 1 1  ON 40
  eH2_1                -1.445561e-01 1 1  ON 41
  eH2_2                -9.509184e-02 1 1  ON 42
  eH2_3                -3.988921e-02 1 1  ON 43
  eH2_4                 9.975089e-03 1 1  ON 44
  eH2_5                 4.508277e-02 1 1  ON 45
  eH2_6                 1.037557e-01 1 1  ON 46
  eH2_7                 1.568658e-01 1 1  ON 47
  eH2_8                 1.806506e-01 1 1  ON 48
  eH2_9                 5.052122e-02 1 1  ON 49
ci_0001                 7.003265e-01 3 1  ON 50
ci_0002                 7.015286e-01 3 1  ON 51
ci_0003                -2.685729e-02 3 1  ON 52
ci_0004                -2.808833e-02 3 1  ON 53
ci_0005                -3.589647e-02 3 1  ON 54
ci_0006                -3.670705e-02 3 1  ON 55
ci_0007                -2.183622e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762255e-02 3 1  ON 58
ci_0010                -1.713005e-02 3 1  ON 59
ci_0011                -1.246454e-02 3 1  ON 60
ci_0012                -1.201762e-02 3 1  ON 61
ci_0013                 1.317760e-02 3 1  ON 62
ci_0014                 1.297234e-02 3 1  ON 63
ci_0015                 1.238895e-02 3 1  ON 64
ci_0016                 1.313721e-02 3 1  ON 65
ci_0017                 1.096611e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118512e-02 3 1  ON 68
ci_0020                 1.177819e-02 3 1  ON 69
ci_0021                -4.460029e-04 3 1  ON 70
ci_0022                -4.816947e-04 3 1  ON 71
ci_0023                -1.166942e-02 3 1  ON 72
ci_0024                -1.028785e-02 3 1  ON 73
ci_0025                -1.011733e-02 3 1  ON 74
ci_0026                -1.096018e-02 3 1  ON 75
ci_0027                -1.137949e-02 3 1  ON 76
ci_0028                -1.138043e-02 3 1  ON 77
ci_0029                -1.069244e-02 3 1  ON 78
ci_0030                -1.040668e-02 3 1  ON 79
ci_0031                 2.076679e-02 3 1  ON 80
ci_0032                 2.128901e-02 3 1  ON 81
ci_0033                 8.104953e-03 3 1  ON 82
ci_0034                 1.043078e-02 3 1  ON 83
ci_0035                 6.884695e-03 3 1  ON 84
ci_0036                 6.709135e-03 3 1  ON 85
ci_0037                -1.053336e-02 3 1  ON 86
ci_0038                -1.070491e-02 3 1  ON 87
ci_0039                -2.824222e-03 3 1  ON 88
ci_0040                -2.726288e-03 3 1  ON 89
ci_0041                 6.628601e-03 3 1  ON 90
ci_0042                 6.834539e-03 3 1  ON 91
ci_0043                -1.789591e-02 3 1  ON 92
ci_0044                -1.810582e-02 3 1  ON 93
ci_0045                 6.870501e-03 3 1  ON 94
ci_0046                 7.981762e-03 3 1  ON 95
ci_0047                -1.926633e-03 3 1  ON 96
ci_0048                -1.608695e-03 3 1  ON 97
ci_0049                -4.904717e-03 3 1  ON 98
ci_0050                -5.257105e-03 3 1  ON 99
ci_0051                -3.528143e-03 3 1  ON 100
ci_0052                -3.469802e-03 3 1  ON 101
ci_0053                -4.662720e-03 3 1  ON 102
ci_0054                -4.585219e-03 3 1  ON 103
ci_0055                 7.395532e-03 3 1  ON 104
ci_0056                 7.193346e-03 3 1  ON 105
ci_0057                 4.385908e-03 3 1  ON 106
ci_0058                 5.050759e-03 3 1  ON 107
ci_0059                -4.267374e-03 3 1  ON 108
ci_0060                -4.797320e-03 3 1  ON 109
ci_0061                -2.191523e-03 3 1  ON 110
ci_0062                -3.316416e-03 3 1  ON 111
ci_0063                -1.018571e-02 3 1  ON 112
ci_0064                -8.588146e-03 3 1  ON 113
ci_0065                -5.183914e-03 3 1  ON 114
ci_0066                -5.370041e-03 3 1  ON 115
ci_0067                -4.791833e-03 3 1  ON 116
ci_0068                -5.117772e-03 3 1  ON 117
ci_0069                 5.022377e-03 3 1  ON 118
ci_0070                 4.130919e-03 3 1  ON 119
ci_0071                 3.164757e-04 3 1  ON 120
ci_0072                 3.825718e-04 3 1  ON 121
ci_0073                 4.187851e-03 3 1  ON 122
ci_0074                 4.109037e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.143514
====================================================
  Execution time = 2.1229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3510e-01
  Total weights = 1.9520e+06
  Execution time = 1.9182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324460434683
                                         uncertainty =       0.002618231471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324460434683
                                         uncertainty =       0.002618231471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402724404
  error estimate for blocks of size 2^( 2) =       0.000415669223
  error estimate for blocks of size 2^( 3) =       0.000428863343
  error estimate for blocks of size 2^( 4) =       0.000440964230
  error estimate for blocks of size 2^( 5) =       0.000451199549
  error estimate for blocks of size 2^( 6) =       0.000460107114
  error estimate for blocks of size 2^( 7) =       0.000465037788

      target function =                  N/A
              le_mean =     -16.905674742908
             les_mean =     286.136926104829
             stat err =       0.000454327170
             autocorr =       1.272686753289
              std dev =       0.569538314709
             le_variance =       0.324373891922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324468130632
                                         uncertainty =       0.002618595399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324468130632
                                         uncertainty =       0.002618595399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402729175
  error estimate for blocks of size 2^( 2) =       0.000415673781
  error estimate for blocks of size 2^( 3) =       0.000428867817
  error estimate for blocks of size 2^( 4) =       0.000440968531
  error estimate for blocks of size 2^( 5) =       0.000451203960
  error estimate for blocks of size 2^( 6) =       0.000460111294
  error estimate for blocks of size 2^( 7) =       0.000465042571

      target function =                  N/A
              le_mean =     -16.905674668962
             les_mean =     286.136981122209
             stat err =       0.000454331589
             autocorr =       1.272681354870
              std dev =       0.569545061893
             le_variance =       0.324381577527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324464299160
                                         uncertainty =       0.002618414366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324464299160
                                         uncertainty =       0.002618414366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402726800
  error estimate for blocks of size 2^( 2) =       0.000415671511
  error estimate for blocks of size 2^( 3) =       0.000428865589
  error estimate for blocks of size 2^( 4) =       0.000440966389
  error estimate for blocks of size 2^( 5) =       0.000451201763
  error estimate for blocks of size 2^( 6) =       0.000460109212
  error estimate for blocks of size 2^( 7) =       0.000465040189

      target function =                  N/A
              le_mean =     -16.905674705020
             les_mean =     286.136951621801
             stat err =       0.000454329388
             autocorr =       1.272684037909
              std dev =       0.569541702791
             le_variance =       0.324377751218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324460917821
                                         uncertainty =       0.002618254348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324460917821
                                         uncertainty =       0.002618254348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402724704
  error estimate for blocks of size 2^( 2) =       0.000415669509
  error estimate for blocks of size 2^( 3) =       0.000428863624
  error estimate for blocks of size 2^( 4) =       0.000440964500
  error estimate for blocks of size 2^( 5) =       0.000451199826
  error estimate for blocks of size 2^( 6) =       0.000460107376
  error estimate for blocks of size 2^( 7) =       0.000465038088

      target function =                  N/A
              le_mean =     -16.905674738097
             les_mean =     286.136929095127
             stat err =       0.000454327448
             autocorr =       1.272686413530
              std dev =       0.569538738289
             le_variance =       0.324374374412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905674742908        initial  <--
     3.8147e+01     3.8147e+02             1.4562e-05       -16.905674668962
     1.5259e+02     1.5259e+03             3.6607e-06       -16.905674705020
     6.1035e+02     6.1035e+03             9.1646e-07       -16.905674738097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9390
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9292
    reference variance = 0.183716
====================================================
  Execution time = 2.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3404e-01
  Total weights = 1.951313050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549751953
                                         uncertainty =       0.002271800372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549751953
                                         uncertainty =       0.002271800372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400274689
  error estimate for blocks of size 2^( 2) =       0.000413108701
  error estimate for blocks of size 2^( 3) =       0.000426126746
  error estimate for blocks of size 2^( 4) =       0.000437858534
  error estimate for blocks of size 2^( 5) =       0.000447997851
  error estimate for blocks of size 2^( 6) =       0.000457392240
  error estimate for blocks of size 2^( 7) =       0.000460386113

      target function =                  N/A
              le_mean =     -16.906577787954
             les_mean =     286.166416820926
             stat err =       0.000450908685
             autocorr =       1.268998014173
              std dev =       0.566073893991
             le_variance =       0.320439653458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657778795e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906577787943       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906577826981       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906577828056       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906577827832       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906577828542       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906577827398       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906577827309       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906577827188       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906577827331       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906577827294       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+02 is 1.191585e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906577787943       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906577797706       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906577797975       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906577797920       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906577798096       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906577797810       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906577797789       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906577797761       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906577797788       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906577797788       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+03 is 2.979628e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906577787943       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906577790384       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906577790451       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906577790438       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906577790483       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906577790409       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906577790406       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906577790388       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906577790405       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906577790394       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+03 is 7.449485e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.265760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0291e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.124303e-01 1 1  ON 0
   uu_1                 1.450254e-01 1 1  ON 1
   uu_2                 4.329180e-02 1 1  ON 2
   uu_3                -1.940611e-02 1 1  ON 3
   uu_4                -6.554883e-02 1 1  ON 4
   uu_5                -1.008263e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425314e-01 1 1  ON 7
   uu_8                -1.353613e-01 1 1  ON 8
   uu_9                -1.041472e-01 1 1  ON 9
   ud_0                 4.474181e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170302e-02 1 1  ON 12
   ud_3                -9.177507e-03 1 1  ON 13
   ud_4                -6.613997e-02 1 1  ON 14
   ud_5                -1.078030e-01 1 1  ON 15
   ud_6                -1.350655e-01 1 1  ON 16
   ud_7                -1.517255e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409332e-01 1 1  ON 19
   eO_0                -7.511563e-01 1 1  ON 20
   eO_1                -4.308197e-01 1 1  ON 21
   eO_2                -2.032140e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531150e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171486e-01 1 1  ON 28
   eO_9                -7.834465e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771617e-02 1 1  ON 32
  eH1_3                -4.262498e-02 1 1  ON 33
  eH1_4                 6.774970e-03 1 1  ON 34
  eH1_5                 4.185566e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560050e-01 1 1  ON 37
  eH1_8                 1.756588e-01 1 1  ON 38
  eH1_9                 6.246109e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509189e-02 1 1  ON 42
  eH2_3                -3.988990e-02 1 1  ON 43
  eH2_4                 9.976142e-03 1 1  ON 44
  eH2_5                 4.508371e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568653e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052021e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685722e-02 3 1  ON 52
ci_0004                -2.808997e-02 3 1  ON 53
ci_0005                -3.589487e-02 3 1  ON 54
ci_0006                -3.670555e-02 3 1  ON 55
ci_0007                -2.183662e-02 3 1  ON 56
ci_0008                -2.216975e-02 3 1  ON 57
ci_0009                -1.762360e-02 3 1  ON 58
ci_0010                -1.712888e-02 3 1  ON 59
ci_0011                -1.246485e-02 3 1  ON 60
ci_0012                -1.201773e-02 3 1  ON 61
ci_0013                 1.317797e-02 3 1  ON 62
ci_0014                 1.297220e-02 3 1  ON 63
ci_0015                 1.238857e-02 3 1  ON 64
ci_0016                 1.313755e-02 3 1  ON 65
ci_0017                 1.096596e-02 3 1  ON 66
ci_0018                 1.137696e-02 3 1  ON 67
ci_0019                 1.118486e-02 3 1  ON 68
ci_0020                 1.177793e-02 3 1  ON 69
ci_0021                -4.439503e-04 3 1  ON 70
ci_0022                -4.814033e-04 3 1  ON 71
ci_0023                -1.166945e-02 3 1  ON 72
ci_0024                -1.028650e-02 3 1  ON 73
ci_0025                -1.011585e-02 3 1  ON 74
ci_0026                -1.096077e-02 3 1  ON 75
ci_0027                -1.137929e-02 3 1  ON 76
ci_0028                -1.138060e-02 3 1  ON 77
ci_0029                -1.069201e-02 3 1  ON 78
ci_0030                -1.040487e-02 3 1  ON 79
ci_0031                 2.076608e-02 3 1  ON 80
ci_0032                 2.128955e-02 3 1  ON 81
ci_0033                 8.102906e-03 3 1  ON 82
ci_0034                 1.043087e-02 3 1  ON 83
ci_0035                 6.885823e-03 3 1  ON 84
ci_0036                 6.709502e-03 3 1  ON 85
ci_0037                -1.053425e-02 3 1  ON 86
ci_0038                -1.070530e-02 3 1  ON 87
ci_0039                -2.824946e-03 3 1  ON 88
ci_0040                -2.726251e-03 3 1  ON 89
ci_0041                 6.628009e-03 3 1  ON 90
ci_0042                 6.834021e-03 3 1  ON 91
ci_0043                -1.789482e-02 3 1  ON 92
ci_0044                -1.810525e-02 3 1  ON 93
ci_0045                 6.869164e-03 3 1  ON 94
ci_0046                 7.981957e-03 3 1  ON 95
ci_0047                -1.925868e-03 3 1  ON 96
ci_0048                -1.608361e-03 3 1  ON 97
ci_0049                -4.905029e-03 3 1  ON 98
ci_0050                -5.256022e-03 3 1  ON 99
ci_0051                -3.527855e-03 3 1  ON 100
ci_0052                -3.470323e-03 3 1  ON 101
ci_0053                -4.663092e-03 3 1  ON 102
ci_0054                -4.583987e-03 3 1  ON 103
ci_0055                 7.395269e-03 3 1  ON 104
ci_0056                 7.193883e-03 3 1  ON 105
ci_0057                 4.385545e-03 3 1  ON 106
ci_0058                 5.051080e-03 3 1  ON 107
ci_0059                -4.266782e-03 3 1  ON 108
ci_0060                -4.797623e-03 3 1  ON 109
ci_0061                -2.189063e-03 3 1  ON 110
ci_0062                -3.317618e-03 3 1  ON 111
ci_0063                -1.018914e-02 3 1  ON 112
ci_0064                -8.590030e-03 3 1  ON 113
ci_0065                -5.184750e-03 3 1  ON 114
ci_0066                -5.370406e-03 3 1  ON 115
ci_0067                -4.790814e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022808e-03 3 1  ON 118
ci_0070                 4.129898e-03 3 1  ON 119
ci_0071                 3.174030e-04 3 1  ON 120
ci_0072                 3.839170e-04 3 1  ON 121
ci_0073                 4.187765e-03 3 1  ON 122
ci_0074                 4.106966e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.165263
====================================================
  Execution time = 2.1254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2735e-01
  Total weights = 1.9517e+06
  Execution time = 1.9105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563633892
                                         uncertainty =       0.001746348173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563633892
                                         uncertainty =       0.001746348173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397181543
  error estimate for blocks of size 2^( 2) =       0.000409841736
  error estimate for blocks of size 2^( 3) =       0.000423627010
  error estimate for blocks of size 2^( 4) =       0.000436924731
  error estimate for blocks of size 2^( 5) =       0.000447541378
  error estimate for blocks of size 2^( 6) =       0.000454335237
  error estimate for blocks of size 2^( 7) =       0.000458981261

      target function =                  N/A
              le_mean =     -16.905841014617
             les_mean =     286.134805519945
             stat err =       0.000449445652
             autocorr =       1.280490172774
              std dev =       0.561699524464
             le_variance =       0.315506355783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563905272
                                         uncertainty =       0.001746366069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563905272
                                         uncertainty =       0.001746366069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397181713
  error estimate for blocks of size 2^( 2) =       0.000409841906
  error estimate for blocks of size 2^( 3) =       0.000423627177
  error estimate for blocks of size 2^( 4) =       0.000436924896
  error estimate for blocks of size 2^( 5) =       0.000447541507
  error estimate for blocks of size 2^( 6) =       0.000454335380
  error estimate for blocks of size 2^( 7) =       0.000458981372

      target function =                  N/A
              le_mean =     -16.905840999047
             les_mean =     286.134804733379
             stat err =       0.000449445789
             autocorr =       1.280489852373
              std dev =       0.561699765593
             le_variance =       0.315506626667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563769668
                                         uncertainty =       0.001746357125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563769668
                                         uncertainty =       0.001746357125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397181628
  error estimate for blocks of size 2^( 2) =       0.000409841821
  error estimate for blocks of size 2^( 3) =       0.000423627094
  error estimate for blocks of size 2^( 4) =       0.000436924814
  error estimate for blocks of size 2^( 5) =       0.000447541442
  error estimate for blocks of size 2^( 6) =       0.000454335308
  error estimate for blocks of size 2^( 7) =       0.000458981317

      target function =                  N/A
              le_mean =     -16.905841006823
             les_mean =     286.134805118876
             stat err =       0.000449445720
             autocorr =       1.280490012463
              std dev =       0.561699645105
             le_variance =       0.315506491311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563650862
                                         uncertainty =       0.001746349292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315563650862
                                         uncertainty =       0.001746349292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397181553
  error estimate for blocks of size 2^( 2) =       0.000409841747
  error estimate for blocks of size 2^( 3) =       0.000423627020
  error estimate for blocks of size 2^( 4) =       0.000436924742
  error estimate for blocks of size 2^( 5) =       0.000447541386
  error estimate for blocks of size 2^( 6) =       0.000454335246
  error estimate for blocks of size 2^( 7) =       0.000458981268

      target function =                  N/A
              le_mean =     -16.905841013642
             les_mean =     286.134805468989
             stat err =       0.000449445660
             autocorr =       1.280490152723
              std dev =       0.561699539542
             le_variance =       0.315506372722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905841014617        initial  <--
     3.8147e+02     3.8147e+03             1.1916e-06       -16.905840999047
     1.5259e+03     1.5259e+04             2.9796e-07       -16.905841006823
     6.1035e+03     6.1035e+04             7.4495e-08       -16.905841013642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9204
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1228e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9102
    reference variance = 0.230637
====================================================
  Execution time = 2.1165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3416e-01
  Total weights = 1.951553634e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321953767024
                                         uncertainty =       0.002682025296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321953767024
                                         uncertainty =       0.002682025296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401187862
  error estimate for blocks of size 2^( 2) =       0.000414178683
  error estimate for blocks of size 2^( 3) =       0.000427761922
  error estimate for blocks of size 2^( 4) =       0.000440759035
  error estimate for blocks of size 2^( 5) =       0.000452186242
  error estimate for blocks of size 2^( 6) =       0.000461540441
  error estimate for blocks of size 2^( 7) =       0.000464862849

      target function =                  N/A
              le_mean =     -16.906073943602
             les_mean =     286.149494769004
             stat err =       0.000454837142
             autocorr =       1.285334820725
              std dev =       0.567365315896
             le_variance =       0.321903401682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607394360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906073943600       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906073946280       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906073946492       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906073946702       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906073946777       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906073946759       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906073946690       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906073946700       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906073946708       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906073946685       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+03 is 1.594697e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906073943600       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906073944270       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906073944323       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906073944376       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906073944388       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906073944392       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906073944368       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906073944376       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906073944357       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906073944303       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+04 is 3.986965e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906073943600       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906073943767       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906073943781       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906073943820       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906073943797       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906073943761       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906073943759       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906073943633       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906073943806       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906073943960       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+04 is 9.967553e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.269665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7373e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329182e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177587e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032149e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543005e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771610e-02 1 1  ON 32
  eH1_3                -4.262488e-02 1 1  ON 33
  eH1_4                 6.775012e-03 1 1  ON 34
  eH1_5                 4.185568e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246098e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976168e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052012e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.808998e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670563e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217001e-02 3 1  ON 57
ci_0009                -1.762370e-02 3 1  ON 58
ci_0010                -1.712887e-02 3 1  ON 59
ci_0011                -1.246486e-02 3 1  ON 60
ci_0012                -1.201768e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297224e-02 3 1  ON 63
ci_0015                 1.238849e-02 3 1  ON 64
ci_0016                 1.313752e-02 3 1  ON 65
ci_0017                 1.096586e-02 3 1  ON 66
ci_0018                 1.137701e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177793e-02 3 1  ON 69
ci_0021                -4.438386e-04 3 1  ON 70
ci_0022                -4.813544e-04 3 1  ON 71
ci_0023                -1.166953e-02 3 1  ON 72
ci_0024                -1.028640e-02 3 1  ON 73
ci_0025                -1.011575e-02 3 1  ON 74
ci_0026                -1.096082e-02 3 1  ON 75
ci_0027                -1.137934e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069195e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076613e-02 3 1  ON 80
ci_0032                 2.128963e-02 3 1  ON 81
ci_0033                 8.102625e-03 3 1  ON 82
ci_0034                 1.043101e-02 3 1  ON 83
ci_0035                 6.885871e-03 3 1  ON 84
ci_0036                 6.709523e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070547e-02 3 1  ON 87
ci_0039                -2.825041e-03 3 1  ON 88
ci_0040                -2.726317e-03 3 1  ON 89
ci_0041                 6.627960e-03 3 1  ON 90
ci_0042                 6.834046e-03 3 1  ON 91
ci_0043                -1.789480e-02 3 1  ON 92
ci_0044                -1.810525e-02 3 1  ON 93
ci_0045                 6.869083e-03 3 1  ON 94
ci_0046                 7.982105e-03 3 1  ON 95
ci_0047                -1.925979e-03 3 1  ON 96
ci_0048                -1.608316e-03 3 1  ON 97
ci_0049                -4.904820e-03 3 1  ON 98
ci_0050                -5.255833e-03 3 1  ON 99
ci_0051                -3.527873e-03 3 1  ON 100
ci_0052                -3.470308e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583910e-03 3 1  ON 103
ci_0055                 7.395431e-03 3 1  ON 104
ci_0056                 7.194103e-03 3 1  ON 105
ci_0057                 4.385660e-03 3 1  ON 106
ci_0058                 5.051046e-03 3 1  ON 107
ci_0059                -4.266692e-03 3 1  ON 108
ci_0060                -4.797548e-03 3 1  ON 109
ci_0061                -2.188869e-03 3 1  ON 110
ci_0062                -3.317451e-03 3 1  ON 111
ci_0063                -1.018933e-02 3 1  ON 112
ci_0064                -8.590103e-03 3 1  ON 113
ci_0065                -5.184582e-03 3 1  ON 114
ci_0066                -5.370373e-03 3 1  ON 115
ci_0067                -4.790808e-03 3 1  ON 116
ci_0068                -5.119424e-03 3 1  ON 117
ci_0069                 5.022792e-03 3 1  ON 118
ci_0070                 4.129815e-03 3 1  ON 119
ci_0071                 3.172094e-04 3 1  ON 120
ci_0072                 3.840205e-04 3 1  ON 121
ci_0073                 4.187802e-03 3 1  ON 122
ci_0074                 4.107013e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.544473
====================================================
  Execution time = 2.1207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3973e-01
  Total weights = 1.9517e+06
  Execution time = 1.9094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252319883
                                         uncertainty =       0.002343378500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252319883
                                         uncertainty =       0.002343378500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402692170
  error estimate for blocks of size 2^( 2) =       0.000415600721
  error estimate for blocks of size 2^( 3) =       0.000428945759
  error estimate for blocks of size 2^( 4) =       0.000441152775
  error estimate for blocks of size 2^( 5) =       0.000451340141
  error estimate for blocks of size 2^( 6) =       0.000457851275
  error estimate for blocks of size 2^( 7) =       0.000461409386

      target function =                  N/A
              le_mean =     -16.905484335123
             les_mean =     286.135130085096
             stat err =       0.000452938394
             autocorr =       1.265120526718
              std dev =       0.569492728009
             le_variance =       0.324321967255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252363511
                                         uncertainty =       0.002343381099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252363511
                                         uncertainty =       0.002343381099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402692197
  error estimate for blocks of size 2^( 2) =       0.000415600748
  error estimate for blocks of size 2^( 3) =       0.000428945787
  error estimate for blocks of size 2^( 4) =       0.000441152805
  error estimate for blocks of size 2^( 5) =       0.000451340171
  error estimate for blocks of size 2^( 6) =       0.000457851308
  error estimate for blocks of size 2^( 7) =       0.000461409416

      target function =                  N/A
              le_mean =     -16.905484334087
             les_mean =     286.135130154153
             stat err =       0.000452938425
             autocorr =       1.265120526930
              std dev =       0.569492766151
             le_variance =       0.324322010698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252341697
                                         uncertainty =       0.002343379799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252341697
                                         uncertainty =       0.002343379799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402692183
  error estimate for blocks of size 2^( 2) =       0.000415600735
  error estimate for blocks of size 2^( 3) =       0.000428945773
  error estimate for blocks of size 2^( 4) =       0.000441152790
  error estimate for blocks of size 2^( 5) =       0.000451340156
  error estimate for blocks of size 2^( 6) =       0.000457851291
  error estimate for blocks of size 2^( 7) =       0.000461409401

      target function =                  N/A
              le_mean =     -16.905484334605
             les_mean =     286.135130118834
             stat err =       0.000452938409
             autocorr =       1.265120526826
              std dev =       0.569492747080
             le_variance =       0.324321988977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252322610
                                         uncertainty =       0.002343378663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324252322610
                                         uncertainty =       0.002343378663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402692171
  error estimate for blocks of size 2^( 2) =       0.000415600723
  error estimate for blocks of size 2^( 3) =       0.000428945761
  error estimate for blocks of size 2^( 4) =       0.000441152777
  error estimate for blocks of size 2^( 5) =       0.000451340143
  error estimate for blocks of size 2^( 6) =       0.000457851277
  error estimate for blocks of size 2^( 7) =       0.000461409388

      target function =                  N/A
              le_mean =     -16.905484335059
             les_mean =     286.135130089228
             stat err =       0.000452938396
             autocorr =       1.265120526733
              std dev =       0.569492730393
             le_variance =       0.324321969970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905484335123        initial  <--
     3.8147e+03     3.8147e+04             1.5947e-07       -16.905484334087
     1.5259e+04     1.5259e+05             3.9870e-08       -16.905484334605
     6.1035e+04     6.1035e+05             9.9676e-09       -16.905484335059

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8727
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8252e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8597
    reference variance = 0.309597
====================================================
  Execution time = 2.1264e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4593e-01
  Total weights = 1.951630551e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321879895553
                                         uncertainty =       0.002283083682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321879895553
                                         uncertainty =       0.002283083682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401266614
  error estimate for blocks of size 2^( 2) =       0.000414133161
  error estimate for blocks of size 2^( 3) =       0.000427411778
  error estimate for blocks of size 2^( 4) =       0.000439577675
  error estimate for blocks of size 2^( 5) =       0.000450552213
  error estimate for blocks of size 2^( 6) =       0.000458801859
  error estimate for blocks of size 2^( 7) =       0.000461510628

      target function =                  N/A
              le_mean =     -16.906238995042
             les_mean =     286.166842381010
             stat err =       0.000452610594
             autocorr =       1.272281976178
              std dev =       0.567476687617
             le_variance =       0.322029790988


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623899504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238995021       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238995235       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238995227       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906238995233       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906238995233       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238995224       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906238995262       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238995238       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906238995233       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+04 is 1.394424e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238995021       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238995075       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238995073       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906238995074       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906238995096       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238995048       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906238995235       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238995187       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906238994989       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+05 is 3.486083e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238995021       residual = 3.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238995035       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906238995034       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906238995034       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906238995130       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906238995113       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906238994844       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906238994151       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906238995315       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+05 is 8.715223e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7372e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771610e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052011e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096586e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438342e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102611e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709529e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825047e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869079e-03 3 1  ON 94
ci_0046                 7.982105e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255822e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470303e-03 3 1  ON 101
ci_0053                -4.663158e-03 3 1  ON 102
ci_0054                -4.583897e-03 3 1  ON 103
ci_0055                 7.395441e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266686e-03 3 1  ON 108
ci_0060                -4.797537e-03 3 1  ON 109
ci_0061                -2.188854e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018936e-02 3 1  ON 112
ci_0064                -8.590110e-03 3 1  ON 113
ci_0065                -5.184588e-03 3 1  ON 114
ci_0066                -5.370366e-03 3 1  ON 115
ci_0067                -4.790817e-03 3 1  ON 116
ci_0068                -5.119428e-03 3 1  ON 117
ci_0069                 5.022815e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172119e-04 3 1  ON 120
ci_0072                 3.840274e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107015e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9753
    reference variance = 0.321904
====================================================
  Execution time = 2.1150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3891e-01
  Total weights = 1.9513e+06
  Execution time = 1.9101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300469844
                                         uncertainty =       0.002677129912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300469844
                                         uncertainty =       0.002677129912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404495463
  error estimate for blocks of size 2^( 2) =       0.000417672812
  error estimate for blocks of size 2^( 3) =       0.000431881139
  error estimate for blocks of size 2^( 4) =       0.000445034071
  error estimate for blocks of size 2^( 5) =       0.000456831997
  error estimate for blocks of size 2^( 6) =       0.000463698060
  error estimate for blocks of size 2^( 7) =       0.000469702994

      target function =                  N/A
              le_mean =     -16.906529888015
             les_mean =     286.169665761663
             stat err =       0.000458816780
             autocorr =       1.286622898388
              std dev =       0.572042969627
             le_variance =       0.327233159100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300468092
                                         uncertainty =       0.002677129547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300468092
                                         uncertainty =       0.002677129547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404495462
  error estimate for blocks of size 2^( 2) =       0.000417672811
  error estimate for blocks of size 2^( 3) =       0.000431881138
  error estimate for blocks of size 2^( 4) =       0.000445034070
  error estimate for blocks of size 2^( 5) =       0.000456831996
  error estimate for blocks of size 2^( 6) =       0.000463698060
  error estimate for blocks of size 2^( 7) =       0.000469702994

      target function =                  N/A
              le_mean =     -16.906529887765
             les_mean =     286.169665736314
             stat err =       0.000458816780
             autocorr =       1.286622903130
              std dev =       0.572042968081
             le_variance =       0.327233157331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300468968
                                         uncertainty =       0.002677129730

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300468968
                                         uncertainty =       0.002677129730

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404495462
  error estimate for blocks of size 2^( 2) =       0.000417672812
  error estimate for blocks of size 2^( 3) =       0.000431881139
  error estimate for blocks of size 2^( 4) =       0.000445034071
  error estimate for blocks of size 2^( 5) =       0.000456831996
  error estimate for blocks of size 2^( 6) =       0.000463698060
  error estimate for blocks of size 2^( 7) =       0.000469702994

      target function =                  N/A
              le_mean =     -16.906529887890
             les_mean =     286.169665748988
             stat err =       0.000458816780
             autocorr =       1.286622900757
              std dev =       0.572042968854
             le_variance =       0.327233158215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300469734
                                         uncertainty =       0.002677129890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327300469734
                                         uncertainty =       0.002677129890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404495463
  error estimate for blocks of size 2^( 2) =       0.000417672812
  error estimate for blocks of size 2^( 3) =       0.000431881139
  error estimate for blocks of size 2^( 4) =       0.000445034071
  error estimate for blocks of size 2^( 5) =       0.000456831997
  error estimate for blocks of size 2^( 6) =       0.000463698060
  error estimate for blocks of size 2^( 7) =       0.000469702994

      target function =                  N/A
              le_mean =     -16.906529888000
             les_mean =     286.169665760078
             stat err =       0.000458816780
             autocorr =       1.286622898686
              std dev =       0.572042969531
             le_variance =       0.327233158990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906529888015        initial  <--
     3.8147e+04     3.8147e+05             1.3944e-08       -16.906529887765
     1.5259e+05     1.5259e+06             3.4861e-09       -16.906529887890
     6.1035e+05     6.1035e+06             8.7152e-10       -16.906529888000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8220
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172127e-04 3 1  ON 120
ci_0072                 3.840269e-04 3 1  ON 121
ci_0073                 4.187797e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9334
    reference variance = 0.235683
====================================================
  Execution time = 2.1436e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3632e-01
  Total weights = 1.951508977e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183893451
                                         uncertainty =       0.001959528151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322183893451
                                         uncertainty =       0.001959528151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401370216
  error estimate for blocks of size 2^( 2) =       0.000414059900
  error estimate for blocks of size 2^( 3) =       0.000427332822
  error estimate for blocks of size 2^( 4) =       0.000438998464
  error estimate for blocks of size 2^( 5) =       0.000449033876
  error estimate for blocks of size 2^( 6) =       0.000456646857
  error estimate for blocks of size 2^( 7) =       0.000459488799

      target function =                  N/A
              le_mean =     -16.906161881046
             les_mean =     286.154625147104
             stat err =       0.000451041999
             autocorr =       1.262826488466
              std dev =       0.567623202488
             le_variance =       0.322196100003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616188105e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161881035       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161881062       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161881065       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161881065       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161881180       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161881497       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161880956       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161881022       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906161881076       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906161880725       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+05 is 1.024713e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161881035       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161881042       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161881042       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161881032       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161881042       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161881245       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161880559       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161880629       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906161880993       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906161883305       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+06 is 2.561783e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161881035       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161881037       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906161881037       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906161881037       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906161881037       residual = 7.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906161880464       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906161870158       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906161875697       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906161880349       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906161898571       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+06 is 6.404457e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.276925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7536e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170292e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756586e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813413e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726320e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925983e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385652e-03 3 1  ON 106
ci_0058                 5.051049e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317448e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184585e-03 3 1  ON 114
ci_0066                -5.370368e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172125e-04 3 1  ON 120
ci_0072                 3.840271e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8223
    reference variance = 0.223954
====================================================
  Execution time = 2.0925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3026e-01
  Total weights = 1.9515e+06
  Execution time = 1.9237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558392
                                         uncertainty =       0.001830628545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558392
                                         uncertainty =       0.001830628545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399538508
  error estimate for blocks of size 2^( 2) =       0.000412497261
  error estimate for blocks of size 2^( 3) =       0.000425486522
  error estimate for blocks of size 2^( 4) =       0.000437436766
  error estimate for blocks of size 2^( 5) =       0.000447490873
  error estimate for blocks of size 2^( 6) =       0.000455171106
  error estimate for blocks of size 2^( 7) =       0.000458225432

      target function =                  N/A
              le_mean =     -16.905634207034
             les_mean =     286.130729285557
             stat err =       0.000449581044
             autocorr =       1.266189468555
              std dev =       0.565032776330
             le_variance =       0.319262038327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558677
                                         uncertainty =       0.001830628572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558677
                                         uncertainty =       0.001830628572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399538508
  error estimate for blocks of size 2^( 2) =       0.000412497261
  error estimate for blocks of size 2^( 3) =       0.000425486522
  error estimate for blocks of size 2^( 4) =       0.000437436766
  error estimate for blocks of size 2^( 5) =       0.000447490873
  error estimate for blocks of size 2^( 6) =       0.000455171106
  error estimate for blocks of size 2^( 7) =       0.000458225433

      target function =                  N/A
              le_mean =     -16.905634207041
             les_mean =     286.130729286813
             stat err =       0.000449581044
             autocorr =       1.266189467888
              std dev =       0.565032776585
             le_variance =       0.319262038615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558535
                                         uncertainty =       0.001830628558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558535
                                         uncertainty =       0.001830628558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399538508
  error estimate for blocks of size 2^( 2) =       0.000412497261
  error estimate for blocks of size 2^( 3) =       0.000425486522
  error estimate for blocks of size 2^( 4) =       0.000437436766
  error estimate for blocks of size 2^( 5) =       0.000447490873
  error estimate for blocks of size 2^( 6) =       0.000455171106
  error estimate for blocks of size 2^( 7) =       0.000458225433

      target function =                  N/A
              le_mean =     -16.905634207037
             les_mean =     286.130729286185
             stat err =       0.000449581044
             autocorr =       1.266189468216
              std dev =       0.565032776457
             le_variance =       0.319262038471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558410
                                         uncertainty =       0.001830628547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319282558410
                                         uncertainty =       0.001830628547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399538508
  error estimate for blocks of size 2^( 2) =       0.000412497261
  error estimate for blocks of size 2^( 3) =       0.000425486522
  error estimate for blocks of size 2^( 4) =       0.000437436766
  error estimate for blocks of size 2^( 5) =       0.000447490873
  error estimate for blocks of size 2^( 6) =       0.000455171106
  error estimate for blocks of size 2^( 7) =       0.000458225432

      target function =                  N/A
              le_mean =     -16.905634207034
             les_mean =     286.130729285635
             stat err =       0.000449581044
             autocorr =       1.266189468504
              std dev =       0.565032776346
             le_variance =       0.319262038345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905634207034        initial
     3.8147e+05     3.8147e+06             1.0247e-09       -16.905634207041  <--
     1.5259e+06     1.5259e+07             2.5618e-10       -16.905634207037
     6.1035e+06     6.1035e+07             6.4045e-11       -16.905634207034

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 3.0659e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.887
    reference variance = 0.200535
====================================================
  Execution time = 2.3204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4456e-01
  Total weights = 1.951698423e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325549231255
                                         uncertainty =       0.003350849471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325549231255
                                         uncertainty =       0.003350849471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403377501
  error estimate for blocks of size 2^( 2) =       0.000416243905
  error estimate for blocks of size 2^( 3) =       0.000428964314
  error estimate for blocks of size 2^( 4) =       0.000440491947
  error estimate for blocks of size 2^( 5) =       0.000450318023
  error estimate for blocks of size 2^( 6) =       0.000459345315
  error estimate for blocks of size 2^( 7) =       0.000464943860

      target function =                  N/A
              le_mean =     -16.906103306703
             les_mean =     286.160887136594
             stat err =       0.000453774786
             autocorr =       1.265486097518
              std dev =       0.570461933169
             le_variance =       0.325426817195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610330670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906103306722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906103306762       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906103306756       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906103306751       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906103306765       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906103306765       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906103306763       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906103306837       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906103306503       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+04 is 4.794662e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906103306722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906103306732       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906103306731       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906103306579       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906103306734       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906103306772       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906103306851       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906103306714       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906103307965       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+05 is 1.198666e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906103306722       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906103306725       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906103306724       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906103306725       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906103306628       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906103307233       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906103307528       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906103307625       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906103307408       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+06 is 2.996668e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9246e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438339e-04 3 1  ON 70
ci_0022                -4.813407e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102610e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982105e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608316e-03 3 1  ON 97
ci_0049                -4.904814e-03 3 1  ON 98
ci_0050                -5.255822e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266686e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188853e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018936e-02 3 1  ON 112
ci_0064                -8.590109e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790819e-03 3 1  ON 116
ci_0068                -5.119426e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172122e-04 3 1  ON 120
ci_0072                 3.840275e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107017e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9454
    reference variance = 0.487465
====================================================
  Execution time = 2.1320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3686e-01
  Total weights = 1.9514e+06
  Execution time = 1.9121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689900704
                                         uncertainty =       0.003066529206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689900704
                                         uncertainty =       0.003066529206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402289927
  error estimate for blocks of size 2^( 2) =       0.000414661621
  error estimate for blocks of size 2^( 3) =       0.000427869025
  error estimate for blocks of size 2^( 4) =       0.000439441995
  error estimate for blocks of size 2^( 5) =       0.000449648512
  error estimate for blocks of size 2^( 6) =       0.000455446148
  error estimate for blocks of size 2^( 7) =       0.000459765622

      target function =                  N/A
              le_mean =     -16.906753977400
             les_mean =     286.175186875570
             stat err =       0.000451075569
             autocorr =       1.257246093672
              std dev =       0.568923871117
             le_variance =       0.323674371126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689901998
                                         uncertainty =       0.003066529040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689901998
                                         uncertainty =       0.003066529040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402289928
  error estimate for blocks of size 2^( 2) =       0.000414661621
  error estimate for blocks of size 2^( 3) =       0.000427869026
  error estimate for blocks of size 2^( 4) =       0.000439441996
  error estimate for blocks of size 2^( 5) =       0.000449648513
  error estimate for blocks of size 2^( 6) =       0.000455446149
  error estimate for blocks of size 2^( 7) =       0.000459765623

      target function =                  N/A
              le_mean =     -16.906753977385
             les_mean =     286.175186872869
             stat err =       0.000451075570
             autocorr =       1.257246091918
              std dev =       0.568923872254
             le_variance =       0.323674372421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689901351
                                         uncertainty =       0.003066529123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689901351
                                         uncertainty =       0.003066529123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402289928
  error estimate for blocks of size 2^( 2) =       0.000414661621
  error estimate for blocks of size 2^( 3) =       0.000427869026
  error estimate for blocks of size 2^( 4) =       0.000439441996
  error estimate for blocks of size 2^( 5) =       0.000449648512
  error estimate for blocks of size 2^( 6) =       0.000455446149
  error estimate for blocks of size 2^( 7) =       0.000459765622

      target function =                  N/A
              le_mean =     -16.906753977392
             les_mean =     286.175186874219
             stat err =       0.000451075570
             autocorr =       1.257246092795
              std dev =       0.568923871686
             le_variance =       0.323674371774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689900784
                                         uncertainty =       0.003066529196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323689900784
                                         uncertainty =       0.003066529196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402289927
  error estimate for blocks of size 2^( 2) =       0.000414661621
  error estimate for blocks of size 2^( 3) =       0.000427869025
  error estimate for blocks of size 2^( 4) =       0.000439441995
  error estimate for blocks of size 2^( 5) =       0.000449648512
  error estimate for blocks of size 2^( 6) =       0.000455446148
  error estimate for blocks of size 2^( 7) =       0.000459765622

      target function =                  N/A
              le_mean =     -16.906753977399
             les_mean =     286.175186875401
             stat err =       0.000451075569
             autocorr =       1.257246093570
              std dev =       0.568923871188
             le_variance =       0.323674371207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906753977400        initial  <--
     9.5367e+04     9.5367e+05             4.7947e-09       -16.906753977385
     3.8147e+05     3.8147e+06             1.1987e-09       -16.906753977392
     1.5259e+06     1.5259e+07             2.9967e-10       -16.906753977399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9972
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9418
    reference variance = 0.840269
====================================================
  Execution time = 2.1514e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4139e-01
  Total weights = 1.951649123e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1130e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328593403403
                                         uncertainty =       0.006283032478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328593403403
                                         uncertainty =       0.006283032478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405325858
  error estimate for blocks of size 2^( 2) =       0.000418046994
  error estimate for blocks of size 2^( 3) =       0.000430988285
  error estimate for blocks of size 2^( 4) =       0.000443377462
  error estimate for blocks of size 2^( 5) =       0.000453100246
  error estimate for blocks of size 2^( 6) =       0.000461356379
  error estimate for blocks of size 2^( 7) =       0.000467319998

      target function =                  N/A
              le_mean =     -16.906125449942
             les_mean =     286.158467889948
             stat err =       0.000456288521
             autocorr =       1.267273830118
              std dev =       0.573217324874
             le_variance =       0.328578101535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612544994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125449933       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125449945       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125449947       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125449948       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125449949       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125449866       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125449978       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906125450013       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906125450841       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906125449129       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+05 is 6.805925e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125449933       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125449936       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125449936       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125449937       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125449937       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125449830       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125446971       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906125453426       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906125449705       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906125454992       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+06 is 1.701482e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125449933       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125449933       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125449934       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125454718       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906125449934       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906125450256       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906125477257       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906125443904       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906125436701       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906125402084       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+07 is 4.253694e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7635e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317787e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627965e-03 3 1  ON 90
ci_0042                 6.834035e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590109e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9514
    reference variance = 0.413815
====================================================
  Execution time = 2.0880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3523e-01
  Total weights = 1.9519e+06
  Execution time = 1.9284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044874
                                         uncertainty =       0.002739651735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044874
                                         uncertainty =       0.002739651735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896315
  error estimate for blocks of size 2^( 2) =       0.000415578594
  error estimate for blocks of size 2^( 3) =       0.000428734655
  error estimate for blocks of size 2^( 4) =       0.000440917143
  error estimate for blocks of size 2^( 5) =       0.000451383880
  error estimate for blocks of size 2^( 6) =       0.000459171503
  error estimate for blocks of size 2^( 7) =       0.000461313317

      target function =                  N/A
              le_mean =     -16.905686085423
             les_mean =     286.137449164169
             stat err =       0.000453196461
             autocorr =       1.265279376956
              std dev =       0.569781432569
             le_variance =       0.324650880900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623045120
                                         uncertainty =       0.002739651748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623045120
                                         uncertainty =       0.002739651748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896315
  error estimate for blocks of size 2^( 2) =       0.000415578594
  error estimate for blocks of size 2^( 3) =       0.000428734655
  error estimate for blocks of size 2^( 4) =       0.000440917143
  error estimate for blocks of size 2^( 5) =       0.000451383881
  error estimate for blocks of size 2^( 6) =       0.000459171503
  error estimate for blocks of size 2^( 7) =       0.000461313317

      target function =                  N/A
              le_mean =     -16.905686085423
             les_mean =     286.137449164277
             stat err =       0.000453196461
             autocorr =       1.265279376833
              std dev =       0.569781432784
             le_variance =       0.324650881145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044997
                                         uncertainty =       0.002739651742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044997
                                         uncertainty =       0.002739651742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896315
  error estimate for blocks of size 2^( 2) =       0.000415578594
  error estimate for blocks of size 2^( 3) =       0.000428734655
  error estimate for blocks of size 2^( 4) =       0.000440917143
  error estimate for blocks of size 2^( 5) =       0.000451383880
  error estimate for blocks of size 2^( 6) =       0.000459171503
  error estimate for blocks of size 2^( 7) =       0.000461313317

      target function =                  N/A
              le_mean =     -16.905686085423
             les_mean =     286.137449164223
             stat err =       0.000453196461
             autocorr =       1.265279376902
              std dev =       0.569781432676
             le_variance =       0.324650881023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044890
                                         uncertainty =       0.002739651736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324623044890
                                         uncertainty =       0.002739651736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896315
  error estimate for blocks of size 2^( 2) =       0.000415578594
  error estimate for blocks of size 2^( 3) =       0.000428734655
  error estimate for blocks of size 2^( 4) =       0.000440917143
  error estimate for blocks of size 2^( 5) =       0.000451383880
  error estimate for blocks of size 2^( 6) =       0.000459171503
  error estimate for blocks of size 2^( 7) =       0.000461313317

      target function =                  N/A
              le_mean =     -16.905686085423
             les_mean =     286.137449164176
             stat err =       0.000453196461
             autocorr =       1.265279376947
              std dev =       0.569781432582
             le_variance =       0.324650880915


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905686085423        initial  <--
     9.5367e+05     9.5367e+06             6.8059e-10       -16.905686085423
     3.8147e+06     3.8147e+07             1.7015e-10       -16.905686085423
     1.5259e+07     1.5259e+08             4.2537e-11       -16.905686085423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6401
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8254
    reference variance = 0.212476
====================================================
  Execution time = 2.1120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3370e-01
  Total weights = 1.951671321e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322097611228
                                         uncertainty =       0.001930610195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322097611228
                                         uncertainty =       0.001930610195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401327314
  error estimate for blocks of size 2^( 2) =       0.000414047836
  error estimate for blocks of size 2^( 3) =       0.000427425902
  error estimate for blocks of size 2^( 4) =       0.000440572416
  error estimate for blocks of size 2^( 5) =       0.000451817371
  error estimate for blocks of size 2^( 6) =       0.000459929959
  error estimate for blocks of size 2^( 7) =       0.000465340634

      target function =                  N/A
              le_mean =     -16.905669294927
             les_mean =     286.135359278315
             stat err =       0.000454415095
             autocorr =       1.282059150631
              std dev =       0.567562529910
             le_variance =       0.322127225358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566929493e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669294901       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905669294902       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905669294902       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905669294902       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905669294902       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905669287075       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905669288580       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905669295916       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905669299544       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905669291406       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+06 is 6.261270e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669294901       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905669294901       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905669294901       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905669294901       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905669305039       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905669292597       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905669295858       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905669285816       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905669268767       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905669280396       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+07 is 1.565322e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669294901       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905669294901       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905669294901       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905669294901       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905669202288       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905669301674       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905669205049       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905669231570       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905669306385       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905669310312       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+08 is 3.913324e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7176e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8513
    reference variance = 0.260496
====================================================
  Execution time = 2.1130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3593e-01
  Total weights = 1.9515e+06
  Execution time = 1.9193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568900
                                         uncertainty =       0.002790355538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568900
                                         uncertainty =       0.002790355538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690787
  error estimate for blocks of size 2^( 2) =       0.000415417540
  error estimate for blocks of size 2^( 3) =       0.000428373039
  error estimate for blocks of size 2^( 4) =       0.000440067680
  error estimate for blocks of size 2^( 5) =       0.000451190655
  error estimate for blocks of size 2^( 6) =       0.000459745918
  error estimate for blocks of size 2^( 7) =       0.000463257078

      target function =                  N/A
              le_mean =     -16.906324777660
             les_mean =     286.159751240469
             stat err =       0.000453565333
             autocorr =       1.268633918735
              std dev =       0.569490771858
             le_variance =       0.324319739231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568931
                                         uncertainty =       0.002790355540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568931
                                         uncertainty =       0.002790355540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690787
  error estimate for blocks of size 2^( 2) =       0.000415417540
  error estimate for blocks of size 2^( 3) =       0.000428373039
  error estimate for blocks of size 2^( 4) =       0.000440067680
  error estimate for blocks of size 2^( 5) =       0.000451190655
  error estimate for blocks of size 2^( 6) =       0.000459745918
  error estimate for blocks of size 2^( 7) =       0.000463257078

      target function =                  N/A
              le_mean =     -16.906324777660
             les_mean =     286.159751240480
             stat err =       0.000453565333
             autocorr =       1.268633918712
              std dev =       0.569490771885
             le_variance =       0.324319739262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568915
                                         uncertainty =       0.002790355539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568915
                                         uncertainty =       0.002790355539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690787
  error estimate for blocks of size 2^( 2) =       0.000415417540
  error estimate for blocks of size 2^( 3) =       0.000428373039
  error estimate for blocks of size 2^( 4) =       0.000440067680
  error estimate for blocks of size 2^( 5) =       0.000451190655
  error estimate for blocks of size 2^( 6) =       0.000459745918
  error estimate for blocks of size 2^( 7) =       0.000463257078

      target function =                  N/A
              le_mean =     -16.906324777660
             les_mean =     286.159751240475
             stat err =       0.000453565333
             autocorr =       1.268633918726
              std dev =       0.569490771871
             le_variance =       0.324319739247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568902
                                         uncertainty =       0.002790355538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324280568902
                                         uncertainty =       0.002790355538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402690787
  error estimate for blocks of size 2^( 2) =       0.000415417540
  error estimate for blocks of size 2^( 3) =       0.000428373039
  error estimate for blocks of size 2^( 4) =       0.000440067680
  error estimate for blocks of size 2^( 5) =       0.000451190655
  error estimate for blocks of size 2^( 6) =       0.000459745918
  error estimate for blocks of size 2^( 7) =       0.000463257078

      target function =                  N/A
              le_mean =     -16.906324777660
             les_mean =     286.159751240470
             stat err =       0.000453565333
             autocorr =       1.268633918734
              std dev =       0.569490771859
             le_variance =       0.324319739233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906324777660        initial  <--
     9.5367e+06     9.5367e+07             6.2613e-11       -16.906324777660
     3.8147e+07     3.8147e+08             1.5653e-11       -16.906324777660
     1.5259e+08     1.5259e+09             3.9133e-12       -16.906324777660

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8451
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.974
    reference variance = 0.167402
====================================================
  Execution time = 2.1403e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3349e-01
  Total weights = 1.952147647e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321754881381
                                         uncertainty =       0.002591697911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321754881381
                                         uncertainty =       0.002591697911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401100448
  error estimate for blocks of size 2^( 2) =       0.000414158620
  error estimate for blocks of size 2^( 3) =       0.000427552094
  error estimate for blocks of size 2^( 4) =       0.000440095321
  error estimate for blocks of size 2^( 5) =       0.000451878121
  error estimate for blocks of size 2^( 6) =       0.000462422788
  error estimate for blocks of size 2^( 7) =       0.000469738424

      target function =                  N/A
              le_mean =     -16.905395437112
             les_mean =     286.125885917876
             stat err =       0.000456033663
             autocorr =       1.292669523149
              std dev =       0.567241694089
             le_variance =       0.321763139513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690539543711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905395437064       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905395437064       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905395437064       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905395437064       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905395458083       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905395480691       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905395435551       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905395543149       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905395254635       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905395430023       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+07 is 4.834443e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905395437064       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905395437064       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905395437064       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905395641140       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905395093405       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905395436732       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905395196638       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905395656253       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905395086182       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905395445049       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+08 is 1.208639e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905395437064       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905395437064       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905395437064       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905395861488       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905395350993       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905393605029       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905394636829       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905395132095       residual = 3.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905396730566       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905395317009       residual = 4.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+09 is 3.021480e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7569e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8346
    reference variance = 0.336962
====================================================
  Execution time = 2.7797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3474e-01
  Total weights = 1.9518e+06
  Execution time = 1.9191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069794
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069794
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182006
  error estimate for blocks of size 2^( 2) =       0.000413945490
  error estimate for blocks of size 2^( 3) =       0.000426621020
  error estimate for blocks of size 2^( 4) =       0.000438235806
  error estimate for blocks of size 2^( 5) =       0.000448299328
  error estimate for blocks of size 2^( 6) =       0.000452271046
  error estimate for blocks of size 2^( 7) =       0.000457376504

      target function =                  N/A
              le_mean =     -16.906183372195
             les_mean =     286.153775462597
             stat err =       0.000449045671
             autocorr =       1.252847285170
              std dev =       0.567357034255
             le_variance =       0.321894004319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069797
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069797
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182006
  error estimate for blocks of size 2^( 2) =       0.000413945490
  error estimate for blocks of size 2^( 3) =       0.000426621020
  error estimate for blocks of size 2^( 4) =       0.000438235806
  error estimate for blocks of size 2^( 5) =       0.000448299328
  error estimate for blocks of size 2^( 6) =       0.000452271046
  error estimate for blocks of size 2^( 7) =       0.000457376504

      target function =                  N/A
              le_mean =     -16.906183372195
             les_mean =     286.153775463611
             stat err =       0.000449045671
             autocorr =       1.252847285179
              std dev =       0.567357034257
             le_variance =       0.321894004321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069795
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069795
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182006
  error estimate for blocks of size 2^( 2) =       0.000413945490
  error estimate for blocks of size 2^( 3) =       0.000426621020
  error estimate for blocks of size 2^( 4) =       0.000438235806
  error estimate for blocks of size 2^( 5) =       0.000448299328
  error estimate for blocks of size 2^( 6) =       0.000452271046
  error estimate for blocks of size 2^( 7) =       0.000457376504

      target function =                  N/A
              le_mean =     -16.906183372195
             les_mean =     286.153775463104
             stat err =       0.000449045671
             autocorr =       1.252847285179
              std dev =       0.567357034256
             le_variance =       0.321894004320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069794
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321862069794
                                         uncertainty =       0.001858387359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401182006
  error estimate for blocks of size 2^( 2) =       0.000413945490
  error estimate for blocks of size 2^( 3) =       0.000426621020
  error estimate for blocks of size 2^( 4) =       0.000438235806
  error estimate for blocks of size 2^( 5) =       0.000448299328
  error estimate for blocks of size 2^( 6) =       0.000452271046
  error estimate for blocks of size 2^( 7) =       0.000457376504

      target function =                  N/A
              le_mean =     -16.906183372195
             les_mean =     286.153775462660
             stat err =       0.000449045671
             autocorr =       1.252847285175
              std dev =       0.567357034255
             le_variance =       0.321894004319


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906183372195        initial  <--
     9.5367e+07     9.5367e+08             4.8344e-12       -16.906183372195
     3.8147e+08     3.8147e+09             1.2086e-12       -16.906183372195
     1.5259e+09     1.5259e+10             3.0215e-13       -16.906183372195

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 37.5058
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.0669e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8785
    reference variance = 0.209901
====================================================
  Execution time = 2.1196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3874e-01
  Total weights = 1.951796144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249008247
                                         uncertainty =       0.002427651243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249008247
                                         uncertainty =       0.002427651243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403224500
  error estimate for blocks of size 2^( 2) =       0.000416161463
  error estimate for blocks of size 2^( 3) =       0.000429317755
  error estimate for blocks of size 2^( 4) =       0.000441349547
  error estimate for blocks of size 2^( 5) =       0.000452464743
  error estimate for blocks of size 2^( 6) =       0.000460435377
  error estimate for blocks of size 2^( 7) =       0.000463185660

      target function =                  N/A
              le_mean =     -16.906683183392
             les_mean =     286.174678685995
             stat err =       0.000454358832
             autocorr =       1.269708784065
              std dev =       0.570245556764
             le_variance =       0.325179995009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668318339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683183390       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906683183390       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906683183390       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906683183390       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906683104764       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906682756990       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906683183390       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906684633157       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906683799458       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906684118124       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+08 is 5.272070e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683183390       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906683183390       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906683183390       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906683183390       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906682604714       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906683174725       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906680038266       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906685709762       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906684471796       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906683199766       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+09 is 1.318332e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906683183390       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906683183390       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906683183390       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906683183390       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906683183390       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906681463231       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906687861441       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906670218403       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906694066723       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906685356066       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+10 is 3.299378e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7512e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.2194
====================================================
  Execution time = 2.1243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4038e-01
  Total weights = 1.9516e+06
  Execution time = 1.9328e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404362491
  error estimate for blocks of size 2^( 2) =       0.000416912513
  error estimate for blocks of size 2^( 3) =       0.000429984636
  error estimate for blocks of size 2^( 4) =       0.000442502845
  error estimate for blocks of size 2^( 5) =       0.000453189308
  error estimate for blocks of size 2^( 6) =       0.000461069741
  error estimate for blocks of size 2^( 7) =       0.000466823446

      target function =                  N/A
              le_mean =     -16.905806704675
             les_mean =     286.146683097819
             stat err =       0.000455896335
             autocorr =       1.271131481637
              std dev =       0.571854919132
             le_variance =       0.327018048535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404362491
  error estimate for blocks of size 2^( 2) =       0.000416912513
  error estimate for blocks of size 2^( 3) =       0.000429984636
  error estimate for blocks of size 2^( 4) =       0.000442502845
  error estimate for blocks of size 2^( 5) =       0.000453189308
  error estimate for blocks of size 2^( 6) =       0.000461069741
  error estimate for blocks of size 2^( 7) =       0.000466823446

      target function =                  N/A
              le_mean =     -16.905806704675
             les_mean =     286.146683097817
             stat err =       0.000455896335
             autocorr =       1.271131481640
              std dev =       0.571854919131
             le_variance =       0.327018048535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404362491
  error estimate for blocks of size 2^( 2) =       0.000416912513
  error estimate for blocks of size 2^( 3) =       0.000429984636
  error estimate for blocks of size 2^( 4) =       0.000442502845
  error estimate for blocks of size 2^( 5) =       0.000453189308
  error estimate for blocks of size 2^( 6) =       0.000461069741
  error estimate for blocks of size 2^( 7) =       0.000466823446

      target function =                  N/A
              le_mean =     -16.905806704675
             les_mean =     286.146683097818
             stat err =       0.000455896335
             autocorr =       1.271131481639
              std dev =       0.571854919131
             le_variance =       0.327018048535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327004257264
                                         uncertainty =       0.003283600323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404362491
  error estimate for blocks of size 2^( 2) =       0.000416912513
  error estimate for blocks of size 2^( 3) =       0.000429984636
  error estimate for blocks of size 2^( 4) =       0.000442502845
  error estimate for blocks of size 2^( 5) =       0.000453189308
  error estimate for blocks of size 2^( 6) =       0.000461069741
  error estimate for blocks of size 2^( 7) =       0.000466823446

      target function =                  N/A
              le_mean =     -16.905806704675
             les_mean =     286.146683097818
             stat err =       0.000455896335
             autocorr =       1.271131481639
              std dev =       0.571854919131
             le_variance =       0.327018048535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905806704675        initial  <--
     9.5367e+08     9.5367e+09             5.2721e-13       -16.905806704675
     3.8147e+09     3.8147e+10             1.3183e-13       -16.905806704675
     1.5259e+10     1.5259e+11             3.2994e-14       -16.905806704675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.4680
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8431
    reference variance = 0.450199
====================================================
  Execution time = 3.2084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3462e-01
  Total weights = 1.951908997e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322152846500
                                         uncertainty =       0.002856043346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322152846500
                                         uncertainty =       0.002856043346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401349283
  error estimate for blocks of size 2^( 2) =       0.000414343957
  error estimate for blocks of size 2^( 3) =       0.000427769118
  error estimate for blocks of size 2^( 4) =       0.000440365156
  error estimate for blocks of size 2^( 5) =       0.000450322121
  error estimate for blocks of size 2^( 6) =       0.000457329576
  error estimate for blocks of size 2^( 7) =       0.000462690227

      target function =                  N/A
              le_mean =     -16.906099767166
             les_mean =     286.150832906958
             stat err =       0.000452676770
             autocorr =       1.272129818227
              std dev =       0.567593599906
             le_variance =       0.322162494655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609976717e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099767163       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099767163       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099767163       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099223350       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906099596039       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906099995098       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906089512045       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906102949797       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906099433269       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906100407772       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+09 is 5.459855e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099767163       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099767163       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099767163       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099767163       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906095684135       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906098302254       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906120656958       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092238769       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906107958177       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906001737863       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906108748508       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906122293746       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906575446534       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906622549087       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906377766661       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906165372082       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906068354545       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906283640494       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905781167706       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906028871174       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904892793906       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907121422924       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.904898569364       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.904632676964       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905954361298       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904325801804       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905032142174       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.908298582600       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.905250818803       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904700839538       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901532584475       residual = 2.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.896659928946       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.908563315903       residual = 8.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.900738161521       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.907027039789       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.903369271714       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.902623398950       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.907361706388       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.908355328213       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.907082858542       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.914956273770       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.915951313923       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.903361245002       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.904034887976       residual = 6.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.899056223279       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.903523872611       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.903000636307       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.907707352897       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.901196701479       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.908881182941       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.913654252847       residual = 7.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.903841898362       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.905177326668       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.906418152216       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.907816264191       residual = 5.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.907391276472       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.902228989031       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.905446015396       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.907746279335       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.906053723116       residual = 1.62e-04           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.907332034773       residual = 3.02e-04           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.908953835300       residual = 1.68e-03           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.904724430248       residual = 2.85e-04           smallest_sin_value = 9.95e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.910089294912       residual = 2.13e-03           smallest_sin_value = 9.91e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+10 is 1.370596e-14

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906099767163       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906099767163       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906099767163       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906099767163       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906151469497       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906129331018       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906205473705       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905908761073       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906918811437       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906380111977       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906672466130       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903961539780       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905855845047       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908170578369       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.904295184792       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.903115150007       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913435317108       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904638460137       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.901669987028       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.900959003722       residual = 3.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906855698527       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902010345443       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.901988783582       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.918586086224       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.925329605262       residual = 4.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904405164042       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.917630034002       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.895651555561       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.907350684864       residual = 4.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910700377418       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.915940257235       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.904702071363       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.921874942441       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.896128195662       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.908414570018       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.916282964225       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.924917852026       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.908198509559       residual = 3.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.898361687238       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.919445244607       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.901306868487       residual = 6.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.903502416985       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.917013272641       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.875722499080       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.896574449034       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.912907524998       residual = 6.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.892619743790       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.911246862302       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.904159753309       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.893749980122       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.889967963070       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.923959882793       residual = 4.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.881329786426       residual = 9.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.916089827241       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.889420359248       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.893800201412       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.922926004082       residual = 4.16e-02           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.912748548139       residual = 1.71e-02           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.911486983875       residual = 5.05e-03           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.900687683163       residual = 8.38e-03           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.894121249745       residual = 1.86e-02           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.916372066501       residual = 2.00e-02           smallest_sin_value = 9.97e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.894185222225       residual = 2.69e-02           smallest_sin_value = 9.95e-01
davidson iteration   63 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         63 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+11 is 3.377484e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507539 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.8295e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.0079
    reference variance = 0.294544
====================================================
  Execution time = 2.1148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3775e-01
  Total weights = 1.9518e+06
  Execution time = 1.9161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403596926
  error estimate for blocks of size 2^( 2) =       0.000416368535
  error estimate for blocks of size 2^( 3) =       0.000429341599
  error estimate for blocks of size 2^( 4) =       0.000441454836
  error estimate for blocks of size 2^( 5) =       0.000452320978
  error estimate for blocks of size 2^( 6) =       0.000460467581
  error estimate for blocks of size 2^( 7) =       0.000464169160

      target function =                  N/A
              le_mean =     -16.905986405967
             les_mean =     286.150126276763
             stat err =       0.000454603139
             autocorr =       1.268729859395
              std dev =       0.570772246088
             le_variance =       0.325780956905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403596926
  error estimate for blocks of size 2^( 2) =       0.000416368535
  error estimate for blocks of size 2^( 3) =       0.000429341599
  error estimate for blocks of size 2^( 4) =       0.000441454836
  error estimate for blocks of size 2^( 5) =       0.000452320978
  error estimate for blocks of size 2^( 6) =       0.000460467581
  error estimate for blocks of size 2^( 7) =       0.000464169160

      target function =                  N/A
              le_mean =     -16.905986405967
             les_mean =     286.150126276762
             stat err =       0.000454603139
             autocorr =       1.268729859392
              std dev =       0.570772246088
             le_variance =       0.325780956905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403596926
  error estimate for blocks of size 2^( 2) =       0.000416368535
  error estimate for blocks of size 2^( 3) =       0.000429341599
  error estimate for blocks of size 2^( 4) =       0.000441454836
  error estimate for blocks of size 2^( 5) =       0.000452320978
  error estimate for blocks of size 2^( 6) =       0.000460467581
  error estimate for blocks of size 2^( 7) =       0.000464169160

      target function =                  N/A
              le_mean =     -16.905986405967
             les_mean =     286.150126276763
             stat err =       0.000454603139
             autocorr =       1.268729859388
              std dev =       0.570772246088
             le_variance =       0.325780956905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325869024543
                                         uncertainty =       0.002810490164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403596926
  error estimate for blocks of size 2^( 2) =       0.000416368535
  error estimate for blocks of size 2^( 3) =       0.000429341599
  error estimate for blocks of size 2^( 4) =       0.000441454836
  error estimate for blocks of size 2^( 5) =       0.000452320978
  error estimate for blocks of size 2^( 6) =       0.000460467581
  error estimate for blocks of size 2^( 7) =       0.000464169160

      target function =                  N/A
              le_mean =     -16.905986405967
             les_mean =     286.150126276763
             stat err =       0.000454603139
             autocorr =       1.268729859396
              std dev =       0.570772246088
             le_variance =       0.325780956905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905986405967        initial  <--
     9.5367e+09     9.5367e+10             5.4599e-14       -16.905986405967
     3.8147e+10     3.8147e+11             1.3706e-14       -16.905986405967
     1.5259e+11     1.5259e+12             3.3775e-15       -16.905986405967

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8571
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.9290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8028
    reference variance = 0.149861
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3719e-01
  Total weights = 1.951751914e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323192120845
                                         uncertainty =       0.001848113334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323192120845
                                         uncertainty =       0.001848113334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401940275
  error estimate for blocks of size 2^( 2) =       0.000414374303
  error estimate for blocks of size 2^( 3) =       0.000426957879
  error estimate for blocks of size 2^( 4) =       0.000437395025
  error estimate for blocks of size 2^( 5) =       0.000447671046
  error estimate for blocks of size 2^( 6) =       0.000454154694
  error estimate for blocks of size 2^( 7) =       0.000459163581

      target function =                  N/A
              le_mean =     -16.906557279453
             les_mean =     286.168869241741
             stat err =       0.000449596087
             autocorr =       1.251186336996
              std dev =       0.568429388695
             le_variance =       0.323111969932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655727945e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+10, overlap shift 9.5367e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557279447       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557279447       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557279447       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557279447       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906550642354       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906551795192       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906584365631       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906520475254       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906519519336       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906921170016       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906545646069       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906626043167       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905984333221       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906133542705       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906322508635       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907006510255       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906984699484       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905171993444       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906012785061       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910148082437       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906877570836       residual = 4.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908369064264       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.895581039837       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.913306992693       residual = 6.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909294825353       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908858520358       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.903438086076       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.902519495000       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906141310902       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910780909085       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.899405211970       residual = 6.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.908280111809       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.912673000952       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.902170203362       residual = 2.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.913652145780       residual = 7.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.913220792870       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907243681692       residual = 7.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.903113883383       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.906530693359       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.905836024748       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.908111225080       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.909614751823       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.911356612830       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.900812178154       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.892559363912       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.896328528057       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.895201367137       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.900433411049       residual = 5.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.908424499293       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.912611825163       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.907184741597       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.904099247727       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.906170116448       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.903843506242       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.902270896848       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.906997537080       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.886604907531       residual = 5.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.911851657760       residual = 5.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.897981121325       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.906805460609       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.905232912379       residual = 8.82e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.901214049074       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.903649840118       residual = 2.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.906428321370       residual = 9.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.919335938813       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.912794412762       residual = 6.87e-03           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.907856284607       residual = 1.38e-03           smallest_sin_value = 9.99e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.888364702876       residual = 4.70e-02           smallest_sin_value = 9.99e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.917840654144       residual = 1.71e-02           smallest_sin_value = 9.95e-01
davidson iteration   69:   krylov dim =  70   energy =     -16.930236319692       residual = 7.50e-02           smallest_sin_value = 9.94e-01
davidson iteration   70:   krylov dim =  71   energy =     -16.925797686794       residual = 4.55e-02           smallest_sin_value = 9.94e-01
davidson iteration   71:   krylov dim =  72   energy =     -16.910198507318       residual = 3.78e-03           smallest_sin_value = 9.91e-01
davidson iteration   72:   krylov dim =  73   energy =     -16.900159987941       residual = 4.52e-03           smallest_sin_value = 9.91e-01
davidson iteration   73 stopping due to small subspace S singular value of 9.48e-01
davidson solver did not converge after         73 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+10 is 7.985027e-15

solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557279447       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557279447       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557279447       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557279447       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652893694       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703650723       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906106246031       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905701937992       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906078912869       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907400584951       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905233575063       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.908066688015       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.902417211103       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907630942055       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.897367876334       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.926041260034       residual = 5.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.881254018225       residual = 8.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910305170471       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.919605013107       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.896243497552       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.865780452155       residual = 2.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903469870798       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.940123099114       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907981946637       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.890514876701       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.885442838029       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.946688841094       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.926996884129       residual = 5.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.868481870703       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.926018615858       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.877690451098       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.940253062728       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.923122693301       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.884799693185       residual = 6.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.883752279527       residual = 7.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.888165223234       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.898509371977       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.895801512290       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.859377390372       residual = 2.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.940056008408       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.890937765355       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.881760720221       residual = 9.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.925511382033       residual = 4.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.922263856574       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.922986540456       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.942124534561       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.947468202196       residual = 2.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.910724173663       residual = 2.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.887973232694       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.859102057258       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.904275883300       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.843303408682       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.888690119674       residual = 4.43e-02           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   energy =     -16.924830163057       residual = 3.80e-02           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -16.847776496965       residual = 4.57e-01           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.947207452611       residual = 2.50e-01           smallest_sin_value = 9.97e-01
davidson iteration   56:   krylov dim =  57   energy =     -16.901077326739       residual = 9.45e-03           smallest_sin_value = 9.96e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.941257905434       residual = 1.64e-01           smallest_sin_value = 9.91e-01
davidson iteration   58 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         58 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+11 is 1.958699e-15

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557279447       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557279447       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557279447       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557279447       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907066978973       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906170547963       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907057764740       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.908506451609       residual = 5.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.900706279468       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.902823089455       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906727946596       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.903461920897       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909572753539       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913217448833       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907023014147       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.902662484670       residual = 2.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.921591119091       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.873994447106       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905562022514       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907662970025       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.934054919703       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.982912511241       residual = 7.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.852491581267       residual = 4.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.946406541934       residual = 3.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.923242964259       residual = 4.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.925448091448       residual = 3.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.882937301071       residual = 6.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.874020412100       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.136665827559       residual = 6.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.893205511958       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.720407866853       residual = 4.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.947999591815       residual = 2.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.423352655365       residual = 2.92e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.936617168417       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.863428735471       residual = 2.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.986397034841       residual = 8.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.792828771860       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.931186841368       residual = 6.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.941480908253       residual = 3.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.642596705127       residual = 9.33e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.822148245080       residual = 8.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.752477856171       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.981864825076       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.847711571247       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.716779676341       residual = 4.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.997831093125       residual = 1.62e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.962479615674       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.357023620682       residual = 2.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.994266532017       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.849798045045       residual = 6.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.850965869952       residual = 8.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.814131333621       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.062147050250       residual = 3.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.713374768820       residual = 6.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.812044709076       residual = 2.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.832061047457       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.929074220904       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.958248083282       residual = 9.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.831976266308       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.887007348929       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.906186683380       residual = 3.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.821444153738       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.951053737668       residual = 9.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.950236776201       residual = 4.87e-01           smallest_sin_value = 9.99e-01
davidson iteration   64:   krylov dim =  65   energy =     -17.007213180959       residual = 1.40e+00           smallest_sin_value = 9.99e-01
davidson iteration   65:   krylov dim =  66   energy =     -16.974073007124       residual = 9.26e-01           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.930416097481       residual = 2.79e-01           smallest_sin_value = 9.97e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.826576756608       residual = 1.47e+00           smallest_sin_value = 9.94e-01
davidson iteration   68:   krylov dim =  69   energy =     -17.055962134114       residual = 3.28e+00           smallest_sin_value = 9.94e-01
davidson iteration   69 stopping due to small subspace S singular value of 9.68e-01
davidson solver did not converge after         69 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+12 is 4.524728e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.869049 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7276e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.208218
====================================================
  Execution time = 2.3959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3742e-01
  Total weights = 1.9515e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400575
  error estimate for blocks of size 2^( 2) =       0.000414370967
  error estimate for blocks of size 2^( 3) =       0.000427574966
  error estimate for blocks of size 2^( 4) =       0.000439836638
  error estimate for blocks of size 2^( 5) =       0.000450568672
  error estimate for blocks of size 2^( 6) =       0.000457381662
  error estimate for blocks of size 2^( 7) =       0.000461975844

      target function =                  N/A
              le_mean =     -16.905799951610
             les_mean =     286.143494982383
             stat err =       0.000452440704
             autocorr =       1.270478610293
              std dev =       0.567666137303
             le_variance =       0.322244843441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400575
  error estimate for blocks of size 2^( 2) =       0.000414370967
  error estimate for blocks of size 2^( 3) =       0.000427574966
  error estimate for blocks of size 2^( 4) =       0.000439836638
  error estimate for blocks of size 2^( 5) =       0.000450568672
  error estimate for blocks of size 2^( 6) =       0.000457381662
  error estimate for blocks of size 2^( 7) =       0.000461975844

      target function =                  N/A
              le_mean =     -16.905799951610
             les_mean =     286.143494982383
             stat err =       0.000452440704
             autocorr =       1.270478610289
              std dev =       0.567666137303
             le_variance =       0.322244843441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400575
  error estimate for blocks of size 2^( 2) =       0.000414370967
  error estimate for blocks of size 2^( 3) =       0.000427574966
  error estimate for blocks of size 2^( 4) =       0.000439836638
  error estimate for blocks of size 2^( 5) =       0.000450568672
  error estimate for blocks of size 2^( 6) =       0.000457381662
  error estimate for blocks of size 2^( 7) =       0.000461975844

      target function =                  N/A
              le_mean =     -16.905799951610
             les_mean =     286.143494982383
             stat err =       0.000452440704
             autocorr =       1.270478610291
              std dev =       0.567666137303
             le_variance =       0.322244843441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322292216703
                                         uncertainty =       0.002190297942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401400575
  error estimate for blocks of size 2^( 2) =       0.000414370967
  error estimate for blocks of size 2^( 3) =       0.000427574966
  error estimate for blocks of size 2^( 4) =       0.000439836638
  error estimate for blocks of size 2^( 5) =       0.000450568672
  error estimate for blocks of size 2^( 6) =       0.000457381662
  error estimate for blocks of size 2^( 7) =       0.000461975844

      target function =                  N/A
              le_mean =     -16.905799951610
             les_mean =     286.143494982383
             stat err =       0.000452440704
             autocorr =       1.270478610291
              std dev =       0.567666137303
             le_variance =       0.322244843441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905799951610        initial  <--
     9.5367e+10     9.5367e+11             7.9850e-15       -16.905799951610
     3.8147e+11     3.8147e+12             1.9587e-15       -16.905799951610
     1.5259e+12     1.5259e+13             4.5247e-16       -16.905799951610

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.4225
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.947
    reference variance = 0.316135
====================================================
  Execution time = 2.1191e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2987e-01
  Total weights = 1.951642912e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317973854242
                                         uncertainty =       0.002094278158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317973854242
                                         uncertainty =       0.002094278158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398741277
  error estimate for blocks of size 2^( 2) =       0.000411809181
  error estimate for blocks of size 2^( 3) =       0.000425378135
  error estimate for blocks of size 2^( 4) =       0.000438530422
  error estimate for blocks of size 2^( 5) =       0.000449039357
  error estimate for blocks of size 2^( 6) =       0.000457016068
  error estimate for blocks of size 2^( 7) =       0.000461275254

      target function =                  N/A
              le_mean =     -16.905683799256
             les_mean =     286.132018264725
             stat err =       0.000451465275
             autocorr =       1.281935909753
              std dev =       0.563905321542
             le_variance =       0.317989211663


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568379926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683799230       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905683799230       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683799230       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683799230       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890837291       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905687397702       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905431577624       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905264779334       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907332440888       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907810518097       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905370204763       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906554191086       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.898092632856       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.904616728877       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914095291980       residual = 9.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.928825837722       residual = 7.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.920915553366       residual = 3.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910193207998       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.849286637075       residual = 4.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.853749068788       residual = 3.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.843711525714       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.977765197335       residual = 7.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.881652689441       residual = 7.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.921827428220       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.888453401578       residual = 4.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.881587295425       residual = 6.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.938779996349       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.891398269484       residual = 3.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.990701879798       residual = 9.82e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.869588061400       residual = 1.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.848972840949       residual = 4.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.888930341925       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.869923710108       residual = 1.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.869613761164       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.856885910623       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.967842171261       residual = 5.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.892487485492       residual = 3.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.978350044603       residual = 6.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.915057198579       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.886447941508       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.952211838104       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.886092482178       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.968969541740       residual = 5.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.930407284082       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.826056168069       residual = 8.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.927795353288       residual = 9.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.866132878260       residual = 2.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.912877935533       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.896138488757       residual = 1.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.890917286449       residual = 8.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.794554369688       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.940658449001       residual = 2.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.826618771674       residual = 8.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.857895831779       residual = 3.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.773542441277       residual = 2.33e+00           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.789448424418       residual = 1.99e+00           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -16.960286946900       residual = 7.04e-01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.872099750359       residual = 2.11e-01           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.017934687829       residual = 1.62e+00           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.004963423364       residual = 1.45e+00           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.802619245656       residual = 2.14e+00           smallest_sin_value = 9.93e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.011729743414       residual = 1.39e+00           smallest_sin_value = 9.92e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+11 is 4.863283e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683799230       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905683799230       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905683799230       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905234695756       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.900685679632       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.904953117095       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905683799232       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.903630127657       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.903845784642       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912506359845       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.956059967550       residual = 3.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.927186573393       residual = 6.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.957444079451       residual = 3.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.864127838759       residual = 2.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.806945672569       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.972863224324       residual = 6.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910618289469       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.935222257265       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.873989386047       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.857350022467       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.820867968239       residual = 9.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.739636165835       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.858063245760       residual = 2.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914685382079       residual = 5.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.881409554792       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.776069420881       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.661180030662       residual = 7.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.966733596078       residual = 5.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.941040243216       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.925547862734       residual = 6.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.723362630119       residual = 4.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.023922288186       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.803250221094       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.581829187206       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.487960542146       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.922909061303       residual = 5.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.151700457327       residual = 8.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.832657195066       residual = 7.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.974903626115       residual = 1.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.913902221561       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.380104050755       residual = 3.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.454921496012       residual = 2.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.519470822738       residual = 4.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.174900871622       residual = 9.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.886449547815       residual = 5.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.828119050846       residual = 4.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.757878903143       residual = 2.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.766846345487       residual = 3.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.904586732249       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -15.065779458890       residual = 4.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.276741580912       residual = 5.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.468943536806       residual = 2.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -18.280720751820       residual = 2.88e+02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.579463380514       residual = 1.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.077982258146       residual = 8.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.225679403435       residual = 1.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.755558967995       residual = 3.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.252907981861       residual = 5.64e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.431051215635       residual = 3.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.019676887800       residual = 5.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.988824999330       residual = 5.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -18.000300738640       residual = 1.54e+02           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.492796675409       residual = 2.81e+01           smallest_sin_value = 9.99e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.153111280772       residual = 8.51e+00           smallest_sin_value = 9.97e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.245713875840       residual = 7.56e+01           smallest_sin_value = 9.95e-01
davidson iteration   65:   krylov dim =  66   energy =     -17.614850122091       residual = 5.85e+01           smallest_sin_value = 9.91e-01
davidson iteration   66 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         66 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+12 is 1.225225e-16

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905683799230       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905683799230       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.66e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.077393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7497e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8275
    reference variance = 0.333593
====================================================
  Execution time = 2.0757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2881e-01
  Total weights = 1.9513e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397923710
  error estimate for blocks of size 2^( 2) =       0.000410856149
  error estimate for blocks of size 2^( 3) =       0.000423721476
  error estimate for blocks of size 2^( 4) =       0.000436143469
  error estimate for blocks of size 2^( 5) =       0.000446333408
  error estimate for blocks of size 2^( 6) =       0.000453291226
  error estimate for blocks of size 2^( 7) =       0.000459193371

      target function =                  N/A
              le_mean =     -16.906236939423
             les_mean =     286.149661236271
             stat err =       0.000448740369
             autocorr =       1.271717495413
              std dev =       0.562749107900
             le_variance =       0.316686558442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397923710
  error estimate for blocks of size 2^( 2) =       0.000410856149
  error estimate for blocks of size 2^( 3) =       0.000423721476
  error estimate for blocks of size 2^( 4) =       0.000436143469
  error estimate for blocks of size 2^( 5) =       0.000446333408
  error estimate for blocks of size 2^( 6) =       0.000453291226
  error estimate for blocks of size 2^( 7) =       0.000459193371

      target function =                  N/A
              le_mean =     -16.906236939423
             les_mean =     286.149661236271
             stat err =       0.000448740369
             autocorr =       1.271717495412
              std dev =       0.562749107900
             le_variance =       0.316686558442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397923710
  error estimate for blocks of size 2^( 2) =       0.000410856149
  error estimate for blocks of size 2^( 3) =       0.000423721476
  error estimate for blocks of size 2^( 4) =       0.000436143469
  error estimate for blocks of size 2^( 5) =       0.000446333408
  error estimate for blocks of size 2^( 6) =       0.000453291226
  error estimate for blocks of size 2^( 7) =       0.000459193371

      target function =                  N/A
              le_mean =     -16.906236939423
             les_mean =     286.149661236271
             stat err =       0.000448740369
             autocorr =       1.271717495411
              std dev =       0.562749107900
             le_variance =       0.316686558442

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654777283
                                         uncertainty =       0.001873028996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397923710
  error estimate for blocks of size 2^( 2) =       0.000410856149
  error estimate for blocks of size 2^( 3) =       0.000423721476
  error estimate for blocks of size 2^( 4) =       0.000436143469
  error estimate for blocks of size 2^( 5) =       0.000446333408
  error estimate for blocks of size 2^( 6) =       0.000453291226
  error estimate for blocks of size 2^( 7) =       0.000459193371

      target function =                  N/A
              le_mean =     -16.906236939423
             les_mean =     286.149661236271
             stat err =       0.000448740369
             autocorr =       1.271717495413
              std dev =       0.562749107900
             le_variance =       0.316686558442


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906236939423        initial  <--
     9.5367e+11     9.5367e+12             4.8633e-16       -16.906236939423
     3.8147e+12     3.8147e+13             1.2252e-16       -16.906236939423
     1.5259e+13     1.5259e+14             0.0000e+00       -16.906236939423

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2783
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8792
    reference variance = 0.259633
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3610e-01
  Total weights = 1.951778216e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323246158140
                                         uncertainty =       0.002905413451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323246158140
                                         uncertainty =       0.002905413451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401967592
  error estimate for blocks of size 2^( 2) =       0.000414913117
  error estimate for blocks of size 2^( 3) =       0.000427796388
  error estimate for blocks of size 2^( 4) =       0.000439813492
  error estimate for blocks of size 2^( 5) =       0.000450137215
  error estimate for blocks of size 2^( 6) =       0.000458481905
  error estimate for blocks of size 2^( 7) =       0.000464057633

      target function =                  N/A
              le_mean =     -16.906528184388
             les_mean =     286.166792674748
             stat err =       0.000453122561
             autocorr =       1.270718323982
              std dev =       0.568468020201
             le_variance =       0.323155889992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652818439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528184374       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.078579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6985e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9343
    reference variance = 0.262731
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3582e-01
  Total weights = 1.9517e+06
  Execution time = 1.8866e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401248368
  error estimate for blocks of size 2^( 2) =       0.000414220115
  error estimate for blocks of size 2^( 3) =       0.000427711226
  error estimate for blocks of size 2^( 4) =       0.000439867183
  error estimate for blocks of size 2^( 5) =       0.000449310310
  error estimate for blocks of size 2^( 6) =       0.000457447751
  error estimate for blocks of size 2^( 7) =       0.000460111458

      target function =                  N/A
              le_mean =     -16.906024698324
             les_mean =     286.149489590139
             stat err =       0.000451684175
             autocorr =       1.267194245396
              std dev =       0.567450884563
             le_variance =       0.322000506392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401248368
  error estimate for blocks of size 2^( 2) =       0.000414220115
  error estimate for blocks of size 2^( 3) =       0.000427711226
  error estimate for blocks of size 2^( 4) =       0.000439867183
  error estimate for blocks of size 2^( 5) =       0.000449310310
  error estimate for blocks of size 2^( 6) =       0.000457447751
  error estimate for blocks of size 2^( 7) =       0.000460111458

      target function =                  N/A
              le_mean =     -16.906024698324
             les_mean =     286.149489590139
             stat err =       0.000451684175
             autocorr =       1.267194245396
              std dev =       0.567450884563
             le_variance =       0.322000506392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401248368
  error estimate for blocks of size 2^( 2) =       0.000414220115
  error estimate for blocks of size 2^( 3) =       0.000427711226
  error estimate for blocks of size 2^( 4) =       0.000439867183
  error estimate for blocks of size 2^( 5) =       0.000449310310
  error estimate for blocks of size 2^( 6) =       0.000457447751
  error estimate for blocks of size 2^( 7) =       0.000460111458

      target function =                  N/A
              le_mean =     -16.906024698324
             les_mean =     286.149489590139
             stat err =       0.000451684175
             autocorr =       1.267194245396
              std dev =       0.567450884563
             le_variance =       0.322000506392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322035064785
                                         uncertainty =       0.002012696634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401248368
  error estimate for blocks of size 2^( 2) =       0.000414220115
  error estimate for blocks of size 2^( 3) =       0.000427711226
  error estimate for blocks of size 2^( 4) =       0.000439867183
  error estimate for blocks of size 2^( 5) =       0.000449310310
  error estimate for blocks of size 2^( 6) =       0.000457447751
  error estimate for blocks of size 2^( 7) =       0.000460111458

      target function =                  N/A
              le_mean =     -16.906024698324
             les_mean =     286.149489590139
             stat err =       0.000451684175
             autocorr =       1.267194245396
              std dev =       0.567450884563
             le_variance =       0.322000506392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906024698324        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -16.906024698324
     3.8147e+13     3.8147e+14             0.0000e+00       -16.906024698324
     1.5259e+14     1.5259e+15             0.0000e+00       -16.906024698324

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3857
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9028
    reference variance = 0.275674
====================================================
  Execution time = 2.1237e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3725e-01
  Total weights = 1.951433404e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324545898234
                                         uncertainty =       0.002236623380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324545898234
                                         uncertainty =       0.002236623380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402807318
  error estimate for blocks of size 2^( 2) =       0.000415645364
  error estimate for blocks of size 2^( 3) =       0.000428553553
  error estimate for blocks of size 2^( 4) =       0.000441224946
  error estimate for blocks of size 2^( 5) =       0.000450789761
  error estimate for blocks of size 2^( 6) =       0.000458135081
  error estimate for blocks of size 2^( 7) =       0.000462876018

      target function =                  N/A
              le_mean =     -16.906531403664
             les_mean =     286.168049688648
             stat err =       0.000453256451
             autocorr =       1.266173690848
              std dev =       0.569655571791
             le_variance =       0.324507470472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653140366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906531403657       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.079730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7287e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9145
    reference variance = 0.215936
====================================================
  Execution time = 2.8844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3702e-01
  Total weights = 1.9516e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777624
  error estimate for blocks of size 2^( 2) =       0.000416296309
  error estimate for blocks of size 2^( 3) =       0.000429653685
  error estimate for blocks of size 2^( 4) =       0.000442499507
  error estimate for blocks of size 2^( 5) =       0.000453736613
  error estimate for blocks of size 2^( 6) =       0.000460733231
  error estimate for blocks of size 2^( 7) =       0.000467443709

      target function =                  N/A
              le_mean =     -16.906146434629
             les_mean =     286.154810181891
             stat err =       0.000456103265
             autocorr =       1.282317862236
              std dev =       0.569613577951
             le_variance =       0.324459628187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777624
  error estimate for blocks of size 2^( 2) =       0.000416296309
  error estimate for blocks of size 2^( 3) =       0.000429653685
  error estimate for blocks of size 2^( 4) =       0.000442499507
  error estimate for blocks of size 2^( 5) =       0.000453736613
  error estimate for blocks of size 2^( 6) =       0.000460733231
  error estimate for blocks of size 2^( 7) =       0.000467443709

      target function =                  N/A
              le_mean =     -16.906146434629
             les_mean =     286.154810181891
             stat err =       0.000456103265
             autocorr =       1.282317862236
              std dev =       0.569613577951
             le_variance =       0.324459628187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777624
  error estimate for blocks of size 2^( 2) =       0.000416296309
  error estimate for blocks of size 2^( 3) =       0.000429653685
  error estimate for blocks of size 2^( 4) =       0.000442499507
  error estimate for blocks of size 2^( 5) =       0.000453736613
  error estimate for blocks of size 2^( 6) =       0.000460733231
  error estimate for blocks of size 2^( 7) =       0.000467443709

      target function =                  N/A
              le_mean =     -16.906146434629
             les_mean =     286.154810181891
             stat err =       0.000456103265
             autocorr =       1.282317862236
              std dev =       0.569613577951
             le_variance =       0.324459628187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324385912992
                                         uncertainty =       0.001819485612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402777624
  error estimate for blocks of size 2^( 2) =       0.000416296309
  error estimate for blocks of size 2^( 3) =       0.000429653685
  error estimate for blocks of size 2^( 4) =       0.000442499507
  error estimate for blocks of size 2^( 5) =       0.000453736613
  error estimate for blocks of size 2^( 6) =       0.000460733231
  error estimate for blocks of size 2^( 7) =       0.000467443709

      target function =                  N/A
              le_mean =     -16.906146434629
             les_mean =     286.154810181891
             stat err =       0.000456103265
             autocorr =       1.282317862236
              std dev =       0.569613577951
             le_variance =       0.324459628187


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906146434629        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -16.906146434629
     3.8147e+14     3.8147e+15             0.0000e+00       -16.906146434629
     1.5259e+15     1.5259e+16             0.0000e+00       -16.906146434629

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 38.3660
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.5660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.215512
====================================================
  Execution time = 3.0676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3390e-01
  Total weights = 1.951972283e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094067534
                                         uncertainty =       0.001907453705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094067534
                                         uncertainty =       0.001907453705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401298119
  error estimate for blocks of size 2^( 2) =       0.000414142788
  error estimate for blocks of size 2^( 3) =       0.000427292382
  error estimate for blocks of size 2^( 4) =       0.000439638188
  error estimate for blocks of size 2^( 5) =       0.000450761890
  error estimate for blocks of size 2^( 6) =       0.000459339796
  error estimate for blocks of size 2^( 7) =       0.000466440495

      target function =                  N/A
              le_mean =     -16.906183440997
             les_mean =     286.152934674202
             stat err =       0.000454045092
             autocorr =       1.280158438670
              std dev =       0.567521242533
             le_variance =       0.322080360727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618344100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183440975       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183440975       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183440975       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183440970       residual = 4.74e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906183440976       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -21.258136158551       residual = 2.52e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -14.334777593471       residual = 9.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -21.610736681696       residual = 3.47e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.630581266721       residual = 7.21e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =      -9.226731230129       residual = 8.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -14.178321945706       residual = 9.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+14 is 4.606482e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183440975       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183440975       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183440975       residual = 2.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.716256044890       residual = 8.66e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.434538730360       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -18.031147337587       residual = 1.68e+02           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+15 is 1.151620e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906183440975       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906183440975       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183440975       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.912185336713       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.819213444577       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+16 is 2.879051e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.083176 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.6831e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9664
    reference variance = 0.442518
====================================================
  Execution time = 3.8456e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3255e-01
  Total weights = 1.9522e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113287
  error estimate for blocks of size 2^( 2) =       0.000414091865
  error estimate for blocks of size 2^( 3) =       0.000427018588
  error estimate for blocks of size 2^( 4) =       0.000439688589
  error estimate for blocks of size 2^( 5) =       0.000450801638
  error estimate for blocks of size 2^( 6) =       0.000459446320
  error estimate for blocks of size 2^( 7) =       0.000463887678

      target function =                  N/A
              le_mean =     -16.906381465020
             les_mean =     286.158289123899
             stat err =       0.000453456056
             autocorr =       1.278016078160
              std dev =       0.567259849976
             le_variance =       0.321783737395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113287
  error estimate for blocks of size 2^( 2) =       0.000414091865
  error estimate for blocks of size 2^( 3) =       0.000427018588
  error estimate for blocks of size 2^( 4) =       0.000439688589
  error estimate for blocks of size 2^( 5) =       0.000450801638
  error estimate for blocks of size 2^( 6) =       0.000459446320
  error estimate for blocks of size 2^( 7) =       0.000463887678

      target function =                  N/A
              le_mean =     -16.906381465020
             les_mean =     286.158289123899
             stat err =       0.000453456056
             autocorr =       1.278016078160
              std dev =       0.567259849976
             le_variance =       0.321783737395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113287
  error estimate for blocks of size 2^( 2) =       0.000414091865
  error estimate for blocks of size 2^( 3) =       0.000427018588
  error estimate for blocks of size 2^( 4) =       0.000439688589
  error estimate for blocks of size 2^( 5) =       0.000450801638
  error estimate for blocks of size 2^( 6) =       0.000459446320
  error estimate for blocks of size 2^( 7) =       0.000463887678

      target function =                  N/A
              le_mean =     -16.906381465020
             les_mean =     286.158289123899
             stat err =       0.000453456056
             autocorr =       1.278016078160
              std dev =       0.567259849976
             le_variance =       0.321783737395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321735018086
                                         uncertainty =       0.002002349468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401113287
  error estimate for blocks of size 2^( 2) =       0.000414091865
  error estimate for blocks of size 2^( 3) =       0.000427018588
  error estimate for blocks of size 2^( 4) =       0.000439688589
  error estimate for blocks of size 2^( 5) =       0.000450801638
  error estimate for blocks of size 2^( 6) =       0.000459446320
  error estimate for blocks of size 2^( 7) =       0.000463887678

      target function =                  N/A
              le_mean =     -16.906381465020
             les_mean =     286.158289123899
             stat err =       0.000453456056
             autocorr =       1.278016078160
              std dev =       0.567259849976
             le_variance =       0.321783737395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906381465020        initial  <--
     9.5367e+14     9.5367e+15             4.6065e-19       -16.906381465020
     3.8147e+15     3.8147e+16             1.1516e-19       -16.906381465020
     1.5259e+16     1.5259e+17             2.8791e-20       -16.906381465020

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 48.0068
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4844e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9819
    reference variance = 0.21186
====================================================
  Execution time = 2.0901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3855e-01
  Total weights = 1.952092663e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324194933173
                                         uncertainty =       0.003351147783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324194933173
                                         uncertainty =       0.003351147783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402619180
  error estimate for blocks of size 2^( 2) =       0.000415438120
  error estimate for blocks of size 2^( 3) =       0.000428631340
  error estimate for blocks of size 2^( 4) =       0.000441001125
  error estimate for blocks of size 2^( 5) =       0.000452527097
  error estimate for blocks of size 2^( 6) =       0.000462392794
  error estimate for blocks of size 2^( 7) =       0.000467618017

      target function =                  N/A
              le_mean =     -16.905665708734
             les_mean =     286.140087059537
             stat err =       0.000455884758
             autocorr =       1.282098009713
              std dev =       0.569389504500
             le_variance =       0.324204407835


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566570873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.45e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.45e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665708696       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.084328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7034e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.979
    reference variance = 0.514153
====================================================
  Execution time = 2.1578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3477e-01
  Total weights = 1.9516e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400207592
  error estimate for blocks of size 2^( 2) =       0.000413028634
  error estimate for blocks of size 2^( 3) =       0.000426211879
  error estimate for blocks of size 2^( 4) =       0.000438358430
  error estimate for blocks of size 2^( 5) =       0.000449556182
  error estimate for blocks of size 2^( 6) =       0.000456813141
  error estimate for blocks of size 2^( 7) =       0.000458575321

      target function =                  N/A
              le_mean =     -16.905581755371
             les_mean =     286.133460147861
             stat err =       0.000450825768
             autocorr =       1.268956738754
              std dev =       0.565979004584
             le_variance =       0.320332233630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400207592
  error estimate for blocks of size 2^( 2) =       0.000413028634
  error estimate for blocks of size 2^( 3) =       0.000426211879
  error estimate for blocks of size 2^( 4) =       0.000438358430
  error estimate for blocks of size 2^( 5) =       0.000449556182
  error estimate for blocks of size 2^( 6) =       0.000456813141
  error estimate for blocks of size 2^( 7) =       0.000458575321

      target function =                  N/A
              le_mean =     -16.905581755371
             les_mean =     286.133460147861
             stat err =       0.000450825768
             autocorr =       1.268956738754
              std dev =       0.565979004584
             le_variance =       0.320332233630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400207592
  error estimate for blocks of size 2^( 2) =       0.000413028634
  error estimate for blocks of size 2^( 3) =       0.000426211879
  error estimate for blocks of size 2^( 4) =       0.000438358430
  error estimate for blocks of size 2^( 5) =       0.000449556182
  error estimate for blocks of size 2^( 6) =       0.000456813141
  error estimate for blocks of size 2^( 7) =       0.000458575321

      target function =                  N/A
              le_mean =     -16.905581755371
             les_mean =     286.133460147861
             stat err =       0.000450825768
             autocorr =       1.268956738754
              std dev =       0.565979004584
             le_variance =       0.320332233630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398053301
                                         uncertainty =       0.002188999731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400207592
  error estimate for blocks of size 2^( 2) =       0.000413028634
  error estimate for blocks of size 2^( 3) =       0.000426211879
  error estimate for blocks of size 2^( 4) =       0.000438358430
  error estimate for blocks of size 2^( 5) =       0.000449556182
  error estimate for blocks of size 2^( 6) =       0.000456813141
  error estimate for blocks of size 2^( 7) =       0.000458575321

      target function =                  N/A
              le_mean =     -16.905581755371
             les_mean =     286.133460147861
             stat err =       0.000450825768
             autocorr =       1.268956738754
              std dev =       0.565979004584
             le_variance =       0.320332233630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905581755371        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -16.905581755371
     3.8147e+16     3.8147e+17             0.0000e+00       -16.905581755371
     1.5259e+17     1.5259e+18             0.0000e+00       -16.905581755371

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1159
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9911e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8735
    reference variance = 0.212401
====================================================
  Execution time = 2.2289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3058e-01
  Total weights = 1.951673475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320781975898
                                         uncertainty =       0.001912339079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320781975898
                                         uncertainty =       0.001912339079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426279
  error estimate for blocks of size 2^( 2) =       0.000413117221
  error estimate for blocks of size 2^( 3) =       0.000425750662
  error estimate for blocks of size 2^( 4) =       0.000437497309
  error estimate for blocks of size 2^( 5) =       0.000447677644
  error estimate for blocks of size 2^( 6) =       0.000455403797
  error estimate for blocks of size 2^( 7) =       0.000459661509

      target function =                  N/A
              le_mean =     -16.906939460984
             les_mean =     286.175182170280
             stat err =       0.000450060065
             autocorr =       1.263268928132
              std dev =       0.566288274469
             le_variance =       0.320682409801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690693946098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906939460971       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.085525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8389e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9525
    reference variance = 0.312684
====================================================
  Execution time = 4.1594e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4211e-01
  Total weights = 1.9521e+06
  Execution time = 1.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912470
  error estimate for blocks of size 2^( 2) =       0.000415570883
  error estimate for blocks of size 2^( 3) =       0.000428611053
  error estimate for blocks of size 2^( 4) =       0.000441315792
  error estimate for blocks of size 2^( 5) =       0.000452519893
  error estimate for blocks of size 2^( 6) =       0.000461801861
  error estimate for blocks of size 2^( 7) =       0.000466842866

      target function =                  N/A
              le_mean =     -16.905671138481
             les_mean =     286.143825934162
             stat err =       0.000455620103
             autocorr =       1.278746149883
              std dev =       0.569804278845
             le_variance =       0.324676916191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912470
  error estimate for blocks of size 2^( 2) =       0.000415570883
  error estimate for blocks of size 2^( 3) =       0.000428611053
  error estimate for blocks of size 2^( 4) =       0.000441315792
  error estimate for blocks of size 2^( 5) =       0.000452519893
  error estimate for blocks of size 2^( 6) =       0.000461801861
  error estimate for blocks of size 2^( 7) =       0.000466842866

      target function =                  N/A
              le_mean =     -16.905671138481
             les_mean =     286.143825934162
             stat err =       0.000455620103
             autocorr =       1.278746149883
              std dev =       0.569804278845
             le_variance =       0.324676916191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912470
  error estimate for blocks of size 2^( 2) =       0.000415570883
  error estimate for blocks of size 2^( 3) =       0.000428611053
  error estimate for blocks of size 2^( 4) =       0.000441315792
  error estimate for blocks of size 2^( 5) =       0.000452519893
  error estimate for blocks of size 2^( 6) =       0.000461801861
  error estimate for blocks of size 2^( 7) =       0.000466842866

      target function =                  N/A
              le_mean =     -16.905671138481
             les_mean =     286.143825934162
             stat err =       0.000455620103
             autocorr =       1.278746149883
              std dev =       0.569804278845
             le_variance =       0.324676916191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324650675798
                                         uncertainty =       0.002486430193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912470
  error estimate for blocks of size 2^( 2) =       0.000415570883
  error estimate for blocks of size 2^( 3) =       0.000428611053
  error estimate for blocks of size 2^( 4) =       0.000441315792
  error estimate for blocks of size 2^( 5) =       0.000452519893
  error estimate for blocks of size 2^( 6) =       0.000461801861
  error estimate for blocks of size 2^( 7) =       0.000466842866

      target function =                  N/A
              le_mean =     -16.905671138481
             les_mean =     286.143825934162
             stat err =       0.000455620103
             autocorr =       1.278746149883
              std dev =       0.569804278845
             le_variance =       0.324676916191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905671138481        initial  <--
     9.5367e+16     9.5367e+17             0.0000e+00       -16.905671138481
     3.8147e+17     3.8147e+18             0.0000e+00       -16.905671138481
     1.5259e+18     1.5259e+19             0.0000e+00       -16.905671138481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.1507
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 7.9547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.346283
====================================================
  Execution time = 2.0770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3855e-01
  Total weights = 1.951624395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325141997412
                                         uncertainty =       0.002492224966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325141997412
                                         uncertainty =       0.002492224966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403216125
  error estimate for blocks of size 2^( 2) =       0.000415895471
  error estimate for blocks of size 2^( 3) =       0.000429614061
  error estimate for blocks of size 2^( 4) =       0.000441888467
  error estimate for blocks of size 2^( 5) =       0.000452413409
  error estimate for blocks of size 2^( 6) =       0.000458887030
  error estimate for blocks of size 2^( 7) =       0.000466198374

      target function =                  N/A
              le_mean =     -16.905906099813
             les_mean =     286.148215346315
             stat err =       0.000454846820
             autocorr =       1.272490480959
              std dev =       0.570233712301
             le_variance =       0.325166486645


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590609981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906099810       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.086687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6885e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.83
    reference variance = 0.669905
====================================================
  Execution time = 2.2879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4009e-01
  Total weights = 1.9515e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403363398
  error estimate for blocks of size 2^( 2) =       0.000416049882
  error estimate for blocks of size 2^( 3) =       0.000428939764
  error estimate for blocks of size 2^( 4) =       0.000440609634
  error estimate for blocks of size 2^( 5) =       0.000450843312
  error estimate for blocks of size 2^( 6) =       0.000458527139
  error estimate for blocks of size 2^( 7) =       0.000462675683

      target function =                  N/A
              le_mean =     -16.906151258351
             les_mean =     286.158035545489
             stat err =       0.000453163942
             autocorr =       1.262169608204
              std dev =       0.570441987974
             le_variance =       0.325404061644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403363398
  error estimate for blocks of size 2^( 2) =       0.000416049882
  error estimate for blocks of size 2^( 3) =       0.000428939764
  error estimate for blocks of size 2^( 4) =       0.000440609634
  error estimate for blocks of size 2^( 5) =       0.000450843312
  error estimate for blocks of size 2^( 6) =       0.000458527139
  error estimate for blocks of size 2^( 7) =       0.000462675683

      target function =                  N/A
              le_mean =     -16.906151258351
             les_mean =     286.158035545489
             stat err =       0.000453163942
             autocorr =       1.262169608204
              std dev =       0.570441987974
             le_variance =       0.325404061644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403363398
  error estimate for blocks of size 2^( 2) =       0.000416049882
  error estimate for blocks of size 2^( 3) =       0.000428939764
  error estimate for blocks of size 2^( 4) =       0.000440609634
  error estimate for blocks of size 2^( 5) =       0.000450843312
  error estimate for blocks of size 2^( 6) =       0.000458527139
  error estimate for blocks of size 2^( 7) =       0.000462675683

      target function =                  N/A
              le_mean =     -16.906151258351
             les_mean =     286.158035545489
             stat err =       0.000453163942
             autocorr =       1.262169608204
              std dev =       0.570441987974
             le_variance =       0.325404061644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325393082868
                                         uncertainty =       0.003367064465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403363398
  error estimate for blocks of size 2^( 2) =       0.000416049882
  error estimate for blocks of size 2^( 3) =       0.000428939764
  error estimate for blocks of size 2^( 4) =       0.000440609634
  error estimate for blocks of size 2^( 5) =       0.000450843312
  error estimate for blocks of size 2^( 6) =       0.000458527139
  error estimate for blocks of size 2^( 7) =       0.000462675683

      target function =                  N/A
              le_mean =     -16.906151258351
             les_mean =     286.158035545489
             stat err =       0.000453163942
             autocorr =       1.262169608204
              std dev =       0.570441987974
             le_variance =       0.325404061644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906151258351        initial  <--
     9.5367e+17     9.5367e+18             0.0000e+00       -16.906151258351
     3.8147e+18     3.8147e+19             0.0000e+00       -16.906151258351
     1.5259e+19     1.5259e+20             0.0000e+00       -16.906151258351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.4185
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8304
    reference variance = 0.164154
====================================================
  Execution time = 2.1004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3732e-01
  Total weights = 1.951723987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324222261441
                                         uncertainty =       0.003032669762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324222261441
                                         uncertainty =       0.003032669762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402610164
  error estimate for blocks of size 2^( 2) =       0.000415653583
  error estimate for blocks of size 2^( 3) =       0.000429015084
  error estimate for blocks of size 2^( 4) =       0.000441944324
  error estimate for blocks of size 2^( 5) =       0.000453017955
  error estimate for blocks of size 2^( 6) =       0.000459438737
  error estimate for blocks of size 2^( 7) =       0.000462974688

      target function =                  N/A
              le_mean =     -16.905160814179
             les_mean =     286.121785810862
             stat err =       0.000454343926
             autocorr =       1.273503032019
              std dev =       0.569376754578
             le_variance =       0.324189888654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690516081418e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160814150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160814150       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905160814150       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905160814150       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905160814058       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+18 is 3.804439e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160814150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160814150       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905160814150       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905160814150       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+19 is 1.083317e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905160814150       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905160814150       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905160814150       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905160814150       residual = 8.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905160814010       residual = 8.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+20 is 2.708293e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.088721 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7173e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9234
    reference variance = 0.251413
====================================================
  Execution time = 2.0642e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3799e-01
  Total weights = 1.9514e+06
  Execution time = 1.8923e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402843489
  error estimate for blocks of size 2^( 2) =       0.000416372918
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000440848178
  error estimate for blocks of size 2^( 5) =       0.000451583490
  error estimate for blocks of size 2^( 6) =       0.000459721738
  error estimate for blocks of size 2^( 7) =       0.000467558793

      target function =                  N/A
              le_mean =     -16.906017194864
             les_mean =     286.151403815756
             stat err =       0.000454928050
             autocorr =       1.275301098379
              std dev =       0.569706725136
             le_variance =       0.324565752665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402843489
  error estimate for blocks of size 2^( 2) =       0.000416372918
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000440848178
  error estimate for blocks of size 2^( 5) =       0.000451583490
  error estimate for blocks of size 2^( 6) =       0.000459721738
  error estimate for blocks of size 2^( 7) =       0.000467558793

      target function =                  N/A
              le_mean =     -16.906017194864
             les_mean =     286.151403815756
             stat err =       0.000454928050
             autocorr =       1.275301098379
              std dev =       0.569706725136
             le_variance =       0.324565752665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402843489
  error estimate for blocks of size 2^( 2) =       0.000416372918
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000440848178
  error estimate for blocks of size 2^( 5) =       0.000451583490
  error estimate for blocks of size 2^( 6) =       0.000459721738
  error estimate for blocks of size 2^( 7) =       0.000467558793

      target function =                  N/A
              le_mean =     -16.906017194864
             les_mean =     286.151403815756
             stat err =       0.000454928050
             autocorr =       1.275301098379
              std dev =       0.569706725136
             le_variance =       0.324565752665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324503060483
                                         uncertainty =       0.002397392709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402843489
  error estimate for blocks of size 2^( 2) =       0.000416372918
  error estimate for blocks of size 2^( 3) =       0.000428860106
  error estimate for blocks of size 2^( 4) =       0.000440848178
  error estimate for blocks of size 2^( 5) =       0.000451583490
  error estimate for blocks of size 2^( 6) =       0.000459721738
  error estimate for blocks of size 2^( 7) =       0.000467558793

      target function =                  N/A
              le_mean =     -16.906017194864
             les_mean =     286.151403815756
             stat err =       0.000454928050
             autocorr =       1.275301098379
              std dev =       0.569706725136
             le_variance =       0.324565752665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906017194864        initial  <--
     9.5367e+18     9.5367e+19             3.8044e-23       -16.906017194864
     3.8147e+19     3.8147e+20             1.0833e-23       -16.906017194864
     1.5259e+20     1.5259e+21             2.7083e-24       -16.906017194864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1953
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.4915e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8516
    reference variance = 0.357328
====================================================
  Execution time = 2.0939e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3433e-01
  Total weights = 1.951577468e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322373311430
                                         uncertainty =       0.002480739212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322373311430
                                         uncertainty =       0.002480739212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401532639
  error estimate for blocks of size 2^( 2) =       0.000414385735
  error estimate for blocks of size 2^( 3) =       0.000427397468
  error estimate for blocks of size 2^( 4) =       0.000440104098
  error estimate for blocks of size 2^( 5) =       0.000450350962
  error estimate for blocks of size 2^( 6) =       0.000457192555
  error estimate for blocks of size 2^( 7) =       0.000460945971

      target function =                  N/A
              le_mean =     -16.905880716625
             les_mean =     286.143131806917
             stat err =       0.000452148396
             autocorr =       1.268003007442
              std dev =       0.567852903643
             le_variance =       0.322456920176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588071662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880716610       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880716610       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880716610       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880716610       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905880716610       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905880716610       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+20 is 1.014091e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880716610       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880716610       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905880716610       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905880716610       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+21 is 2.535228e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.090329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6969e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9261
    reference variance = 0.280471
====================================================
  Execution time = 2.0565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4020e-01
  Total weights = 1.9519e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387608
  error estimate for blocks of size 2^( 2) =       0.000415219474
  error estimate for blocks of size 2^( 3) =       0.000428176490
  error estimate for blocks of size 2^( 4) =       0.000440243840
  error estimate for blocks of size 2^( 5) =       0.000451351691
  error estimate for blocks of size 2^( 6) =       0.000458891907
  error estimate for blocks of size 2^( 7) =       0.000465195625

      target function =                  N/A
              le_mean =     -16.906290579485
             les_mean =     286.162859859594
             stat err =       0.000453920766
             autocorr =       1.272538429982
              std dev =       0.569062012762
             le_variance =       0.323831574368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387608
  error estimate for blocks of size 2^( 2) =       0.000415219474
  error estimate for blocks of size 2^( 3) =       0.000428176490
  error estimate for blocks of size 2^( 4) =       0.000440243840
  error estimate for blocks of size 2^( 5) =       0.000451351691
  error estimate for blocks of size 2^( 6) =       0.000458891907
  error estimate for blocks of size 2^( 7) =       0.000465195625

      target function =                  N/A
              le_mean =     -16.906290579485
             les_mean =     286.162859859594
             stat err =       0.000453920766
             autocorr =       1.272538429982
              std dev =       0.569062012762
             le_variance =       0.323831574368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387608
  error estimate for blocks of size 2^( 2) =       0.000415219474
  error estimate for blocks of size 2^( 3) =       0.000428176490
  error estimate for blocks of size 2^( 4) =       0.000440243840
  error estimate for blocks of size 2^( 5) =       0.000451351691
  error estimate for blocks of size 2^( 6) =       0.000458891907
  error estimate for blocks of size 2^( 7) =       0.000465195625

      target function =                  N/A
              le_mean =     -16.906290579485
             les_mean =     286.162859859594
             stat err =       0.000453920766
             autocorr =       1.272538429982
              std dev =       0.569062012762
             le_variance =       0.323831574368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323816019811
                                         uncertainty =       0.002149149804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402387608
  error estimate for blocks of size 2^( 2) =       0.000415219474
  error estimate for blocks of size 2^( 3) =       0.000428176490
  error estimate for blocks of size 2^( 4) =       0.000440243840
  error estimate for blocks of size 2^( 5) =       0.000451351691
  error estimate for blocks of size 2^( 6) =       0.000458891907
  error estimate for blocks of size 2^( 7) =       0.000465195625

      target function =                  N/A
              le_mean =     -16.906290579485
             les_mean =     286.162859859594
             stat err =       0.000453920766
             autocorr =       1.272538429982
              std dev =       0.569062012762
             le_variance =       0.323831574368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906290579485        initial  <--
     9.5367e+19     9.5367e+20             0.0000e+00       -16.906290579485
     3.8147e+20     3.8147e+21             1.0141e-24       -16.906290579485
     1.5259e+21     1.5259e+22             2.5352e-25       -16.906290579485

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1033
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7079e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8543
    reference variance = 0.214803
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3964e-01
  Total weights = 1.951657988e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321560997954
                                         uncertainty =       0.002270548408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321560997954
                                         uncertainty =       0.002270548408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400964088
  error estimate for blocks of size 2^( 2) =       0.000413597053
  error estimate for blocks of size 2^( 3) =       0.000425979069
  error estimate for blocks of size 2^( 4) =       0.000437899147
  error estimate for blocks of size 2^( 5) =       0.000447689158
  error estimate for blocks of size 2^( 6) =       0.000456176848
  error estimate for blocks of size 2^( 7) =       0.000461990278

      target function =                  N/A
              le_mean =     -16.905770089968
             les_mean =     286.144704753472
             stat err =       0.000450938858
             autocorr =       1.264807309790
              std dev =       0.567048850949
             le_variance =       0.321544399363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577008997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905770089943       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.091500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6892e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9861
    reference variance = 0.312406
====================================================
  Execution time = 2.0676e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4481e-01
  Total weights = 1.9519e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406923909
  error estimate for blocks of size 2^( 2) =       0.000419786295
  error estimate for blocks of size 2^( 3) =       0.000433237637
  error estimate for blocks of size 2^( 4) =       0.000445593401
  error estimate for blocks of size 2^( 5) =       0.000455543184
  error estimate for blocks of size 2^( 6) =       0.000461425894
  error estimate for blocks of size 2^( 7) =       0.000466521429

      target function =                  N/A
              le_mean =     -16.905972578757
             les_mean =     286.156721534778
             stat err =       0.000457270977
             autocorr =       1.262760126613
              std dev =       0.575477310495
             le_variance =       0.331174134895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406923909
  error estimate for blocks of size 2^( 2) =       0.000419786295
  error estimate for blocks of size 2^( 3) =       0.000433237637
  error estimate for blocks of size 2^( 4) =       0.000445593401
  error estimate for blocks of size 2^( 5) =       0.000455543184
  error estimate for blocks of size 2^( 6) =       0.000461425894
  error estimate for blocks of size 2^( 7) =       0.000466521429

      target function =                  N/A
              le_mean =     -16.905972578757
             les_mean =     286.156721534778
             stat err =       0.000457270977
             autocorr =       1.262760126613
              std dev =       0.575477310495
             le_variance =       0.331174134895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406923909
  error estimate for blocks of size 2^( 2) =       0.000419786295
  error estimate for blocks of size 2^( 3) =       0.000433237637
  error estimate for blocks of size 2^( 4) =       0.000445593401
  error estimate for blocks of size 2^( 5) =       0.000455543184
  error estimate for blocks of size 2^( 6) =       0.000461425894
  error estimate for blocks of size 2^( 7) =       0.000466521429

      target function =                  N/A
              le_mean =     -16.905972578757
             les_mean =     286.156721534778
             stat err =       0.000457270977
             autocorr =       1.262760126613
              std dev =       0.575477310495
             le_variance =       0.331174134895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331143098204
                                         uncertainty =       0.003008028090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406923909
  error estimate for blocks of size 2^( 2) =       0.000419786295
  error estimate for blocks of size 2^( 3) =       0.000433237637
  error estimate for blocks of size 2^( 4) =       0.000445593401
  error estimate for blocks of size 2^( 5) =       0.000455543184
  error estimate for blocks of size 2^( 6) =       0.000461425894
  error estimate for blocks of size 2^( 7) =       0.000466521429

      target function =                  N/A
              le_mean =     -16.905972578757
             les_mean =     286.156721534778
             stat err =       0.000457270977
             autocorr =       1.262760126613
              std dev =       0.575477310495
             le_variance =       0.331174134895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905972578757        initial  <--
     9.5367e+20     9.5367e+21             0.0000e+00       -16.905972578757
     3.8147e+21     3.8147e+22             0.0000e+00       -16.905972578757
     1.5259e+22     1.5259e+23             0.0000e+00       -16.905972578757

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2329
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7132e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8185
    reference variance = 0.686414
====================================================
  Execution time = 2.1047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3586e-01
  Total weights = 1.952113358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768171449
                                         uncertainty =       0.002508663945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323768171449
                                         uncertainty =       0.002508663945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402425193
  error estimate for blocks of size 2^( 2) =       0.000415377786
  error estimate for blocks of size 2^( 3) =       0.000428784009
  error estimate for blocks of size 2^( 4) =       0.000441265330
  error estimate for blocks of size 2^( 5) =       0.000451752545
  error estimate for blocks of size 2^( 6) =       0.000459803321
  error estimate for blocks of size 2^( 7) =       0.000462327923

      target function =                  N/A
              le_mean =     -16.906102718416
             les_mean =     286.152165451272
             stat err =       0.000453787280
             autocorr =       1.271552554027
              std dev =       0.569115165443
             le_variance =       0.323892071537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610271842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906102718426       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906102718426       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906102717903       residual = 1.17e+05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+21 is 4.277368e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906102718426       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906102718426       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906102718426       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+22 is 1.069342e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906102718426       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906102718426       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906102732605       residual = 4.68e+05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+23 is 2.673355e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.092892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7131e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.171742
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3121e-01
  Total weights = 1.9516e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467254
  error estimate for blocks of size 2^( 2) =       0.000413360376
  error estimate for blocks of size 2^( 3) =       0.000426772626
  error estimate for blocks of size 2^( 4) =       0.000439278104
  error estimate for blocks of size 2^( 5) =       0.000449956945
  error estimate for blocks of size 2^( 6) =       0.000458666969
  error estimate for blocks of size 2^( 7) =       0.000464516389

      target function =                  N/A
              le_mean =     -16.906286472181
             les_mean =     286.153728811466
             stat err =       0.000453104602
             autocorr =       1.280156089122
              std dev =       0.566346222093
             le_variance =       0.320748043279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467254
  error estimate for blocks of size 2^( 2) =       0.000413360376
  error estimate for blocks of size 2^( 3) =       0.000426772626
  error estimate for blocks of size 2^( 4) =       0.000439278104
  error estimate for blocks of size 2^( 5) =       0.000449956945
  error estimate for blocks of size 2^( 6) =       0.000458666969
  error estimate for blocks of size 2^( 7) =       0.000464516389

      target function =                  N/A
              le_mean =     -16.906286472181
             les_mean =     286.153728811466
             stat err =       0.000453104602
             autocorr =       1.280156089122
              std dev =       0.566346222093
             le_variance =       0.320748043279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467254
  error estimate for blocks of size 2^( 2) =       0.000413360376
  error estimate for blocks of size 2^( 3) =       0.000426772626
  error estimate for blocks of size 2^( 4) =       0.000439278104
  error estimate for blocks of size 2^( 5) =       0.000449956945
  error estimate for blocks of size 2^( 6) =       0.000458666969
  error estimate for blocks of size 2^( 7) =       0.000464516389

      target function =                  N/A
              le_mean =     -16.906286472181
             les_mean =     286.153728811466
             stat err =       0.000453104602
             autocorr =       1.280156089122
              std dev =       0.566346222093
             le_variance =       0.320748043279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320791777828
                                         uncertainty =       0.002108788836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467254
  error estimate for blocks of size 2^( 2) =       0.000413360376
  error estimate for blocks of size 2^( 3) =       0.000426772626
  error estimate for blocks of size 2^( 4) =       0.000439278104
  error estimate for blocks of size 2^( 5) =       0.000449956945
  error estimate for blocks of size 2^( 6) =       0.000458666969
  error estimate for blocks of size 2^( 7) =       0.000464516389

      target function =                  N/A
              le_mean =     -16.906286472181
             les_mean =     286.153728811466
             stat err =       0.000453104602
             autocorr =       1.280156089122
              std dev =       0.566346222093
             le_variance =       0.320748043279


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906286472181        initial  <--
     9.5367e+21     9.5367e+22             4.2774e-26       -16.906286472181
     3.8147e+22     3.8147e+23             1.0693e-26       -16.906286472181
     1.5259e+23     1.5259e+24             2.6734e-27       -16.906286472181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1095
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9944
    reference variance = 0.303974
====================================================
  Execution time = 2.0985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3507e-01
  Total weights = 1.951623987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0679e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322575756186
                                         uncertainty =       0.001867894923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322575756186
                                         uncertainty =       0.001867894923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401612550
  error estimate for blocks of size 2^( 2) =       0.000414497634
  error estimate for blocks of size 2^( 3) =       0.000427588725
  error estimate for blocks of size 2^( 4) =       0.000439861140
  error estimate for blocks of size 2^( 5) =       0.000450720245
  error estimate for blocks of size 2^( 6) =       0.000458986653
  error estimate for blocks of size 2^( 7) =       0.000462235673

      target function =                  N/A
              le_mean =     -16.905915747282
             les_mean =     286.145052247518
             stat err =       0.000452950928
             autocorr =       1.272001886972
              std dev =       0.567965915180
             le_variance =       0.322585280807


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591574728e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905915747238       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.094061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7058e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.201551
====================================================
  Execution time = 2.5377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3162e-01
  Total weights = 1.9519e+06
  Execution time = 1.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400166147
  error estimate for blocks of size 2^( 2) =       0.000413343825
  error estimate for blocks of size 2^( 3) =       0.000427285458
  error estimate for blocks of size 2^( 4) =       0.000440426024
  error estimate for blocks of size 2^( 5) =       0.000451114426
  error estimate for blocks of size 2^( 6) =       0.000459176660
  error estimate for blocks of size 2^( 7) =       0.000464641414

      target function =                  N/A
              le_mean =     -16.904943201541
             les_mean =     286.108727536371
             stat err =       0.000453839631
             autocorr =       1.286246313962
              std dev =       0.565920392685
             le_variance =       0.320265890856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400166147
  error estimate for blocks of size 2^( 2) =       0.000413343825
  error estimate for blocks of size 2^( 3) =       0.000427285458
  error estimate for blocks of size 2^( 4) =       0.000440426024
  error estimate for blocks of size 2^( 5) =       0.000451114426
  error estimate for blocks of size 2^( 6) =       0.000459176660
  error estimate for blocks of size 2^( 7) =       0.000464641414

      target function =                  N/A
              le_mean =     -16.904943201541
             les_mean =     286.108727536371
             stat err =       0.000453839631
             autocorr =       1.286246313962
              std dev =       0.565920392685
             le_variance =       0.320265890856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400166147
  error estimate for blocks of size 2^( 2) =       0.000413343825
  error estimate for blocks of size 2^( 3) =       0.000427285458
  error estimate for blocks of size 2^( 4) =       0.000440426024
  error estimate for blocks of size 2^( 5) =       0.000451114426
  error estimate for blocks of size 2^( 6) =       0.000459176660
  error estimate for blocks of size 2^( 7) =       0.000464641414

      target function =                  N/A
              le_mean =     -16.904943201541
             les_mean =     286.108727536371
             stat err =       0.000453839631
             autocorr =       1.286246313962
              std dev =       0.565920392685
             le_variance =       0.320265890856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294845180
                                         uncertainty =       0.001923661211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400166147
  error estimate for blocks of size 2^( 2) =       0.000413343825
  error estimate for blocks of size 2^( 3) =       0.000427285458
  error estimate for blocks of size 2^( 4) =       0.000440426024
  error estimate for blocks of size 2^( 5) =       0.000451114426
  error estimate for blocks of size 2^( 6) =       0.000459176660
  error estimate for blocks of size 2^( 7) =       0.000464641414

      target function =                  N/A
              le_mean =     -16.904943201541
             les_mean =     286.108727536371
             stat err =       0.000453839631
             autocorr =       1.286246313962
              std dev =       0.565920392685
             le_variance =       0.320265890856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904943201541        initial  <--
     9.5367e+22     9.5367e+23             0.0000e+00       -16.904943201541
     3.8147e+23     3.8147e+24             0.0000e+00       -16.904943201541
     1.5259e+24     1.5259e+25             0.0000e+00       -16.904943201541

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.8704
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1935e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9258
    reference variance = 0.168504
====================================================
  Execution time = 4.8370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3862e-01
  Total weights = 1.951469186e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325081780473
                                         uncertainty =       0.002693382363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325081780473
                                         uncertainty =       0.002693382363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403149118
  error estimate for blocks of size 2^( 2) =       0.000415367855
  error estimate for blocks of size 2^( 3) =       0.000427455877
  error estimate for blocks of size 2^( 4) =       0.000439024152
  error estimate for blocks of size 2^( 5) =       0.000448855451
  error estimate for blocks of size 2^( 6) =       0.000456306566
  error estimate for blocks of size 2^( 7) =       0.000461276892

      target function =                  N/A
              le_mean =     -16.906836959318
             les_mean =     286.179754727740
             stat err =       0.000451365765
             autocorr =       1.253504229789
              std dev =       0.570138950756
             le_variance =       0.325058423169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683695932e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836959287       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836959287       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836959287       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836959287       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906836959287       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906836959286       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+24 is 9.499723e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906836959287       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906836959287       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906836959287       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906836959286       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+25 is 2.374931e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.095639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.4471e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.206411
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3354e-01
  Total weights = 1.9517e+06
  Execution time = 1.8890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400915901
  error estimate for blocks of size 2^( 2) =       0.000413726530
  error estimate for blocks of size 2^( 3) =       0.000426670566
  error estimate for blocks of size 2^( 4) =       0.000438934209
  error estimate for blocks of size 2^( 5) =       0.000449916510
  error estimate for blocks of size 2^( 6) =       0.000457480918
  error estimate for blocks of size 2^( 7) =       0.000463557810

      target function =                  N/A
              le_mean =     -16.906533734277
             les_mean =     286.164425506320
             stat err =       0.000452472362
             autocorr =       1.273730507272
              std dev =       0.566980704268
             le_variance =       0.321467119012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400915901
  error estimate for blocks of size 2^( 2) =       0.000413726530
  error estimate for blocks of size 2^( 3) =       0.000426670566
  error estimate for blocks of size 2^( 4) =       0.000438934209
  error estimate for blocks of size 2^( 5) =       0.000449916510
  error estimate for blocks of size 2^( 6) =       0.000457480918
  error estimate for blocks of size 2^( 7) =       0.000463557810

      target function =                  N/A
              le_mean =     -16.906533734277
             les_mean =     286.164425506320
             stat err =       0.000452472362
             autocorr =       1.273730507272
              std dev =       0.566980704268
             le_variance =       0.321467119012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400915901
  error estimate for blocks of size 2^( 2) =       0.000413726530
  error estimate for blocks of size 2^( 3) =       0.000426670566
  error estimate for blocks of size 2^( 4) =       0.000438934209
  error estimate for blocks of size 2^( 5) =       0.000449916510
  error estimate for blocks of size 2^( 6) =       0.000457480918
  error estimate for blocks of size 2^( 7) =       0.000463557810

      target function =                  N/A
              le_mean =     -16.906533734277
             les_mean =     286.164425506320
             stat err =       0.000452472362
             autocorr =       1.273730507272
              std dev =       0.566980704268
             le_variance =       0.321467119012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321517858859
                                         uncertainty =       0.001917355989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400915901
  error estimate for blocks of size 2^( 2) =       0.000413726530
  error estimate for blocks of size 2^( 3) =       0.000426670566
  error estimate for blocks of size 2^( 4) =       0.000438934209
  error estimate for blocks of size 2^( 5) =       0.000449916510
  error estimate for blocks of size 2^( 6) =       0.000457480918
  error estimate for blocks of size 2^( 7) =       0.000463557810

      target function =                  N/A
              le_mean =     -16.906533734277
             les_mean =     286.164425506320
             stat err =       0.000452472362
             autocorr =       1.273730507272
              std dev =       0.566980704268
             le_variance =       0.321467119012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906533734277        initial  <--
     9.5367e+23     9.5367e+24             0.0000e+00       -16.906533734277
     3.8147e+24     3.8147e+25             9.4997e-29       -16.906533734277
     1.5259e+25     1.5259e+26             2.3749e-29       -16.906533734277

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3446
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 8.4822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.009
    reference variance = 1.60733
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3517e-01
  Total weights = 1.951533892e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155735167
                                         uncertainty =       0.002090928244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323155735167
                                         uncertainty =       0.002090928244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401980935
  error estimate for blocks of size 2^( 2) =       0.000414988889
  error estimate for blocks of size 2^( 3) =       0.000428176562
  error estimate for blocks of size 2^( 4) =       0.000440102241
  error estimate for blocks of size 2^( 5) =       0.000450492764
  error estimate for blocks of size 2^( 6) =       0.000457855429
  error estimate for blocks of size 2^( 7) =       0.000462745599

      target function =                  N/A
              le_mean =     -16.906447813332
             les_mean =     286.163144504512
             stat err =       0.000452799008
             autocorr =       1.268820015392
              std dev =       0.568486890371
             le_variance =       0.323177344524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644781333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906447813338       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.096804 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6841e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8704
    reference variance = 0.268421
====================================================
  Execution time = 2.0963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3760e-01
  Total weights = 1.9519e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401721034
  error estimate for blocks of size 2^( 2) =       0.000414929920
  error estimate for blocks of size 2^( 3) =       0.000428259392
  error estimate for blocks of size 2^( 4) =       0.000440571672
  error estimate for blocks of size 2^( 5) =       0.000450584513
  error estimate for blocks of size 2^( 6) =       0.000460148317
  error estimate for blocks of size 2^( 7) =       0.000464640178

      target function =                  N/A
              le_mean =     -16.906881225287
             les_mean =     286.180237122590
             stat err =       0.000453986170
             autocorr =       1.277132924755
              std dev =       0.568119335074
             le_variance =       0.322759578885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401721034
  error estimate for blocks of size 2^( 2) =       0.000414929920
  error estimate for blocks of size 2^( 3) =       0.000428259392
  error estimate for blocks of size 2^( 4) =       0.000440571672
  error estimate for blocks of size 2^( 5) =       0.000450584513
  error estimate for blocks of size 2^( 6) =       0.000460148317
  error estimate for blocks of size 2^( 7) =       0.000464640178

      target function =                  N/A
              le_mean =     -16.906881225287
             les_mean =     286.180237122590
             stat err =       0.000453986170
             autocorr =       1.277132924755
              std dev =       0.568119335074
             le_variance =       0.322759578885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401721034
  error estimate for blocks of size 2^( 2) =       0.000414929920
  error estimate for blocks of size 2^( 3) =       0.000428259392
  error estimate for blocks of size 2^( 4) =       0.000440571672
  error estimate for blocks of size 2^( 5) =       0.000450584513
  error estimate for blocks of size 2^( 6) =       0.000460148317
  error estimate for blocks of size 2^( 7) =       0.000464640178

      target function =                  N/A
              le_mean =     -16.906881225287
             les_mean =     286.180237122590
             stat err =       0.000453986170
             autocorr =       1.277132924755
              std dev =       0.568119335074
             le_variance =       0.322759578885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322441330256
                                         uncertainty =       0.002169230805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401721034
  error estimate for blocks of size 2^( 2) =       0.000414929920
  error estimate for blocks of size 2^( 3) =       0.000428259392
  error estimate for blocks of size 2^( 4) =       0.000440571672
  error estimate for blocks of size 2^( 5) =       0.000450584513
  error estimate for blocks of size 2^( 6) =       0.000460148317
  error estimate for blocks of size 2^( 7) =       0.000464640178

      target function =                  N/A
              le_mean =     -16.906881225287
             les_mean =     286.180237122590
             stat err =       0.000453986170
             autocorr =       1.277132924755
              std dev =       0.568119335074
             le_variance =       0.322759578885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906881225287        initial  <--
     9.5367e+24     9.5367e+25             0.0000e+00       -16.906881225287
     3.8147e+25     3.8147e+26             0.0000e+00       -16.906881225287
     1.5259e+26     1.5259e+27             0.0000e+00       -16.906881225287

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4600
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7307e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.881
    reference variance = 0.141423
====================================================
  Execution time = 2.0893e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3302e-01
  Total weights = 1.951616906e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320613100938
                                         uncertainty =       0.002850929928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320613100938
                                         uncertainty =       0.002850929928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400358699
  error estimate for blocks of size 2^( 2) =       0.000413028988
  error estimate for blocks of size 2^( 3) =       0.000426313112
  error estimate for blocks of size 2^( 4) =       0.000439145639
  error estimate for blocks of size 2^( 5) =       0.000450065608
  error estimate for blocks of size 2^( 6) =       0.000457264722
  error estimate for blocks of size 2^( 7) =       0.000462018563

      target function =                  N/A
              le_mean =     -16.906184131877
             les_mean =     286.152085416222
             stat err =       0.000452123633
             autocorr =       1.275310330747
              std dev =       0.566192702371
             le_variance =       0.320574176219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618413188e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184131851       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184131851       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906192693239       residual = 3.69e+07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906184131862       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+25 is 4.818508e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184131851       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184131851       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906142843270       residual = 1.47e+08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+26 is 1.204627e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184131851       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906184131851       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906309654328       residual = 5.90e+08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305801533       residual = 5.05e+08           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+27 is 3.011567e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.098484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7019e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.191823
====================================================
  Execution time = 2.0681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3859e-01
  Total weights = 1.9517e+06
  Execution time = 1.8853e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402615897
  error estimate for blocks of size 2^( 2) =       0.000415585051
  error estimate for blocks of size 2^( 3) =       0.000429362878
  error estimate for blocks of size 2^( 4) =       0.000441882657
  error estimate for blocks of size 2^( 5) =       0.000453072113
  error estimate for blocks of size 2^( 6) =       0.000461779554
  error estimate for blocks of size 2^( 7) =       0.000467706076

      target function =                  N/A
              le_mean =     -16.905694961818
             les_mean =     286.141107673873
             stat err =       0.000456110100
             autocorr =       1.283386722030
              std dev =       0.569384861664
             le_variance =       0.324199120692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402615897
  error estimate for blocks of size 2^( 2) =       0.000415585051
  error estimate for blocks of size 2^( 3) =       0.000429362878
  error estimate for blocks of size 2^( 4) =       0.000441882657
  error estimate for blocks of size 2^( 5) =       0.000453072113
  error estimate for blocks of size 2^( 6) =       0.000461779554
  error estimate for blocks of size 2^( 7) =       0.000467706076

      target function =                  N/A
              le_mean =     -16.905694961818
             les_mean =     286.141107673873
             stat err =       0.000456110100
             autocorr =       1.283386722030
              std dev =       0.569384861664
             le_variance =       0.324199120692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402615897
  error estimate for blocks of size 2^( 2) =       0.000415585051
  error estimate for blocks of size 2^( 3) =       0.000429362878
  error estimate for blocks of size 2^( 4) =       0.000441882657
  error estimate for blocks of size 2^( 5) =       0.000453072113
  error estimate for blocks of size 2^( 6) =       0.000461779554
  error estimate for blocks of size 2^( 7) =       0.000467706076

      target function =                  N/A
              le_mean =     -16.905694961818
             les_mean =     286.141107673873
             stat err =       0.000456110100
             autocorr =       1.283386722030
              std dev =       0.569384861664
             le_variance =       0.324199120692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324163771752
                                         uncertainty =       0.003168414392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402615897
  error estimate for blocks of size 2^( 2) =       0.000415585051
  error estimate for blocks of size 2^( 3) =       0.000429362878
  error estimate for blocks of size 2^( 4) =       0.000441882657
  error estimate for blocks of size 2^( 5) =       0.000453072113
  error estimate for blocks of size 2^( 6) =       0.000461779554
  error estimate for blocks of size 2^( 7) =       0.000467706076

      target function =                  N/A
              le_mean =     -16.905694961818
             les_mean =     286.141107673873
             stat err =       0.000456110100
             autocorr =       1.283386722030
              std dev =       0.569384861664
             le_variance =       0.324199120692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905694961818        initial  <--
     9.5367e+25     9.5367e+26             4.8185e-30       -16.905694961818
     3.8147e+26     3.8147e+27             1.2046e-30       -16.905694961818
     1.5259e+27     1.5259e+28             3.0116e-31       -16.905694961818

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1936
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7219e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.312699
====================================================
  Execution time = 2.0771e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3494e-01
  Total weights = 1.951773396e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323500967069
                                         uncertainty =       0.002354287974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323500967069
                                         uncertainty =       0.002354287974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402215461
  error estimate for blocks of size 2^( 2) =       0.000415457229
  error estimate for blocks of size 2^( 3) =       0.000428316748
  error estimate for blocks of size 2^( 4) =       0.000441182002
  error estimate for blocks of size 2^( 5) =       0.000452608171
  error estimate for blocks of size 2^( 6) =       0.000461438649
  error estimate for blocks of size 2^( 7) =       0.000466013731

      target function =                  N/A
              le_mean =     -16.906892554106
             les_mean =     286.177952545642
             stat err =       0.000455310638
             autocorr =       1.281439404468
              std dev =       0.568818559692
             le_variance =       0.323554553850


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689255411e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+28, overlap shift 1.5259e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906892554096       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.099648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6949e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.353985
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3686e-01
  Total weights = 1.9515e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403068761
  error estimate for blocks of size 2^( 2) =       0.000416365395
  error estimate for blocks of size 2^( 3) =       0.000429341606
  error estimate for blocks of size 2^( 4) =       0.000441268949
  error estimate for blocks of size 2^( 5) =       0.000451794244
  error estimate for blocks of size 2^( 6) =       0.000460440872
  error estimate for blocks of size 2^( 7) =       0.000464123102

      target function =                  N/A
              le_mean =     -16.906045227805
             les_mean =     286.151222917044
             stat err =       0.000454406792
             autocorr =       1.270958433780
              std dev =       0.570025307980
             le_variance =       0.324928851738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403068761
  error estimate for blocks of size 2^( 2) =       0.000416365395
  error estimate for blocks of size 2^( 3) =       0.000429341606
  error estimate for blocks of size 2^( 4) =       0.000441268949
  error estimate for blocks of size 2^( 5) =       0.000451794244
  error estimate for blocks of size 2^( 6) =       0.000460440872
  error estimate for blocks of size 2^( 7) =       0.000464123102

      target function =                  N/A
              le_mean =     -16.906045227805
             les_mean =     286.151222917044
             stat err =       0.000454406792
             autocorr =       1.270958433780
              std dev =       0.570025307980
             le_variance =       0.324928851738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403068761
  error estimate for blocks of size 2^( 2) =       0.000416365395
  error estimate for blocks of size 2^( 3) =       0.000429341606
  error estimate for blocks of size 2^( 4) =       0.000441268949
  error estimate for blocks of size 2^( 5) =       0.000451794244
  error estimate for blocks of size 2^( 6) =       0.000460440872
  error estimate for blocks of size 2^( 7) =       0.000464123102

      target function =                  N/A
              le_mean =     -16.906045227805
             les_mean =     286.151222917044
             stat err =       0.000454406792
             autocorr =       1.270958433780
              std dev =       0.570025307980
             le_variance =       0.324928851738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324995999557
                                         uncertainty =       0.002067668306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403068761
  error estimate for blocks of size 2^( 2) =       0.000416365395
  error estimate for blocks of size 2^( 3) =       0.000429341606
  error estimate for blocks of size 2^( 4) =       0.000441268949
  error estimate for blocks of size 2^( 5) =       0.000451794244
  error estimate for blocks of size 2^( 6) =       0.000460440872
  error estimate for blocks of size 2^( 7) =       0.000464123102

      target function =                  N/A
              le_mean =     -16.906045227805
             les_mean =     286.151222917044
             stat err =       0.000454406792
             autocorr =       1.270958433780
              std dev =       0.570025307980
             le_variance =       0.324928851738


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906045227805        initial  <--
     9.5367e+26     9.5367e+27             0.0000e+00       -16.906045227805
     3.8147e+27     3.8147e+28             0.0000e+00       -16.906045227805
     1.5259e+28     1.5259e+29             0.0000e+00       -16.906045227805

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1078
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8874
    reference variance = 0.193046
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3416e-01
  Total weights = 1.951512594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4575e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323328027002
                                         uncertainty =       0.002055407419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323328027002
                                         uncertainty =       0.002055407419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402016093
  error estimate for blocks of size 2^( 2) =       0.000415024752
  error estimate for blocks of size 2^( 3) =       0.000428192790
  error estimate for blocks of size 2^( 4) =       0.000440471944
  error estimate for blocks of size 2^( 5) =       0.000449988700
  error estimate for blocks of size 2^( 6) =       0.000458077973
  error estimate for blocks of size 2^( 7) =       0.000462499714

      target function =                  N/A
              le_mean =     -16.906659989877
             les_mean =     286.169309330551
             stat err =       0.000452759583
             autocorr =       1.268377191851
              std dev =       0.568536611719
             le_variance =       0.323233878865


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665998988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+29, overlap shift 1.5259e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906659989867       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.100848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8959e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9
    reference variance = 0.265848
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3663e-01
  Total weights = 1.9516e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402675267
  error estimate for blocks of size 2^( 2) =       0.000415144522
  error estimate for blocks of size 2^( 3) =       0.000428141153
  error estimate for blocks of size 2^( 4) =       0.000439461800
  error estimate for blocks of size 2^( 5) =       0.000449066205
  error estimate for blocks of size 2^( 6) =       0.000454602739
  error estimate for blocks of size 2^( 7) =       0.000457804215

      target function =                  N/A
              le_mean =     -16.906080868270
             les_mean =     286.152204769234
             stat err =       0.000450233740
             autocorr =       1.250161622109
              std dev =       0.569468824448
             le_variance =       0.324294742018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402675267
  error estimate for blocks of size 2^( 2) =       0.000415144522
  error estimate for blocks of size 2^( 3) =       0.000428141153
  error estimate for blocks of size 2^( 4) =       0.000439461800
  error estimate for blocks of size 2^( 5) =       0.000449066205
  error estimate for blocks of size 2^( 6) =       0.000454602739
  error estimate for blocks of size 2^( 7) =       0.000457804215

      target function =                  N/A
              le_mean =     -16.906080868270
             les_mean =     286.152204769234
             stat err =       0.000450233740
             autocorr =       1.250161622109
              std dev =       0.569468824448
             le_variance =       0.324294742018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402675267
  error estimate for blocks of size 2^( 2) =       0.000415144522
  error estimate for blocks of size 2^( 3) =       0.000428141153
  error estimate for blocks of size 2^( 4) =       0.000439461800
  error estimate for blocks of size 2^( 5) =       0.000449066205
  error estimate for blocks of size 2^( 6) =       0.000454602739
  error estimate for blocks of size 2^( 7) =       0.000457804215

      target function =                  N/A
              le_mean =     -16.906080868270
             les_mean =     286.152204769234
             stat err =       0.000450233740
             autocorr =       1.250161622109
              std dev =       0.569468824448
             le_variance =       0.324294742018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324221074120
                                         uncertainty =       0.005380666660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402675267
  error estimate for blocks of size 2^( 2) =       0.000415144522
  error estimate for blocks of size 2^( 3) =       0.000428141153
  error estimate for blocks of size 2^( 4) =       0.000439461800
  error estimate for blocks of size 2^( 5) =       0.000449066205
  error estimate for blocks of size 2^( 6) =       0.000454602739
  error estimate for blocks of size 2^( 7) =       0.000457804215

      target function =                  N/A
              le_mean =     -16.906080868270
             les_mean =     286.152204769234
             stat err =       0.000450233740
             autocorr =       1.250161622109
              std dev =       0.569468824448
             le_variance =       0.324294742018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906080868270        initial  <--
     9.5367e+27     9.5367e+28             0.0000e+00       -16.906080868270
     3.8147e+28     3.8147e+29             0.0000e+00       -16.906080868270
     1.5259e+29     1.5259e+30             0.0000e+00       -16.906080868270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0863
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9052e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8741
    reference variance = 0.224592
====================================================
  Execution time = 2.4517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3436e-01
  Total weights = 1.951594818e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321351544231
                                         uncertainty =       0.002430281383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321351544231
                                         uncertainty =       0.002430281383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400811934
  error estimate for blocks of size 2^( 2) =       0.000413853860
  error estimate for blocks of size 2^( 3) =       0.000427162469
  error estimate for blocks of size 2^( 4) =       0.000439922293
  error estimate for blocks of size 2^( 5) =       0.000451088412
  error estimate for blocks of size 2^( 6) =       0.000459428524
  error estimate for blocks of size 2^( 7) =       0.000464692010

      target function =                  N/A
              le_mean =     -16.906010542857
             les_mean =     286.147555142901
             stat err =       0.000453782810
             autocorr =       1.281783840074
              std dev =       0.566833672902
             le_variance =       0.321300412736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601054286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+30, overlap shift 1.5259e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906010542877       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.102006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0608e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.22264
====================================================
  Execution time = 2.0753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3286e-01
  Total weights = 1.9520e+06
  Execution time = 1.8873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400784009
  error estimate for blocks of size 2^( 2) =       0.000413292056
  error estimate for blocks of size 2^( 3) =       0.000425602039
  error estimate for blocks of size 2^( 4) =       0.000437177948
  error estimate for blocks of size 2^( 5) =       0.000446117342
  error estimate for blocks of size 2^( 6) =       0.000452388926
  error estimate for blocks of size 2^( 7) =       0.000457754333

      target function =                  N/A
              le_mean =     -16.906275018738
             les_mean =     286.154997407116
             stat err =       0.000448359637
             autocorr =       1.251504014577
              std dev =       0.566794181731
             le_variance =       0.321255644444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400784009
  error estimate for blocks of size 2^( 2) =       0.000413292056
  error estimate for blocks of size 2^( 3) =       0.000425602039
  error estimate for blocks of size 2^( 4) =       0.000437177948
  error estimate for blocks of size 2^( 5) =       0.000446117342
  error estimate for blocks of size 2^( 6) =       0.000452388926
  error estimate for blocks of size 2^( 7) =       0.000457754333

      target function =                  N/A
              le_mean =     -16.906275018738
             les_mean =     286.154997407116
             stat err =       0.000448359637
             autocorr =       1.251504014577
              std dev =       0.566794181731
             le_variance =       0.321255644444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400784009
  error estimate for blocks of size 2^( 2) =       0.000413292056
  error estimate for blocks of size 2^( 3) =       0.000425602039
  error estimate for blocks of size 2^( 4) =       0.000437177948
  error estimate for blocks of size 2^( 5) =       0.000446117342
  error estimate for blocks of size 2^( 6) =       0.000452388926
  error estimate for blocks of size 2^( 7) =       0.000457754333

      target function =                  N/A
              le_mean =     -16.906275018738
             les_mean =     286.154997407116
             stat err =       0.000448359637
             autocorr =       1.251504014577
              std dev =       0.566794181731
             le_variance =       0.321255644444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321256130039
                                         uncertainty =       0.001830471332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400784009
  error estimate for blocks of size 2^( 2) =       0.000413292056
  error estimate for blocks of size 2^( 3) =       0.000425602039
  error estimate for blocks of size 2^( 4) =       0.000437177948
  error estimate for blocks of size 2^( 5) =       0.000446117342
  error estimate for blocks of size 2^( 6) =       0.000452388926
  error estimate for blocks of size 2^( 7) =       0.000457754333

      target function =                  N/A
              le_mean =     -16.906275018738
             les_mean =     286.154997407116
             stat err =       0.000448359637
             autocorr =       1.251504014577
              std dev =       0.566794181731
             le_variance =       0.321255644444


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906275018738        initial  <--
     9.5367e+28     9.5367e+29             0.0000e+00       -16.906275018738
     3.8147e+29     3.8147e+30             0.0000e+00       -16.906275018738
     1.5259e+30     1.5259e+31             0.0000e+00       -16.906275018738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2841
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0899e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.8924
    reference variance = 0.264486
====================================================
  Execution time = 2.1025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3152e-01
  Total weights = 1.951757987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1333e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320528314119
                                         uncertainty =       0.002342763458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320528314119
                                         uncertainty =       0.002342763458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400323659
  error estimate for blocks of size 2^( 2) =       0.000413064491
  error estimate for blocks of size 2^( 3) =       0.000426208741
  error estimate for blocks of size 2^( 4) =       0.000438817073
  error estimate for blocks of size 2^( 5) =       0.000449271570
  error estimate for blocks of size 2^( 6) =       0.000457623660
  error estimate for blocks of size 2^( 7) =       0.000462242997

      target function =                  N/A
              le_mean =     -16.906262616310
             les_mean =     286.153232728271
             stat err =       0.000451988825
             autocorr =       1.274773065986
              std dev =       0.566143148453
             le_variance =       0.320518064541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626261631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+31, overlap shift 1.5259e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262616280       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.103187 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7164e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.874
    reference variance = 0.357929
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3393e-01
  Total weights = 1.9516e+06
  Execution time = 1.8832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401183259
  error estimate for blocks of size 2^( 2) =       0.000414396643
  error estimate for blocks of size 2^( 3) =       0.000428936482
  error estimate for blocks of size 2^( 4) =       0.000442273490
  error estimate for blocks of size 2^( 5) =       0.000454980728
  error estimate for blocks of size 2^( 6) =       0.000464426485
  error estimate for blocks of size 2^( 7) =       0.000473118404

      target function =                  N/A
              le_mean =     -16.905778420696
             les_mean =     286.139272244502
             stat err =       0.000458699777
             autocorr =       1.307288542858
              std dev =       0.567358805213
             le_variance =       0.321896013853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401183259
  error estimate for blocks of size 2^( 2) =       0.000414396643
  error estimate for blocks of size 2^( 3) =       0.000428936482
  error estimate for blocks of size 2^( 4) =       0.000442273490
  error estimate for blocks of size 2^( 5) =       0.000454980728
  error estimate for blocks of size 2^( 6) =       0.000464426485
  error estimate for blocks of size 2^( 7) =       0.000473118404

      target function =                  N/A
              le_mean =     -16.905778420696
             les_mean =     286.139272244502
             stat err =       0.000458699777
             autocorr =       1.307288542858
              std dev =       0.567358805213
             le_variance =       0.321896013853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401183259
  error estimate for blocks of size 2^( 2) =       0.000414396643
  error estimate for blocks of size 2^( 3) =       0.000428936482
  error estimate for blocks of size 2^( 4) =       0.000442273490
  error estimate for blocks of size 2^( 5) =       0.000454980728
  error estimate for blocks of size 2^( 6) =       0.000464426485
  error estimate for blocks of size 2^( 7) =       0.000473118404

      target function =                  N/A
              le_mean =     -16.905778420696
             les_mean =     286.139272244502
             stat err =       0.000458699777
             autocorr =       1.307288542858
              std dev =       0.567358805213
             le_variance =       0.321896013853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321983215236
                                         uncertainty =       0.001881718373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401183259
  error estimate for blocks of size 2^( 2) =       0.000414396643
  error estimate for blocks of size 2^( 3) =       0.000428936482
  error estimate for blocks of size 2^( 4) =       0.000442273490
  error estimate for blocks of size 2^( 5) =       0.000454980728
  error estimate for blocks of size 2^( 6) =       0.000464426485
  error estimate for blocks of size 2^( 7) =       0.000473118404

      target function =                  N/A
              le_mean =     -16.905778420696
             les_mean =     286.139272244502
             stat err =       0.000458699777
             autocorr =       1.307288542858
              std dev =       0.567358805213
             le_variance =       0.321896013853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905778420696        initial  <--
     9.5367e+29     9.5367e+30             0.0000e+00       -16.905778420696
     3.8147e+30     3.8147e+31             0.0000e+00       -16.905778420696
     1.5259e+31     1.5259e+32             0.0000e+00       -16.905778420696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1122
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.341694
====================================================
  Execution time = 2.0692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3492e-01
  Total weights = 1.951980534e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322605949495
                                         uncertainty =       0.002502725688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322605949495
                                         uncertainty =       0.002502725688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401659503
  error estimate for blocks of size 2^( 2) =       0.000414050729
  error estimate for blocks of size 2^( 3) =       0.000427050532
  error estimate for blocks of size 2^( 4) =       0.000438504208
  error estimate for blocks of size 2^( 5) =       0.000448641869
  error estimate for blocks of size 2^( 6) =       0.000454633777
  error estimate for blocks of size 2^( 7) =       0.000457251624

      target function =                  N/A
              le_mean =     -16.906609998552
             les_mean =     286.168378602334
             stat err =       0.000449757870
             autocorr =       1.253838061628
              std dev =       0.568032316865
             le_variance =       0.322660713003


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660999855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+32, overlap shift 1.5259e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906609998539       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.104366 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6739e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9909
    reference variance = 0.197492
====================================================
  Execution time = 2.0918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3419e-01
  Total weights = 1.9519e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402061488
  error estimate for blocks of size 2^( 2) =       0.000414819958
  error estimate for blocks of size 2^( 3) =       0.000428267925
  error estimate for blocks of size 2^( 4) =       0.000440250198
  error estimate for blocks of size 2^( 5) =       0.000450699024
  error estimate for blocks of size 2^( 6) =       0.000457594190
  error estimate for blocks of size 2^( 7) =       0.000466308170

      target function =                  N/A
              le_mean =     -16.906563547457
             les_mean =     286.166082482170
             stat err =       0.000453712896
             autocorr =       1.273436502568
              std dev =       0.568600809433
             le_variance =       0.323306880488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402061488
  error estimate for blocks of size 2^( 2) =       0.000414819958
  error estimate for blocks of size 2^( 3) =       0.000428267925
  error estimate for blocks of size 2^( 4) =       0.000440250198
  error estimate for blocks of size 2^( 5) =       0.000450699024
  error estimate for blocks of size 2^( 6) =       0.000457594190
  error estimate for blocks of size 2^( 7) =       0.000466308170

      target function =                  N/A
              le_mean =     -16.906563547457
             les_mean =     286.166082482170
             stat err =       0.000453712896
             autocorr =       1.273436502568
              std dev =       0.568600809433
             le_variance =       0.323306880488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402061488
  error estimate for blocks of size 2^( 2) =       0.000414819958
  error estimate for blocks of size 2^( 3) =       0.000428267925
  error estimate for blocks of size 2^( 4) =       0.000440250198
  error estimate for blocks of size 2^( 5) =       0.000450699024
  error estimate for blocks of size 2^( 6) =       0.000457594190
  error estimate for blocks of size 2^( 7) =       0.000466308170

      target function =                  N/A
              le_mean =     -16.906563547457
             les_mean =     286.166082482170
             stat err =       0.000453712896
             autocorr =       1.273436502568
              std dev =       0.568600809433
             le_variance =       0.323306880488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323408386973
                                         uncertainty =       0.002177237424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402061488
  error estimate for blocks of size 2^( 2) =       0.000414819958
  error estimate for blocks of size 2^( 3) =       0.000428267925
  error estimate for blocks of size 2^( 4) =       0.000440250198
  error estimate for blocks of size 2^( 5) =       0.000450699024
  error estimate for blocks of size 2^( 6) =       0.000457594190
  error estimate for blocks of size 2^( 7) =       0.000466308170

      target function =                  N/A
              le_mean =     -16.906563547457
             les_mean =     286.166082482170
             stat err =       0.000453712896
             autocorr =       1.273436502568
              std dev =       0.568600809433
             le_variance =       0.323306880488


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906563547457        initial  <--
     9.5367e+30     9.5367e+31             0.0000e+00       -16.906563547457
     3.8147e+31     3.8147e+32             0.0000e+00       -16.906563547457
     1.5259e+32     1.5259e+33             0.0000e+00       -16.906563547457

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4323
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8197
    reference variance = 0.250889
====================================================
  Execution time = 2.0757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3682e-01
  Total weights = 1.951730403e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323341531074
                                         uncertainty =       0.002027944946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323341531074
                                         uncertainty =       0.002027944946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402171703
  error estimate for blocks of size 2^( 2) =       0.000414903744
  error estimate for blocks of size 2^( 3) =       0.000428112132
  error estimate for blocks of size 2^( 4) =       0.000442427537
  error estimate for blocks of size 2^( 5) =       0.000453419389
  error estimate for blocks of size 2^( 6) =       0.000462031686
  error estimate for blocks of size 2^( 7) =       0.000468540983

      target function =                  N/A
              le_mean =     -16.906085094881
             les_mean =     286.152531177700
             stat err =       0.000456604899
             autocorr =       1.289015416550
              std dev =       0.568756677485
             le_variance =       0.323484158183


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608509488e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+33, overlap shift 1.5259e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906085094884       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.105527 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7018e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.413567
====================================================
  Execution time = 2.0659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2996e-01
  Total weights = 1.9515e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000795
  error estimate for blocks of size 2^( 2) =       0.000413331875
  error estimate for blocks of size 2^( 3) =       0.000426911613
  error estimate for blocks of size 2^( 4) =       0.000439021756
  error estimate for blocks of size 2^( 5) =       0.000449046732
  error estimate for blocks of size 2^( 6) =       0.000457803601
  error estimate for blocks of size 2^( 7) =       0.000464661512

      target function =                  N/A
              le_mean =     -16.906241348253
             les_mean =     286.150960900523
             stat err =       0.000452633400
             autocorr =       1.280476129102
              std dev =       0.565686549097
             le_variance =       0.320001271829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000795
  error estimate for blocks of size 2^( 2) =       0.000413331875
  error estimate for blocks of size 2^( 3) =       0.000426911613
  error estimate for blocks of size 2^( 4) =       0.000439021756
  error estimate for blocks of size 2^( 5) =       0.000449046732
  error estimate for blocks of size 2^( 6) =       0.000457803601
  error estimate for blocks of size 2^( 7) =       0.000464661512

      target function =                  N/A
              le_mean =     -16.906241348253
             les_mean =     286.150960900523
             stat err =       0.000452633400
             autocorr =       1.280476129102
              std dev =       0.565686549097
             le_variance =       0.320001271829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000795
  error estimate for blocks of size 2^( 2) =       0.000413331875
  error estimate for blocks of size 2^( 3) =       0.000426911613
  error estimate for blocks of size 2^( 4) =       0.000439021756
  error estimate for blocks of size 2^( 5) =       0.000449046732
  error estimate for blocks of size 2^( 6) =       0.000457803601
  error estimate for blocks of size 2^( 7) =       0.000464661512

      target function =                  N/A
              le_mean =     -16.906241348253
             les_mean =     286.150960900523
             stat err =       0.000452633400
             autocorr =       1.280476129102
              std dev =       0.565686549097
             le_variance =       0.320001271829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320049615433
                                         uncertainty =       0.001782055492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400000795
  error estimate for blocks of size 2^( 2) =       0.000413331875
  error estimate for blocks of size 2^( 3) =       0.000426911613
  error estimate for blocks of size 2^( 4) =       0.000439021756
  error estimate for blocks of size 2^( 5) =       0.000449046732
  error estimate for blocks of size 2^( 6) =       0.000457803601
  error estimate for blocks of size 2^( 7) =       0.000464661512

      target function =                  N/A
              le_mean =     -16.906241348253
             les_mean =     286.150960900523
             stat err =       0.000452633400
             autocorr =       1.280476129102
              std dev =       0.565686549097
             le_variance =       0.320001271829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906241348253        initial  <--
     9.5367e+31     9.5367e+32             0.0000e+00       -16.906241348253
     3.8147e+32     3.8147e+33             0.0000e+00       -16.906241348253
     1.5259e+33     1.5259e+34             0.0000e+00       -16.906241348253

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1891
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8694
    reference variance = 0.254169
====================================================
  Execution time = 2.0927e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3630e-01
  Total weights = 1.951757197e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322294331424
                                         uncertainty =       0.002331183717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322294331424
                                         uncertainty =       0.002331183717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401375717
  error estimate for blocks of size 2^( 2) =       0.000414293865
  error estimate for blocks of size 2^( 3) =       0.000427377130
  error estimate for blocks of size 2^( 4) =       0.000438386349
  error estimate for blocks of size 2^( 5) =       0.000449013929
  error estimate for blocks of size 2^( 6) =       0.000454837198
  error estimate for blocks of size 2^( 7) =       0.000458254056

      target function =                  N/A
              le_mean =     -16.906302648186
             les_mean =     286.159368244901
             stat err =       0.000450122883
             autocorr =       1.257650578950
              std dev =       0.567630982334
             le_variance =       0.322204932106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630264819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+34, overlap shift 1.5259e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302648162       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+34 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.106652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6974e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9842
    reference variance = 0.742339
====================================================
  Execution time = 2.2761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4577e-01
  Total weights = 1.9516e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405565324
  error estimate for blocks of size 2^( 2) =       0.000418065963
  error estimate for blocks of size 2^( 3) =       0.000430584612
  error estimate for blocks of size 2^( 4) =       0.000442502811
  error estimate for blocks of size 2^( 5) =       0.000453695226
  error estimate for blocks of size 2^( 6) =       0.000461404026
  error estimate for blocks of size 2^( 7) =       0.000465162389

      target function =                  N/A
              le_mean =     -16.906632819259
             les_mean =     286.180000968187
             stat err =       0.000455691113
             autocorr =       1.262465403962
              std dev =       0.573555982304
             le_variance =       0.328966464836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405565324
  error estimate for blocks of size 2^( 2) =       0.000418065963
  error estimate for blocks of size 2^( 3) =       0.000430584612
  error estimate for blocks of size 2^( 4) =       0.000442502811
  error estimate for blocks of size 2^( 5) =       0.000453695226
  error estimate for blocks of size 2^( 6) =       0.000461404026
  error estimate for blocks of size 2^( 7) =       0.000465162389

      target function =                  N/A
              le_mean =     -16.906632819259
             les_mean =     286.180000968187
             stat err =       0.000455691113
             autocorr =       1.262465403962
              std dev =       0.573555982304
             le_variance =       0.328966464836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405565324
  error estimate for blocks of size 2^( 2) =       0.000418065963
  error estimate for blocks of size 2^( 3) =       0.000430584612
  error estimate for blocks of size 2^( 4) =       0.000442502811
  error estimate for blocks of size 2^( 5) =       0.000453695226
  error estimate for blocks of size 2^( 6) =       0.000461404026
  error estimate for blocks of size 2^( 7) =       0.000465162389

      target function =                  N/A
              le_mean =     -16.906632819259
             les_mean =     286.180000968187
             stat err =       0.000455691113
             autocorr =       1.262465403962
              std dev =       0.573555982304
             le_variance =       0.328966464836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328853344704
                                         uncertainty =       0.002731167867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405565324
  error estimate for blocks of size 2^( 2) =       0.000418065963
  error estimate for blocks of size 2^( 3) =       0.000430584612
  error estimate for blocks of size 2^( 4) =       0.000442502811
  error estimate for blocks of size 2^( 5) =       0.000453695226
  error estimate for blocks of size 2^( 6) =       0.000461404026
  error estimate for blocks of size 2^( 7) =       0.000465162389

      target function =                  N/A
              le_mean =     -16.906632819259
             les_mean =     286.180000968187
             stat err =       0.000455691113
             autocorr =       1.262465403962
              std dev =       0.573555982304
             le_variance =       0.328966464836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906632819259        initial  <--
     9.5367e+32     9.5367e+33             0.0000e+00       -16.906632819259
     3.8147e+33     3.8147e+34             0.0000e+00       -16.906632819259
     1.5259e+34     1.5259e+35             0.0000e+00       -16.906632819259

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3333
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.27245
====================================================
  Execution time = 2.0941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3613e-01
  Total weights = 1.951825448e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021291372
                                         uncertainty =       0.002679942158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021291372
                                         uncertainty =       0.002679942158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400016905
  error estimate for blocks of size 2^( 2) =       0.000412709466
  error estimate for blocks of size 2^( 3) =       0.000425064506
  error estimate for blocks of size 2^( 4) =       0.000437744513
  error estimate for blocks of size 2^( 5) =       0.000448238126
  error estimate for blocks of size 2^( 6) =       0.000457393734
  error estimate for blocks of size 2^( 7) =       0.000461971840

      target function =                  N/A
              le_mean =     -16.906176216313
             les_mean =     286.154920511221
             stat err =       0.000451337053
             autocorr =       1.273049488835
              std dev =       0.565709332870
             le_variance =       0.320027049296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617621631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+35, overlap shift 1.5259e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176216348       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.107821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6995e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8775
    reference variance = 0.178272
====================================================
  Execution time = 2.1060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4052e-01
  Total weights = 1.9516e+06
  Execution time = 1.8941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405027104
  error estimate for blocks of size 2^( 2) =       0.000417908602
  error estimate for blocks of size 2^( 3) =       0.000430446652
  error estimate for blocks of size 2^( 4) =       0.000442532337
  error estimate for blocks of size 2^( 5) =       0.000450862742
  error estimate for blocks of size 2^( 6) =       0.000456775624
  error estimate for blocks of size 2^( 7) =       0.000463434445

      target function =                  N/A
              le_mean =     -16.906551466219
             les_mean =     286.172004899415
             stat err =       0.000453401287
             autocorr =       1.253133455274
              std dev =       0.572794822998
             le_variance =       0.328093909254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405027104
  error estimate for blocks of size 2^( 2) =       0.000417908602
  error estimate for blocks of size 2^( 3) =       0.000430446652
  error estimate for blocks of size 2^( 4) =       0.000442532337
  error estimate for blocks of size 2^( 5) =       0.000450862742
  error estimate for blocks of size 2^( 6) =       0.000456775624
  error estimate for blocks of size 2^( 7) =       0.000463434445

      target function =                  N/A
              le_mean =     -16.906551466219
             les_mean =     286.172004899415
             stat err =       0.000453401287
             autocorr =       1.253133455274
              std dev =       0.572794822998
             le_variance =       0.328093909254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405027104
  error estimate for blocks of size 2^( 2) =       0.000417908602
  error estimate for blocks of size 2^( 3) =       0.000430446652
  error estimate for blocks of size 2^( 4) =       0.000442532337
  error estimate for blocks of size 2^( 5) =       0.000450862742
  error estimate for blocks of size 2^( 6) =       0.000456775624
  error estimate for blocks of size 2^( 7) =       0.000463434445

      target function =                  N/A
              le_mean =     -16.906551466219
             les_mean =     286.172004899415
             stat err =       0.000453401287
             autocorr =       1.253133455274
              std dev =       0.572794822998
             le_variance =       0.328093909254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328075377129
                                         uncertainty =       0.002467263201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405027104
  error estimate for blocks of size 2^( 2) =       0.000417908602
  error estimate for blocks of size 2^( 3) =       0.000430446652
  error estimate for blocks of size 2^( 4) =       0.000442532337
  error estimate for blocks of size 2^( 5) =       0.000450862742
  error estimate for blocks of size 2^( 6) =       0.000456775624
  error estimate for blocks of size 2^( 7) =       0.000463434445

      target function =                  N/A
              le_mean =     -16.906551466219
             les_mean =     286.172004899415
             stat err =       0.000453401287
             autocorr =       1.253133455274
              std dev =       0.572794822998
             le_variance =       0.328093909254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906551466219        initial  <--
     9.5367e+33     9.5367e+34             0.0000e+00       -16.906551466219
     3.8147e+34     3.8147e+35             0.0000e+00       -16.906551466219
     1.5259e+35     1.5259e+36             0.0000e+00       -16.906551466219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6190
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.184544
====================================================
  Execution time = 2.1118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3174e-01
  Total weights = 1.951741454e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319650791263
                                         uncertainty =       0.002070458592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319650791263
                                         uncertainty =       0.002070458592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399745500
  error estimate for blocks of size 2^( 2) =       0.000412831090
  error estimate for blocks of size 2^( 3) =       0.000425961731
  error estimate for blocks of size 2^( 4) =       0.000439012927
  error estimate for blocks of size 2^( 5) =       0.000450737738
  error estimate for blocks of size 2^( 6) =       0.000458860091
  error estimate for blocks of size 2^( 7) =       0.000466525753

      target function =                  N/A
              le_mean =     -16.905901550144
             les_mean =     286.141246647152
             stat err =       0.000453784127
             autocorr =       1.288639484989
              std dev =       0.565325507826
             le_variance =       0.319592929799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590155014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901550107       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901550107       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901432037       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+34 is 5.227286e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901550107       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901550107       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901908875       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+35 is 1.306822e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+36, overlap shift 1.5259e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901550107       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901550107       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905900955200       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+36 is 3.267054e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.109283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7192e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.9394
    reference variance = 0.150346
====================================================
  Execution time = 2.0912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3366e-01
  Total weights = 1.9516e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400978975
  error estimate for blocks of size 2^( 2) =       0.000413955711
  error estimate for blocks of size 2^( 3) =       0.000427077988
  error estimate for blocks of size 2^( 4) =       0.000439676054
  error estimate for blocks of size 2^( 5) =       0.000449425799
  error estimate for blocks of size 2^( 6) =       0.000455471335
  error estimate for blocks of size 2^( 7) =       0.000460080626

      target function =                  N/A
              le_mean =     -16.907019144328
             les_mean =     286.180952514521
             stat err =       0.000451163454
             autocorr =       1.265973518456
              std dev =       0.567069905290
             le_variance =       0.321568277486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400978975
  error estimate for blocks of size 2^( 2) =       0.000413955711
  error estimate for blocks of size 2^( 3) =       0.000427077988
  error estimate for blocks of size 2^( 4) =       0.000439676054
  error estimate for blocks of size 2^( 5) =       0.000449425799
  error estimate for blocks of size 2^( 6) =       0.000455471335
  error estimate for blocks of size 2^( 7) =       0.000460080626

      target function =                  N/A
              le_mean =     -16.907019144328
             les_mean =     286.180952514521
             stat err =       0.000451163454
             autocorr =       1.265973518456
              std dev =       0.567069905290
             le_variance =       0.321568277486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400978975
  error estimate for blocks of size 2^( 2) =       0.000413955711
  error estimate for blocks of size 2^( 3) =       0.000427077988
  error estimate for blocks of size 2^( 4) =       0.000439676054
  error estimate for blocks of size 2^( 5) =       0.000449425799
  error estimate for blocks of size 2^( 6) =       0.000455471335
  error estimate for blocks of size 2^( 7) =       0.000460080626

      target function =                  N/A
              le_mean =     -16.907019144328
             les_mean =     286.180952514521
             stat err =       0.000451163454
             autocorr =       1.265973518456
              std dev =       0.567069905290
             le_variance =       0.321568277486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321562946794
                                         uncertainty =       0.002988509343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400978975
  error estimate for blocks of size 2^( 2) =       0.000413955711
  error estimate for blocks of size 2^( 3) =       0.000427077988
  error estimate for blocks of size 2^( 4) =       0.000439676054
  error estimate for blocks of size 2^( 5) =       0.000449425799
  error estimate for blocks of size 2^( 6) =       0.000455471335
  error estimate for blocks of size 2^( 7) =       0.000460080626

      target function =                  N/A
              le_mean =     -16.907019144328
             les_mean =     286.180952514521
             stat err =       0.000451163454
             autocorr =       1.265973518456
              std dev =       0.567069905290
             le_variance =       0.321568277486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907019144328        initial  <--
     9.5367e+34     9.5367e+35             5.2273e-39       -16.907019144328
     3.8147e+35     3.8147e+36             1.3068e-39       -16.907019144328
     1.5259e+36     1.5259e+37             3.2671e-40       -16.907019144328

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4195
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7622e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.208666
====================================================
  Execution time = 2.0957e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3697e-01
  Total weights = 1.952018840e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931610030
                                         uncertainty =       0.002887838759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931610030
                                         uncertainty =       0.002887838759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218976
  error estimate for blocks of size 2^( 2) =       0.000413923644
  error estimate for blocks of size 2^( 3) =       0.000427242634
  error estimate for blocks of size 2^( 4) =       0.000439212699
  error estimate for blocks of size 2^( 5) =       0.000448470353
  error estimate for blocks of size 2^( 6) =       0.000454709187
  error estimate for blocks of size 2^( 7) =       0.000458298251

      target function =                  N/A
              le_mean =     -16.906767635842
             les_mean =     286.175764778422
             stat err =       0.000450172622
             autocorr =       1.258911582738
              std dev =       0.567409316884
             le_variance =       0.321953332887


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676763584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906767635834       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906767635834       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906767845154       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+35 is 3.217546e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906767635834       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906767635834       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906766891479       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+36 is 8.043864e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+37, overlap shift 1.5259e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906767635834       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906767635834       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906768798828       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+37 is 2.010966e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.110736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7081e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9387
    reference variance = 0.295397
====================================================
  Execution time = 2.0688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3133e-01
  Total weights = 1.9514e+06
  Execution time = 1.8655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364252
  error estimate for blocks of size 2^( 2) =       0.000412547874
  error estimate for blocks of size 2^( 3) =       0.000426052341
  error estimate for blocks of size 2^( 4) =       0.000438572880
  error estimate for blocks of size 2^( 5) =       0.000448035236
  error estimate for blocks of size 2^( 6) =       0.000457642423
  error estimate for blocks of size 2^( 7) =       0.000461768216

      target function =                  N/A
              le_mean =     -16.906673197289
             les_mean =     286.166931129572
             stat err =       0.000451504689
             autocorr =       1.278162743457
              std dev =       0.564786341152
             le_variance =       0.318983611152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364252
  error estimate for blocks of size 2^( 2) =       0.000412547874
  error estimate for blocks of size 2^( 3) =       0.000426052341
  error estimate for blocks of size 2^( 4) =       0.000438572880
  error estimate for blocks of size 2^( 5) =       0.000448035236
  error estimate for blocks of size 2^( 6) =       0.000457642423
  error estimate for blocks of size 2^( 7) =       0.000461768216

      target function =                  N/A
              le_mean =     -16.906673197289
             les_mean =     286.166931129572
             stat err =       0.000451504689
             autocorr =       1.278162743457
              std dev =       0.564786341152
             le_variance =       0.318983611152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364252
  error estimate for blocks of size 2^( 2) =       0.000412547874
  error estimate for blocks of size 2^( 3) =       0.000426052341
  error estimate for blocks of size 2^( 4) =       0.000438572880
  error estimate for blocks of size 2^( 5) =       0.000448035236
  error estimate for blocks of size 2^( 6) =       0.000457642423
  error estimate for blocks of size 2^( 7) =       0.000461768216

      target function =                  N/A
              le_mean =     -16.906673197289
             les_mean =     286.166931129572
             stat err =       0.000451504689
             autocorr =       1.278162743457
              std dev =       0.564786341152
             le_variance =       0.318983611152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319048845314
                                         uncertainty =       0.001654137657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364252
  error estimate for blocks of size 2^( 2) =       0.000412547874
  error estimate for blocks of size 2^( 3) =       0.000426052341
  error estimate for blocks of size 2^( 4) =       0.000438572880
  error estimate for blocks of size 2^( 5) =       0.000448035236
  error estimate for blocks of size 2^( 6) =       0.000457642423
  error estimate for blocks of size 2^( 7) =       0.000461768216

      target function =                  N/A
              le_mean =     -16.906673197289
             les_mean =     286.166931129572
             stat err =       0.000451504689
             autocorr =       1.278162743457
              std dev =       0.564786341152
             le_variance =       0.318983611152


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906673197289        initial  <--
     9.5367e+35     9.5367e+36             3.2175e-40       -16.906673197289
     3.8147e+36     3.8147e+37             8.0439e-41       -16.906673197289
     1.5259e+37     1.5259e+38             2.0110e-41       -16.906673197289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1138
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8994
    reference variance = 0.15203
====================================================
  Execution time = 2.1138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4112e-01
  Total weights = 1.951840641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322123178530
                                         uncertainty =       0.002104267628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322123178530
                                         uncertainty =       0.002104267628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401275023
  error estimate for blocks of size 2^( 2) =       0.000414047988
  error estimate for blocks of size 2^( 3) =       0.000427544873
  error estimate for blocks of size 2^( 4) =       0.000439797726
  error estimate for blocks of size 2^( 5) =       0.000450425733
  error estimate for blocks of size 2^( 6) =       0.000458132611
  error estimate for blocks of size 2^( 7) =       0.000462402907

      target function =                  N/A
              le_mean =     -16.906584181743
             les_mean =     286.173708698678
             stat err =       0.000452689744
             autocorr =       1.272673656367
              std dev =       0.567488579959
             le_variance =       0.322043288384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658418174e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584181770       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584181770       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584181770       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906555175781       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+36 is 5.328130e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584181770       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584181770       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584181770       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906616210938       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+37 is 1.332033e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+38, overlap shift 1.5259e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906584181770       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906584181770       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906584181770       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906494140625       residual = 4.63e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906555175781       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+38 is 3.330081e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.112605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7203e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.337566
====================================================
  Execution time = 2.0930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3741e-01
  Total weights = 1.9514e+06
  Execution time = 1.8695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402170226
  error estimate for blocks of size 2^( 2) =       0.000414491749
  error estimate for blocks of size 2^( 3) =       0.000427628826
  error estimate for blocks of size 2^( 4) =       0.000439478962
  error estimate for blocks of size 2^( 5) =       0.000449710571
  error estimate for blocks of size 2^( 6) =       0.000455933816
  error estimate for blocks of size 2^( 7) =       0.000459316943

      target function =                  N/A
              le_mean =     -16.905492334862
             les_mean =     286.133077041041
             stat err =       0.000451110073
             autocorr =       1.258187072877
              std dev =       0.568754588227
             le_variance =       0.323481781630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402170226
  error estimate for blocks of size 2^( 2) =       0.000414491749
  error estimate for blocks of size 2^( 3) =       0.000427628826
  error estimate for blocks of size 2^( 4) =       0.000439478962
  error estimate for blocks of size 2^( 5) =       0.000449710571
  error estimate for blocks of size 2^( 6) =       0.000455933816
  error estimate for blocks of size 2^( 7) =       0.000459316943

      target function =                  N/A
              le_mean =     -16.905492334862
             les_mean =     286.133077041041
             stat err =       0.000451110073
             autocorr =       1.258187072877
              std dev =       0.568754588227
             le_variance =       0.323481781630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402170226
  error estimate for blocks of size 2^( 2) =       0.000414491749
  error estimate for blocks of size 2^( 3) =       0.000427628826
  error estimate for blocks of size 2^( 4) =       0.000439478962
  error estimate for blocks of size 2^( 5) =       0.000449710571
  error estimate for blocks of size 2^( 6) =       0.000455933816
  error estimate for blocks of size 2^( 7) =       0.000459316943

      target function =                  N/A
              le_mean =     -16.905492334862
             les_mean =     286.133077041041
             stat err =       0.000451110073
             autocorr =       1.258187072877
              std dev =       0.568754588227
             le_variance =       0.323481781630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323487964741
                                         uncertainty =       0.002500605041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402170226
  error estimate for blocks of size 2^( 2) =       0.000414491749
  error estimate for blocks of size 2^( 3) =       0.000427628826
  error estimate for blocks of size 2^( 4) =       0.000439478962
  error estimate for blocks of size 2^( 5) =       0.000449710571
  error estimate for blocks of size 2^( 6) =       0.000455933816
  error estimate for blocks of size 2^( 7) =       0.000459316943

      target function =                  N/A
              le_mean =     -16.905492334862
             les_mean =     286.133077041041
             stat err =       0.000451110073
             autocorr =       1.258187072877
              std dev =       0.568754588227
             le_variance =       0.323481781630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905492334862        initial  <--
     9.5367e+36     9.5367e+37             5.3281e-41       -16.905492334862
     3.8147e+37     3.8147e+38             1.3320e-41       -16.905492334862
     1.5259e+38     1.5259e+39             3.3301e-42       -16.905492334862

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3852
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.937
    reference variance = 0.385534
====================================================
  Execution time = 2.0849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5217e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3659e-01
  Total weights = 1.951694617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322494209852
                                         uncertainty =       0.002602324571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322494209852
                                         uncertainty =       0.002602324571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401572220
  error estimate for blocks of size 2^( 2) =       0.000414484112
  error estimate for blocks of size 2^( 3) =       0.000427252557
  error estimate for blocks of size 2^( 4) =       0.000439248063
  error estimate for blocks of size 2^( 5) =       0.000449231262
  error estimate for blocks of size 2^( 6) =       0.000455292567
  error estimate for blocks of size 2^( 7) =       0.000460116492

      target function =                  N/A
              le_mean =     -16.906671547584
             les_mean =     286.172128044641
             stat err =       0.000450972096
             autocorr =       1.261165311604
              std dev =       0.567908880239
             le_variance =       0.322520496255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690667154758e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+39, overlap shift 1.5259e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671547567       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.113760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7113e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9445
    reference variance = 0.188349
====================================================
  Execution time = 2.2950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3598e-01
  Total weights = 1.9516e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402793202
  error estimate for blocks of size 2^( 2) =       0.000415665468
  error estimate for blocks of size 2^( 3) =       0.000428446375
  error estimate for blocks of size 2^( 4) =       0.000440730933
  error estimate for blocks of size 2^( 5) =       0.000451924878
  error estimate for blocks of size 2^( 6) =       0.000460171413
  error estimate for blocks of size 2^( 7) =       0.000466146542

      target function =                  N/A
              le_mean =     -16.906116666530
             les_mean =     286.152765404593
             stat err =       0.000454743441
             autocorr =       1.274584473248
              std dev =       0.569635609173
             le_variance =       0.324484727238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402793202
  error estimate for blocks of size 2^( 2) =       0.000415665468
  error estimate for blocks of size 2^( 3) =       0.000428446375
  error estimate for blocks of size 2^( 4) =       0.000440730933
  error estimate for blocks of size 2^( 5) =       0.000451924878
  error estimate for blocks of size 2^( 6) =       0.000460171413
  error estimate for blocks of size 2^( 7) =       0.000466146542

      target function =                  N/A
              le_mean =     -16.906116666530
             les_mean =     286.152765404593
             stat err =       0.000454743441
             autocorr =       1.274584473248
              std dev =       0.569635609173
             le_variance =       0.324484727238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402793202
  error estimate for blocks of size 2^( 2) =       0.000415665468
  error estimate for blocks of size 2^( 3) =       0.000428446375
  error estimate for blocks of size 2^( 4) =       0.000440730933
  error estimate for blocks of size 2^( 5) =       0.000451924878
  error estimate for blocks of size 2^( 6) =       0.000460171413
  error estimate for blocks of size 2^( 7) =       0.000466146542

      target function =                  N/A
              le_mean =     -16.906116666530
             les_mean =     286.152765404593
             stat err =       0.000454743441
             autocorr =       1.274584473248
              std dev =       0.569635609173
             le_variance =       0.324484727238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324543735153
                                         uncertainty =       0.003965209296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402793202
  error estimate for blocks of size 2^( 2) =       0.000415665468
  error estimate for blocks of size 2^( 3) =       0.000428446375
  error estimate for blocks of size 2^( 4) =       0.000440730933
  error estimate for blocks of size 2^( 5) =       0.000451924878
  error estimate for blocks of size 2^( 6) =       0.000460171413
  error estimate for blocks of size 2^( 7) =       0.000466146542

      target function =                  N/A
              le_mean =     -16.906116666530
             les_mean =     286.152765404593
             stat err =       0.000454743441
             autocorr =       1.274584473248
              std dev =       0.569635609173
             le_variance =       0.324484727238


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906116666530        initial  <--
     9.5367e+37     9.5367e+38             0.0000e+00       -16.906116666530
     3.8147e+38     3.8147e+39             0.0000e+00       -16.906116666530
     1.5259e+39     1.5259e+40             0.0000e+00       -16.906116666530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.4954
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9615e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9135
    reference variance = 0.286971
====================================================
  Execution time = 2.0890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3829e-01
  Total weights = 1.951530607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326211945475
                                         uncertainty =       0.002034684411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326211945475
                                         uncertainty =       0.002034684411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403883792
  error estimate for blocks of size 2^( 2) =       0.000416818587
  error estimate for blocks of size 2^( 3) =       0.000429011391
  error estimate for blocks of size 2^( 4) =       0.000440973224
  error estimate for blocks of size 2^( 5) =       0.000451084725
  error estimate for blocks of size 2^( 6) =       0.000458409177
  error estimate for blocks of size 2^( 7) =       0.000463655972

      target function =                  N/A
              le_mean =     -16.907144845173
             les_mean =     286.189834099669
             stat err =       0.000453530775
             autocorr =       1.260958150941
              std dev =       0.571177936101
             le_variance =       0.326244234688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690714484517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+40, overlap shift 1.5259e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907144845184       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.114914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6952e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.160297
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3627e-01
  Total weights = 1.9519e+06
  Execution time = 1.8629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402009065
  error estimate for blocks of size 2^( 2) =       0.000414830216
  error estimate for blocks of size 2^( 3) =       0.000428198267
  error estimate for blocks of size 2^( 4) =       0.000441166706
  error estimate for blocks of size 2^( 5) =       0.000451118578
  error estimate for blocks of size 2^( 6) =       0.000458958218
  error estimate for blocks of size 2^( 7) =       0.000463661522

      target function =                  N/A
              le_mean =     -16.905465584479
             les_mean =     286.131041072050
             stat err =       0.000453726256
             autocorr =       1.273843659844
              std dev =       0.568526672565
             le_variance =       0.323222577418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402009065
  error estimate for blocks of size 2^( 2) =       0.000414830216
  error estimate for blocks of size 2^( 3) =       0.000428198267
  error estimate for blocks of size 2^( 4) =       0.000441166706
  error estimate for blocks of size 2^( 5) =       0.000451118578
  error estimate for blocks of size 2^( 6) =       0.000458958218
  error estimate for blocks of size 2^( 7) =       0.000463661522

      target function =                  N/A
              le_mean =     -16.905465584479
             les_mean =     286.131041072050
             stat err =       0.000453726256
             autocorr =       1.273843659844
              std dev =       0.568526672565
             le_variance =       0.323222577418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402009065
  error estimate for blocks of size 2^( 2) =       0.000414830216
  error estimate for blocks of size 2^( 3) =       0.000428198267
  error estimate for blocks of size 2^( 4) =       0.000441166706
  error estimate for blocks of size 2^( 5) =       0.000451118578
  error estimate for blocks of size 2^( 6) =       0.000458958218
  error estimate for blocks of size 2^( 7) =       0.000463661522

      target function =                  N/A
              le_mean =     -16.905465584479
             les_mean =     286.131041072050
             stat err =       0.000453726256
             autocorr =       1.273843659844
              std dev =       0.568526672565
             le_variance =       0.323222577418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323265466833
                                         uncertainty =       0.002078325806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402009065
  error estimate for blocks of size 2^( 2) =       0.000414830216
  error estimate for blocks of size 2^( 3) =       0.000428198267
  error estimate for blocks of size 2^( 4) =       0.000441166706
  error estimate for blocks of size 2^( 5) =       0.000451118578
  error estimate for blocks of size 2^( 6) =       0.000458958218
  error estimate for blocks of size 2^( 7) =       0.000463661522

      target function =                  N/A
              le_mean =     -16.905465584479
             les_mean =     286.131041072050
             stat err =       0.000453726256
             autocorr =       1.273843659844
              std dev =       0.568526672565
             le_variance =       0.323222577418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905465584479        initial  <--
     9.5367e+38     9.5367e+39             0.0000e+00       -16.905465584479
     3.8147e+39     3.8147e+40             0.0000e+00       -16.905465584479
     1.5259e+40     1.5259e+41             0.0000e+00       -16.905465584479

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0272
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9194
    reference variance = 0.34855
====================================================
  Execution time = 2.1198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4106e-01
  Total weights = 1.951661507e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327400634827
                                         uncertainty =       0.003380948398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327400634827
                                         uncertainty =       0.003380948398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404550056
  error estimate for blocks of size 2^( 2) =       0.000417485614
  error estimate for blocks of size 2^( 3) =       0.000431038062
  error estimate for blocks of size 2^( 4) =       0.000443012445
  error estimate for blocks of size 2^( 5) =       0.000453151033
  error estimate for blocks of size 2^( 6) =       0.000460836670
  error estimate for blocks of size 2^( 7) =       0.000465313517

      target function =                  N/A
              le_mean =     -16.906465891307
             les_mean =     286.169648774749
             stat err =       0.000455578416
             autocorr =       1.268182481216
              std dev =       0.572120175827
             le_variance =       0.327321495589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646589131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+40, overlap shift 3.8147e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+41, overlap shift 1.5259e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465891270       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.116101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7280e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.213984
====================================================
  Execution time = 2.1733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3179e-01
  Total weights = 1.9521e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663186
  error estimate for blocks of size 2^( 2) =       0.000412319771
  error estimate for blocks of size 2^( 3) =       0.000425555227
  error estimate for blocks of size 2^( 4) =       0.000437715311
  error estimate for blocks of size 2^( 5) =       0.000448310787
  error estimate for blocks of size 2^( 6) =       0.000456349391
  error estimate for blocks of size 2^( 7) =       0.000462912026

      target function =                  N/A
              le_mean =     -16.906711877376
             les_mean =     286.168701489776
             stat err =       0.000451321879
             autocorr =       1.275218138490
              std dev =       0.565209098523
             le_variance =       0.319461325053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663186
  error estimate for blocks of size 2^( 2) =       0.000412319771
  error estimate for blocks of size 2^( 3) =       0.000425555227
  error estimate for blocks of size 2^( 4) =       0.000437715311
  error estimate for blocks of size 2^( 5) =       0.000448310787
  error estimate for blocks of size 2^( 6) =       0.000456349391
  error estimate for blocks of size 2^( 7) =       0.000462912026

      target function =                  N/A
              le_mean =     -16.906711877376
             les_mean =     286.168701489776
             stat err =       0.000451321879
             autocorr =       1.275218138490
              std dev =       0.565209098523
             le_variance =       0.319461325053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663186
  error estimate for blocks of size 2^( 2) =       0.000412319771
  error estimate for blocks of size 2^( 3) =       0.000425555227
  error estimate for blocks of size 2^( 4) =       0.000437715311
  error estimate for blocks of size 2^( 5) =       0.000448310787
  error estimate for blocks of size 2^( 6) =       0.000456349391
  error estimate for blocks of size 2^( 7) =       0.000462912026

      target function =                  N/A
              le_mean =     -16.906711877376
             les_mean =     286.168701489776
             stat err =       0.000451321879
             autocorr =       1.275218138490
              std dev =       0.565209098523
             le_variance =       0.319461325053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319440501380
                                         uncertainty =       0.002200859035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399663186
  error estimate for blocks of size 2^( 2) =       0.000412319771
  error estimate for blocks of size 2^( 3) =       0.000425555227
  error estimate for blocks of size 2^( 4) =       0.000437715311
  error estimate for blocks of size 2^( 5) =       0.000448310787
  error estimate for blocks of size 2^( 6) =       0.000456349391
  error estimate for blocks of size 2^( 7) =       0.000462912026

      target function =                  N/A
              le_mean =     -16.906711877376
             les_mean =     286.168701489776
             stat err =       0.000451321879
             autocorr =       1.275218138490
              std dev =       0.565209098523
             le_variance =       0.319461325053


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906711877376        initial  <--
     9.5367e+39     9.5367e+40             0.0000e+00       -16.906711877376
     3.8147e+40     3.8147e+41             0.0000e+00       -16.906711877376
     1.5259e+41     1.5259e+42             0.0000e+00       -16.906711877376

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3603
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9211
    reference variance = 0.207961
====================================================
  Execution time = 2.1614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3391e-01
  Total weights = 1.951701653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321668773136
                                         uncertainty =       0.002084602790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321668773136
                                         uncertainty =       0.002084602790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401035643
  error estimate for blocks of size 2^( 2) =       0.000413984048
  error estimate for blocks of size 2^( 3) =       0.000427276506
  error estimate for blocks of size 2^( 4) =       0.000438969370
  error estimate for blocks of size 2^( 5) =       0.000448587387
  error estimate for blocks of size 2^( 6) =       0.000455046926
  error estimate for blocks of size 2^( 7) =       0.000460008343

      target function =                  N/A
              le_mean =     -16.905979435764
             les_mean =     286.146049134033
             stat err =       0.000450653007
             autocorr =       1.262753551120
              std dev =       0.567150045727
             le_variance =       0.321659174368


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597943576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+41, overlap shift 3.8147e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+42, overlap shift 1.5259e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905979435789       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.117296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7662e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.568753
====================================================
  Execution time = 2.1007e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3435e-01
  Total weights = 1.9518e+06
  Execution time = 1.9005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400863476
  error estimate for blocks of size 2^( 2) =       0.000413684988
  error estimate for blocks of size 2^( 3) =       0.000427145361
  error estimate for blocks of size 2^( 4) =       0.000438552744
  error estimate for blocks of size 2^( 5) =       0.000447705666
  error estimate for blocks of size 2^( 6) =       0.000455844627
  error estimate for blocks of size 2^( 7) =       0.000461866423

      target function =                  N/A
              le_mean =     -16.906515297782
             les_mean =     286.164613173411
             stat err =       0.000450992365
             autocorr =       1.265742616008
              std dev =       0.566906564616
             le_variance =       0.321383053005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400863476
  error estimate for blocks of size 2^( 2) =       0.000413684988
  error estimate for blocks of size 2^( 3) =       0.000427145361
  error estimate for blocks of size 2^( 4) =       0.000438552744
  error estimate for blocks of size 2^( 5) =       0.000447705666
  error estimate for blocks of size 2^( 6) =       0.000455844627
  error estimate for blocks of size 2^( 7) =       0.000461866423

      target function =                  N/A
              le_mean =     -16.906515297782
             les_mean =     286.164613173411
             stat err =       0.000450992365
             autocorr =       1.265742616008
              std dev =       0.566906564616
             le_variance =       0.321383053005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400863476
  error estimate for blocks of size 2^( 2) =       0.000413684988
  error estimate for blocks of size 2^( 3) =       0.000427145361
  error estimate for blocks of size 2^( 4) =       0.000438552744
  error estimate for blocks of size 2^( 5) =       0.000447705666
  error estimate for blocks of size 2^( 6) =       0.000455844627
  error estimate for blocks of size 2^( 7) =       0.000461866423

      target function =                  N/A
              le_mean =     -16.906515297782
             les_mean =     286.164613173411
             stat err =       0.000450992365
             autocorr =       1.265742616008
              std dev =       0.566906564616
             le_variance =       0.321383053005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441014701
                                         uncertainty =       0.002864205673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400863476
  error estimate for blocks of size 2^( 2) =       0.000413684988
  error estimate for blocks of size 2^( 3) =       0.000427145361
  error estimate for blocks of size 2^( 4) =       0.000438552744
  error estimate for blocks of size 2^( 5) =       0.000447705666
  error estimate for blocks of size 2^( 6) =       0.000455844627
  error estimate for blocks of size 2^( 7) =       0.000461866423

      target function =                  N/A
              le_mean =     -16.906515297782
             les_mean =     286.164613173411
             stat err =       0.000450992365
             autocorr =       1.265742616008
              std dev =       0.566906564616
             le_variance =       0.321383053005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906515297782        initial  <--
     9.5367e+40     9.5367e+41             0.0000e+00       -16.906515297782
     3.8147e+41     3.8147e+42             0.0000e+00       -16.906515297782
     1.5259e+42     1.5259e+43             0.0000e+00       -16.906515297782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6486
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.235703
====================================================
  Execution time = 2.1745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5209e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3877e-01
  Total weights = 1.951217326e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323748858848
                                         uncertainty =       0.003143285310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323748858848
                                         uncertainty =       0.003143285310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402338995
  error estimate for blocks of size 2^( 2) =       0.000414961133
  error estimate for blocks of size 2^( 3) =       0.000428043932
  error estimate for blocks of size 2^( 4) =       0.000440113101
  error estimate for blocks of size 2^( 5) =       0.000449237673
  error estimate for blocks of size 2^( 6) =       0.000455998317
  error estimate for blocks of size 2^( 7) =       0.000458080144

      target function =                  N/A
              le_mean =     -16.905665616628
             les_mean =     286.140298772518
             stat err =       0.000450857309
             autocorr =       1.255723364185
              std dev =       0.568993263263
             le_variance =       0.323753333639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566561663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+42, overlap shift 3.8147e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+43, overlap shift 1.5259e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905665616615       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.118468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7776e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9427
    reference variance = 0.185682
====================================================
  Execution time = 2.1498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3115e-01
  Total weights = 1.9519e+06
  Execution time = 1.8927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400173271
  error estimate for blocks of size 2^( 2) =       0.000413614900
  error estimate for blocks of size 2^( 3) =       0.000427156702
  error estimate for blocks of size 2^( 4) =       0.000438754785
  error estimate for blocks of size 2^( 5) =       0.000450817307
  error estimate for blocks of size 2^( 6) =       0.000457471872
  error estimate for blocks of size 2^( 7) =       0.000463203428

      target function =                  N/A
              le_mean =     -16.905921285570
             les_mean =     286.141326985460
             stat err =       0.000452561848
             autocorr =       1.278968136117
              std dev =       0.565930466899
             le_variance =       0.320277293365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400173271
  error estimate for blocks of size 2^( 2) =       0.000413614900
  error estimate for blocks of size 2^( 3) =       0.000427156702
  error estimate for blocks of size 2^( 4) =       0.000438754785
  error estimate for blocks of size 2^( 5) =       0.000450817307
  error estimate for blocks of size 2^( 6) =       0.000457471872
  error estimate for blocks of size 2^( 7) =       0.000463203428

      target function =                  N/A
              le_mean =     -16.905921285570
             les_mean =     286.141326985460
             stat err =       0.000452561848
             autocorr =       1.278968136117
              std dev =       0.565930466899
             le_variance =       0.320277293365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400173271
  error estimate for blocks of size 2^( 2) =       0.000413614900
  error estimate for blocks of size 2^( 3) =       0.000427156702
  error estimate for blocks of size 2^( 4) =       0.000438754785
  error estimate for blocks of size 2^( 5) =       0.000450817307
  error estimate for blocks of size 2^( 6) =       0.000457471872
  error estimate for blocks of size 2^( 7) =       0.000463203428

      target function =                  N/A
              le_mean =     -16.905921285570
             les_mean =     286.141326985460
             stat err =       0.000452561848
             autocorr =       1.278968136117
              std dev =       0.565930466899
             le_variance =       0.320277293365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320350738304
                                         uncertainty =       0.002158030113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400173271
  error estimate for blocks of size 2^( 2) =       0.000413614900
  error estimate for blocks of size 2^( 3) =       0.000427156702
  error estimate for blocks of size 2^( 4) =       0.000438754785
  error estimate for blocks of size 2^( 5) =       0.000450817307
  error estimate for blocks of size 2^( 6) =       0.000457471872
  error estimate for blocks of size 2^( 7) =       0.000463203428

      target function =                  N/A
              le_mean =     -16.905921285570
             les_mean =     286.141326985460
             stat err =       0.000452561848
             autocorr =       1.278968136117
              std dev =       0.565930466899
             le_variance =       0.320277293365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905921285570        initial  <--
     9.5367e+41     9.5367e+42             0.0000e+00       -16.905921285570
     3.8147e+42     3.8147e+43             0.0000e+00       -16.905921285570
     1.5259e+43     1.5259e+44             0.0000e+00       -16.905921285570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1142
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.0062
    reference variance = 0.444207
====================================================
  Execution time = 2.1470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3280e-01
  Total weights = 1.951782147e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321870827372
                                         uncertainty =       0.002174311729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321870827372
                                         uncertainty =       0.002174311729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401163654
  error estimate for blocks of size 2^( 2) =       0.000413897021
  error estimate for blocks of size 2^( 3) =       0.000426487786
  error estimate for blocks of size 2^( 4) =       0.000437943357
  error estimate for blocks of size 2^( 5) =       0.000448550476
  error estimate for blocks of size 2^( 6) =       0.000454723983
  error estimate for blocks of size 2^( 7) =       0.000459900613

      target function =                  N/A
              le_mean =     -16.906248916284
             les_mean =     286.154047492417
             stat err =       0.000450279607
             autocorr =       1.259857424148
              std dev =       0.567331080548
             le_variance =       0.321864554956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624891628e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+43, overlap shift 3.8147e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+44, overlap shift 1.5259e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906248916294       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.119648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7664e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.194699
====================================================
  Execution time = 2.1303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3460e-01
  Total weights = 1.9518e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700096
  error estimate for blocks of size 2^( 2) =       0.000413554855
  error estimate for blocks of size 2^( 3) =       0.000426711267
  error estimate for blocks of size 2^( 4) =       0.000438859423
  error estimate for blocks of size 2^( 5) =       0.000449206822
  error estimate for blocks of size 2^( 6) =       0.000454659742
  error estimate for blocks of size 2^( 7) =       0.000459110850

      target function =                  N/A
              le_mean =     -16.905992375561
             les_mean =     286.147181771742
             stat err =       0.000450459209
             autocorr =       1.263781655671
              std dev =       0.566675509884
             le_variance =       0.321121133502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700096
  error estimate for blocks of size 2^( 2) =       0.000413554855
  error estimate for blocks of size 2^( 3) =       0.000426711267
  error estimate for blocks of size 2^( 4) =       0.000438859423
  error estimate for blocks of size 2^( 5) =       0.000449206822
  error estimate for blocks of size 2^( 6) =       0.000454659742
  error estimate for blocks of size 2^( 7) =       0.000459110850

      target function =                  N/A
              le_mean =     -16.905992375561
             les_mean =     286.147181771742
             stat err =       0.000450459209
             autocorr =       1.263781655671
              std dev =       0.566675509884
             le_variance =       0.321121133502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700096
  error estimate for blocks of size 2^( 2) =       0.000413554855
  error estimate for blocks of size 2^( 3) =       0.000426711267
  error estimate for blocks of size 2^( 4) =       0.000438859423
  error estimate for blocks of size 2^( 5) =       0.000449206822
  error estimate for blocks of size 2^( 6) =       0.000454659742
  error estimate for blocks of size 2^( 7) =       0.000459110850

      target function =                  N/A
              le_mean =     -16.905992375561
             les_mean =     286.147181771742
             stat err =       0.000450459209
             autocorr =       1.263781655671
              std dev =       0.566675509884
             le_variance =       0.321121133502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321164242505
                                         uncertainty =       0.001900530296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700096
  error estimate for blocks of size 2^( 2) =       0.000413554855
  error estimate for blocks of size 2^( 3) =       0.000426711267
  error estimate for blocks of size 2^( 4) =       0.000438859423
  error estimate for blocks of size 2^( 5) =       0.000449206822
  error estimate for blocks of size 2^( 6) =       0.000454659742
  error estimate for blocks of size 2^( 7) =       0.000459110850

      target function =                  N/A
              le_mean =     -16.905992375561
             les_mean =     286.147181771742
             stat err =       0.000450459209
             autocorr =       1.263781655671
              std dev =       0.566675509884
             le_variance =       0.321121133502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905992375561        initial  <--
     9.5367e+42     9.5367e+43             0.0000e+00       -16.905992375561
     3.8147e+43     3.8147e+44             0.0000e+00       -16.905992375561
     1.5259e+44     1.5259e+45             0.0000e+00       -16.905992375561

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.6649
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8341
    reference variance = 0.172981
====================================================
  Execution time = 2.1321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4041e-01
  Total weights = 1.951893456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323497049986
                                         uncertainty =       0.002431802467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323497049986
                                         uncertainty =       0.002431802467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402217799
  error estimate for blocks of size 2^( 2) =       0.000415193902
  error estimate for blocks of size 2^( 3) =       0.000428079268
  error estimate for blocks of size 2^( 4) =       0.000440405306
  error estimate for blocks of size 2^( 5) =       0.000450577824
  error estimate for blocks of size 2^( 6) =       0.000459190138
  error estimate for blocks of size 2^( 7) =       0.000464969995

      target function =                  N/A
              le_mean =     -16.906023520743
             les_mean =     286.154037885989
             stat err =       0.000453785816
             autocorr =       1.272855969680
              std dev =       0.568821866017
             le_variance =       0.323558315259


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602352074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+44, overlap shift 3.8147e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+45, overlap shift 1.5259e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023520750       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.120821 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7589e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8569
    reference variance = 0.346856
====================================================
  Execution time = 2.1269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3609e-01
  Total weights = 1.9517e+06
  Execution time = 1.9003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401939052
  error estimate for blocks of size 2^( 2) =       0.000414964925
  error estimate for blocks of size 2^( 3) =       0.000428262692
  error estimate for blocks of size 2^( 4) =       0.000441270054
  error estimate for blocks of size 2^( 5) =       0.000452762340
  error estimate for blocks of size 2^( 6) =       0.000460358972
  error estimate for blocks of size 2^( 7) =       0.000465855553

      target function =                  N/A
              le_mean =     -16.906097517796
             les_mean =     286.152226986769
             stat err =       0.000455061730
             autocorr =       1.281799857354
              std dev =       0.568427658584
             le_variance =       0.323110003044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401939052
  error estimate for blocks of size 2^( 2) =       0.000414964925
  error estimate for blocks of size 2^( 3) =       0.000428262692
  error estimate for blocks of size 2^( 4) =       0.000441270054
  error estimate for blocks of size 2^( 5) =       0.000452762340
  error estimate for blocks of size 2^( 6) =       0.000460358972
  error estimate for blocks of size 2^( 7) =       0.000465855553

      target function =                  N/A
              le_mean =     -16.906097517796
             les_mean =     286.152226986769
             stat err =       0.000455061730
             autocorr =       1.281799857354
              std dev =       0.568427658584
             le_variance =       0.323110003044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401939052
  error estimate for blocks of size 2^( 2) =       0.000414964925
  error estimate for blocks of size 2^( 3) =       0.000428262692
  error estimate for blocks of size 2^( 4) =       0.000441270054
  error estimate for blocks of size 2^( 5) =       0.000452762340
  error estimate for blocks of size 2^( 6) =       0.000460358972
  error estimate for blocks of size 2^( 7) =       0.000465855553

      target function =                  N/A
              le_mean =     -16.906097517796
             les_mean =     286.152226986769
             stat err =       0.000455061730
             autocorr =       1.281799857354
              std dev =       0.568427658584
             le_variance =       0.323110003044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323083357179
                                         uncertainty =       0.002427275590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401939052
  error estimate for blocks of size 2^( 2) =       0.000414964925
  error estimate for blocks of size 2^( 3) =       0.000428262692
  error estimate for blocks of size 2^( 4) =       0.000441270054
  error estimate for blocks of size 2^( 5) =       0.000452762340
  error estimate for blocks of size 2^( 6) =       0.000460358972
  error estimate for blocks of size 2^( 7) =       0.000465855553

      target function =                  N/A
              le_mean =     -16.906097517796
             les_mean =     286.152226986769
             stat err =       0.000455061730
             autocorr =       1.281799857354
              std dev =       0.568427658584
             le_variance =       0.323110003044


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906097517796        initial  <--
     9.5367e+43     9.5367e+44             0.0000e+00       -16.906097517796
     3.8147e+44     3.8147e+45             0.0000e+00       -16.906097517796
     1.5259e+45     1.5259e+46             0.0000e+00       -16.906097517796

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9166
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8512e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.8856
    reference variance = 0.253823
====================================================
  Execution time = 2.1449e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2870e-01
  Total weights = 1.952065311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318490593888
                                         uncertainty =       0.002467785198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318490593888
                                         uncertainty =       0.002467785198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399016549
  error estimate for blocks of size 2^( 2) =       0.000412241453
  error estimate for blocks of size 2^( 3) =       0.000425905672
  error estimate for blocks of size 2^( 4) =       0.000438902574
  error estimate for blocks of size 2^( 5) =       0.000450413294
  error estimate for blocks of size 2^( 6) =       0.000459654526
  error estimate for blocks of size 2^( 7) =       0.000467912191

      target function =                  N/A
              le_mean =     -16.905653021611
             les_mean =     286.129808917081
             stat err =       0.000454220646
             autocorr =       1.295841621443
              std dev =       0.564294615497
             le_variance =       0.318428413079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565302161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+44, overlap shift 9.5367e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653021588       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653021588       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250000000       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+44 is 2.598455e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+45, overlap shift 3.8147e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653021588       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653021588       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.875000000000       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.875000000000       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+45 is 6.496138e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+46, overlap shift 1.5259e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905653021588       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653021588       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.875000000000       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.000000000000       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+46 is 1.624034e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.122487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7681e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9086
    reference variance = 0.278887
====================================================
  Execution time = 2.1612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3373e-01
  Total weights = 1.9515e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219669
  error estimate for blocks of size 2^( 2) =       0.000414021674
  error estimate for blocks of size 2^( 3) =       0.000427926943
  error estimate for blocks of size 2^( 4) =       0.000440598684
  error estimate for blocks of size 2^( 5) =       0.000451661169
  error estimate for blocks of size 2^( 6) =       0.000460991685
  error estimate for blocks of size 2^( 7) =       0.000466303472

      target function =                  N/A
              le_mean =     -16.905886833344
             les_mean =     286.142736665856
             stat err =       0.000454888752
             autocorr =       1.285422707631
              std dev =       0.567410296715
             le_variance =       0.321954444818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219669
  error estimate for blocks of size 2^( 2) =       0.000414021674
  error estimate for blocks of size 2^( 3) =       0.000427926943
  error estimate for blocks of size 2^( 4) =       0.000440598684
  error estimate for blocks of size 2^( 5) =       0.000451661169
  error estimate for blocks of size 2^( 6) =       0.000460991685
  error estimate for blocks of size 2^( 7) =       0.000466303472

      target function =                  N/A
              le_mean =     -16.905886833344
             les_mean =     286.142736665856
             stat err =       0.000454888752
             autocorr =       1.285422707631
              std dev =       0.567410296715
             le_variance =       0.321954444818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219669
  error estimate for blocks of size 2^( 2) =       0.000414021674
  error estimate for blocks of size 2^( 3) =       0.000427926943
  error estimate for blocks of size 2^( 4) =       0.000440598684
  error estimate for blocks of size 2^( 5) =       0.000451661169
  error estimate for blocks of size 2^( 6) =       0.000460991685
  error estimate for blocks of size 2^( 7) =       0.000466303472

      target function =                  N/A
              le_mean =     -16.905886833344
             les_mean =     286.142736665856
             stat err =       0.000454888752
             autocorr =       1.285422707631
              std dev =       0.567410296715
             le_variance =       0.321954444818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321974164501
                                         uncertainty =       0.003317362543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219669
  error estimate for blocks of size 2^( 2) =       0.000414021674
  error estimate for blocks of size 2^( 3) =       0.000427926943
  error estimate for blocks of size 2^( 4) =       0.000440598684
  error estimate for blocks of size 2^( 5) =       0.000451661169
  error estimate for blocks of size 2^( 6) =       0.000460991685
  error estimate for blocks of size 2^( 7) =       0.000466303472

      target function =                  N/A
              le_mean =     -16.905886833344
             les_mean =     286.142736665856
             stat err =       0.000454888752
             autocorr =       1.285422707631
              std dev =       0.567410296715
             le_variance =       0.321954444818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905886833344        initial  <--
     9.5367e+44     9.5367e+45             2.5985e-49       -16.905886833344
     3.8147e+45     3.8147e+46             6.4961e-50       -16.905886833344
     1.5259e+46     1.5259e+47             1.6240e-50       -16.905886833344

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2338
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.8399
    reference variance = 0.358616
====================================================
  Execution time = 2.1568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4135e-01
  Total weights = 1.951430483e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326720129288
                                         uncertainty =       0.004790295013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326720129288
                                         uncertainty =       0.004790295013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404206358
  error estimate for blocks of size 2^( 2) =       0.000417317858
  error estimate for blocks of size 2^( 3) =       0.000430810537
  error estimate for blocks of size 2^( 4) =       0.000443992719
  error estimate for blocks of size 2^( 5) =       0.000456154921
  error estimate for blocks of size 2^( 6) =       0.000465606705
  error estimate for blocks of size 2^( 7) =       0.000471061351

      target function =                  N/A
              le_mean =     -16.906164987802
             les_mean =     286.159766498881
             stat err =       0.000459203924
             autocorr =       1.290639343338
              std dev =       0.571634113312
             le_variance =       0.326765559502


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616498780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+45, overlap shift 9.5367e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+46, overlap shift 3.8147e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+47, overlap shift 1.5259e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906164987799       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.123678 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7736e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9523
    reference variance = 0.297941
====================================================
  Execution time = 2.1336e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3733e-01
  Total weights = 1.9518e+06
  Execution time = 1.9002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403358890
  error estimate for blocks of size 2^( 2) =       0.000416416676
  error estimate for blocks of size 2^( 3) =       0.000430016322
  error estimate for blocks of size 2^( 4) =       0.000442319572
  error estimate for blocks of size 2^( 5) =       0.000454738801
  error estimate for blocks of size 2^( 6) =       0.000464578171
  error estimate for blocks of size 2^( 7) =       0.000470293208

      target function =                  N/A
              le_mean =     -16.906042354392
             les_mean =     286.151597235268
             stat err =       0.000457982438
             autocorr =       1.289182445429
              std dev =       0.570435612669
             le_variance =       0.325396788201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403358890
  error estimate for blocks of size 2^( 2) =       0.000416416676
  error estimate for blocks of size 2^( 3) =       0.000430016322
  error estimate for blocks of size 2^( 4) =       0.000442319572
  error estimate for blocks of size 2^( 5) =       0.000454738801
  error estimate for blocks of size 2^( 6) =       0.000464578171
  error estimate for blocks of size 2^( 7) =       0.000470293208

      target function =                  N/A
              le_mean =     -16.906042354392
             les_mean =     286.151597235268
             stat err =       0.000457982438
             autocorr =       1.289182445429
              std dev =       0.570435612669
             le_variance =       0.325396788201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403358890
  error estimate for blocks of size 2^( 2) =       0.000416416676
  error estimate for blocks of size 2^( 3) =       0.000430016322
  error estimate for blocks of size 2^( 4) =       0.000442319572
  error estimate for blocks of size 2^( 5) =       0.000454738801
  error estimate for blocks of size 2^( 6) =       0.000464578171
  error estimate for blocks of size 2^( 7) =       0.000470293208

      target function =                  N/A
              le_mean =     -16.906042354392
             les_mean =     286.151597235268
             stat err =       0.000457982438
             autocorr =       1.289182445429
              std dev =       0.570435612669
             le_variance =       0.325396788201

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325303487920
                                         uncertainty =       0.002224895477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403358890
  error estimate for blocks of size 2^( 2) =       0.000416416676
  error estimate for blocks of size 2^( 3) =       0.000430016322
  error estimate for blocks of size 2^( 4) =       0.000442319572
  error estimate for blocks of size 2^( 5) =       0.000454738801
  error estimate for blocks of size 2^( 6) =       0.000464578171
  error estimate for blocks of size 2^( 7) =       0.000470293208

      target function =                  N/A
              le_mean =     -16.906042354392
             les_mean =     286.151597235268
             stat err =       0.000457982438
             autocorr =       1.289182445429
              std dev =       0.570435612669
             le_variance =       0.325396788201


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906042354392        initial  <--
     9.5367e+45     9.5367e+46             0.0000e+00       -16.906042354392
     3.8147e+46     3.8147e+47             0.0000e+00       -16.906042354392
     1.5259e+47     1.5259e+48             0.0000e+00       -16.906042354392

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9762
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8503
    reference variance = 0.235676
====================================================
  Execution time = 2.1462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4156e-01
  Total weights = 1.951486987e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324440132928
                                         uncertainty =       0.002698556683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324440132928
                                         uncertainty =       0.002698556683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402707039
  error estimate for blocks of size 2^( 2) =       0.000415878388
  error estimate for blocks of size 2^( 3) =       0.000429175695
  error estimate for blocks of size 2^( 4) =       0.000441096396
  error estimate for blocks of size 2^( 5) =       0.000451095588
  error estimate for blocks of size 2^( 6) =       0.000460162294
  error estimate for blocks of size 2^( 7) =       0.000464705007

      target function =                  N/A
              le_mean =     -16.906282197181
             les_mean =     286.163937154836
             stat err =       0.000454264821
             autocorr =       1.272447199934
              std dev =       0.569513756103
             le_variance =       0.324345918391


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628219718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+46, overlap shift 9.5367e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+47, overlap shift 3.8147e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+48, overlap shift 1.5259e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282197178       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.125045 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7648e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.989
    reference variance = 0.230876
====================================================
  Execution time = 2.1577e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3467e-01
  Total weights = 1.9517e+06
  Execution time = 1.8856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400815197
  error estimate for blocks of size 2^( 2) =       0.000413996010
  error estimate for blocks of size 2^( 3) =       0.000427083034
  error estimate for blocks of size 2^( 4) =       0.000439212063
  error estimate for blocks of size 2^( 5) =       0.000450357800
  error estimate for blocks of size 2^( 6) =       0.000459378597
  error estimate for blocks of size 2^( 7) =       0.000463701472

      target function =                  N/A
              le_mean =     -16.906183051263
             les_mean =     286.153692357212
             stat err =       0.000453162483
             autocorr =       1.278260993059
              std dev =       0.566838287495
             le_variance =       0.321305644170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400815197
  error estimate for blocks of size 2^( 2) =       0.000413996010
  error estimate for blocks of size 2^( 3) =       0.000427083034
  error estimate for blocks of size 2^( 4) =       0.000439212063
  error estimate for blocks of size 2^( 5) =       0.000450357800
  error estimate for blocks of size 2^( 6) =       0.000459378597
  error estimate for blocks of size 2^( 7) =       0.000463701472

      target function =                  N/A
              le_mean =     -16.906183051263
             les_mean =     286.153692357212
             stat err =       0.000453162483
             autocorr =       1.278260993059
              std dev =       0.566838287495
             le_variance =       0.321305644170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400815197
  error estimate for blocks of size 2^( 2) =       0.000413996010
  error estimate for blocks of size 2^( 3) =       0.000427083034
  error estimate for blocks of size 2^( 4) =       0.000439212063
  error estimate for blocks of size 2^( 5) =       0.000450357800
  error estimate for blocks of size 2^( 6) =       0.000459378597
  error estimate for blocks of size 2^( 7) =       0.000463701472

      target function =                  N/A
              le_mean =     -16.906183051263
             les_mean =     286.153692357212
             stat err =       0.000453162483
             autocorr =       1.278260993059
              std dev =       0.566838287495
             le_variance =       0.321305644170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321275765815
                                         uncertainty =       0.001935168925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400815197
  error estimate for blocks of size 2^( 2) =       0.000413996010
  error estimate for blocks of size 2^( 3) =       0.000427083034
  error estimate for blocks of size 2^( 4) =       0.000439212063
  error estimate for blocks of size 2^( 5) =       0.000450357800
  error estimate for blocks of size 2^( 6) =       0.000459378597
  error estimate for blocks of size 2^( 7) =       0.000463701472

      target function =                  N/A
              le_mean =     -16.906183051263
             les_mean =     286.153692357212
             stat err =       0.000453162483
             autocorr =       1.278260993059
              std dev =       0.566838287495
             le_variance =       0.321305644170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906183051263        initial  <--
     9.5367e+46     9.5367e+47             0.0000e+00       -16.906183051263
     3.8147e+47     3.8147e+48             0.0000e+00       -16.906183051263
     1.5259e+48     1.5259e+49             0.0000e+00       -16.906183051263

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1593
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.9611
    reference variance = 0.210302
====================================================
  Execution time = 2.1649e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3741e-01
  Total weights = 1.951593102e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1527e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324633827073
                                         uncertainty =       0.002921514938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324633827073
                                         uncertainty =       0.002921514938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402898012
  error estimate for blocks of size 2^( 2) =       0.000415527970
  error estimate for blocks of size 2^( 3) =       0.000428464119
  error estimate for blocks of size 2^( 4) =       0.000441345770
  error estimate for blocks of size 2^( 5) =       0.000451167730
  error estimate for blocks of size 2^( 6) =       0.000458739364
  error estimate for blocks of size 2^( 7) =       0.000463047362

      target function =                  N/A
              le_mean =     -16.905689905042
             les_mean =     286.139756258207
             stat err =       0.000453575056
             autocorr =       1.267383584187
              std dev =       0.569783832734
             le_variance =       0.324653616045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568990504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+47, overlap shift 9.5367e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689905003       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689905003       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689905003       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+47 is 4.875364e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+48, overlap shift 3.8147e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689905003       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689905003       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689905003       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+48 is 1.218841e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+49, overlap shift 1.5259e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689905003       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689905003       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689905003       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+49 is 3.047102e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.126473 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7807e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.8791
    reference variance = 0.255342
====================================================
  Execution time = 2.1213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3514e-01
  Total weights = 1.9518e+06
  Execution time = 1.9297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402761012
  error estimate for blocks of size 2^( 2) =       0.000415656779
  error estimate for blocks of size 2^( 3) =       0.000429350861
  error estimate for blocks of size 2^( 4) =       0.000441417178
  error estimate for blocks of size 2^( 5) =       0.000452363451
  error estimate for blocks of size 2^( 6) =       0.000460923170
  error estimate for blocks of size 2^( 7) =       0.000466356050

      target function =                  N/A
              le_mean =     -16.905697243378
             les_mean =     286.137740913635
             stat err =       0.000455264962
             autocorr =       1.277713869405
              std dev =       0.569590085500
             le_variance =       0.324432865500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402761012
  error estimate for blocks of size 2^( 2) =       0.000415656779
  error estimate for blocks of size 2^( 3) =       0.000429350861
  error estimate for blocks of size 2^( 4) =       0.000441417178
  error estimate for blocks of size 2^( 5) =       0.000452363451
  error estimate for blocks of size 2^( 6) =       0.000460923170
  error estimate for blocks of size 2^( 7) =       0.000466356050

      target function =                  N/A
              le_mean =     -16.905697243378
             les_mean =     286.137740913635
             stat err =       0.000455264962
             autocorr =       1.277713869405
              std dev =       0.569590085500
             le_variance =       0.324432865500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402761012
  error estimate for blocks of size 2^( 2) =       0.000415656779
  error estimate for blocks of size 2^( 3) =       0.000429350861
  error estimate for blocks of size 2^( 4) =       0.000441417178
  error estimate for blocks of size 2^( 5) =       0.000452363451
  error estimate for blocks of size 2^( 6) =       0.000460923170
  error estimate for blocks of size 2^( 7) =       0.000466356050

      target function =                  N/A
              le_mean =     -16.905697243378
             les_mean =     286.137740913635
             stat err =       0.000455264962
             autocorr =       1.277713869405
              std dev =       0.569590085500
             le_variance =       0.324432865500

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324498377149
                                         uncertainty =       0.002291801372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402761012
  error estimate for blocks of size 2^( 2) =       0.000415656779
  error estimate for blocks of size 2^( 3) =       0.000429350861
  error estimate for blocks of size 2^( 4) =       0.000441417178
  error estimate for blocks of size 2^( 5) =       0.000452363451
  error estimate for blocks of size 2^( 6) =       0.000460923170
  error estimate for blocks of size 2^( 7) =       0.000466356050

      target function =                  N/A
              le_mean =     -16.905697243378
             les_mean =     286.137740913635
             stat err =       0.000455264962
             autocorr =       1.277713869405
              std dev =       0.569590085500
             le_variance =       0.324432865500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905697243378        initial  <--
     9.5367e+47     9.5367e+48             4.8754e-52       -16.905697243378
     3.8147e+48     3.8147e+49             1.2188e-52       -16.905697243378
     1.5259e+49     1.5259e+50             3.0471e-53       -16.905697243378

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.5593
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2373e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9296
    reference variance = 0.376413
====================================================
  Execution time = 2.1433e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3772e-01
  Total weights = 1.951676610e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323919649852
                                         uncertainty =       0.002473881680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323919649852
                                         uncertainty =       0.002473881680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402439854
  error estimate for blocks of size 2^( 2) =       0.000415537650
  error estimate for blocks of size 2^( 3) =       0.000428347573
  error estimate for blocks of size 2^( 4) =       0.000439928430
  error estimate for blocks of size 2^( 5) =       0.000449170790
  error estimate for blocks of size 2^( 6) =       0.000455795097
  error estimate for blocks of size 2^( 7) =       0.000461489927

      target function =                  N/A
              le_mean =     -16.906122325483
             les_mean =     286.154696888308
             stat err =       0.000451596061
             autocorr =       1.259210469858
              std dev =       0.569135898995
             le_variance =       0.323915671525


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612232548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+48, overlap shift 9.5367e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+49, overlap shift 3.8147e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+50, overlap shift 1.5259e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906122325479       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.127646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7511e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.9613
    reference variance = 0.24685
====================================================
  Execution time = 2.1289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4034e-01
  Total weights = 1.9515e+06
  Execution time = 1.9016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403975525
  error estimate for blocks of size 2^( 2) =       0.000416988744
  error estimate for blocks of size 2^( 3) =       0.000430421558
  error estimate for blocks of size 2^( 4) =       0.000443391407
  error estimate for blocks of size 2^( 5) =       0.000455153654
  error estimate for blocks of size 2^( 6) =       0.000464879734
  error estimate for blocks of size 2^( 7) =       0.000470598596

      target function =                  N/A
              le_mean =     -16.905908632926
             les_mean =     286.150086092787
             stat err =       0.000458505848
             autocorr =       1.288189190603
              std dev =       0.571307665667
             le_variance =       0.326392448850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403975525
  error estimate for blocks of size 2^( 2) =       0.000416988744
  error estimate for blocks of size 2^( 3) =       0.000430421558
  error estimate for blocks of size 2^( 4) =       0.000443391407
  error estimate for blocks of size 2^( 5) =       0.000455153654
  error estimate for blocks of size 2^( 6) =       0.000464879734
  error estimate for blocks of size 2^( 7) =       0.000470598596

      target function =                  N/A
              le_mean =     -16.905908632926
             les_mean =     286.150086092787
             stat err =       0.000458505848
             autocorr =       1.288189190603
              std dev =       0.571307665667
             le_variance =       0.326392448850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403975525
  error estimate for blocks of size 2^( 2) =       0.000416988744
  error estimate for blocks of size 2^( 3) =       0.000430421558
  error estimate for blocks of size 2^( 4) =       0.000443391407
  error estimate for blocks of size 2^( 5) =       0.000455153654
  error estimate for blocks of size 2^( 6) =       0.000464879734
  error estimate for blocks of size 2^( 7) =       0.000470598596

      target function =                  N/A
              le_mean =     -16.905908632926
             les_mean =     286.150086092787
             stat err =       0.000458505848
             autocorr =       1.288189190603
              std dev =       0.571307665667
             le_variance =       0.326392448850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326462985791
                                         uncertainty =       0.002698213457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403975525
  error estimate for blocks of size 2^( 2) =       0.000416988744
  error estimate for blocks of size 2^( 3) =       0.000430421558
  error estimate for blocks of size 2^( 4) =       0.000443391407
  error estimate for blocks of size 2^( 5) =       0.000455153654
  error estimate for blocks of size 2^( 6) =       0.000464879734
  error estimate for blocks of size 2^( 7) =       0.000470598596

      target function =                  N/A
              le_mean =     -16.905908632926
             les_mean =     286.150086092787
             stat err =       0.000458505848
             autocorr =       1.288189190603
              std dev =       0.571307665667
             le_variance =       0.326392448850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905908632926        initial  <--
     9.5367e+48     9.5367e+49             0.0000e+00       -16.905908632926
     3.8147e+49     3.8147e+50             0.0000e+00       -16.905908632926
     1.5259e+50     1.5259e+51             0.0000e+00       -16.905908632926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9334
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9762
    reference variance = 0.286939
====================================================
  Execution time = 2.1600e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5240e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4045e-01
  Total weights = 1.951537047e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327709848737
                                         uncertainty =       0.003345949535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327709848737
                                         uncertainty =       0.003345949535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404757370
  error estimate for blocks of size 2^( 2) =       0.000417915900
  error estimate for blocks of size 2^( 3) =       0.000431368852
  error estimate for blocks of size 2^( 4) =       0.000443757090
  error estimate for blocks of size 2^( 5) =       0.000455257629
  error estimate for blocks of size 2^( 6) =       0.000466785569
  error estimate for blocks of size 2^( 7) =       0.000474780980

      target function =                  N/A
              le_mean =     -16.906289523073
             les_mean =     286.163070686086
             stat err =       0.000460145317
             autocorr =       1.292410510852
              std dev =       0.572413362720
             le_variance =       0.327657057821


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628952307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+49, overlap shift 9.5367e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+50, overlap shift 3.8147e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+51, overlap shift 1.5259e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289523083       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.128839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7708e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.8237
    reference variance = 0.278137
====================================================
  Execution time = 2.1145e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3758e-01
  Total weights = 1.9515e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402403002
  error estimate for blocks of size 2^( 2) =       0.000415029186
  error estimate for blocks of size 2^( 3) =       0.000428844327
  error estimate for blocks of size 2^( 4) =       0.000441359726
  error estimate for blocks of size 2^( 5) =       0.000451550322
  error estimate for blocks of size 2^( 6) =       0.000460257996
  error estimate for blocks of size 2^( 7) =       0.000466434792

      target function =                  N/A
              le_mean =     -16.905641445069
             les_mean =     286.138297239275
             stat err =       0.000454900709
             autocorr =       1.277940999063
              std dev =       0.569083782967
             le_variance =       0.323856352036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402403002
  error estimate for blocks of size 2^( 2) =       0.000415029186
  error estimate for blocks of size 2^( 3) =       0.000428844327
  error estimate for blocks of size 2^( 4) =       0.000441359726
  error estimate for blocks of size 2^( 5) =       0.000451550322
  error estimate for blocks of size 2^( 6) =       0.000460257996
  error estimate for blocks of size 2^( 7) =       0.000466434792

      target function =                  N/A
              le_mean =     -16.905641445069
             les_mean =     286.138297239275
             stat err =       0.000454900709
             autocorr =       1.277940999063
              std dev =       0.569083782967
             le_variance =       0.323856352036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402403002
  error estimate for blocks of size 2^( 2) =       0.000415029186
  error estimate for blocks of size 2^( 3) =       0.000428844327
  error estimate for blocks of size 2^( 4) =       0.000441359726
  error estimate for blocks of size 2^( 5) =       0.000451550322
  error estimate for blocks of size 2^( 6) =       0.000460257996
  error estimate for blocks of size 2^( 7) =       0.000466434792

      target function =                  N/A
              le_mean =     -16.905641445069
             les_mean =     286.138297239275
             stat err =       0.000454900709
             autocorr =       1.277940999063
              std dev =       0.569083782967
             le_variance =       0.323856352036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323912883054
                                         uncertainty =       0.002908050391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402403002
  error estimate for blocks of size 2^( 2) =       0.000415029186
  error estimate for blocks of size 2^( 3) =       0.000428844327
  error estimate for blocks of size 2^( 4) =       0.000441359726
  error estimate for blocks of size 2^( 5) =       0.000451550322
  error estimate for blocks of size 2^( 6) =       0.000460257996
  error estimate for blocks of size 2^( 7) =       0.000466434792

      target function =                  N/A
              le_mean =     -16.905641445069
             les_mean =     286.138297239275
             stat err =       0.000454900709
             autocorr =       1.277940999063
              std dev =       0.569083782967
             le_variance =       0.323856352036


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905641445069        initial  <--
     9.5367e+49     9.5367e+50             0.0000e+00       -16.905641445069
     3.8147e+50     3.8147e+51             0.0000e+00       -16.905641445069
     1.5259e+51     1.5259e+52             0.0000e+00       -16.905641445069

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6169
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8282
    reference variance = 0.176453
====================================================
  Execution time = 2.0980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3639e-01
  Total weights = 1.951531982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323361958517
                                         uncertainty =       0.002335433628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323361958517
                                         uncertainty =       0.002335433628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402112707
  error estimate for blocks of size 2^( 2) =       0.000414890927
  error estimate for blocks of size 2^( 3) =       0.000427920190
  error estimate for blocks of size 2^( 4) =       0.000439530541
  error estimate for blocks of size 2^( 5) =       0.000448991313
  error estimate for blocks of size 2^( 6) =       0.000456742742
  error estimate for blocks of size 2^( 7) =       0.000462042318

      target function =                  N/A
              le_mean =     -16.905913552472
             les_mean =     286.146302670805
             stat err =       0.000451826729
             autocorr =       1.262549002562
              std dev =       0.568673243921
             le_variance =       0.323389258352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690591355247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+50, overlap shift 9.5367e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913552450       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913552450       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905913552450       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+50 is 3.384901e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+51, overlap shift 3.8147e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913552450       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913552450       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+51 is 8.462253e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+52, overlap shift 1.5259e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905913552450       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905913552450       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905913552450       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+52 is 2.115563e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.130225 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7097e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9965
    reference variance = 0.231721
====================================================
  Execution time = 2.1262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3857e-01
  Total weights = 1.9517e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400957020
  error estimate for blocks of size 2^( 2) =       0.000413950801
  error estimate for blocks of size 2^( 3) =       0.000427539903
  error estimate for blocks of size 2^( 4) =       0.000439991540
  error estimate for blocks of size 2^( 5) =       0.000451142941
  error estimate for blocks of size 2^( 6) =       0.000461077018
  error estimate for blocks of size 2^( 7) =       0.000463998796

      target function =                  N/A
              le_mean =     -16.905978708197
             les_mean =     286.150686261302
             stat err =       0.000454052574
             autocorr =       1.282379718179
              std dev =       0.567038855610
             le_variance =       0.321533063772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400957020
  error estimate for blocks of size 2^( 2) =       0.000413950801
  error estimate for blocks of size 2^( 3) =       0.000427539903
  error estimate for blocks of size 2^( 4) =       0.000439991540
  error estimate for blocks of size 2^( 5) =       0.000451142941
  error estimate for blocks of size 2^( 6) =       0.000461077018
  error estimate for blocks of size 2^( 7) =       0.000463998796

      target function =                  N/A
              le_mean =     -16.905978708197
             les_mean =     286.150686261302
             stat err =       0.000454052574
             autocorr =       1.282379718179
              std dev =       0.567038855610
             le_variance =       0.321533063772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400957020
  error estimate for blocks of size 2^( 2) =       0.000413950801
  error estimate for blocks of size 2^( 3) =       0.000427539903
  error estimate for blocks of size 2^( 4) =       0.000439991540
  error estimate for blocks of size 2^( 5) =       0.000451142941
  error estimate for blocks of size 2^( 6) =       0.000461077018
  error estimate for blocks of size 2^( 7) =       0.000463998796

      target function =                  N/A
              le_mean =     -16.905978708197
             les_mean =     286.150686261302
             stat err =       0.000454052574
             autocorr =       1.282379718179
              std dev =       0.567038855610
             le_variance =       0.321533063772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321563006694
                                         uncertainty =       0.002234052082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400957020
  error estimate for blocks of size 2^( 2) =       0.000413950801
  error estimate for blocks of size 2^( 3) =       0.000427539903
  error estimate for blocks of size 2^( 4) =       0.000439991540
  error estimate for blocks of size 2^( 5) =       0.000451142941
  error estimate for blocks of size 2^( 6) =       0.000461077018
  error estimate for blocks of size 2^( 7) =       0.000463998796

      target function =                  N/A
              le_mean =     -16.905978708197
             les_mean =     286.150686261302
             stat err =       0.000454052574
             autocorr =       1.282379718179
              std dev =       0.567038855610
             le_variance =       0.321533063772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905978708197        initial  <--
     9.5367e+50     9.5367e+51             3.3849e-55       -16.905978708197
     3.8147e+51     3.8147e+52             8.4623e-56       -16.905978708197
     1.5259e+52     1.5259e+53             2.1156e-56       -16.905978708197

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7172
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.8882
    reference variance = 0.242581
====================================================
  Execution time = 2.1000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3272e-01
  Total weights = 1.952090256e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321403602308
                                         uncertainty =       0.002452222758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321403602308
                                         uncertainty =       0.002452222758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400821063
  error estimate for blocks of size 2^( 2) =       0.000413566421
  error estimate for blocks of size 2^( 3) =       0.000426833255
  error estimate for blocks of size 2^( 4) =       0.000438689265
  error estimate for blocks of size 2^( 5) =       0.000449433876
  error estimate for blocks of size 2^( 6) =       0.000458553058
  error estimate for blocks of size 2^( 7) =       0.000463356185

      target function =                  N/A
              le_mean =     -16.906136339546
             les_mean =     286.150161689357
             stat err =       0.000452508096
             autocorr =       1.274534619123
              std dev =       0.566846583379
             le_variance =       0.321315049089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613633955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+51, overlap shift 9.5367e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+52, overlap shift 3.8147e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+53, overlap shift 1.5259e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136339567       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.131343 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7128e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.154301
====================================================
  Execution time = 2.1394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3670e-01
  Total weights = 1.9517e+06
  Execution time = 1.8634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813804
  error estimate for blocks of size 2^( 2) =       0.000415043350
  error estimate for blocks of size 2^( 3) =       0.000428037069
  error estimate for blocks of size 2^( 4) =       0.000438950085
  error estimate for blocks of size 2^( 5) =       0.000448900817
  error estimate for blocks of size 2^( 6) =       0.000455302993
  error estimate for blocks of size 2^( 7) =       0.000460881018

      target function =                  N/A
              le_mean =     -16.906677415852
             les_mean =     286.172438528167
             stat err =       0.000451008728
             autocorr =       1.253606404935
              std dev =       0.569664745266
             le_variance =       0.324517921999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813804
  error estimate for blocks of size 2^( 2) =       0.000415043350
  error estimate for blocks of size 2^( 3) =       0.000428037069
  error estimate for blocks of size 2^( 4) =       0.000438950085
  error estimate for blocks of size 2^( 5) =       0.000448900817
  error estimate for blocks of size 2^( 6) =       0.000455302993
  error estimate for blocks of size 2^( 7) =       0.000460881018

      target function =                  N/A
              le_mean =     -16.906677415852
             les_mean =     286.172438528167
             stat err =       0.000451008728
             autocorr =       1.253606404935
              std dev =       0.569664745266
             le_variance =       0.324517921999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813804
  error estimate for blocks of size 2^( 2) =       0.000415043350
  error estimate for blocks of size 2^( 3) =       0.000428037069
  error estimate for blocks of size 2^( 4) =       0.000438950085
  error estimate for blocks of size 2^( 5) =       0.000448900817
  error estimate for blocks of size 2^( 6) =       0.000455302993
  error estimate for blocks of size 2^( 7) =       0.000460881018

      target function =                  N/A
              le_mean =     -16.906677415852
             les_mean =     286.172438528167
             stat err =       0.000451008728
             autocorr =       1.253606404935
              std dev =       0.569664745266
             le_variance =       0.324517921999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324501385010
                                         uncertainty =       0.002295261450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402813804
  error estimate for blocks of size 2^( 2) =       0.000415043350
  error estimate for blocks of size 2^( 3) =       0.000428037069
  error estimate for blocks of size 2^( 4) =       0.000438950085
  error estimate for blocks of size 2^( 5) =       0.000448900817
  error estimate for blocks of size 2^( 6) =       0.000455302993
  error estimate for blocks of size 2^( 7) =       0.000460881018

      target function =                  N/A
              le_mean =     -16.906677415852
             les_mean =     286.172438528167
             stat err =       0.000451008728
             autocorr =       1.253606404935
              std dev =       0.569664745266
             le_variance =       0.324517921999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906677415852        initial  <--
     9.5367e+51     9.5367e+52             0.0000e+00       -16.906677415852
     3.8147e+52     3.8147e+53             0.0000e+00       -16.906677415852
     1.5259e+53     1.5259e+54             0.0000e+00       -16.906677415852

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8130
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.8237
    reference variance = 0.485819
====================================================
  Execution time = 2.1140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3705e-01
  Total weights = 1.951740136e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321212079356
                                         uncertainty =       0.002450986027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321212079356
                                         uncertainty =       0.002450986027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400795805
  error estimate for blocks of size 2^( 2) =       0.000414052081
  error estimate for blocks of size 2^( 3) =       0.000427555698
  error estimate for blocks of size 2^( 4) =       0.000439982684
  error estimate for blocks of size 2^( 5) =       0.000451793754
  error estimate for blocks of size 2^( 6) =       0.000462020238
  error estimate for blocks of size 2^( 7) =       0.000468736389

      target function =                  N/A
              le_mean =     -16.905264859850
             les_mean =     286.125030023625
             stat err =       0.000455633266
             autocorr =       1.292362998594
              std dev =       0.566810863248
             le_variance =       0.321274554696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690526485985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+52, overlap shift 9.5367e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905264859859       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905264859859       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+52 is 5.379735e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+53, overlap shift 3.8147e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905264859859       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905264859859       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905264859859       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+53 is 1.393513e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+54, overlap shift 1.5259e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905264859859       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905264859859       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905264859859       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+54 is 3.483783e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.132688 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7286e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.983
    reference variance = 0.243027
====================================================
  Execution time = 2.1092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3435e-01
  Total weights = 1.9516e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402386277
  error estimate for blocks of size 2^( 2) =       0.000415489159
  error estimate for blocks of size 2^( 3) =       0.000429106806
  error estimate for blocks of size 2^( 4) =       0.000441244614
  error estimate for blocks of size 2^( 5) =       0.000450255948
  error estimate for blocks of size 2^( 6) =       0.000457627047
  error estimate for blocks of size 2^( 7) =       0.000460516773

      target function =                  N/A
              le_mean =     -16.905514616916
             les_mean =     286.130770799346
             stat err =       0.000452411095
             autocorr =       1.264096336993
              std dev =       0.569060130206
             le_variance =       0.323829431790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402386277
  error estimate for blocks of size 2^( 2) =       0.000415489159
  error estimate for blocks of size 2^( 3) =       0.000429106806
  error estimate for blocks of size 2^( 4) =       0.000441244614
  error estimate for blocks of size 2^( 5) =       0.000450255948
  error estimate for blocks of size 2^( 6) =       0.000457627047
  error estimate for blocks of size 2^( 7) =       0.000460516773

      target function =                  N/A
              le_mean =     -16.905514616916
             les_mean =     286.130770799346
             stat err =       0.000452411095
             autocorr =       1.264096336993
              std dev =       0.569060130206
             le_variance =       0.323829431790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402386277
  error estimate for blocks of size 2^( 2) =       0.000415489159
  error estimate for blocks of size 2^( 3) =       0.000429106806
  error estimate for blocks of size 2^( 4) =       0.000441244614
  error estimate for blocks of size 2^( 5) =       0.000450255948
  error estimate for blocks of size 2^( 6) =       0.000457627047
  error estimate for blocks of size 2^( 7) =       0.000460516773

      target function =                  N/A
              le_mean =     -16.905514616916
             les_mean =     286.130770799346
             stat err =       0.000452411095
             autocorr =       1.264096336993
              std dev =       0.569060130206
             le_variance =       0.323829431790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323899206268
                                         uncertainty =       0.002815951806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402386277
  error estimate for blocks of size 2^( 2) =       0.000415489159
  error estimate for blocks of size 2^( 3) =       0.000429106806
  error estimate for blocks of size 2^( 4) =       0.000441244614
  error estimate for blocks of size 2^( 5) =       0.000450255948
  error estimate for blocks of size 2^( 6) =       0.000457627047
  error estimate for blocks of size 2^( 7) =       0.000460516773

      target function =                  N/A
              le_mean =     -16.905514616916
             les_mean =     286.130770799346
             stat err =       0.000452411095
             autocorr =       1.264096336993
              std dev =       0.569060130206
             le_variance =       0.323829431790


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905514616916        initial  <--
     9.5367e+52     9.5367e+53             5.3797e-57       -16.905514616916
     3.8147e+53     3.8147e+54             1.3935e-57       -16.905514616916
     1.5259e+54     1.5259e+55             3.4838e-58       -16.905514616916

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5116
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.354845
====================================================
  Execution time = 2.3060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3620e-01
  Total weights = 1.951614069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323715960033
                                         uncertainty =       0.002582165922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323715960033
                                         uncertainty =       0.002582165922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402323372
  error estimate for blocks of size 2^( 2) =       0.000415311479
  error estimate for blocks of size 2^( 3) =       0.000428270921
  error estimate for blocks of size 2^( 4) =       0.000440634717
  error estimate for blocks of size 2^( 5) =       0.000451128277
  error estimate for blocks of size 2^( 6) =       0.000458295549
  error estimate for blocks of size 2^( 7) =       0.000466536571

      target function =                  N/A
              le_mean =     -16.906027180694
             les_mean =     286.149955475700
             stat err =       0.000454148779
             autocorr =       1.274223983442
              std dev =       0.568971169716
             le_variance =       0.323728191969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602718069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+53, overlap shift 9.5367e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027180656       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027180656       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+53 is 4.816617e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+54, overlap shift 3.8147e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027180656       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027180656       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+54 is 1.204154e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+55, overlap shift 1.5259e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027180656       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027180656       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+55 is 3.010385e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.133830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9150e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.9487
    reference variance = 0.192047
====================================================
  Execution time = 2.0970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2913e-01
  Total weights = 1.9517e+06
  Execution time = 1.8668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399018360
  error estimate for blocks of size 2^( 2) =       0.000412477650
  error estimate for blocks of size 2^( 3) =       0.000426129042
  error estimate for blocks of size 2^( 4) =       0.000438875496
  error estimate for blocks of size 2^( 5) =       0.000449727598
  error estimate for blocks of size 2^( 6) =       0.000459457035
  error estimate for blocks of size 2^( 7) =       0.000461991879

      target function =                  N/A
              le_mean =     -16.905887940420
             les_mean =     286.138178536307
             stat err =       0.000452513002
             autocorr =       1.286104817404
              std dev =       0.564297176884
             le_variance =       0.318431303839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399018360
  error estimate for blocks of size 2^( 2) =       0.000412477650
  error estimate for blocks of size 2^( 3) =       0.000426129042
  error estimate for blocks of size 2^( 4) =       0.000438875496
  error estimate for blocks of size 2^( 5) =       0.000449727598
  error estimate for blocks of size 2^( 6) =       0.000459457035
  error estimate for blocks of size 2^( 7) =       0.000461991879

      target function =                  N/A
              le_mean =     -16.905887940420
             les_mean =     286.138178536307
             stat err =       0.000452513002
             autocorr =       1.286104817404
              std dev =       0.564297176884
             le_variance =       0.318431303839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399018360
  error estimate for blocks of size 2^( 2) =       0.000412477650
  error estimate for blocks of size 2^( 3) =       0.000426129042
  error estimate for blocks of size 2^( 4) =       0.000438875496
  error estimate for blocks of size 2^( 5) =       0.000449727598
  error estimate for blocks of size 2^( 6) =       0.000459457035
  error estimate for blocks of size 2^( 7) =       0.000461991879

      target function =                  N/A
              le_mean =     -16.905887940420
             les_mean =     286.138178536307
             stat err =       0.000452513002
             autocorr =       1.286104817404
              std dev =       0.564297176884
             le_variance =       0.318431303839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318377469499
                                         uncertainty =       0.001704334886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399018360
  error estimate for blocks of size 2^( 2) =       0.000412477650
  error estimate for blocks of size 2^( 3) =       0.000426129042
  error estimate for blocks of size 2^( 4) =       0.000438875496
  error estimate for blocks of size 2^( 5) =       0.000449727598
  error estimate for blocks of size 2^( 6) =       0.000459457035
  error estimate for blocks of size 2^( 7) =       0.000461991879

      target function =                  N/A
              le_mean =     -16.905887940420
             les_mean =     286.138178536307
             stat err =       0.000452513002
             autocorr =       1.286104817404
              std dev =       0.564297176884
             le_variance =       0.318431303839


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905887940420        initial  <--
     9.5367e+53     9.5367e+54             4.8166e-58       -16.905887940420
     3.8147e+54     3.8147e+55             1.2042e-58       -16.905887940420
     1.5259e+55     1.5259e+56             3.0104e-59       -16.905887940420

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4043
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.172304
====================================================
  Execution time = 2.1169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3486e-01
  Total weights = 1.951873179e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323573578301
                                         uncertainty =       0.002617709934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323573578301
                                         uncertainty =       0.002617709934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402189337
  error estimate for blocks of size 2^( 2) =       0.000415438342
  error estimate for blocks of size 2^( 3) =       0.000429162872
  error estimate for blocks of size 2^( 4) =       0.000441486280
  error estimate for blocks of size 2^( 5) =       0.000452744305
  error estimate for blocks of size 2^( 6) =       0.000459311811
  error estimate for blocks of size 2^( 7) =       0.000462481011

      target function =                  N/A
              le_mean =     -16.905988032528
             les_mean =     286.147287283927
             stat err =       0.000454005852
             autocorr =       1.274270995284
              std dev =       0.568781614326
             le_variance =       0.323512524795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598803253e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+54, overlap shift 9.5367e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988032509       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988032509       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+54 is 5.076291e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+55, overlap shift 3.8147e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988032509       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988032509       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+55 is 1.269073e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+56, overlap shift 1.5259e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905988032509       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905988032509       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+56 is 3.172682e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.134959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7280e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8882
    reference variance = 0.19686
====================================================
  Execution time = 2.0863e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4017e-01
  Total weights = 1.9513e+06
  Execution time = 1.8655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403477643
  error estimate for blocks of size 2^( 2) =       0.000415911899
  error estimate for blocks of size 2^( 3) =       0.000429058907
  error estimate for blocks of size 2^( 4) =       0.000441674649
  error estimate for blocks of size 2^( 5) =       0.000452129235
  error estimate for blocks of size 2^( 6) =       0.000460012879
  error estimate for blocks of size 2^( 7) =       0.000466189027

      target function =                  N/A
              le_mean =     -16.905881544566
             les_mean =     286.148999479587
             stat err =       0.000455001448
             autocorr =       1.271705668163
              std dev =       0.570603554555
             le_variance =       0.325588416471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403477643
  error estimate for blocks of size 2^( 2) =       0.000415911899
  error estimate for blocks of size 2^( 3) =       0.000429058907
  error estimate for blocks of size 2^( 4) =       0.000441674649
  error estimate for blocks of size 2^( 5) =       0.000452129235
  error estimate for blocks of size 2^( 6) =       0.000460012879
  error estimate for blocks of size 2^( 7) =       0.000466189027

      target function =                  N/A
              le_mean =     -16.905881544566
             les_mean =     286.148999479587
             stat err =       0.000455001448
             autocorr =       1.271705668163
              std dev =       0.570603554555
             le_variance =       0.325588416471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403477643
  error estimate for blocks of size 2^( 2) =       0.000415911899
  error estimate for blocks of size 2^( 3) =       0.000429058907
  error estimate for blocks of size 2^( 4) =       0.000441674649
  error estimate for blocks of size 2^( 5) =       0.000452129235
  error estimate for blocks of size 2^( 6) =       0.000460012879
  error estimate for blocks of size 2^( 7) =       0.000466189027

      target function =                  N/A
              le_mean =     -16.905881544566
             les_mean =     286.148999479587
             stat err =       0.000455001448
             autocorr =       1.271705668163
              std dev =       0.570603554555
             le_variance =       0.325588416471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325565411099
                                         uncertainty =       0.002365374103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403477643
  error estimate for blocks of size 2^( 2) =       0.000415911899
  error estimate for blocks of size 2^( 3) =       0.000429058907
  error estimate for blocks of size 2^( 4) =       0.000441674649
  error estimate for blocks of size 2^( 5) =       0.000452129235
  error estimate for blocks of size 2^( 6) =       0.000460012879
  error estimate for blocks of size 2^( 7) =       0.000466189027

      target function =                  N/A
              le_mean =     -16.905881544566
             les_mean =     286.148999479587
             stat err =       0.000455001448
             autocorr =       1.271705668163
              std dev =       0.570603554555
             le_variance =       0.325588416471


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905881544566        initial  <--
     9.5367e+54     9.5367e+55             5.0763e-59       -16.905881544566
     3.8147e+55     3.8147e+56             1.2691e-59       -16.905881544566
     1.5259e+56     1.5259e+57             3.1727e-60       -16.905881544566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2868
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7573e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9275
    reference variance = 0.371336
====================================================
  Execution time = 2.0970e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3748e-01
  Total weights = 1.952110652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326704494026
                                         uncertainty =       0.003226082842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326704494026
                                         uncertainty =       0.003226082842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404165368
  error estimate for blocks of size 2^( 2) =       0.000416793588
  error estimate for blocks of size 2^( 3) =       0.000429599835
  error estimate for blocks of size 2^( 4) =       0.000442237901
  error estimate for blocks of size 2^( 5) =       0.000451959796
  error estimate for blocks of size 2^( 6) =       0.000457404061
  error estimate for blocks of size 2^( 7) =       0.000462694612

      target function =                  N/A
              le_mean =     -16.906186206976
             les_mean =     286.156610699699
             stat err =       0.000453574092
             autocorr =       1.259442332404
              std dev =       0.571576144635
             le_variance =       0.326699289116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618620698e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+55, overlap shift 9.5367e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+56, overlap shift 3.8147e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+57, overlap shift 1.5259e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906186206948       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.136146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7069e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8765
    reference variance = 0.217153
====================================================
  Execution time = 2.1296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3933e-01
  Total weights = 1.9515e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403620733
  error estimate for blocks of size 2^( 2) =       0.000416993231
  error estimate for blocks of size 2^( 3) =       0.000430209412
  error estimate for blocks of size 2^( 4) =       0.000443653213
  error estimate for blocks of size 2^( 5) =       0.000454985948
  error estimate for blocks of size 2^( 6) =       0.000463151397
  error estimate for blocks of size 2^( 7) =       0.000468774302

      target function =                  N/A
              le_mean =     -16.905263095280
             les_mean =     286.127250003726
             stat err =       0.000457641215
             autocorr =       1.285592490209
              std dev =       0.570805914302
             le_variance =       0.325819391803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403620733
  error estimate for blocks of size 2^( 2) =       0.000416993231
  error estimate for blocks of size 2^( 3) =       0.000430209412
  error estimate for blocks of size 2^( 4) =       0.000443653213
  error estimate for blocks of size 2^( 5) =       0.000454985948
  error estimate for blocks of size 2^( 6) =       0.000463151397
  error estimate for blocks of size 2^( 7) =       0.000468774302

      target function =                  N/A
              le_mean =     -16.905263095280
             les_mean =     286.127250003726
             stat err =       0.000457641215
             autocorr =       1.285592490209
              std dev =       0.570805914302
             le_variance =       0.325819391803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403620733
  error estimate for blocks of size 2^( 2) =       0.000416993231
  error estimate for blocks of size 2^( 3) =       0.000430209412
  error estimate for blocks of size 2^( 4) =       0.000443653213
  error estimate for blocks of size 2^( 5) =       0.000454985948
  error estimate for blocks of size 2^( 6) =       0.000463151397
  error estimate for blocks of size 2^( 7) =       0.000468774302

      target function =                  N/A
              le_mean =     -16.905263095280
             les_mean =     286.127250003726
             stat err =       0.000457641215
             autocorr =       1.285592490209
              std dev =       0.570805914302
             le_variance =       0.325819391803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325696934454
                                         uncertainty =       0.002289830858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403620733
  error estimate for blocks of size 2^( 2) =       0.000416993231
  error estimate for blocks of size 2^( 3) =       0.000430209412
  error estimate for blocks of size 2^( 4) =       0.000443653213
  error estimate for blocks of size 2^( 5) =       0.000454985948
  error estimate for blocks of size 2^( 6) =       0.000463151397
  error estimate for blocks of size 2^( 7) =       0.000468774302

      target function =                  N/A
              le_mean =     -16.905263095280
             les_mean =     286.127250003726
             stat err =       0.000457641215
             autocorr =       1.285592490209
              std dev =       0.570805914302
             le_variance =       0.325819391803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905263095280        initial  <--
     9.5367e+55     9.5367e+56             0.0000e+00       -16.905263095280
     3.8147e+56     3.8147e+57             0.0000e+00       -16.905263095280
     1.5259e+57     1.5259e+58             0.0000e+00       -16.905263095280

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7620
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.8381
    reference variance = 0.204596
====================================================
  Execution time = 2.0850e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3204e-01
  Total weights = 1.952040131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320156113361
                                         uncertainty =       0.001859596376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320156113361
                                         uncertainty =       0.001859596376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400050440
  error estimate for blocks of size 2^( 2) =       0.000412797498
  error estimate for blocks of size 2^( 3) =       0.000425933886
  error estimate for blocks of size 2^( 4) =       0.000438118011
  error estimate for blocks of size 2^( 5) =       0.000448149779
  error estimate for blocks of size 2^( 6) =       0.000455819062
  error estimate for blocks of size 2^( 7) =       0.000459765249

      target function =                  N/A
              le_mean =     -16.906239682496
             les_mean =     286.152984151879
             stat err =       0.000450463025
             autocorr =       1.267911071129
              std dev =       0.565756757779
             le_variance =       0.320080708973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623968250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+56, overlap shift 9.5367e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239682496       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239682496       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+56 is 3.329015e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+57, overlap shift 3.8147e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239682496       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239682496       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239682496       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+57 is 1.046249e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+58, overlap shift 1.5259e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239682496       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239682496       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239682496       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+58 is 2.615622e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.137509 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6937e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9745
    reference variance = 0.322879
====================================================
  Execution time = 2.1175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3438e-01
  Total weights = 1.9512e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401555171
  error estimate for blocks of size 2^( 2) =       0.000414557900
  error estimate for blocks of size 2^( 3) =       0.000427599073
  error estimate for blocks of size 2^( 4) =       0.000440586792
  error estimate for blocks of size 2^( 5) =       0.000451411597
  error estimate for blocks of size 2^( 6) =       0.000457611047
  error estimate for blocks of size 2^( 7) =       0.000461995154

      target function =                  N/A
              le_mean =     -16.905897807026
             les_mean =     286.143755732355
             stat err =       0.000452901147
             autocorr =       1.272085772688
              std dev =       0.567884769309
             le_variance =       0.322493111213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401555171
  error estimate for blocks of size 2^( 2) =       0.000414557900
  error estimate for blocks of size 2^( 3) =       0.000427599073
  error estimate for blocks of size 2^( 4) =       0.000440586792
  error estimate for blocks of size 2^( 5) =       0.000451411597
  error estimate for blocks of size 2^( 6) =       0.000457611047
  error estimate for blocks of size 2^( 7) =       0.000461995154

      target function =                  N/A
              le_mean =     -16.905897807026
             les_mean =     286.143755732355
             stat err =       0.000452901147
             autocorr =       1.272085772688
              std dev =       0.567884769309
             le_variance =       0.322493111213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401555171
  error estimate for blocks of size 2^( 2) =       0.000414557900
  error estimate for blocks of size 2^( 3) =       0.000427599073
  error estimate for blocks of size 2^( 4) =       0.000440586792
  error estimate for blocks of size 2^( 5) =       0.000451411597
  error estimate for blocks of size 2^( 6) =       0.000457611047
  error estimate for blocks of size 2^( 7) =       0.000461995154

      target function =                  N/A
              le_mean =     -16.905897807026
             les_mean =     286.143755732355
             stat err =       0.000452901147
             autocorr =       1.272085772688
              std dev =       0.567884769309
             le_variance =       0.322493111213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322515016013
                                         uncertainty =       0.001867134560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401555171
  error estimate for blocks of size 2^( 2) =       0.000414557900
  error estimate for blocks of size 2^( 3) =       0.000427599073
  error estimate for blocks of size 2^( 4) =       0.000440586792
  error estimate for blocks of size 2^( 5) =       0.000451411597
  error estimate for blocks of size 2^( 6) =       0.000457611047
  error estimate for blocks of size 2^( 7) =       0.000461995154

      target function =                  N/A
              le_mean =     -16.905897807026
             les_mean =     286.143755732355
             stat err =       0.000452901147
             autocorr =       1.272085772688
              std dev =       0.567884769309
             le_variance =       0.322493111213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905897807026        initial  <--
     9.5367e+56     9.5367e+57             3.3290e-61       -16.905897807026
     3.8147e+57     3.8147e+58             1.0462e-61       -16.905897807026
     1.5259e+58     1.5259e+59             2.6156e-62       -16.905897807026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6751
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7618e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9316
    reference variance = 0.281728
====================================================
  Execution time = 2.0989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3538e-01
  Total weights = 1.951433268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322842893154
                                         uncertainty =       0.002377426417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322842893154
                                         uncertainty =       0.002377426417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401821836
  error estimate for blocks of size 2^( 2) =       0.000414551304
  error estimate for blocks of size 2^( 3) =       0.000428217796
  error estimate for blocks of size 2^( 4) =       0.000440920728
  error estimate for blocks of size 2^( 5) =       0.000452781343
  error estimate for blocks of size 2^( 6) =       0.000460862178
  error estimate for blocks of size 2^( 7) =       0.000467094841

      target function =                  N/A
              le_mean =     -16.906635761003
             les_mean =     286.169713285233
             stat err =       0.000455414772
             autocorr =       1.284538600773
              std dev =       0.568261890700
             le_variance =       0.322921576421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663576100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+57, overlap shift 9.5367e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+58, overlap shift 3.8147e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+59, overlap shift 1.5259e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635761006       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.138687 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7260e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.936
    reference variance = 0.318951
====================================================
  Execution time = 2.1230e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3460e-01
  Total weights = 1.9518e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401953561
  error estimate for blocks of size 2^( 2) =       0.000415036661
  error estimate for blocks of size 2^( 3) =       0.000428332023
  error estimate for blocks of size 2^( 4) =       0.000441544627
  error estimate for blocks of size 2^( 5) =       0.000453766536
  error estimate for blocks of size 2^( 6) =       0.000462961453
  error estimate for blocks of size 2^( 7) =       0.000470118310

      target function =                  N/A
              le_mean =     -16.906191186168
             les_mean =     286.153896126773
             stat err =       0.000457097731
             autocorr =       1.293202009812
              std dev =       0.568448177306
             le_variance =       0.323133330282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401953561
  error estimate for blocks of size 2^( 2) =       0.000415036661
  error estimate for blocks of size 2^( 3) =       0.000428332023
  error estimate for blocks of size 2^( 4) =       0.000441544627
  error estimate for blocks of size 2^( 5) =       0.000453766536
  error estimate for blocks of size 2^( 6) =       0.000462961453
  error estimate for blocks of size 2^( 7) =       0.000470118310

      target function =                  N/A
              le_mean =     -16.906191186168
             les_mean =     286.153896126773
             stat err =       0.000457097731
             autocorr =       1.293202009812
              std dev =       0.568448177306
             le_variance =       0.323133330282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401953561
  error estimate for blocks of size 2^( 2) =       0.000415036661
  error estimate for blocks of size 2^( 3) =       0.000428332023
  error estimate for blocks of size 2^( 4) =       0.000441544627
  error estimate for blocks of size 2^( 5) =       0.000453766536
  error estimate for blocks of size 2^( 6) =       0.000462961453
  error estimate for blocks of size 2^( 7) =       0.000470118310

      target function =                  N/A
              le_mean =     -16.906191186168
             les_mean =     286.153896126773
             stat err =       0.000457097731
             autocorr =       1.293202009812
              std dev =       0.568448177306
             le_variance =       0.323133330282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323206645762
                                         uncertainty =       0.002695311834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401953561
  error estimate for blocks of size 2^( 2) =       0.000415036661
  error estimate for blocks of size 2^( 3) =       0.000428332023
  error estimate for blocks of size 2^( 4) =       0.000441544627
  error estimate for blocks of size 2^( 5) =       0.000453766536
  error estimate for blocks of size 2^( 6) =       0.000462961453
  error estimate for blocks of size 2^( 7) =       0.000470118310

      target function =                  N/A
              le_mean =     -16.906191186168
             les_mean =     286.153896126773
             stat err =       0.000457097731
             autocorr =       1.293202009812
              std dev =       0.568448177306
             le_variance =       0.323133330282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906191186168        initial  <--
     9.5367e+57     9.5367e+58             0.0000e+00       -16.906191186168
     3.8147e+58     3.8147e+59             0.0000e+00       -16.906191186168
     1.5259e+59     1.5259e+60             0.0000e+00       -16.906191186168

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6642
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8179
    reference variance = 0.260162
====================================================
  Execution time = 2.4821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4373e-01
  Total weights = 1.951676006e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329270214531
                                         uncertainty =       0.003618524577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329270214531
                                         uncertainty =       0.003618524577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405794108
  error estimate for blocks of size 2^( 2) =       0.000418732322
  error estimate for blocks of size 2^( 3) =       0.000431969475
  error estimate for blocks of size 2^( 4) =       0.000444939714
  error estimate for blocks of size 2^( 5) =       0.000456667900
  error estimate for blocks of size 2^( 6) =       0.000464703685
  error estimate for blocks of size 2^( 7) =       0.000470810721

      target function =                  N/A
              le_mean =     -16.905817070156
             les_mean =     286.150384421358
             stat err =       0.000459280505
             autocorr =       1.280986491801
              std dev =       0.573879530473
             le_variance =       0.329337715495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581707016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+58, overlap shift 9.5367e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817070152       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817070152       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817070152       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+58 is 7.217902e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+59, overlap shift 3.8147e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817070152       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817070152       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817070152       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905817070152       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+59 is 2.177108e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+60, overlap shift 1.5259e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905817070152       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905817070152       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905817070152       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+60 is 4.511189e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.140297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0812e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.296693
====================================================
  Execution time = 2.2187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3693e-01
  Total weights = 1.9519e+06
  Execution time = 1.8582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403304776
  error estimate for blocks of size 2^( 2) =       0.000416254350
  error estimate for blocks of size 2^( 3) =       0.000430020246
  error estimate for blocks of size 2^( 4) =       0.000442716136
  error estimate for blocks of size 2^( 5) =       0.000454582558
  error estimate for blocks of size 2^( 6) =       0.000464251807
  error estimate for blocks of size 2^( 7) =       0.000467781632

      target function =                  N/A
              le_mean =     -16.906468041124
             les_mean =     286.165588009718
             stat err =       0.000457333033
             autocorr =       1.285873993209
              std dev =       0.570359084266
             le_variance =       0.325309485005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403304776
  error estimate for blocks of size 2^( 2) =       0.000416254350
  error estimate for blocks of size 2^( 3) =       0.000430020246
  error estimate for blocks of size 2^( 4) =       0.000442716136
  error estimate for blocks of size 2^( 5) =       0.000454582558
  error estimate for blocks of size 2^( 6) =       0.000464251807
  error estimate for blocks of size 2^( 7) =       0.000467781632

      target function =                  N/A
              le_mean =     -16.906468041124
             les_mean =     286.165588009718
             stat err =       0.000457333033
             autocorr =       1.285873993209
              std dev =       0.570359084266
             le_variance =       0.325309485005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403304776
  error estimate for blocks of size 2^( 2) =       0.000416254350
  error estimate for blocks of size 2^( 3) =       0.000430020246
  error estimate for blocks of size 2^( 4) =       0.000442716136
  error estimate for blocks of size 2^( 5) =       0.000454582558
  error estimate for blocks of size 2^( 6) =       0.000464251807
  error estimate for blocks of size 2^( 7) =       0.000467781632

      target function =                  N/A
              le_mean =     -16.906468041124
             les_mean =     286.165588009718
             stat err =       0.000457333033
             autocorr =       1.285873993209
              std dev =       0.570359084266
             le_variance =       0.325309485005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325305288553
                                         uncertainty =       0.002188814771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403304776
  error estimate for blocks of size 2^( 2) =       0.000416254350
  error estimate for blocks of size 2^( 3) =       0.000430020246
  error estimate for blocks of size 2^( 4) =       0.000442716136
  error estimate for blocks of size 2^( 5) =       0.000454582558
  error estimate for blocks of size 2^( 6) =       0.000464251807
  error estimate for blocks of size 2^( 7) =       0.000467781632

      target function =                  N/A
              le_mean =     -16.906468041124
             les_mean =     286.165588009718
             stat err =       0.000457333033
             autocorr =       1.285873993209
              std dev =       0.570359084266
             le_variance =       0.325309485005


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906468041124        initial  <--
     9.5367e+58     9.5367e+59             7.2179e-63       -16.906468041124
     3.8147e+59     3.8147e+60             2.1771e-63       -16.906468041124
     1.5259e+60     1.5259e+61             4.5112e-64       -16.906468041124

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5831
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.2401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.190981
====================================================
  Execution time = 2.0934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3242e-01
  Total weights = 1.951598323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322336612793
                                         uncertainty =       0.002168226421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322336612793
                                         uncertainty =       0.002168226421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401459492
  error estimate for blocks of size 2^( 2) =       0.000414363901
  error estimate for blocks of size 2^( 3) =       0.000427394926
  error estimate for blocks of size 2^( 4) =       0.000440005515
  error estimate for blocks of size 2^( 5) =       0.000450658836
  error estimate for blocks of size 2^( 6) =       0.000458589177
  error estimate for blocks of size 2^( 7) =       0.000462217723

      target function =                  N/A
              le_mean =     -16.906125591873
             les_mean =     286.149502423202
             stat err =       0.000452867813
             autocorr =       1.272504854984
              std dev =       0.567749458265
             le_variance =       0.322339447361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612559187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+59, overlap shift 9.5367e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125591860       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125591860       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+59 is 4.632518e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+60, overlap shift 3.8147e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125591860       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125591860       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906125591860       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+60 is 1.158129e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+61, overlap shift 1.5259e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906125591860       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906125591860       residual = 5.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+61 is 2.895323e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.141572 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6947e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 0.315963
====================================================
  Execution time = 2.0795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3164e-01
  Total weights = 1.9517e+06
  Execution time = 1.8744e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399428618
  error estimate for blocks of size 2^( 2) =       0.000411986964
  error estimate for blocks of size 2^( 3) =       0.000424598878
  error estimate for blocks of size 2^( 4) =       0.000436118608
  error estimate for blocks of size 2^( 5) =       0.000446386954
  error estimate for blocks of size 2^( 6) =       0.000454019539
  error estimate for blocks of size 2^( 7) =       0.000459387436

      target function =                  N/A
              le_mean =     -16.906278874844
             les_mean =     286.153906475603
             stat err =       0.000448978134
             autocorr =       1.263490633136
              std dev =       0.564877368666
             le_variance =       0.319086441631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399428618
  error estimate for blocks of size 2^( 2) =       0.000411986964
  error estimate for blocks of size 2^( 3) =       0.000424598878
  error estimate for blocks of size 2^( 4) =       0.000436118608
  error estimate for blocks of size 2^( 5) =       0.000446386954
  error estimate for blocks of size 2^( 6) =       0.000454019539
  error estimate for blocks of size 2^( 7) =       0.000459387436

      target function =                  N/A
              le_mean =     -16.906278874844
             les_mean =     286.153906475603
             stat err =       0.000448978134
             autocorr =       1.263490633136
              std dev =       0.564877368666
             le_variance =       0.319086441631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399428618
  error estimate for blocks of size 2^( 2) =       0.000411986964
  error estimate for blocks of size 2^( 3) =       0.000424598878
  error estimate for blocks of size 2^( 4) =       0.000436118608
  error estimate for blocks of size 2^( 5) =       0.000446386954
  error estimate for blocks of size 2^( 6) =       0.000454019539
  error estimate for blocks of size 2^( 7) =       0.000459387436

      target function =                  N/A
              le_mean =     -16.906278874844
             les_mean =     286.153906475603
             stat err =       0.000448978134
             autocorr =       1.263490633136
              std dev =       0.564877368666
             le_variance =       0.319086441631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319184082716
                                         uncertainty =       0.001987871776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399428618
  error estimate for blocks of size 2^( 2) =       0.000411986964
  error estimate for blocks of size 2^( 3) =       0.000424598878
  error estimate for blocks of size 2^( 4) =       0.000436118608
  error estimate for blocks of size 2^( 5) =       0.000446386954
  error estimate for blocks of size 2^( 6) =       0.000454019539
  error estimate for blocks of size 2^( 7) =       0.000459387436

      target function =                  N/A
              le_mean =     -16.906278874844
             les_mean =     286.153906475603
             stat err =       0.000448978134
             autocorr =       1.263490633136
              std dev =       0.564877368666
             le_variance =       0.319086441631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906278874844        initial  <--
     9.5367e+59     9.5367e+60             4.6325e-64       -16.906278874844
     3.8147e+60     3.8147e+61             1.1581e-64       -16.906278874844
     1.5259e+61     1.5259e+62             2.8953e-65       -16.906278874844

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2882
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9065
    reference variance = 0.188675
====================================================
  Execution time = 2.0935e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3838e-01
  Total weights = 1.951713040e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323789493277
                                         uncertainty =       0.002218449187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323789493277
                                         uncertainty =       0.002218449187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402333723
  error estimate for blocks of size 2^( 2) =       0.000415035383
  error estimate for blocks of size 2^( 3) =       0.000428372592
  error estimate for blocks of size 2^( 4) =       0.000440388045
  error estimate for blocks of size 2^( 5) =       0.000449815097
  error estimate for blocks of size 2^( 6) =       0.000456840277
  error estimate for blocks of size 2^( 7) =       0.000461680973

      target function =                  N/A
              le_mean =     -16.906465996147
             les_mean =     286.166969425940
             stat err =       0.000452181098
             autocorr =       1.263141302388
              std dev =       0.568985808038
             le_variance =       0.323744849749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646599615e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+60, overlap shift 9.5367e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+61, overlap shift 3.8147e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+62, overlap shift 1.5259e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906465996134       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.142719 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7027e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.8931
    reference variance = 0.348927
====================================================
  Execution time = 2.0886e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4092e-01
  Total weights = 1.9519e+06
  Execution time = 1.8693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403244906
  error estimate for blocks of size 2^( 2) =       0.000416021570
  error estimate for blocks of size 2^( 3) =       0.000429658034
  error estimate for blocks of size 2^( 4) =       0.000441649034
  error estimate for blocks of size 2^( 5) =       0.000452754957
  error estimate for blocks of size 2^( 6) =       0.000460391269
  error estimate for blocks of size 2^( 7) =       0.000464049732

      target function =                  N/A
              le_mean =     -16.905332244697
             les_mean =     286.131181256755
             stat err =       0.000454711248
             autocorr =       1.271550507125
              std dev =       0.570274414549
             le_variance =       0.325212907889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403244906
  error estimate for blocks of size 2^( 2) =       0.000416021570
  error estimate for blocks of size 2^( 3) =       0.000429658034
  error estimate for blocks of size 2^( 4) =       0.000441649034
  error estimate for blocks of size 2^( 5) =       0.000452754957
  error estimate for blocks of size 2^( 6) =       0.000460391269
  error estimate for blocks of size 2^( 7) =       0.000464049732

      target function =                  N/A
              le_mean =     -16.905332244697
             les_mean =     286.131181256755
             stat err =       0.000454711248
             autocorr =       1.271550507125
              std dev =       0.570274414549
             le_variance =       0.325212907889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403244906
  error estimate for blocks of size 2^( 2) =       0.000416021570
  error estimate for blocks of size 2^( 3) =       0.000429658034
  error estimate for blocks of size 2^( 4) =       0.000441649034
  error estimate for blocks of size 2^( 5) =       0.000452754957
  error estimate for blocks of size 2^( 6) =       0.000460391269
  error estimate for blocks of size 2^( 7) =       0.000464049732

      target function =                  N/A
              le_mean =     -16.905332244697
             les_mean =     286.131181256755
             stat err =       0.000454711248
             autocorr =       1.271550507125
              std dev =       0.570274414549
             le_variance =       0.325212907889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325259372797
                                         uncertainty =       0.002614277198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403244906
  error estimate for blocks of size 2^( 2) =       0.000416021570
  error estimate for blocks of size 2^( 3) =       0.000429658034
  error estimate for blocks of size 2^( 4) =       0.000441649034
  error estimate for blocks of size 2^( 5) =       0.000452754957
  error estimate for blocks of size 2^( 6) =       0.000460391269
  error estimate for blocks of size 2^( 7) =       0.000464049732

      target function =                  N/A
              le_mean =     -16.905332244697
             les_mean =     286.131181256755
             stat err =       0.000454711248
             autocorr =       1.271550507125
              std dev =       0.570274414549
             le_variance =       0.325212907889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905332244697        initial  <--
     9.5367e+60     9.5367e+61             0.0000e+00       -16.905332244697
     3.8147e+61     3.8147e+62             0.0000e+00       -16.905332244697
     1.5259e+62     1.5259e+63             0.0000e+00       -16.905332244697

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3400
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.8538
    reference variance = 0.316872
====================================================
  Execution time = 2.0979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4077e-01
  Total weights = 1.951226052e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325974779151
                                         uncertainty =       0.003134719319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325974779151
                                         uncertainty =       0.003134719319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403702797
  error estimate for blocks of size 2^( 2) =       0.000416347586
  error estimate for blocks of size 2^( 3) =       0.000429130387
  error estimate for blocks of size 2^( 4) =       0.000440837692
  error estimate for blocks of size 2^( 5) =       0.000450988425
  error estimate for blocks of size 2^( 6) =       0.000458073441
  error estimate for blocks of size 2^( 7) =       0.000462625340

      target function =                  N/A
              le_mean =     -16.905975370777
             les_mean =     286.152771811430
             stat err =       0.000453131225
             autocorr =       1.259866310507
              std dev =       0.570921970621
             le_variance =       0.325951896538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597537078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+61, overlap shift 9.5367e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975370788       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975370788       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+61 is 6.622431e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+62, overlap shift 3.8147e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975370788       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975370788       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975370788       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+62 is 1.655608e-66

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+63, overlap shift 1.5259e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905975370788       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905975370788       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+63 is 4.139019e-67

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.144009 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7081e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9084
    reference variance = 0.391769
====================================================
  Execution time = 2.1117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3735e-01
  Total weights = 1.9518e+06
  Execution time = 1.8674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403012357
  error estimate for blocks of size 2^( 2) =       0.000415876592
  error estimate for blocks of size 2^( 3) =       0.000428635486
  error estimate for blocks of size 2^( 4) =       0.000440788356
  error estimate for blocks of size 2^( 5) =       0.000451349390
  error estimate for blocks of size 2^( 6) =       0.000459359262
  error estimate for blocks of size 2^( 7) =       0.000465550530

      target function =                  N/A
              le_mean =     -16.905832331289
             les_mean =     286.144513156344
             stat err =       0.000454261884
             autocorr =       1.270503518195
              std dev =       0.569945540664
             le_variance =       0.324837919323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403012357
  error estimate for blocks of size 2^( 2) =       0.000415876592
  error estimate for blocks of size 2^( 3) =       0.000428635486
  error estimate for blocks of size 2^( 4) =       0.000440788356
  error estimate for blocks of size 2^( 5) =       0.000451349390
  error estimate for blocks of size 2^( 6) =       0.000459359262
  error estimate for blocks of size 2^( 7) =       0.000465550530

      target function =                  N/A
              le_mean =     -16.905832331289
             les_mean =     286.144513156344
             stat err =       0.000454261884
             autocorr =       1.270503518195
              std dev =       0.569945540664
             le_variance =       0.324837919323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403012357
  error estimate for blocks of size 2^( 2) =       0.000415876592
  error estimate for blocks of size 2^( 3) =       0.000428635486
  error estimate for blocks of size 2^( 4) =       0.000440788356
  error estimate for blocks of size 2^( 5) =       0.000451349390
  error estimate for blocks of size 2^( 6) =       0.000459359262
  error estimate for blocks of size 2^( 7) =       0.000465550530

      target function =                  N/A
              le_mean =     -16.905832331289
             les_mean =     286.144513156344
             stat err =       0.000454261884
             autocorr =       1.270503518195
              std dev =       0.569945540664
             le_variance =       0.324837919323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324849886564
                                         uncertainty =       0.002456636293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403012357
  error estimate for blocks of size 2^( 2) =       0.000415876592
  error estimate for blocks of size 2^( 3) =       0.000428635486
  error estimate for blocks of size 2^( 4) =       0.000440788356
  error estimate for blocks of size 2^( 5) =       0.000451349390
  error estimate for blocks of size 2^( 6) =       0.000459359262
  error estimate for blocks of size 2^( 7) =       0.000465550530

      target function =                  N/A
              le_mean =     -16.905832331289
             les_mean =     286.144513156344
             stat err =       0.000454261884
             autocorr =       1.270503518195
              std dev =       0.569945540664
             le_variance =       0.324837919323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905832331289        initial  <--
     9.5367e+61     9.5367e+62             6.6224e-66       -16.905832331289
     3.8147e+62     3.8147e+63             1.6556e-66       -16.905832331289
     1.5259e+63     1.5259e+64             4.1390e-67       -16.905832331289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5605
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.8858
    reference variance = 0.276575
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2851e-01
  Total weights = 1.951651702e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317452677284
                                         uncertainty =       0.002074780199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317452677284
                                         uncertainty =       0.002074780199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398401324
  error estimate for blocks of size 2^( 2) =       0.000411340384
  error estimate for blocks of size 2^( 3) =       0.000424261948
  error estimate for blocks of size 2^( 4) =       0.000436922974
  error estimate for blocks of size 2^( 5) =       0.000445897442
  error estimate for blocks of size 2^( 6) =       0.000451985641
  error estimate for blocks of size 2^( 7) =       0.000456313707

      target function =                  N/A
              le_mean =     -16.906330724620
             les_mean =     286.152524330187
             stat err =       0.000447779941
             autocorr =       1.263245393761
              std dev =       0.563424556107
             le_variance =       0.317447230424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633072462e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+62, overlap shift 9.5367e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+63, overlap shift 3.8147e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+64, overlap shift 1.5259e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330724628       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.145173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7096e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.259323
====================================================
  Execution time = 2.0912e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3598e-01
  Total weights = 1.9517e+06
  Execution time = 1.8631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587065
  error estimate for blocks of size 2^( 2) =       0.000413338679
  error estimate for blocks of size 2^( 3) =       0.000426469375
  error estimate for blocks of size 2^( 4) =       0.000438696662
  error estimate for blocks of size 2^( 5) =       0.000450320325
  error estimate for blocks of size 2^( 6) =       0.000458817390
  error estimate for blocks of size 2^( 7) =       0.000463855103

      target function =                  N/A
              le_mean =     -16.905816352748
             les_mean =     286.142606860062
             stat err =       0.000452922370
             autocorr =       1.278361548065
              std dev =       0.566515660133
             le_variance =       0.320939993176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587065
  error estimate for blocks of size 2^( 2) =       0.000413338679
  error estimate for blocks of size 2^( 3) =       0.000426469375
  error estimate for blocks of size 2^( 4) =       0.000438696662
  error estimate for blocks of size 2^( 5) =       0.000450320325
  error estimate for blocks of size 2^( 6) =       0.000458817390
  error estimate for blocks of size 2^( 7) =       0.000463855103

      target function =                  N/A
              le_mean =     -16.905816352748
             les_mean =     286.142606860062
             stat err =       0.000452922370
             autocorr =       1.278361548065
              std dev =       0.566515660133
             le_variance =       0.320939993176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587065
  error estimate for blocks of size 2^( 2) =       0.000413338679
  error estimate for blocks of size 2^( 3) =       0.000426469375
  error estimate for blocks of size 2^( 4) =       0.000438696662
  error estimate for blocks of size 2^( 5) =       0.000450320325
  error estimate for blocks of size 2^( 6) =       0.000458817390
  error estimate for blocks of size 2^( 7) =       0.000463855103

      target function =                  N/A
              le_mean =     -16.905816352748
             les_mean =     286.142606860062
             stat err =       0.000452922370
             autocorr =       1.278361548065
              std dev =       0.566515660133
             le_variance =       0.320939993176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320815564337
                                         uncertainty =       0.002159095018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400587065
  error estimate for blocks of size 2^( 2) =       0.000413338679
  error estimate for blocks of size 2^( 3) =       0.000426469375
  error estimate for blocks of size 2^( 4) =       0.000438696662
  error estimate for blocks of size 2^( 5) =       0.000450320325
  error estimate for blocks of size 2^( 6) =       0.000458817390
  error estimate for blocks of size 2^( 7) =       0.000463855103

      target function =                  N/A
              le_mean =     -16.905816352748
             les_mean =     286.142606860062
             stat err =       0.000452922370
             autocorr =       1.278361548065
              std dev =       0.566515660133
             le_variance =       0.320939993176


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905816352748        initial  <--
     9.5367e+62     9.5367e+63             0.0000e+00       -16.905816352748
     3.8147e+63     3.8147e+64             0.0000e+00       -16.905816352748
     1.5259e+64     1.5259e+65             0.0000e+00       -16.905816352748

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3348
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8785
    reference variance = 0.3291
====================================================
  Execution time = 2.2884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3309e-01
  Total weights = 1.951888002e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156591937
                                         uncertainty =       0.001937658855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321156591937
                                         uncertainty =       0.001937658855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737012
  error estimate for blocks of size 2^( 2) =       0.000413401982
  error estimate for blocks of size 2^( 3) =       0.000426477014
  error estimate for blocks of size 2^( 4) =       0.000439054724
  error estimate for blocks of size 2^( 5) =       0.000449103541
  error estimate for blocks of size 2^( 6) =       0.000455162150
  error estimate for blocks of size 2^( 7) =       0.000456795885

      target function =                  N/A
              le_mean =     -16.906540577297
             les_mean =     286.164203920089
             stat err =       0.000450029075
             autocorr =       1.261136905818
              std dev =       0.566727717509
             le_variance =       0.321180305793


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690654057730e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+63, overlap shift 9.5367e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+64, overlap shift 3.8147e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+65, overlap shift 1.5259e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906540577312       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.146351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9038e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9858
    reference variance = 0.333146
====================================================
  Execution time = 2.1092e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3177e-01
  Total weights = 1.9516e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400488142
  error estimate for blocks of size 2^( 2) =       0.000413592326
  error estimate for blocks of size 2^( 3) =       0.000426759353
  error estimate for blocks of size 2^( 4) =       0.000439786296
  error estimate for blocks of size 2^( 5) =       0.000450265853
  error estimate for blocks of size 2^( 6) =       0.000457356120
  error estimate for blocks of size 2^( 7) =       0.000462596896

      target function =                  N/A
              le_mean =     -16.905847209460
             les_mean =     286.139436889032
             stat err =       0.000452501291
             autocorr =       1.276616118404
              std dev =       0.566375761281
             le_variance =       0.320781502967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400488142
  error estimate for blocks of size 2^( 2) =       0.000413592326
  error estimate for blocks of size 2^( 3) =       0.000426759353
  error estimate for blocks of size 2^( 4) =       0.000439786296
  error estimate for blocks of size 2^( 5) =       0.000450265853
  error estimate for blocks of size 2^( 6) =       0.000457356120
  error estimate for blocks of size 2^( 7) =       0.000462596896

      target function =                  N/A
              le_mean =     -16.905847209460
             les_mean =     286.139436889032
             stat err =       0.000452501291
             autocorr =       1.276616118404
              std dev =       0.566375761281
             le_variance =       0.320781502967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400488142
  error estimate for blocks of size 2^( 2) =       0.000413592326
  error estimate for blocks of size 2^( 3) =       0.000426759353
  error estimate for blocks of size 2^( 4) =       0.000439786296
  error estimate for blocks of size 2^( 5) =       0.000450265853
  error estimate for blocks of size 2^( 6) =       0.000457356120
  error estimate for blocks of size 2^( 7) =       0.000462596896

      target function =                  N/A
              le_mean =     -16.905847209460
             les_mean =     286.139436889032
             stat err =       0.000452501291
             autocorr =       1.276616118404
              std dev =       0.566375761281
             le_variance =       0.320781502967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320863635088
                                         uncertainty =       0.002005526482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400488142
  error estimate for blocks of size 2^( 2) =       0.000413592326
  error estimate for blocks of size 2^( 3) =       0.000426759353
  error estimate for blocks of size 2^( 4) =       0.000439786296
  error estimate for blocks of size 2^( 5) =       0.000450265853
  error estimate for blocks of size 2^( 6) =       0.000457356120
  error estimate for blocks of size 2^( 7) =       0.000462596896

      target function =                  N/A
              le_mean =     -16.905847209460
             les_mean =     286.139436889032
             stat err =       0.000452501291
             autocorr =       1.276616118404
              std dev =       0.566375761281
             le_variance =       0.320781502967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905847209460        initial  <--
     9.5367e+63     9.5367e+64             0.0000e+00       -16.905847209460
     3.8147e+64     3.8147e+65             0.0000e+00       -16.905847209460
     1.5259e+65     1.5259e+66             0.0000e+00       -16.905847209460

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7493
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9327
    reference variance = 0.194731
====================================================
  Execution time = 2.0979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5218e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3846e-01
  Total weights = 1.951589448e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320433981234
                                         uncertainty =       0.001792582902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320433981234
                                         uncertainty =       0.001792582902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400344592
  error estimate for blocks of size 2^( 2) =       0.000413436373
  error estimate for blocks of size 2^( 3) =       0.000426796826
  error estimate for blocks of size 2^( 4) =       0.000439632714
  error estimate for blocks of size 2^( 5) =       0.000450007923
  error estimate for blocks of size 2^( 6) =       0.000457487789
  error estimate for blocks of size 2^( 7) =       0.000463300712

      target function =                  N/A
              le_mean =     -16.906054083931
             les_mean =     286.153120449639
             stat err =       0.000452607285
             autocorr =       1.278130347728
              std dev =       0.566172751598
             le_variance =       0.320551584652


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605408393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+64, overlap shift 9.5367e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054083917       residual = 7.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054083917       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+64 is 1.050649e-68

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+65, overlap shift 3.8147e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054083917       residual = 7.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054083917       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+65 is 2.626621e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+66, overlap shift 1.5259e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906054083917       residual = 7.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906054083917       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+66 is 6.566553e-70

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.147521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7114e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9179
    reference variance = 0.245571
====================================================
  Execution time = 2.0890e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3628e-01
  Total weights = 1.9519e+06
  Execution time = 1.8707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401051473
  error estimate for blocks of size 2^( 2) =       0.000414172012
  error estimate for blocks of size 2^( 3) =       0.000427395431
  error estimate for blocks of size 2^( 4) =       0.000439865388
  error estimate for blocks of size 2^( 5) =       0.000450653361
  error estimate for blocks of size 2^( 6) =       0.000458501812
  error estimate for blocks of size 2^( 7) =       0.000463003143

      target function =                  N/A
              le_mean =     -16.905586668780
             les_mean =     286.135138806916
             stat err =       0.000453005926
             autocorr =       1.275873257401
              std dev =       0.567172432358
             le_variance =       0.321684568027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401051473
  error estimate for blocks of size 2^( 2) =       0.000414172012
  error estimate for blocks of size 2^( 3) =       0.000427395431
  error estimate for blocks of size 2^( 4) =       0.000439865388
  error estimate for blocks of size 2^( 5) =       0.000450653361
  error estimate for blocks of size 2^( 6) =       0.000458501812
  error estimate for blocks of size 2^( 7) =       0.000463003143

      target function =                  N/A
              le_mean =     -16.905586668780
             les_mean =     286.135138806916
             stat err =       0.000453005926
             autocorr =       1.275873257401
              std dev =       0.567172432358
             le_variance =       0.321684568027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401051473
  error estimate for blocks of size 2^( 2) =       0.000414172012
  error estimate for blocks of size 2^( 3) =       0.000427395431
  error estimate for blocks of size 2^( 4) =       0.000439865388
  error estimate for blocks of size 2^( 5) =       0.000450653361
  error estimate for blocks of size 2^( 6) =       0.000458501812
  error estimate for blocks of size 2^( 7) =       0.000463003143

      target function =                  N/A
              le_mean =     -16.905586668780
             les_mean =     286.135138806916
             stat err =       0.000453005926
             autocorr =       1.275873257401
              std dev =       0.567172432358
             le_variance =       0.321684568027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321712956960
                                         uncertainty =       0.002091869217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401051473
  error estimate for blocks of size 2^( 2) =       0.000414172012
  error estimate for blocks of size 2^( 3) =       0.000427395431
  error estimate for blocks of size 2^( 4) =       0.000439865388
  error estimate for blocks of size 2^( 5) =       0.000450653361
  error estimate for blocks of size 2^( 6) =       0.000458501812
  error estimate for blocks of size 2^( 7) =       0.000463003143

      target function =                  N/A
              le_mean =     -16.905586668780
             les_mean =     286.135138806916
             stat err =       0.000453005926
             autocorr =       1.275873257401
              std dev =       0.567172432358
             le_variance =       0.321684568027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905586668780        initial  <--
     9.5367e+64     9.5367e+65             1.0506e-68       -16.905586668780
     3.8147e+65     3.8147e+66             2.6266e-69       -16.905586668780
     1.5259e+66     1.5259e+67             6.5666e-70       -16.905586668780

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3381
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.919
    reference variance = 0.271503
====================================================
  Execution time = 2.1089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5429e-01
  Total weights = 1.951558440e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335788472021
                                         uncertainty =       0.007839658161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335788472021
                                         uncertainty =       0.007839658161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409673880
  error estimate for blocks of size 2^( 2) =       0.000421961451
  error estimate for blocks of size 2^( 3) =       0.000435900901
  error estimate for blocks of size 2^( 4) =       0.000448831733
  error estimate for blocks of size 2^( 5) =       0.000458989401
  error estimate for blocks of size 2^( 6) =       0.000467360371
  error estimate for blocks of size 2^( 7) =       0.000471255019

      target function =                  N/A
              le_mean =     -16.905798694079
             les_mean =     286.160321544233
             stat err =       0.000461609131
             autocorr =       1.269615543815
              std dev =       0.579366357851
             le_variance =       0.335665376609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690579869408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+65, overlap shift 9.5367e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+66, overlap shift 3.8147e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+67, overlap shift 1.5259e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905798694098       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.148693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7114e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.451882
====================================================
  Execution time = 2.1003e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3580e-01
  Total weights = 1.9516e+06
  Execution time = 1.8885e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896099
  error estimate for blocks of size 2^( 2) =       0.000414948001
  error estimate for blocks of size 2^( 3) =       0.000428619196
  error estimate for blocks of size 2^( 4) =       0.000441468729
  error estimate for blocks of size 2^( 5) =       0.000453013523
  error estimate for blocks of size 2^( 6) =       0.000460835949
  error estimate for blocks of size 2^( 7) =       0.000465621604

      target function =                  N/A
              le_mean =     -16.905958614411
             les_mean =     286.147239583127
             stat err =       0.000455234951
             autocorr =       1.283050102259
              std dev =       0.568366913334
             le_variance =       0.323040948173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896099
  error estimate for blocks of size 2^( 2) =       0.000414948001
  error estimate for blocks of size 2^( 3) =       0.000428619196
  error estimate for blocks of size 2^( 4) =       0.000441468729
  error estimate for blocks of size 2^( 5) =       0.000453013523
  error estimate for blocks of size 2^( 6) =       0.000460835949
  error estimate for blocks of size 2^( 7) =       0.000465621604

      target function =                  N/A
              le_mean =     -16.905958614411
             les_mean =     286.147239583127
             stat err =       0.000455234951
             autocorr =       1.283050102259
              std dev =       0.568366913334
             le_variance =       0.323040948173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896099
  error estimate for blocks of size 2^( 2) =       0.000414948001
  error estimate for blocks of size 2^( 3) =       0.000428619196
  error estimate for blocks of size 2^( 4) =       0.000441468729
  error estimate for blocks of size 2^( 5) =       0.000453013523
  error estimate for blocks of size 2^( 6) =       0.000460835949
  error estimate for blocks of size 2^( 7) =       0.000465621604

      target function =                  N/A
              le_mean =     -16.905958614411
             les_mean =     286.147239583127
             stat err =       0.000455234951
             autocorr =       1.283050102259
              std dev =       0.568366913334
             le_variance =       0.323040948173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322964053320
                                         uncertainty =       0.002054530051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401896099
  error estimate for blocks of size 2^( 2) =       0.000414948001
  error estimate for blocks of size 2^( 3) =       0.000428619196
  error estimate for blocks of size 2^( 4) =       0.000441468729
  error estimate for blocks of size 2^( 5) =       0.000453013523
  error estimate for blocks of size 2^( 6) =       0.000460835949
  error estimate for blocks of size 2^( 7) =       0.000465621604

      target function =                  N/A
              le_mean =     -16.905958614411
             les_mean =     286.147239583127
             stat err =       0.000455234951
             autocorr =       1.283050102259
              std dev =       0.568366913334
             le_variance =       0.323040948173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905958614411        initial  <--
     9.5367e+65     9.5367e+66             0.0000e+00       -16.905958614411
     3.8147e+66     3.8147e+67             0.0000e+00       -16.905958614411
     1.5259e+67     1.5259e+68             0.0000e+00       -16.905958614411

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5117
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7632e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.902
    reference variance = 0.209615
====================================================
  Execution time = 2.1109e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5241e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4137e-01
  Total weights = 1.951896307e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328467615586
                                         uncertainty =       0.002954341285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328467615586
                                         uncertainty =       0.002954341285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405240772
  error estimate for blocks of size 2^( 2) =       0.000418338246
  error estimate for blocks of size 2^( 3) =       0.000431961117
  error estimate for blocks of size 2^( 4) =       0.000444545635
  error estimate for blocks of size 2^( 5) =       0.000456133298
  error estimate for blocks of size 2^( 6) =       0.000463631074
  error estimate for blocks of size 2^( 7) =       0.000469604791

      target function =                  N/A
              le_mean =     -16.906267043116
             les_mean =     286.163238406354
             stat err =       0.000458478699
             autocorr =       1.280006159360
              std dev =       0.573096995363
             le_variance =       0.328440166094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626704312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+66, overlap shift 9.5367e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+67, overlap shift 3.8147e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+68, overlap shift 1.5259e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906267043110       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.149860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7240e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.308864
====================================================
  Execution time = 2.1523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3432e-01
  Total weights = 1.9520e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401562039
  error estimate for blocks of size 2^( 2) =       0.000414198117
  error estimate for blocks of size 2^( 3) =       0.000427351120
  error estimate for blocks of size 2^( 4) =       0.000440308847
  error estimate for blocks of size 2^( 5) =       0.000450882331
  error estimate for blocks of size 2^( 6) =       0.000460150416
  error estimate for blocks of size 2^( 7) =       0.000463052644

      target function =                  N/A
              le_mean =     -16.906737744537
             les_mean =     286.172099580970
             stat err =       0.000453598559
             autocorr =       1.275962855280
              std dev =       0.567894481705
             le_variance =       0.322504142351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401562039
  error estimate for blocks of size 2^( 2) =       0.000414198117
  error estimate for blocks of size 2^( 3) =       0.000427351120
  error estimate for blocks of size 2^( 4) =       0.000440308847
  error estimate for blocks of size 2^( 5) =       0.000450882331
  error estimate for blocks of size 2^( 6) =       0.000460150416
  error estimate for blocks of size 2^( 7) =       0.000463052644

      target function =                  N/A
              le_mean =     -16.906737744537
             les_mean =     286.172099580970
             stat err =       0.000453598559
             autocorr =       1.275962855280
              std dev =       0.567894481705
             le_variance =       0.322504142351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401562039
  error estimate for blocks of size 2^( 2) =       0.000414198117
  error estimate for blocks of size 2^( 3) =       0.000427351120
  error estimate for blocks of size 2^( 4) =       0.000440308847
  error estimate for blocks of size 2^( 5) =       0.000450882331
  error estimate for blocks of size 2^( 6) =       0.000460150416
  error estimate for blocks of size 2^( 7) =       0.000463052644

      target function =                  N/A
              le_mean =     -16.906737744537
             les_mean =     286.172099580970
             stat err =       0.000453598559
             autocorr =       1.275962855280
              std dev =       0.567894481705
             le_variance =       0.322504142351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322513691928
                                         uncertainty =       0.002650629389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401562039
  error estimate for blocks of size 2^( 2) =       0.000414198117
  error estimate for blocks of size 2^( 3) =       0.000427351120
  error estimate for blocks of size 2^( 4) =       0.000440308847
  error estimate for blocks of size 2^( 5) =       0.000450882331
  error estimate for blocks of size 2^( 6) =       0.000460150416
  error estimate for blocks of size 2^( 7) =       0.000463052644

      target function =                  N/A
              le_mean =     -16.906737744537
             les_mean =     286.172099580970
             stat err =       0.000453598559
             autocorr =       1.275962855280
              std dev =       0.567894481705
             le_variance =       0.322504142351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906737744537        initial  <--
     9.5367e+66     9.5367e+67             0.0000e+00       -16.906737744537
     3.8147e+67     3.8147e+68             0.0000e+00       -16.906737744537
     1.5259e+68     1.5259e+69             0.0000e+00       -16.906737744537

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0329
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9285
    reference variance = 0.211149
====================================================
  Execution time = 2.0917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5230e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3660e-01
  Total weights = 1.951775652e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323438258696
                                         uncertainty =       0.002693289990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323438258696
                                         uncertainty =       0.002693289990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402126069
  error estimate for blocks of size 2^( 2) =       0.000415318523
  error estimate for blocks of size 2^( 3) =       0.000428140460
  error estimate for blocks of size 2^( 4) =       0.000440437385
  error estimate for blocks of size 2^( 5) =       0.000450249577
  error estimate for blocks of size 2^( 6) =       0.000457134040
  error estimate for blocks of size 2^( 7) =       0.000462755267

      target function =                  N/A
              le_mean =     -16.906589554414
             les_mean =     286.169370875817
             stat err =       0.000452644067
             autocorr =       1.267036738375
              std dev =       0.568692140849
             le_variance =       0.323410751064


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658955441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+67, overlap shift 9.5367e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+68, overlap shift 3.8147e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+69, overlap shift 1.5259e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906589554430       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.151054 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6987e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9127
    reference variance = 1.42588
====================================================
  Execution time = 2.0987e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3446e-01
  Total weights = 1.9515e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065764
  error estimate for blocks of size 2^( 2) =       0.000415265211
  error estimate for blocks of size 2^( 3) =       0.000428694811
  error estimate for blocks of size 2^( 4) =       0.000441554077
  error estimate for blocks of size 2^( 5) =       0.000452697308
  error estimate for blocks of size 2^( 6) =       0.000461046625
  error estimate for blocks of size 2^( 7) =       0.000466673832

      target function =                  N/A
              le_mean =     -16.905071679150
             les_mean =     286.115912821489
             stat err =       0.000455492960
             autocorr =       1.283421027349
              std dev =       0.568606856193
             le_variance =       0.323313756910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065764
  error estimate for blocks of size 2^( 2) =       0.000415265211
  error estimate for blocks of size 2^( 3) =       0.000428694811
  error estimate for blocks of size 2^( 4) =       0.000441554077
  error estimate for blocks of size 2^( 5) =       0.000452697308
  error estimate for blocks of size 2^( 6) =       0.000461046625
  error estimate for blocks of size 2^( 7) =       0.000466673832

      target function =                  N/A
              le_mean =     -16.905071679150
             les_mean =     286.115912821489
             stat err =       0.000455492960
             autocorr =       1.283421027349
              std dev =       0.568606856193
             le_variance =       0.323313756910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065764
  error estimate for blocks of size 2^( 2) =       0.000415265211
  error estimate for blocks of size 2^( 3) =       0.000428694811
  error estimate for blocks of size 2^( 4) =       0.000441554077
  error estimate for blocks of size 2^( 5) =       0.000452697308
  error estimate for blocks of size 2^( 6) =       0.000461046625
  error estimate for blocks of size 2^( 7) =       0.000466673832

      target function =                  N/A
              le_mean =     -16.905071679150
             les_mean =     286.115912821489
             stat err =       0.000455492960
             autocorr =       1.283421027349
              std dev =       0.568606856193
             le_variance =       0.323313756910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323281795601
                                         uncertainty =       0.002199822022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402065764
  error estimate for blocks of size 2^( 2) =       0.000415265211
  error estimate for blocks of size 2^( 3) =       0.000428694811
  error estimate for blocks of size 2^( 4) =       0.000441554077
  error estimate for blocks of size 2^( 5) =       0.000452697308
  error estimate for blocks of size 2^( 6) =       0.000461046625
  error estimate for blocks of size 2^( 7) =       0.000466673832

      target function =                  N/A
              le_mean =     -16.905071679150
             les_mean =     286.115912821489
             stat err =       0.000455492960
             autocorr =       1.283421027349
              std dev =       0.568606856193
             le_variance =       0.323313756910


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905071679150        initial  <--
     9.5367e+67     9.5367e+68             0.0000e+00       -16.905071679150
     3.8147e+68     3.8147e+69             0.0000e+00       -16.905071679150
     1.5259e+69     1.5259e+70             0.0000e+00       -16.905071679150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4309
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.8748
    reference variance = 0.174368
====================================================
  Execution time = 2.1066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3596e-01
  Total weights = 1.952016229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.4182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485362039
                                         uncertainty =       0.002156782322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322485362039
                                         uncertainty =       0.002156782322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401545397
  error estimate for blocks of size 2^( 2) =       0.000414977036
  error estimate for blocks of size 2^( 3) =       0.000428250962
  error estimate for blocks of size 2^( 4) =       0.000440938725
  error estimate for blocks of size 2^( 5) =       0.000452189848
  error estimate for blocks of size 2^( 6) =       0.000460184145
  error estimate for blocks of size 2^( 7) =       0.000464079221

      target function =                  N/A
              le_mean =     -16.906681053368
             les_mean =     286.171821591719
             stat err =       0.000454347985
             autocorr =       1.280288688327
              std dev =       0.567870946568
             le_variance =       0.322477411956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690668105337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+68, overlap shift 9.5367e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681053388       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681053388       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681053388       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906681053388       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+68 is 5.458522e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+69, overlap shift 3.8147e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681053388       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681053388       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681053388       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+69 is 1.343002e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+70, overlap shift 1.5259e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906681053388       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906681053388       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906681053388       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+70 is 3.357504e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.152633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9979e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.0221
    reference variance = 0.645482
====================================================
  Execution time = 2.0908e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4148e-01
  Total weights = 1.9517e+06
  Execution time = 1.8825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401324500
  error estimate for blocks of size 2^( 2) =       0.000414215521
  error estimate for blocks of size 2^( 3) =       0.000427371469
  error estimate for blocks of size 2^( 4) =       0.000439454732
  error estimate for blocks of size 2^( 5) =       0.000448908153
  error estimate for blocks of size 2^( 6) =       0.000456214263
  error estimate for blocks of size 2^( 7) =       0.000463074002

      target function =                  N/A
              le_mean =     -16.905789581244
             les_mean =     286.147199854031
             stat err =       0.000451912788
             autocorr =       1.267996089078
              std dev =       0.567558551171
             le_variance =       0.322122709008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401324500
  error estimate for blocks of size 2^( 2) =       0.000414215521
  error estimate for blocks of size 2^( 3) =       0.000427371469
  error estimate for blocks of size 2^( 4) =       0.000439454732
  error estimate for blocks of size 2^( 5) =       0.000448908153
  error estimate for blocks of size 2^( 6) =       0.000456214263
  error estimate for blocks of size 2^( 7) =       0.000463074002

      target function =                  N/A
              le_mean =     -16.905789581244
             les_mean =     286.147199854031
             stat err =       0.000451912788
             autocorr =       1.267996089078
              std dev =       0.567558551171
             le_variance =       0.322122709008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401324500
  error estimate for blocks of size 2^( 2) =       0.000414215521
  error estimate for blocks of size 2^( 3) =       0.000427371469
  error estimate for blocks of size 2^( 4) =       0.000439454732
  error estimate for blocks of size 2^( 5) =       0.000448908153
  error estimate for blocks of size 2^( 6) =       0.000456214263
  error estimate for blocks of size 2^( 7) =       0.000463074002

      target function =                  N/A
              le_mean =     -16.905789581244
             les_mean =     286.147199854031
             stat err =       0.000451912788
             autocorr =       1.267996089078
              std dev =       0.567558551171
             le_variance =       0.322122709008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322033500963
                                         uncertainty =       0.002539284581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401324500
  error estimate for blocks of size 2^( 2) =       0.000414215521
  error estimate for blocks of size 2^( 3) =       0.000427371469
  error estimate for blocks of size 2^( 4) =       0.000439454732
  error estimate for blocks of size 2^( 5) =       0.000448908153
  error estimate for blocks of size 2^( 6) =       0.000456214263
  error estimate for blocks of size 2^( 7) =       0.000463074002

      target function =                  N/A
              le_mean =     -16.905789581244
             les_mean =     286.147199854031
             stat err =       0.000451912788
             autocorr =       1.267996089078
              std dev =       0.567558551171
             le_variance =       0.322122709008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905789581244        initial  <--
     9.5367e+68     9.5367e+69             5.4585e-73       -16.905789581244
     3.8147e+69     3.8147e+70             1.3430e-73       -16.905789581244
     1.5259e+70     1.5259e+71             3.3575e-74       -16.905789581244

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4178
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8455
    reference variance = 0.238265
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4877e-01
  Total weights = 1.951400497e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091911775
                                         uncertainty =       0.010834640492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335091911775
                                         uncertainty =       0.010834640492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409325066
  error estimate for blocks of size 2^( 2) =       0.000422105402
  error estimate for blocks of size 2^( 3) =       0.000435197623
  error estimate for blocks of size 2^( 4) =       0.000448336154
  error estimate for blocks of size 2^( 5) =       0.000458836424
  error estimate for blocks of size 2^( 6) =       0.000468177635
  error estimate for blocks of size 2^( 7) =       0.000472427911

      target function =                  N/A
              le_mean =     -16.905924743389
             les_mean =     286.159065852264
             stat err =       0.000461944531
             autocorr =       1.273629116807
              std dev =       0.578873059448
             le_variance =       0.335094018954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592474339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+69, overlap shift 9.5367e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+70, overlap shift 3.8147e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+71, overlap shift 1.5259e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905924743368       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.153819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7232e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.217
====================================================
  Execution time = 2.1055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3492e-01
  Total weights = 1.9516e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124036
  error estimate for blocks of size 2^( 2) =       0.000413807512
  error estimate for blocks of size 2^( 3) =       0.000427230208
  error estimate for blocks of size 2^( 4) =       0.000439875480
  error estimate for blocks of size 2^( 5) =       0.000451464998
  error estimate for blocks of size 2^( 6) =       0.000460216061
  error estimate for blocks of size 2^( 7) =       0.000468349971

      target function =                  N/A
              le_mean =     -16.905650138237
             les_mean =     286.135929490046
             stat err =       0.000454976628
             autocorr =       1.286532616355
              std dev =       0.567275052357
             le_variance =       0.321800985026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124036
  error estimate for blocks of size 2^( 2) =       0.000413807512
  error estimate for blocks of size 2^( 3) =       0.000427230208
  error estimate for blocks of size 2^( 4) =       0.000439875480
  error estimate for blocks of size 2^( 5) =       0.000451464998
  error estimate for blocks of size 2^( 6) =       0.000460216061
  error estimate for blocks of size 2^( 7) =       0.000468349971

      target function =                  N/A
              le_mean =     -16.905650138237
             les_mean =     286.135929490046
             stat err =       0.000454976628
             autocorr =       1.286532616355
              std dev =       0.567275052357
             le_variance =       0.321800985026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124036
  error estimate for blocks of size 2^( 2) =       0.000413807512
  error estimate for blocks of size 2^( 3) =       0.000427230208
  error estimate for blocks of size 2^( 4) =       0.000439875480
  error estimate for blocks of size 2^( 5) =       0.000451464998
  error estimate for blocks of size 2^( 6) =       0.000460216061
  error estimate for blocks of size 2^( 7) =       0.000468349971

      target function =                  N/A
              le_mean =     -16.905650138237
             les_mean =     286.135929490046
             stat err =       0.000454976628
             autocorr =       1.286532616355
              std dev =       0.567275052357
             le_variance =       0.321800985026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321809046694
                                         uncertainty =       0.001858426500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124036
  error estimate for blocks of size 2^( 2) =       0.000413807512
  error estimate for blocks of size 2^( 3) =       0.000427230208
  error estimate for blocks of size 2^( 4) =       0.000439875480
  error estimate for blocks of size 2^( 5) =       0.000451464998
  error estimate for blocks of size 2^( 6) =       0.000460216061
  error estimate for blocks of size 2^( 7) =       0.000468349971

      target function =                  N/A
              le_mean =     -16.905650138237
             les_mean =     286.135929490046
             stat err =       0.000454976628
             autocorr =       1.286532616355
              std dev =       0.567275052357
             le_variance =       0.321800985026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905650138237        initial  <--
     9.5367e+69     9.5367e+70             0.0000e+00       -16.905650138237
     3.8147e+70     3.8147e+71             0.0000e+00       -16.905650138237
     1.5259e+71     1.5259e+72             0.0000e+00       -16.905650138237

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5262
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7765e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9542
    reference variance = 0.189108
====================================================
  Execution time = 2.0836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3356e-01
  Total weights = 1.951765242e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320808043899
                                         uncertainty =       0.001847921981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320808043899
                                         uncertainty =       0.001847921981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400525978
  error estimate for blocks of size 2^( 2) =       0.000413594978
  error estimate for blocks of size 2^( 3) =       0.000426800852
  error estimate for blocks of size 2^( 4) =       0.000439575712
  error estimate for blocks of size 2^( 5) =       0.000450324113
  error estimate for blocks of size 2^( 6) =       0.000458195947
  error estimate for blocks of size 2^( 7) =       0.000464568258

      target function =                  N/A
              le_mean =     -16.906599641270
             les_mean =     286.166674162782
             stat err =       0.000453166007
             autocorr =       1.280127629116
              std dev =       0.566429270634
             le_variance =       0.320842118631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659964127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+70, overlap shift 9.5367e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+71, overlap shift 3.8147e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+72, overlap shift 1.5259e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599641279       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.154987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6948e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.202602
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3167e-01
  Total weights = 1.9517e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399290764
  error estimate for blocks of size 2^( 2) =       0.000412272440
  error estimate for blocks of size 2^( 3) =       0.000424794276
  error estimate for blocks of size 2^( 4) =       0.000437181024
  error estimate for blocks of size 2^( 5) =       0.000446749824
  error estimate for blocks of size 2^( 6) =       0.000453486356
  error estimate for blocks of size 2^( 7) =       0.000456855306

      target function =                  N/A
              le_mean =     -16.906062983878
             les_mean =     286.146633814290
             stat err =       0.000448568127
             autocorr =       1.262055038239
              std dev =       0.564682413531
             le_variance =       0.318866228151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399290764
  error estimate for blocks of size 2^( 2) =       0.000412272440
  error estimate for blocks of size 2^( 3) =       0.000424794276
  error estimate for blocks of size 2^( 4) =       0.000437181024
  error estimate for blocks of size 2^( 5) =       0.000446749824
  error estimate for blocks of size 2^( 6) =       0.000453486356
  error estimate for blocks of size 2^( 7) =       0.000456855306

      target function =                  N/A
              le_mean =     -16.906062983878
             les_mean =     286.146633814290
             stat err =       0.000448568127
             autocorr =       1.262055038239
              std dev =       0.564682413531
             le_variance =       0.318866228151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399290764
  error estimate for blocks of size 2^( 2) =       0.000412272440
  error estimate for blocks of size 2^( 3) =       0.000424794276
  error estimate for blocks of size 2^( 4) =       0.000437181024
  error estimate for blocks of size 2^( 5) =       0.000446749824
  error estimate for blocks of size 2^( 6) =       0.000453486356
  error estimate for blocks of size 2^( 7) =       0.000456855306

      target function =                  N/A
              le_mean =     -16.906062983878
             les_mean =     286.146633814290
             stat err =       0.000448568127
             autocorr =       1.262055038239
              std dev =       0.564682413531
             le_variance =       0.318866228151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318918383154
                                         uncertainty =       0.001582160589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399290764
  error estimate for blocks of size 2^( 2) =       0.000412272440
  error estimate for blocks of size 2^( 3) =       0.000424794276
  error estimate for blocks of size 2^( 4) =       0.000437181024
  error estimate for blocks of size 2^( 5) =       0.000446749824
  error estimate for blocks of size 2^( 6) =       0.000453486356
  error estimate for blocks of size 2^( 7) =       0.000456855306

      target function =                  N/A
              le_mean =     -16.906062983878
             les_mean =     286.146633814290
             stat err =       0.000448568127
             autocorr =       1.262055038239
              std dev =       0.564682413531
             le_variance =       0.318866228151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906062983878        initial  <--
     9.5367e+70     9.5367e+71             0.0000e+00       -16.906062983878
     3.8147e+71     3.8147e+72             0.0000e+00       -16.906062983878
     1.5259e+72     1.5259e+73             0.0000e+00       -16.906062983878

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2344
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7513e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.25067
====================================================
  Execution time = 2.1042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3147e-01
  Total weights = 1.951764974e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0551e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319659995510
                                         uncertainty =       0.002306788391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319659995510
                                         uncertainty =       0.002306788391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399745932
  error estimate for blocks of size 2^( 2) =       0.000412936820
  error estimate for blocks of size 2^( 3) =       0.000425887725
  error estimate for blocks of size 2^( 4) =       0.000438019514
  error estimate for blocks of size 2^( 5) =       0.000447750708
  error estimate for blocks of size 2^( 6) =       0.000454359584
  error estimate for blocks of size 2^( 7) =       0.000459993095

      target function =                  N/A
              le_mean =     -16.906413164104
             les_mean =     286.158278263684
             stat err =       0.000450030725
             autocorr =       1.267407359508
              std dev =       0.565326119085
             le_variance =       0.319593620920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690641316410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+71, overlap shift 9.5367e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+72, overlap shift 3.8147e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+73, overlap shift 1.5259e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906413164085       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.156183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7102e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.9642
    reference variance = 0.165792
====================================================
  Execution time = 2.1569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 1.9517e+06
  Execution time = 1.8736e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403979768
  error estimate for blocks of size 2^( 2) =       0.000416991508
  error estimate for blocks of size 2^( 3) =       0.000430459746
  error estimate for blocks of size 2^( 4) =       0.000442623743
  error estimate for blocks of size 2^( 5) =       0.000451634703
  error estimate for blocks of size 2^( 6) =       0.000458018828
  error estimate for blocks of size 2^( 7) =       0.000462140073

      target function =                  N/A
              le_mean =     -16.905943181681
             les_mean =     286.149003740529
             stat err =       0.000453604337
             autocorr =       1.260767963305
              std dev =       0.571313666875
             le_variance =       0.326399305959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403979768
  error estimate for blocks of size 2^( 2) =       0.000416991508
  error estimate for blocks of size 2^( 3) =       0.000430459746
  error estimate for blocks of size 2^( 4) =       0.000442623743
  error estimate for blocks of size 2^( 5) =       0.000451634703
  error estimate for blocks of size 2^( 6) =       0.000458018828
  error estimate for blocks of size 2^( 7) =       0.000462140073

      target function =                  N/A
              le_mean =     -16.905943181681
             les_mean =     286.149003740529
             stat err =       0.000453604337
             autocorr =       1.260767963305
              std dev =       0.571313666875
             le_variance =       0.326399305959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403979768
  error estimate for blocks of size 2^( 2) =       0.000416991508
  error estimate for blocks of size 2^( 3) =       0.000430459746
  error estimate for blocks of size 2^( 4) =       0.000442623743
  error estimate for blocks of size 2^( 5) =       0.000451634703
  error estimate for blocks of size 2^( 6) =       0.000458018828
  error estimate for blocks of size 2^( 7) =       0.000462140073

      target function =                  N/A
              le_mean =     -16.905943181681
             les_mean =     286.149003740529
             stat err =       0.000453604337
             autocorr =       1.260767963305
              std dev =       0.571313666875
             le_variance =       0.326399305959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326404703373
                                         uncertainty =       0.003574352041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403979768
  error estimate for blocks of size 2^( 2) =       0.000416991508
  error estimate for blocks of size 2^( 3) =       0.000430459746
  error estimate for blocks of size 2^( 4) =       0.000442623743
  error estimate for blocks of size 2^( 5) =       0.000451634703
  error estimate for blocks of size 2^( 6) =       0.000458018828
  error estimate for blocks of size 2^( 7) =       0.000462140073

      target function =                  N/A
              le_mean =     -16.905943181681
             les_mean =     286.149003740529
             stat err =       0.000453604337
             autocorr =       1.260767963305
              std dev =       0.571313666875
             le_variance =       0.326399305959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905943181681        initial  <--
     9.5367e+71     9.5367e+72             0.0000e+00       -16.905943181681
     3.8147e+72     3.8147e+73             0.0000e+00       -16.905943181681
     1.5259e+73     1.5259e+74             0.0000e+00       -16.905943181681

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0265
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8135e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.8232
    reference variance = 0.252558
====================================================
  Execution time = 2.1098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3240e-01
  Total weights = 1.951771820e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321077767918
                                         uncertainty =       0.001773571841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321077767918
                                         uncertainty =       0.001773571841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400643774
  error estimate for blocks of size 2^( 2) =       0.000413970973
  error estimate for blocks of size 2^( 3) =       0.000426448595
  error estimate for blocks of size 2^( 4) =       0.000438914589
  error estimate for blocks of size 2^( 5) =       0.000449192544
  error estimate for blocks of size 2^( 6) =       0.000457981142
  error estimate for blocks of size 2^( 7) =       0.000460653022

      target function =                  N/A
              le_mean =     -16.906506506092
             les_mean =     286.162362052255
             stat err =       0.000451685324
             autocorr =       1.271028132032
              std dev =       0.566595859070
             le_variance =       0.321030867516


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690650650609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+72, overlap shift 9.5367e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+73, overlap shift 3.8147e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+74, overlap shift 1.5259e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906506506094       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.157347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7167e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9359
    reference variance = 0.43217
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4128e-01
  Total weights = 1.9515e+06
  Execution time = 1.8740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404182146
  error estimate for blocks of size 2^( 2) =       0.000417129481
  error estimate for blocks of size 2^( 3) =       0.000429740493
  error estimate for blocks of size 2^( 4) =       0.000441304410
  error estimate for blocks of size 2^( 5) =       0.000451204622
  error estimate for blocks of size 2^( 6) =       0.000459446084
  error estimate for blocks of size 2^( 7) =       0.000464735439

      target function =                  N/A
              le_mean =     -16.906567700167
             les_mean =     286.173306995972
             stat err =       0.000454172639
             autocorr =       1.262663663393
              std dev =       0.571599872991
             le_variance =       0.326726414803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404182146
  error estimate for blocks of size 2^( 2) =       0.000417129481
  error estimate for blocks of size 2^( 3) =       0.000429740493
  error estimate for blocks of size 2^( 4) =       0.000441304410
  error estimate for blocks of size 2^( 5) =       0.000451204622
  error estimate for blocks of size 2^( 6) =       0.000459446084
  error estimate for blocks of size 2^( 7) =       0.000464735439

      target function =                  N/A
              le_mean =     -16.906567700167
             les_mean =     286.173306995972
             stat err =       0.000454172639
             autocorr =       1.262663663393
              std dev =       0.571599872991
             le_variance =       0.326726414803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404182146
  error estimate for blocks of size 2^( 2) =       0.000417129481
  error estimate for blocks of size 2^( 3) =       0.000429740493
  error estimate for blocks of size 2^( 4) =       0.000441304410
  error estimate for blocks of size 2^( 5) =       0.000451204622
  error estimate for blocks of size 2^( 6) =       0.000459446084
  error estimate for blocks of size 2^( 7) =       0.000464735439

      target function =                  N/A
              le_mean =     -16.906567700167
             les_mean =     286.173306995972
             stat err =       0.000454172639
             autocorr =       1.262663663393
              std dev =       0.571599872991
             le_variance =       0.326726414803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326799747076
                                         uncertainty =       0.002296814542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404182146
  error estimate for blocks of size 2^( 2) =       0.000417129481
  error estimate for blocks of size 2^( 3) =       0.000429740493
  error estimate for blocks of size 2^( 4) =       0.000441304410
  error estimate for blocks of size 2^( 5) =       0.000451204622
  error estimate for blocks of size 2^( 6) =       0.000459446084
  error estimate for blocks of size 2^( 7) =       0.000464735439

      target function =                  N/A
              le_mean =     -16.906567700167
             les_mean =     286.173306995972
             stat err =       0.000454172639
             autocorr =       1.262663663393
              std dev =       0.571599872991
             le_variance =       0.326726414803


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906567700167        initial  <--
     9.5367e+72     9.5367e+73             0.0000e+00       -16.906567700167
     3.8147e+73     3.8147e+74             0.0000e+00       -16.906567700167
     1.5259e+74     1.5259e+75             0.0000e+00       -16.906567700167

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1694
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8596
    reference variance = 0.225814
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4155e-01
  Total weights = 1.951473276e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325343705167
                                         uncertainty =       0.002634736033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325343705167
                                         uncertainty =       0.002634736033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403345244
  error estimate for blocks of size 2^( 2) =       0.000416098644
  error estimate for blocks of size 2^( 3) =       0.000429541322
  error estimate for blocks of size 2^( 4) =       0.000442604519
  error estimate for blocks of size 2^( 5) =       0.000453742038
  error estimate for blocks of size 2^( 6) =       0.000461554258
  error estimate for blocks of size 2^( 7) =       0.000465653964

      target function =                  N/A
              le_mean =     -16.906376743179
             les_mean =     286.167125634555
             stat err =       0.000455888695
             autocorr =       1.277508399140
              std dev =       0.570416314777
             le_variance =       0.325374772164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637674318e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+73, overlap shift 9.5367e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+74, overlap shift 3.8147e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+75, overlap shift 1.5259e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906376743171       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.158476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6883e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8671
    reference variance = 0.393705
====================================================
  Execution time = 2.2598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3865e-01
  Total weights = 1.9516e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403491964
  error estimate for blocks of size 2^( 2) =       0.000416413717
  error estimate for blocks of size 2^( 3) =       0.000428516480
  error estimate for blocks of size 2^( 4) =       0.000440350820
  error estimate for blocks of size 2^( 5) =       0.000450588123
  error estimate for blocks of size 2^( 6) =       0.000457639931
  error estimate for blocks of size 2^( 7) =       0.000463027024

      target function =                  N/A
              le_mean =     -16.906714690620
             les_mean =     286.175653347137
             stat err =       0.000452901474
             autocorr =       1.259904684889
              std dev =       0.570623807152
             le_variance =       0.325611529289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403491964
  error estimate for blocks of size 2^( 2) =       0.000416413717
  error estimate for blocks of size 2^( 3) =       0.000428516480
  error estimate for blocks of size 2^( 4) =       0.000440350820
  error estimate for blocks of size 2^( 5) =       0.000450588123
  error estimate for blocks of size 2^( 6) =       0.000457639931
  error estimate for blocks of size 2^( 7) =       0.000463027024

      target function =                  N/A
              le_mean =     -16.906714690620
             les_mean =     286.175653347137
             stat err =       0.000452901474
             autocorr =       1.259904684889
              std dev =       0.570623807152
             le_variance =       0.325611529289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403491964
  error estimate for blocks of size 2^( 2) =       0.000416413717
  error estimate for blocks of size 2^( 3) =       0.000428516480
  error estimate for blocks of size 2^( 4) =       0.000440350820
  error estimate for blocks of size 2^( 5) =       0.000450588123
  error estimate for blocks of size 2^( 6) =       0.000457639931
  error estimate for blocks of size 2^( 7) =       0.000463027024

      target function =                  N/A
              le_mean =     -16.906714690620
             les_mean =     286.175653347137
             stat err =       0.000452901474
             autocorr =       1.259904684889
              std dev =       0.570623807152
             le_variance =       0.325611529289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325650810215
                                         uncertainty =       0.002436460608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403491964
  error estimate for blocks of size 2^( 2) =       0.000416413717
  error estimate for blocks of size 2^( 3) =       0.000428516480
  error estimate for blocks of size 2^( 4) =       0.000440350820
  error estimate for blocks of size 2^( 5) =       0.000450588123
  error estimate for blocks of size 2^( 6) =       0.000457639931
  error estimate for blocks of size 2^( 7) =       0.000463027024

      target function =                  N/A
              le_mean =     -16.906714690620
             les_mean =     286.175653347137
             stat err =       0.000452901474
             autocorr =       1.259904684889
              std dev =       0.570623807152
             le_variance =       0.325611529289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906714690620        initial  <--
     9.5367e+73     9.5367e+74             0.0000e+00       -16.906714690620
     3.8147e+74     3.8147e+75             0.0000e+00       -16.906714690620
     1.5259e+75     1.5259e+76             0.0000e+00       -16.906714690620

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0640
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.0081
    reference variance = 0.620438
====================================================
  Execution time = 2.1240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3447e-01
  Total weights = 1.951694419e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324182478482
                                         uncertainty =       0.002288950577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324182478482
                                         uncertainty =       0.002288950577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402585410
  error estimate for blocks of size 2^( 2) =       0.000415799128
  error estimate for blocks of size 2^( 3) =       0.000429391043
  error estimate for blocks of size 2^( 4) =       0.000441379548
  error estimate for blocks of size 2^( 5) =       0.000452271626
  error estimate for blocks of size 2^( 6) =       0.000459433630
  error estimate for blocks of size 2^( 7) =       0.000466277386

      target function =                  N/A
              le_mean =     -16.906091608649
             les_mean =     286.150408379005
             stat err =       0.000454840547
             autocorr =       1.276445523364
              std dev =       0.569341746279
             le_variance =       0.324150024056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609160865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+74, overlap shift 9.5367e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+75, overlap shift 3.8147e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+76, overlap shift 1.5259e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906091608641       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.159672 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7357e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8312
    reference variance = 0.194961
====================================================
  Execution time = 2.1194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3931e-01
  Total weights = 1.9517e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403551954
  error estimate for blocks of size 2^( 2) =       0.000416257598
  error estimate for blocks of size 2^( 3) =       0.000429839736
  error estimate for blocks of size 2^( 4) =       0.000442576012
  error estimate for blocks of size 2^( 5) =       0.000453728704
  error estimate for blocks of size 2^( 6) =       0.000462243704
  error estimate for blocks of size 2^( 7) =       0.000467264274

      target function =                  N/A
              le_mean =     -16.905733376079
             les_mean =     286.143135900266
             stat err =       0.000456453173
             autocorr =       1.279362309909
              std dev =       0.570708646744
             le_variance =       0.325708359469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403551954
  error estimate for blocks of size 2^( 2) =       0.000416257598
  error estimate for blocks of size 2^( 3) =       0.000429839736
  error estimate for blocks of size 2^( 4) =       0.000442576012
  error estimate for blocks of size 2^( 5) =       0.000453728704
  error estimate for blocks of size 2^( 6) =       0.000462243704
  error estimate for blocks of size 2^( 7) =       0.000467264274

      target function =                  N/A
              le_mean =     -16.905733376079
             les_mean =     286.143135900266
             stat err =       0.000456453173
             autocorr =       1.279362309909
              std dev =       0.570708646744
             le_variance =       0.325708359469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403551954
  error estimate for blocks of size 2^( 2) =       0.000416257598
  error estimate for blocks of size 2^( 3) =       0.000429839736
  error estimate for blocks of size 2^( 4) =       0.000442576012
  error estimate for blocks of size 2^( 5) =       0.000453728704
  error estimate for blocks of size 2^( 6) =       0.000462243704
  error estimate for blocks of size 2^( 7) =       0.000467264274

      target function =                  N/A
              le_mean =     -16.905733376079
             les_mean =     286.143135900266
             stat err =       0.000456453173
             autocorr =       1.279362309909
              std dev =       0.570708646744
             le_variance =       0.325708359469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325757910363
                                         uncertainty =       0.003351961581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403551954
  error estimate for blocks of size 2^( 2) =       0.000416257598
  error estimate for blocks of size 2^( 3) =       0.000429839736
  error estimate for blocks of size 2^( 4) =       0.000442576012
  error estimate for blocks of size 2^( 5) =       0.000453728704
  error estimate for blocks of size 2^( 6) =       0.000462243704
  error estimate for blocks of size 2^( 7) =       0.000467264274

      target function =                  N/A
              le_mean =     -16.905733376079
             les_mean =     286.143135900266
             stat err =       0.000456453173
             autocorr =       1.279362309909
              std dev =       0.570708646744
             le_variance =       0.325708359469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905733376079        initial  <--
     9.5367e+74     9.5367e+75             0.0000e+00       -16.905733376079
     3.8147e+75     3.8147e+76             0.0000e+00       -16.905733376079
     1.5259e+76     1.5259e+77             0.0000e+00       -16.905733376079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6590
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8022e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.34206
====================================================
  Execution time = 2.0948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3355e-01
  Total weights = 1.951210651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321541516405
                                         uncertainty =       0.002747205758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321541516405
                                         uncertainty =       0.002747205758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401361503
  error estimate for blocks of size 2^( 2) =       0.000414444986
  error estimate for blocks of size 2^( 3) =       0.000427809175
  error estimate for blocks of size 2^( 4) =       0.000440482050
  error estimate for blocks of size 2^( 5) =       0.000450219916
  error estimate for blocks of size 2^( 6) =       0.000459477164
  error estimate for blocks of size 2^( 7) =       0.000466001418

      target function =                  N/A
              le_mean =     -16.906238020955
             les_mean =     286.154435311334
             stat err =       0.000454045137
             autocorr =       1.279754394384
              std dev =       0.567610880469
             le_variance =       0.322182111627


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623802096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+75, overlap shift 9.5367e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+76, overlap shift 3.8147e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+77, overlap shift 1.5259e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906238020953       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.160853 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7063e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.8542
    reference variance = 0.258079
====================================================
  Execution time = 2.1223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3935e-01
  Total weights = 1.9514e+06
  Execution time = 1.8750e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401849849
  error estimate for blocks of size 2^( 2) =       0.000414813388
  error estimate for blocks of size 2^( 3) =       0.000427718581
  error estimate for blocks of size 2^( 4) =       0.000439668583
  error estimate for blocks of size 2^( 5) =       0.000449504834
  error estimate for blocks of size 2^( 6) =       0.000458216967
  error estimate for blocks of size 2^( 7) =       0.000460141056

      target function =                  N/A
              le_mean =     -16.906474186582
             les_mean =     286.168221923605
             stat err =       0.000451882860
             autocorr =       1.264515386670
              std dev =       0.568301506612
             le_variance =       0.322966602417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401849849
  error estimate for blocks of size 2^( 2) =       0.000414813388
  error estimate for blocks of size 2^( 3) =       0.000427718581
  error estimate for blocks of size 2^( 4) =       0.000439668583
  error estimate for blocks of size 2^( 5) =       0.000449504834
  error estimate for blocks of size 2^( 6) =       0.000458216967
  error estimate for blocks of size 2^( 7) =       0.000460141056

      target function =                  N/A
              le_mean =     -16.906474186582
             les_mean =     286.168221923605
             stat err =       0.000451882860
             autocorr =       1.264515386670
              std dev =       0.568301506612
             le_variance =       0.322966602417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401849849
  error estimate for blocks of size 2^( 2) =       0.000414813388
  error estimate for blocks of size 2^( 3) =       0.000427718581
  error estimate for blocks of size 2^( 4) =       0.000439668583
  error estimate for blocks of size 2^( 5) =       0.000449504834
  error estimate for blocks of size 2^( 6) =       0.000458216967
  error estimate for blocks of size 2^( 7) =       0.000460141056

      target function =                  N/A
              le_mean =     -16.906474186582
             les_mean =     286.168221923605
             stat err =       0.000451882860
             autocorr =       1.264515386670
              std dev =       0.568301506612
             le_variance =       0.322966602417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323025568784
                                         uncertainty =       0.003526640441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401849849
  error estimate for blocks of size 2^( 2) =       0.000414813388
  error estimate for blocks of size 2^( 3) =       0.000427718581
  error estimate for blocks of size 2^( 4) =       0.000439668583
  error estimate for blocks of size 2^( 5) =       0.000449504834
  error estimate for blocks of size 2^( 6) =       0.000458216967
  error estimate for blocks of size 2^( 7) =       0.000460141056

      target function =                  N/A
              le_mean =     -16.906474186582
             les_mean =     286.168221923605
             stat err =       0.000451882860
             autocorr =       1.264515386670
              std dev =       0.568301506612
             le_variance =       0.322966602417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906474186582        initial  <--
     9.5367e+75     9.5367e+76             0.0000e+00       -16.906474186582
     3.8147e+76     3.8147e+77             0.0000e+00       -16.906474186582
     1.5259e+77     1.5259e+78             0.0000e+00       -16.906474186582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6925
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7762e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8249
    reference variance = 0.679406
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 1.951658491e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322362740693
                                         uncertainty =       0.002134027006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322362740693
                                         uncertainty =       0.002134027006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401429027
  error estimate for blocks of size 2^( 2) =       0.000414653977
  error estimate for blocks of size 2^( 3) =       0.000427701887
  error estimate for blocks of size 2^( 4) =       0.000438463358
  error estimate for blocks of size 2^( 5) =       0.000448493236
  error estimate for blocks of size 2^( 6) =       0.000457016781
  error estimate for blocks of size 2^( 7) =       0.000463322433

      target function =                  N/A
              le_mean =     -16.905928334847
             les_mean =     286.146128452245
             stat err =       0.000451823952
             autocorr =       1.266837627513
              std dev =       0.567706374253
             le_variance =       0.322290527367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592833485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+76, overlap shift 9.5367e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+77, overlap shift 3.8147e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+78, overlap shift 1.5259e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905928334837       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.162019 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6970e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.235587
====================================================
  Execution time = 2.1015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4152e-01
  Total weights = 1.9518e+06
  Execution time = 1.8822e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404059549
  error estimate for blocks of size 2^( 2) =       0.000417266905
  error estimate for blocks of size 2^( 3) =       0.000430348697
  error estimate for blocks of size 2^( 4) =       0.000442746683
  error estimate for blocks of size 2^( 5) =       0.000454821428
  error estimate for blocks of size 2^( 6) =       0.000463975056
  error estimate for blocks of size 2^( 7) =       0.000474675706

      target function =                  N/A
              le_mean =     -16.905355846597
             les_mean =     286.132573156337
             stat err =       0.000459054718
             autocorr =       1.290738193504
              std dev =       0.571426494376
             le_variance =       0.326528238475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404059549
  error estimate for blocks of size 2^( 2) =       0.000417266905
  error estimate for blocks of size 2^( 3) =       0.000430348697
  error estimate for blocks of size 2^( 4) =       0.000442746683
  error estimate for blocks of size 2^( 5) =       0.000454821428
  error estimate for blocks of size 2^( 6) =       0.000463975056
  error estimate for blocks of size 2^( 7) =       0.000474675706

      target function =                  N/A
              le_mean =     -16.905355846597
             les_mean =     286.132573156337
             stat err =       0.000459054718
             autocorr =       1.290738193504
              std dev =       0.571426494376
             le_variance =       0.326528238475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404059549
  error estimate for blocks of size 2^( 2) =       0.000417266905
  error estimate for blocks of size 2^( 3) =       0.000430348697
  error estimate for blocks of size 2^( 4) =       0.000442746683
  error estimate for blocks of size 2^( 5) =       0.000454821428
  error estimate for blocks of size 2^( 6) =       0.000463975056
  error estimate for blocks of size 2^( 7) =       0.000474675706

      target function =                  N/A
              le_mean =     -16.905355846597
             les_mean =     286.132573156337
             stat err =       0.000459054718
             autocorr =       1.290738193504
              std dev =       0.571426494376
             le_variance =       0.326528238475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326511797486
                                         uncertainty =       0.003184222112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404059549
  error estimate for blocks of size 2^( 2) =       0.000417266905
  error estimate for blocks of size 2^( 3) =       0.000430348697
  error estimate for blocks of size 2^( 4) =       0.000442746683
  error estimate for blocks of size 2^( 5) =       0.000454821428
  error estimate for blocks of size 2^( 6) =       0.000463975056
  error estimate for blocks of size 2^( 7) =       0.000474675706

      target function =                  N/A
              le_mean =     -16.905355846597
             les_mean =     286.132573156337
             stat err =       0.000459054718
             autocorr =       1.290738193504
              std dev =       0.571426494376
             le_variance =       0.326528238475


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905355846597        initial  <--
     9.5367e+76     9.5367e+77             0.0000e+00       -16.905355846597
     3.8147e+77     3.8147e+78             0.0000e+00       -16.905355846597
     1.5259e+78     1.5259e+79             0.0000e+00       -16.905355846597

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5089
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.916
    reference variance = 0.496916
====================================================
  Execution time = 2.1535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3506e-01
  Total weights = 1.951945460e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323781404668
                                         uncertainty =       0.002026841244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323781404668
                                         uncertainty =       0.002026841244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402346156
  error estimate for blocks of size 2^( 2) =       0.000414858332
  error estimate for blocks of size 2^( 3) =       0.000428103466
  error estimate for blocks of size 2^( 4) =       0.000439594520
  error estimate for blocks of size 2^( 5) =       0.000450866404
  error estimate for blocks of size 2^( 6) =       0.000459545493
  error estimate for blocks of size 2^( 7) =       0.000463483905

      target function =                  N/A
              le_mean =     -16.906697421836
             les_mean =     286.171476002692
             stat err =       0.000453372581
             autocorr =       1.269728268395
              std dev =       0.569003390960
             le_variance =       0.323764858924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669742184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+77, overlap shift 9.5367e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+78, overlap shift 3.8147e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+79, overlap shift 1.5259e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906697421843       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.163211 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7538e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8959
    reference variance = 0.215254
====================================================
  Execution time = 2.1464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3314e-01
  Total weights = 1.9519e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400848764
  error estimate for blocks of size 2^( 2) =       0.000413894449
  error estimate for blocks of size 2^( 3) =       0.000427351361
  error estimate for blocks of size 2^( 4) =       0.000439574847
  error estimate for blocks of size 2^( 5) =       0.000450089794
  error estimate for blocks of size 2^( 6) =       0.000456533308
  error estimate for blocks of size 2^( 7) =       0.000460962440

      target function =                  N/A
              le_mean =     -16.907013070716
             les_mean =     286.180235433119
             stat err =       0.000451790097
             autocorr =       1.270317607362
              std dev =       0.566885758268
             le_variance =       0.321359462927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400848764
  error estimate for blocks of size 2^( 2) =       0.000413894449
  error estimate for blocks of size 2^( 3) =       0.000427351361
  error estimate for blocks of size 2^( 4) =       0.000439574847
  error estimate for blocks of size 2^( 5) =       0.000450089794
  error estimate for blocks of size 2^( 6) =       0.000456533308
  error estimate for blocks of size 2^( 7) =       0.000460962440

      target function =                  N/A
              le_mean =     -16.907013070716
             les_mean =     286.180235433119
             stat err =       0.000451790097
             autocorr =       1.270317607362
              std dev =       0.566885758268
             le_variance =       0.321359462927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400848764
  error estimate for blocks of size 2^( 2) =       0.000413894449
  error estimate for blocks of size 2^( 3) =       0.000427351361
  error estimate for blocks of size 2^( 4) =       0.000439574847
  error estimate for blocks of size 2^( 5) =       0.000450089794
  error estimate for blocks of size 2^( 6) =       0.000456533308
  error estimate for blocks of size 2^( 7) =       0.000460962440

      target function =                  N/A
              le_mean =     -16.907013070716
             les_mean =     286.180235433119
             stat err =       0.000451790097
             autocorr =       1.270317607362
              std dev =       0.566885758268
             le_variance =       0.321359462927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277648975
                                         uncertainty =       0.001887785446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400848764
  error estimate for blocks of size 2^( 2) =       0.000413894449
  error estimate for blocks of size 2^( 3) =       0.000427351361
  error estimate for blocks of size 2^( 4) =       0.000439574847
  error estimate for blocks of size 2^( 5) =       0.000450089794
  error estimate for blocks of size 2^( 6) =       0.000456533308
  error estimate for blocks of size 2^( 7) =       0.000460962440

      target function =                  N/A
              le_mean =     -16.907013070716
             les_mean =     286.180235433119
             stat err =       0.000451790097
             autocorr =       1.270317607362
              std dev =       0.566885758268
             le_variance =       0.321359462927


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907013070716        initial  <--
     9.5367e+77     9.5367e+78             0.0000e+00       -16.907013070716
     3.8147e+78     3.8147e+79             0.0000e+00       -16.907013070716
     1.5259e+79     1.5259e+80             0.0000e+00       -16.907013070716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9488
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8493e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.8427
    reference variance = 0.16016
====================================================
  Execution time = 2.1092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5215e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4308e-01
  Total weights = 1.951960585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324826117060
                                         uncertainty =       0.002972164154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324826117060
                                         uncertainty =       0.002972164154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403251102
  error estimate for blocks of size 2^( 2) =       0.000415925546
  error estimate for blocks of size 2^( 3) =       0.000429291664
  error estimate for blocks of size 2^( 4) =       0.000441129545
  error estimate for blocks of size 2^( 5) =       0.000450909968
  error estimate for blocks of size 2^( 6) =       0.000459312467
  error estimate for blocks of size 2^( 7) =       0.000464949402

      target function =                  N/A
              le_mean =     -16.906409370850
             les_mean =     286.169753090702
             stat err =       0.000454075346
             autocorr =       1.267957565262
              std dev =       0.570283177078
             le_variance =       0.325222902058


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640937085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+78, overlap shift 9.5367e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+79, overlap shift 3.8147e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+80, overlap shift 1.5259e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409370834       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+80 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.164348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7148e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9183
    reference variance = 0.152705
====================================================
  Execution time = 2.2920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3970e-01
  Total weights = 1.9518e+06
  Execution time = 1.8764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402270971
  error estimate for blocks of size 2^( 2) =       0.000414991710
  error estimate for blocks of size 2^( 3) =       0.000428136408
  error estimate for blocks of size 2^( 4) =       0.000440018076
  error estimate for blocks of size 2^( 5) =       0.000451894628
  error estimate for blocks of size 2^( 6) =       0.000459658264
  error estimate for blocks of size 2^( 7) =       0.000465155998

      target function =                  N/A
              le_mean =     -16.905357303771
             les_mean =     286.130801621635
             stat err =       0.000454181741
             autocorr =       1.274740998780
              std dev =       0.568897063299
             le_variance =       0.323643868630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402270971
  error estimate for blocks of size 2^( 2) =       0.000414991710
  error estimate for blocks of size 2^( 3) =       0.000428136408
  error estimate for blocks of size 2^( 4) =       0.000440018076
  error estimate for blocks of size 2^( 5) =       0.000451894628
  error estimate for blocks of size 2^( 6) =       0.000459658264
  error estimate for blocks of size 2^( 7) =       0.000465155998

      target function =                  N/A
              le_mean =     -16.905357303771
             les_mean =     286.130801621635
             stat err =       0.000454181741
             autocorr =       1.274740998780
              std dev =       0.568897063299
             le_variance =       0.323643868630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402270971
  error estimate for blocks of size 2^( 2) =       0.000414991710
  error estimate for blocks of size 2^( 3) =       0.000428136408
  error estimate for blocks of size 2^( 4) =       0.000440018076
  error estimate for blocks of size 2^( 5) =       0.000451894628
  error estimate for blocks of size 2^( 6) =       0.000459658264
  error estimate for blocks of size 2^( 7) =       0.000465155998

      target function =                  N/A
              le_mean =     -16.905357303771
             les_mean =     286.130801621635
             stat err =       0.000454181741
             autocorr =       1.274740998780
              std dev =       0.568897063299
             le_variance =       0.323643868630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323713809812
                                         uncertainty =       0.002347231788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402270971
  error estimate for blocks of size 2^( 2) =       0.000414991710
  error estimate for blocks of size 2^( 3) =       0.000428136408
  error estimate for blocks of size 2^( 4) =       0.000440018076
  error estimate for blocks of size 2^( 5) =       0.000451894628
  error estimate for blocks of size 2^( 6) =       0.000459658264
  error estimate for blocks of size 2^( 7) =       0.000465155998

      target function =                  N/A
              le_mean =     -16.905357303771
             les_mean =     286.130801621635
             stat err =       0.000454181741
             autocorr =       1.274740998780
              std dev =       0.568897063299
             le_variance =       0.323643868630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905357303771        initial  <--
     9.5367e+78     9.5367e+79             0.0000e+00       -16.905357303771
     3.8147e+79     3.8147e+80             0.0000e+00       -16.905357303771
     1.5259e+80     1.5259e+81             0.0000e+00       -16.905357303771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3890
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9543e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.8686
    reference variance = 0.239448
====================================================
  Execution time = 2.0954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3709e-01
  Total weights = 1.951469609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326125236866
                                         uncertainty =       0.002088135599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326125236866
                                         uncertainty =       0.002088135599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403770684
  error estimate for blocks of size 2^( 2) =       0.000416530568
  error estimate for blocks of size 2^( 3) =       0.000430058339
  error estimate for blocks of size 2^( 4) =       0.000443083946
  error estimate for blocks of size 2^( 5) =       0.000455398781
  error estimate for blocks of size 2^( 6) =       0.000464165108
  error estimate for blocks of size 2^( 7) =       0.000467289582

      target function =                  N/A
              le_mean =     -16.905920628105
             les_mean =     286.147243974098
             stat err =       0.000457484354
             autocorr =       1.283757295447
              std dev =       0.571017977422
             le_variance =       0.326061530539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690592062810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+79, overlap shift 9.5367e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+80, overlap shift 3.8147e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+80 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+81, overlap shift 1.5259e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905920628089       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+81 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.165554 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7070e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.967
    reference variance = 0.324438
====================================================
  Execution time = 2.1435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3704e-01
  Total weights = 1.9515e+06
  Execution time = 1.8869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403023031
  error estimate for blocks of size 2^( 2) =       0.000415687956
  error estimate for blocks of size 2^( 3) =       0.000428443867
  error estimate for blocks of size 2^( 4) =       0.000440495850
  error estimate for blocks of size 2^( 5) =       0.000451109418
  error estimate for blocks of size 2^( 6) =       0.000458105709
  error estimate for blocks of size 2^( 7) =       0.000463342236

      target function =                  N/A
              le_mean =     -16.906917917631
             les_mean =     286.180911274865
             stat err =       0.000453263303
             autocorr =       1.264856883379
              std dev =       0.569960637070
             le_variance =       0.324855127809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403023031
  error estimate for blocks of size 2^( 2) =       0.000415687956
  error estimate for blocks of size 2^( 3) =       0.000428443867
  error estimate for blocks of size 2^( 4) =       0.000440495850
  error estimate for blocks of size 2^( 5) =       0.000451109418
  error estimate for blocks of size 2^( 6) =       0.000458105709
  error estimate for blocks of size 2^( 7) =       0.000463342236

      target function =                  N/A
              le_mean =     -16.906917917631
             les_mean =     286.180911274865
             stat err =       0.000453263303
             autocorr =       1.264856883379
              std dev =       0.569960637070
             le_variance =       0.324855127809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403023031
  error estimate for blocks of size 2^( 2) =       0.000415687956
  error estimate for blocks of size 2^( 3) =       0.000428443867
  error estimate for blocks of size 2^( 4) =       0.000440495850
  error estimate for blocks of size 2^( 5) =       0.000451109418
  error estimate for blocks of size 2^( 6) =       0.000458105709
  error estimate for blocks of size 2^( 7) =       0.000463342236

      target function =                  N/A
              le_mean =     -16.906917917631
             les_mean =     286.180911274865
             stat err =       0.000453263303
             autocorr =       1.264856883379
              std dev =       0.569960637070
             le_variance =       0.324855127809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324877086748
                                         uncertainty =       0.002586040104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403023031
  error estimate for blocks of size 2^( 2) =       0.000415687956
  error estimate for blocks of size 2^( 3) =       0.000428443867
  error estimate for blocks of size 2^( 4) =       0.000440495850
  error estimate for blocks of size 2^( 5) =       0.000451109418
  error estimate for blocks of size 2^( 6) =       0.000458105709
  error estimate for blocks of size 2^( 7) =       0.000463342236

      target function =                  N/A
              le_mean =     -16.906917917631
             les_mean =     286.180911274865
             stat err =       0.000453263303
             autocorr =       1.264856883379
              std dev =       0.569960637070
             le_variance =       0.324855127809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906917917631        initial  <--
     9.5367e+79     9.5367e+80             0.0000e+00       -16.906917917631
     3.8147e+80     3.8147e+81             0.0000e+00       -16.906917917631
     1.5259e+81     1.5259e+82             0.0000e+00       -16.906917917631

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9520
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.921
    reference variance = 0.25319
====================================================
  Execution time = 2.1117e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5206e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3854e-01
  Total weights = 1.951648777e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324703804777
                                         uncertainty =       0.002570909659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324703804777
                                         uncertainty =       0.002570909659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402912487
  error estimate for blocks of size 2^( 2) =       0.000415844348
  error estimate for blocks of size 2^( 3) =       0.000429245861
  error estimate for blocks of size 2^( 4) =       0.000441419987
  error estimate for blocks of size 2^( 5) =       0.000451597312
  error estimate for blocks of size 2^( 6) =       0.000459838545
  error estimate for blocks of size 2^( 7) =       0.000464698746

      target function =                  N/A
              le_mean =     -16.906146963894
             les_mean =     286.156341788924
             stat err =       0.000454388647
             autocorr =       1.271842955785
              std dev =       0.569804304157
             le_variance =       0.324676945036


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614696389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+80, overlap shift 9.5367e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906146963893       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+80 is 4.815950e-85

solving harmonic davidson linear method for identity shift 3.8147e+81, overlap shift 3.8147e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906146963893       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+81 is 1.203987e-85

solving harmonic davidson linear method for identity shift 1.5259e+82, overlap shift 1.5259e+83 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906146963893       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906146963893       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+82 is 3.009968e-86

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.166981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7204e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.182766
====================================================
  Execution time = 2.0788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3375e-01
  Total weights = 1.9519e+06
  Execution time = 1.8953e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400797436
  error estimate for blocks of size 2^( 2) =       0.000413866411
  error estimate for blocks of size 2^( 3) =       0.000426364134
  error estimate for blocks of size 2^( 4) =       0.000437755415
  error estimate for blocks of size 2^( 5) =       0.000448017972
  error estimate for blocks of size 2^( 6) =       0.000455262070
  error estimate for blocks of size 2^( 7) =       0.000459048902

      target function =                  N/A
              le_mean =     -16.905503773124
             les_mean =     286.129810371200
             stat err =       0.000450021090
             autocorr =       1.260711937546
              std dev =       0.566813169380
             le_variance =       0.321277168982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400797436
  error estimate for blocks of size 2^( 2) =       0.000413866411
  error estimate for blocks of size 2^( 3) =       0.000426364134
  error estimate for blocks of size 2^( 4) =       0.000437755415
  error estimate for blocks of size 2^( 5) =       0.000448017972
  error estimate for blocks of size 2^( 6) =       0.000455262070
  error estimate for blocks of size 2^( 7) =       0.000459048902

      target function =                  N/A
              le_mean =     -16.905503773124
             les_mean =     286.129810371200
             stat err =       0.000450021090
             autocorr =       1.260711937546
              std dev =       0.566813169380
             le_variance =       0.321277168982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400797436
  error estimate for blocks of size 2^( 2) =       0.000413866411
  error estimate for blocks of size 2^( 3) =       0.000426364134
  error estimate for blocks of size 2^( 4) =       0.000437755415
  error estimate for blocks of size 2^( 5) =       0.000448017972
  error estimate for blocks of size 2^( 6) =       0.000455262070
  error estimate for blocks of size 2^( 7) =       0.000459048902

      target function =                  N/A
              le_mean =     -16.905503773124
             les_mean =     286.129810371200
             stat err =       0.000450021090
             autocorr =       1.260711937546
              std dev =       0.566813169380
             le_variance =       0.321277168982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321280678430
                                         uncertainty =       0.002316806347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400797436
  error estimate for blocks of size 2^( 2) =       0.000413866411
  error estimate for blocks of size 2^( 3) =       0.000426364134
  error estimate for blocks of size 2^( 4) =       0.000437755415
  error estimate for blocks of size 2^( 5) =       0.000448017972
  error estimate for blocks of size 2^( 6) =       0.000455262070
  error estimate for blocks of size 2^( 7) =       0.000459048902

      target function =                  N/A
              le_mean =     -16.905503773124
             les_mean =     286.129810371200
             stat err =       0.000450021090
             autocorr =       1.260711937546
              std dev =       0.566813169380
             le_variance =       0.321277168982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905503773124        initial  <--
     9.5367e+80     9.5367e+81             4.8159e-85       -16.905503773124
     3.8147e+81     3.8147e+82             1.2040e-85       -16.905503773124
     1.5259e+82     1.5259e+83             3.0100e-86       -16.905503773124

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3541
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.799
    reference variance = 0.387934
====================================================
  Execution time = 2.1137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3511e-01
  Total weights = 1.951733087e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835990798
                                         uncertainty =       0.004953807428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324835990798
                                         uncertainty =       0.004953807428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403018144
  error estimate for blocks of size 2^( 2) =       0.000416131655
  error estimate for blocks of size 2^( 3) =       0.000429814932
  error estimate for blocks of size 2^( 4) =       0.000442198639
  error estimate for blocks of size 2^( 5) =       0.000454562442
  error estimate for blocks of size 2^( 6) =       0.000462258498
  error estimate for blocks of size 2^( 7) =       0.000466402857

      target function =                  N/A
              le_mean =     -16.905206446565
             les_mean =     286.121116588394
             stat err =       0.000456355609
             autocorr =       1.282205361514
              std dev =       0.569953725078
             le_variance =       0.324847248730


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690520644657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+81, overlap shift 9.5367e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+81 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+82, overlap shift 3.8147e+83 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+82 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+83, overlap shift 1.5259e+84 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905206446549       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+83 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.168180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7192e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8824
    reference variance = 0.166254
====================================================
  Execution time = 2.1358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3778e-01
  Total weights = 1.9514e+06
  Execution time = 1.8816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401874201
  error estimate for blocks of size 2^( 2) =       0.000414720151
  error estimate for blocks of size 2^( 3) =       0.000428179128
  error estimate for blocks of size 2^( 4) =       0.000440469720
  error estimate for blocks of size 2^( 5) =       0.000452037723
  error estimate for blocks of size 2^( 6) =       0.000461663856
  error estimate for blocks of size 2^( 7) =       0.000466510394

      target function =                  N/A
              le_mean =     -16.904684461770
             les_mean =     286.106140956125
             stat err =       0.000455170423
             autocorr =       1.282826183162
              std dev =       0.568335944948
             le_variance =       0.323005746320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401874201
  error estimate for blocks of size 2^( 2) =       0.000414720151
  error estimate for blocks of size 2^( 3) =       0.000428179128
  error estimate for blocks of size 2^( 4) =       0.000440469720
  error estimate for blocks of size 2^( 5) =       0.000452037723
  error estimate for blocks of size 2^( 6) =       0.000461663856
  error estimate for blocks of size 2^( 7) =       0.000466510394

      target function =                  N/A
              le_mean =     -16.904684461770
             les_mean =     286.106140956125
             stat err =       0.000455170423
             autocorr =       1.282826183162
              std dev =       0.568335944948
             le_variance =       0.323005746320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401874201
  error estimate for blocks of size 2^( 2) =       0.000414720151
  error estimate for blocks of size 2^( 3) =       0.000428179128
  error estimate for blocks of size 2^( 4) =       0.000440469720
  error estimate for blocks of size 2^( 5) =       0.000452037723
  error estimate for blocks of size 2^( 6) =       0.000461663856
  error estimate for blocks of size 2^( 7) =       0.000466510394

      target function =                  N/A
              le_mean =     -16.904684461770
             les_mean =     286.106140956125
             stat err =       0.000455170423
             autocorr =       1.282826183162
              std dev =       0.568335944948
             le_variance =       0.323005746320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027752434
                                         uncertainty =       0.002563915137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401874201
  error estimate for blocks of size 2^( 2) =       0.000414720151
  error estimate for blocks of size 2^( 3) =       0.000428179128
  error estimate for blocks of size 2^( 4) =       0.000440469720
  error estimate for blocks of size 2^( 5) =       0.000452037723
  error estimate for blocks of size 2^( 6) =       0.000461663856
  error estimate for blocks of size 2^( 7) =       0.000466510394

      target function =                  N/A
              le_mean =     -16.904684461770
             les_mean =     286.106140956125
             stat err =       0.000455170423
             autocorr =       1.282826183162
              std dev =       0.568335944948
             le_variance =       0.323005746320


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904684461770        initial  <--
     9.5367e+81     9.5367e+82             0.0000e+00       -16.904684461770
     3.8147e+82     3.8147e+83             0.0000e+00       -16.904684461770
     1.5259e+83     1.5259e+84             0.0000e+00       -16.904684461770

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8379
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.124302e-01 1 1  ON 0
   uu_1                 1.450253e-01 1 1  ON 1
   uu_2                 4.329183e-02 1 1  ON 2
   uu_3                -1.940605e-02 1 1  ON 3
   uu_4                -6.554892e-02 1 1  ON 4
   uu_5                -1.008264e-01 1 1  ON 5
   uu_6                -1.286163e-01 1 1  ON 6
   uu_7                -1.425313e-01 1 1  ON 7
   uu_8                -1.353611e-01 1 1  ON 8
   uu_9                -1.041471e-01 1 1  ON 9
   ud_0                 4.474179e-01 1 1  ON 10
   ud_1                 1.818415e-01 1 1  ON 11
   ud_2                 6.170293e-02 1 1  ON 12
   ud_3                -9.177585e-03 1 1  ON 13
   ud_4                -6.613992e-02 1 1  ON 14
   ud_5                -1.078031e-01 1 1  ON 15
   ud_6                -1.350654e-01 1 1  ON 16
   ud_7                -1.517254e-01 1 1  ON 17
   ud_8                -1.527923e-01 1 1  ON 18
   ud_9                -1.409331e-01 1 1  ON 19
   eO_0                -7.511564e-01 1 1  ON 20
   eO_1                -4.308196e-01 1 1  ON 21
   eO_2                -2.032148e-02 1 1  ON 22
   eO_3                 2.923260e-01 1 1  ON 23
   eO_4                 5.175077e-01 1 1  ON 24
   eO_5                 4.796197e-01 1 1  ON 25
   eO_6                 2.531149e-01 1 1  ON 26
   eO_7                -4.492298e-02 1 1  ON 27
   eO_8                -2.171485e-01 1 1  ON 28
   eO_9                -7.834457e-02 1 1  ON 29
  eH1_0                -2.543004e-01 1 1  ON 30
  eH1_1                -1.470866e-01 1 1  ON 31
  eH1_2                -9.771609e-02 1 1  ON 32
  eH1_3                -4.262487e-02 1 1  ON 33
  eH1_4                 6.775009e-03 1 1  ON 34
  eH1_5                 4.185569e-02 1 1  ON 35
  eH1_6                 1.016531e-01 1 1  ON 36
  eH1_7                 1.560049e-01 1 1  ON 37
  eH1_8                 1.756587e-01 1 1  ON 38
  eH1_9                 6.246097e-02 1 1  ON 39
  eH2_0                -2.516782e-01 1 1  ON 40
  eH2_1                -1.445551e-01 1 1  ON 41
  eH2_2                -9.509182e-02 1 1  ON 42
  eH2_3                -3.988988e-02 1 1  ON 43
  eH2_4                 9.976176e-03 1 1  ON 44
  eH2_5                 4.508373e-02 1 1  ON 45
  eH2_6                 1.037552e-01 1 1  ON 46
  eH2_7                 1.568652e-01 1 1  ON 47
  eH2_8                 1.806498e-01 1 1  ON 48
  eH2_9                 5.052010e-02 1 1  ON 49
ci_0001                 7.003268e-01 3 1  ON 50
ci_0002                 7.015285e-01 3 1  ON 51
ci_0003                -2.685713e-02 3 1  ON 52
ci_0004                -2.809000e-02 3 1  ON 53
ci_0005                -3.589497e-02 3 1  ON 54
ci_0006                -3.670562e-02 3 1  ON 55
ci_0007                -2.183670e-02 3 1  ON 56
ci_0008                -2.217000e-02 3 1  ON 57
ci_0009                -1.762369e-02 3 1  ON 58
ci_0010                -1.712886e-02 3 1  ON 59
ci_0011                -1.246487e-02 3 1  ON 60
ci_0012                -1.201767e-02 3 1  ON 61
ci_0013                 1.317786e-02 3 1  ON 62
ci_0014                 1.297223e-02 3 1  ON 63
ci_0015                 1.238847e-02 3 1  ON 64
ci_0016                 1.313751e-02 3 1  ON 65
ci_0017                 1.096585e-02 3 1  ON 66
ci_0018                 1.137702e-02 3 1  ON 67
ci_0019                 1.118478e-02 3 1  ON 68
ci_0020                 1.177796e-02 3 1  ON 69
ci_0021                -4.438338e-04 3 1  ON 70
ci_0022                -4.813411e-04 3 1  ON 71
ci_0023                -1.166955e-02 3 1  ON 72
ci_0024                -1.028638e-02 3 1  ON 73
ci_0025                -1.011572e-02 3 1  ON 74
ci_0026                -1.096083e-02 3 1  ON 75
ci_0027                -1.137935e-02 3 1  ON 76
ci_0028                -1.138065e-02 3 1  ON 77
ci_0029                -1.069194e-02 3 1  ON 78
ci_0030                -1.040498e-02 3 1  ON 79
ci_0031                 2.076612e-02 3 1  ON 80
ci_0032                 2.128965e-02 3 1  ON 81
ci_0033                 8.102608e-03 3 1  ON 82
ci_0034                 1.043102e-02 3 1  ON 83
ci_0035                 6.885858e-03 3 1  ON 84
ci_0036                 6.709530e-03 3 1  ON 85
ci_0037                -1.053423e-02 3 1  ON 86
ci_0038                -1.070548e-02 3 1  ON 87
ci_0039                -2.825049e-03 3 1  ON 88
ci_0040                -2.726319e-03 3 1  ON 89
ci_0041                 6.627966e-03 3 1  ON 90
ci_0042                 6.834034e-03 3 1  ON 91
ci_0043                -1.789478e-02 3 1  ON 92
ci_0044                -1.810524e-02 3 1  ON 93
ci_0045                 6.869078e-03 3 1  ON 94
ci_0046                 7.982106e-03 3 1  ON 95
ci_0047                -1.925982e-03 3 1  ON 96
ci_0048                -1.608315e-03 3 1  ON 97
ci_0049                -4.904813e-03 3 1  ON 98
ci_0050                -5.255823e-03 3 1  ON 99
ci_0051                -3.527864e-03 3 1  ON 100
ci_0052                -3.470302e-03 3 1  ON 101
ci_0053                -4.663156e-03 3 1  ON 102
ci_0054                -4.583900e-03 3 1  ON 103
ci_0055                 7.395442e-03 3 1  ON 104
ci_0056                 7.194118e-03 3 1  ON 105
ci_0057                 4.385653e-03 3 1  ON 106
ci_0058                 5.051048e-03 3 1  ON 107
ci_0059                -4.266685e-03 3 1  ON 108
ci_0060                -4.797535e-03 3 1  ON 109
ci_0061                -2.188852e-03 3 1  ON 110
ci_0062                -3.317449e-03 3 1  ON 111
ci_0063                -1.018937e-02 3 1  ON 112
ci_0064                -8.590108e-03 3 1  ON 113
ci_0065                -5.184586e-03 3 1  ON 114
ci_0066                -5.370369e-03 3 1  ON 115
ci_0067                -4.790818e-03 3 1  ON 116
ci_0068                -5.119425e-03 3 1  ON 117
ci_0069                 5.022818e-03 3 1  ON 118
ci_0070                 4.129816e-03 3 1  ON 119
ci_0071                 3.172120e-04 3 1  ON 120
ci_0072                 3.840276e-04 3 1  ON 121
ci_0073                 4.187798e-03 3 1  ON 122
ci_0074                 4.107018e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8035e+01 secs
  Total Execution time = 5.9876e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
