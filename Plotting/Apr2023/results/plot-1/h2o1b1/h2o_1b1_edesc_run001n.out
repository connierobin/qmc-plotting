Rank =    0  Free Memory = 86603 MB
Rank =    1  Free Memory = 86603 MB
Rank =    2  Free Memory = 86602 MB
Rank =    3  Free Memory = 86602 MB
Rank =    4  Free Memory = 86602 MB
Rank =    5  Free Memory = 86602 MB
Rank =    6  Free Memory = 86602 MB
Rank =    7  Free Memory = 86602 MB
Rank =    8  Free Memory = 86602 MB
Rank =    9  Free Memory = 86602 MB
Rank =   10  Free Memory = 86602 MB
Rank =   11  Free Memory = 86602 MB
Rank =   12  Free Memory = 86602 MB
Rank =   13  Free Memory = 86602 MB
Rank =   14  Free Memory = 86602 MB
Rank =   15  Free Memory = 86586 MB
Rank =   16  Free Memory = 86586 MB
Rank =   17  Free Memory = 86586 MB
Rank =   18  Free Memory = 86586 MB
Rank =   19  Free Memory = 86586 MB
Rank =   20  Free Memory = 86586 MB
Rank =   21  Free Memory = 86586 MB
Rank =   22  Free Memory = 86586 MB
Rank =   23  Free Memory = 86586 MB
Rank =   24  Free Memory = 86586 MB
Rank =   25  Free Memory = 86586 MB
Rank =   26  Free Memory = 86586 MB
Rank =   27  Free Memory = 86586 MB
Rank =   28  Free Memory = 86586 MB
Rank =   29  Free Memory = 86586 MB
Rank =   30  Free Memory = 86586 MB
Rank =   31  Free Memory = 86586 MB
Rank =   32  Free Memory = 89070 MB
Rank =   33  Free Memory = 89070 MB
Rank =   34  Free Memory = 89070 MB
Rank =   35  Free Memory = 89070 MB
Rank =   36  Free Memory = 89070 MB
Rank =   37  Free Memory = 89070 MB
Rank =   38  Free Memory = 89070 MB
Rank =   39  Free Memory = 89070 MB
Rank =   40  Free Memory = 89070 MB
Rank =   41  Free Memory = 89070 MB
Rank =   42  Free Memory = 89070 MB
Rank =   43  Free Memory = 89070 MB
Rank =   44  Free Memory = 89070 MB
Rank =   45  Free Memory = 89070 MB
Rank =   46  Free Memory = 89070 MB
Rank =   47  Free Memory = 89070 MB
Rank =   48  Free Memory = 89070 MB
Rank =   49  Free Memory = 89070 MB
Rank =   50  Free Memory = 89070 MB
Rank =   51  Free Memory = 89070 MB
Rank =   52  Free Memory = 89070 MB
Rank =   53  Free Memory = 89070 MB
Rank =   54  Free Memory = 89070 MB
Rank =   55  Free Memory = 89070 MB
Rank =   56  Free Memory = 89070 MB
Rank =   57  Free Memory = 89070 MB
Rank =   58  Free Memory = 89070 MB
Rank =   59  Free Memory = 89070 MB
Rank =   60  Free Memory = 89070 MB
Rank =   61  Free Memory = 89070 MB
Rank =   62  Free Memory = 89070 MB
Rank =   63  Free Memory = 89070 MB
Rank =   64  Free Memory = 88971 MB
Rank =   65  Free Memory = 88971 MB
Rank =   66  Free Memory = 88971 MB
Rank =   67  Free Memory = 88971 MB
Rank =   68  Free Memory = 88971 MB
Rank =   69  Free Memory = 88971 MB
Rank =   70  Free Memory = 88971 MB
Rank =   71  Free Memory = 88971 MB
Rank =   72  Free Memory = 88971 MB
Rank =   73  Free Memory = 88970 MB
Rank =   74  Free Memory = 88970 MB
Rank =   75  Free Memory = 88970 MB
Rank =   76  Free Memory = 88970 MB
Rank =   77  Free Memory = 88970 MB
Rank =   78  Free Memory = 88970 MB
Rank =   79  Free Memory = 88970 MB
Rank =   80  Free Memory = 88970 MB
Rank =   81  Free Memory = 88970 MB
Rank =   82  Free Memory = 88970 MB
Rank =   83  Free Memory = 88970 MB
Rank =   84  Free Memory = 88970 MB
Rank =   85  Free Memory = 88970 MB
Rank =   86  Free Memory = 88970 MB
Rank =   87  Free Memory = 88970 MB
Rank =   88  Free Memory = 88970 MB
Rank =   89  Free Memory = 88970 MB
Rank =   90  Free Memory = 88970 MB
Rank =   91  Free Memory = 88970 MB
Rank =   92  Free Memory = 88970 MB
Rank =   93  Free Memory = 88970 MB
Rank =   94  Free Memory = 88970 MB
Rank =   95  Free Memory = 88970 MB
Rank =   96  Free Memory = 88604 MB
Rank =   97  Free Memory = 88604 MB
Rank =   98  Free Memory = 88604 MB
Rank =   99  Free Memory = 88604 MB
Rank =  100  Free Memory = 88604 MB
Rank =  101  Free Memory = 88604 MB
Rank =  102  Free Memory = 88604 MB
Rank =  103  Free Memory = 88604 MB
Rank =  104  Free Memory = 88604 MB
Rank =  105  Free Memory = 88604 MB
Rank =  106  Free Memory = 88604 MB
Rank =  107  Free Memory = 88604 MB
Rank =  108  Free Memory = 88604 MB
Rank =  109  Free Memory = 88604 MB
Rank =  110  Free Memory = 88604 MB
Rank =  111  Free Memory = 88604 MB
Rank =  112  Free Memory = 88604 MB
Rank =  113  Free Memory = 88603 MB
Rank =  114  Free Memory = 88603 MB
Rank =  115  Free Memory = 88603 MB
Rank =  116  Free Memory = 88603 MB
Rank =  117  Free Memory = 88603 MB
Rank =  118  Free Memory = 88603 MB
Rank =  119  Free Memory = 88603 MB
Rank =  120  Free Memory = 88603 MB
Rank =  121  Free Memory = 88603 MB
Rank =  122  Free Memory = 88603 MB
Rank =  123  Free Memory = 88603 MB
Rank =  124  Free Memory = 88603 MB
Rank =  125  Free Memory = 88603 MB
Rank =  126  Free Memory = 88603 MB
Rank =  127  Free Memory = 88603 MB
  Input file(s): opt_h2o_1b1_edesc_run001n.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001n.xml

  Project = H2O
  date    = 2023-03-12 23:20:18 PDT
  host    = n0019.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 162

  Range of prime numbers to use as seeds over processors and threads = 971-1907


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.099245e-01    1         1  ON     0
     uu_1                 1.439267e-01    1         1  ON     1
     uu_2                 4.321000e-02    1         1  ON     2
     uu_3                -1.912983e-02    1         1  ON     3
     uu_4                -6.434190e-02    1         1  ON     4
     uu_5                -9.781534e-02    1         1  ON     5
     uu_6                -1.245416e-01    1         1  ON     6
     uu_7                -1.382522e-01    1         1  ON     7
     uu_8                -1.322097e-01    1         1  ON     8
     uu_9                -1.023447e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.379551e-01    1         1  ON     0
     ud_1                 1.721156e-01    1         1  ON     1
     ud_2                 5.291567e-02    1         1  ON     2
     ud_3                -1.595415e-02    1         1  ON     3
     ud_4                -6.968278e-02    1         1  ON     4
     ud_5                -1.062115e-01    1         1  ON     5
     ud_6                -1.287895e-01    1         1  ON     6
     ud_7                -1.415901e-01    1         1  ON     7
     ud_8                -1.400752e-01    1         1  ON     8
     ud_9                -1.324345e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.694826e-01    1         1  ON     0
     eO_1                -4.483761e-01    1         1  ON     1
     eO_2                -2.578548e-02    1         1  ON     2
     eO_3                 2.984464e-01    1         1  ON     3
     eO_4                 5.315427e-01    1         1  ON     4
     eO_5                 4.915450e-01    1         1  ON     5
     eO_6                 2.578151e-01    1         1  ON     6
     eO_7                -4.672829e-02    1         1  ON     7
     eO_8                -2.137785e-01    1         1  ON     8
     eO_9                -7.492322e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.362265e-01    1         1  ON     0
     eH1_1                -1.382518e-01    1         1  ON     1
     eH1_2                -9.374159e-02    1         1  ON     2
     eH1_3                -3.895806e-02    1         1  ON     3
     eH1_4                 5.480677e-03    1         1  ON     4
     eH1_5                 3.926736e-02    1         1  ON     5
     eH1_6                 9.464365e-02    1         1  ON     6
     eH1_7                 1.480300e-01    1         1  ON     7
     eH1_8                 1.673619e-01    1         1  ON     8
     eH1_9                 5.527810e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.328873e-01    1         1  ON     0
     eH2_1                -1.350509e-01    1         1  ON     1
     eH2_2                -9.054169e-02    1         1  ON     2
     eH2_3                -3.560398e-02    1         1  ON     3
     eH2_4                 8.502165e-03    1         1  ON     4
     eH2_5                 4.201700e-02    1         1  ON     5
     eH2_6                 9.784995e-02    1         1  ON     6
     eH2_7                 1.512209e-01    1         1  ON     7
     eH2_8                 1.724978e-01    1         1  ON     8
     eH2_9                 3.961501e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.092771e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1345e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9631
    reference variance = 0.24971
====================================================
  Execution time = 2.1702e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3254e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332592994417
                                         uncertainty =       0.003360687360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332592994417
                                         uncertainty =       0.003360687360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407761887
  error estimate for blocks of size 2^( 2) =       0.000420782496
  error estimate for blocks of size 2^( 3) =       0.000433877519
  error estimate for blocks of size 2^( 4) =       0.000445482453
  error estimate for blocks of size 2^( 5) =       0.000456198166
  error estimate for blocks of size 2^( 6) =       0.000465238394
  error estimate for blocks of size 2^( 7) =       0.000470273398

      target function =                  N/A
              le_mean =     -16.924618825977
             les_mean =     286.775261752104
             stat err =       0.000459298103
             autocorr =       1.268749958599
              std dev =       0.576662391492
             le_variance =       0.332539513762


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.692461882598e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924618825977       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924626069387       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924625176009       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924627460714       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924631385991       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924630134692       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924630858293       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924631601278       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924631711238       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924631620592       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924631612617       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.425850e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924618825977       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924621104941       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924620826657       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924621724429       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924622636263       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924622359306       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924622515633       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924622610962       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924622582303       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.624608e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924618825977       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924619435081       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924619365147       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924619630688       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924619821180       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924619772602       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924619814067       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924619819670       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924619815056       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 9.126318e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006561 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7359e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.100145e-01                 1 1 ON  0
uu_1  1.440690e-01                 1 1 ON  1
uu_2  4.331659e-02                 1 1 ON  2
uu_3  -1.910730e-02                1 1 ON  3
uu_4  -6.439442e-02                1 1 ON  4
uu_5  -9.791429e-02                1 1 ON  5
uu_6  -1.245761e-01                1 1 ON  6
uu_7  -1.382849e-01                1 1 ON  7
uu_8  -1.323245e-01                1 1 ON  8
uu_9  -1.025107e-01                1 1 ON  9
ud_0  4.376621e-01                 1 1 ON  10
ud_1  1.719018e-01                 1 1 ON  11
ud_2  5.278771e-02                 1 1 ON  12
ud_3  -1.597156e-02                1 1 ON  13
ud_4  -6.969469e-02                1 1 ON  14
ud_5  -1.061582e-01                1 1 ON  15
ud_6  -1.287170e-01                1 1 ON  16
ud_7  -1.413829e-01                1 1 ON  17
ud_8  -1.397998e-01                1 1 ON  18
ud_9  -1.323204e-01                1 1 ON  19
eO_0  -7.697017e-01                1 1 ON  20
eO_1  -4.485752e-01                1 1 ON  21
eO_2  -2.599992e-02                1 1 ON  22
eO_3  2.982358e-01                 1 1 ON  23
eO_4  5.318207e-01                 1 1 ON  24
eO_5  4.919075e-01                 1 1 ON  25
eO_6  2.581643e-01                 1 1 ON  26
eO_7  -4.659585e-02                1 1 ON  27
eO_8  -2.138958e-01                1 1 ON  28
eO_9  -7.505727e-02                1 1 ON  29
eH1_0 -2.361193e-01                1 1 ON  30
eH1_1 -1.382758e-01                1 1 ON  31
eH1_2 -9.382403e-02                1 1 ON  32
eH1_3 -3.895238e-02                1 1 ON  33
eH1_4 5.350161e-03                 1 1 ON  34
eH1_5 3.899371e-02                 1 1 ON  35
eH1_6 9.462482e-02                 1 1 ON  36
eH1_7 1.481322e-01                 1 1 ON  37
eH1_8 1.675217e-01                 1 1 ON  38
eH1_9 5.542536e-02                 1 1 ON  39
eH2_0 -2.327909e-01                1 1 ON  40
eH2_1 -1.351308e-01                1 1 ON  41
eH2_2 -9.057768e-02                1 1 ON  42
eH2_3 -3.570230e-02                1 1 ON  43
eH2_4 8.432702e-03                 1 1 ON  44
eH2_5 4.198980e-02                 1 1 ON  45
eH2_6 9.778019e-02                 1 1 ON  46
eH2_7 1.512247e-01                 1 1 ON  47
eH2_8 1.726087e-01                 1 1 ON  48
eH2_9 3.978888e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9742
    reference variance = 0.247782
====================================================
  Execution time = 2.1125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3662e-01
  Total weights = 2.0000e+06
  Execution time = 1.9011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336728380278
                                         uncertainty =       0.004055610307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336728380278
                                         uncertainty =       0.004055610307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410308436
  error estimate for blocks of size 2^( 2) =       0.000422575717
  error estimate for blocks of size 2^( 3) =       0.000434831679
  error estimate for blocks of size 2^( 4) =       0.000446187643
  error estimate for blocks of size 2^( 5) =       0.000454262303
  error estimate for blocks of size 2^( 6) =       0.000460018647
  error estimate for blocks of size 2^( 7) =       0.000464062172

      target function =                  N/A
              le_mean =     -16.925635355434
             les_mean =     286.813838042274
             stat err =       0.000456132691
             autocorr =       1.235837890917
              std dev =       0.580263755122
             le_variance =       0.336706025508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336544979128
                                         uncertainty =       0.004050451959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336544979128
                                         uncertainty =       0.004050451959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410196794
  error estimate for blocks of size 2^( 2) =       0.000422468961
  error estimate for blocks of size 2^( 3) =       0.000434728172
  error estimate for blocks of size 2^( 4) =       0.000446085204
  error estimate for blocks of size 2^( 5) =       0.000454150453
  error estimate for blocks of size 2^( 6) =       0.000459901990
  error estimate for blocks of size 2^( 7) =       0.000463936845

      target function =                  N/A
              le_mean =     -16.925632745210
             les_mean =     286.813566477413
             stat err =       0.000456018623
             autocorr =       1.235892321904
              std dev =       0.580105869605
             le_variance =       0.336522819950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336552031402
                                         uncertainty =       0.004051245635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336552031402
                                         uncertainty =       0.004051245635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410201065
  error estimate for blocks of size 2^( 2) =       0.000422472951
  error estimate for blocks of size 2^( 3) =       0.000434732426
  error estimate for blocks of size 2^( 4) =       0.000446091060
  error estimate for blocks of size 2^( 5) =       0.000454161122
  error estimate for blocks of size 2^( 6) =       0.000459916127
  error estimate for blocks of size 2^( 7) =       0.000463955721

      target function =                  N/A
              le_mean =     -16.925633308341
             les_mean =     286.813592547693
             stat err =       0.000456031007
             autocorr =       1.235933713794
              std dev =       0.580111909493
             le_variance =       0.336529827535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336702191602
                                         uncertainty =       0.004054928860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336702191602
                                         uncertainty =       0.004054928860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410292492
  error estimate for blocks of size 2^( 2) =       0.000422560419
  error estimate for blocks of size 2^( 3) =       0.000434816851
  error estimate for blocks of size 2^( 4) =       0.000446173234
  error estimate for blocks of size 2^( 5) =       0.000454247327
  error estimate for blocks of size 2^( 6) =       0.000460003563
  error estimate for blocks of size 2^( 7) =       0.000464046693

      target function =                  N/A
              le_mean =     -16.925634986096
             les_mean =     286.813799372623
             stat err =       0.000456117704
             autocorr =       1.235852723708
              std dev =       0.580241207103
             le_variance =       0.336679858420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925635355434        initial  <--
     2.5000e-01     2.5000e+00             1.4259e-03       -16.925632745210
     1.0000e+00     1.0000e+01             3.6246e-04       -16.925633308341
     4.0000e+00     4.0000e+01             9.1263e-05       -16.925634986096

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7680
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.099245e-01 1 1  ON 0
 uu_1                 1.439267e-01 1 1  ON 1
 uu_2                 4.321000e-02 1 1  ON 2
 uu_3                -1.912983e-02 1 1  ON 3
 uu_4                -6.434190e-02 1 1  ON 4
 uu_5                -9.781534e-02 1 1  ON 5
 uu_6                -1.245416e-01 1 1  ON 6
 uu_7                -1.382522e-01 1 1  ON 7
 uu_8                -1.322097e-01 1 1  ON 8
 uu_9                -1.023447e-01 1 1  ON 9
 ud_0                 4.379551e-01 1 1  ON 10
 ud_1                 1.721156e-01 1 1  ON 11
 ud_2                 5.291567e-02 1 1  ON 12
 ud_3                -1.595415e-02 1 1  ON 13
 ud_4                -6.968278e-02 1 1  ON 14
 ud_5                -1.062115e-01 1 1  ON 15
 ud_6                -1.287895e-01 1 1  ON 16
 ud_7                -1.415901e-01 1 1  ON 17
 ud_8                -1.400752e-01 1 1  ON 18
 ud_9                -1.324345e-01 1 1  ON 19
 eO_0                -7.694826e-01 1 1  ON 20
 eO_1                -4.483761e-01 1 1  ON 21
 eO_2                -2.578548e-02 1 1  ON 22
 eO_3                 2.984464e-01 1 1  ON 23
 eO_4                 5.315427e-01 1 1  ON 24
 eO_5                 4.915450e-01 1 1  ON 25
 eO_6                 2.578151e-01 1 1  ON 26
 eO_7                -4.672829e-02 1 1  ON 27
 eO_8                -2.137785e-01 1 1  ON 28
 eO_9                -7.492322e-02 1 1  ON 29
eH1_0                -2.362265e-01 1 1  ON 30
eH1_1                -1.382518e-01 1 1  ON 31
eH1_2                -9.374159e-02 1 1  ON 32
eH1_3                -3.895806e-02 1 1  ON 33
eH1_4                 5.480677e-03 1 1  ON 34
eH1_5                 3.926736e-02 1 1  ON 35
eH1_6                 9.464365e-02 1 1  ON 36
eH1_7                 1.480300e-01 1 1  ON 37
eH1_8                 1.673619e-01 1 1  ON 38
eH1_9                 5.527810e-02 1 1  ON 39
eH2_0                -2.328873e-01 1 1  ON 40
eH2_1                -1.350509e-01 1 1  ON 41
eH2_2                -9.054169e-02 1 1  ON 42
eH2_3                -3.560398e-02 1 1  ON 43
eH2_4                 8.502165e-03 1 1  ON 44
eH2_5                 4.201700e-02 1 1  ON 45
eH2_6                 9.784995e-02 1 1  ON 46
eH2_7                 1.512209e-01 1 1  ON 47
eH2_8                 1.724978e-01 1 1  ON 48
eH2_9                 3.961501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6969e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8905
    reference variance = 0.2117
====================================================
  Execution time = 2.3265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336205325120
                                         uncertainty =       0.003031242887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336205325120
                                         uncertainty =       0.003031242887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410016713
  error estimate for blocks of size 2^( 2) =       0.000422160239
  error estimate for blocks of size 2^( 3) =       0.000435148776
  error estimate for blocks of size 2^( 4) =       0.000446474137
  error estimate for blocks of size 2^( 5) =       0.000455332346
  error estimate for blocks of size 2^( 6) =       0.000462754897
  error estimate for blocks of size 2^( 7) =       0.000466708021

      target function =                  N/A
              le_mean =     -16.924637996889
             les_mean =     286.779598567960
             stat err =       0.000457817350
             autocorr =       1.246755734469
              std dev =       0.579851196732
             le_variance =       0.336227410351


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692463799689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924637996889       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924638327327       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924638346154       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924638424474       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924638211195       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924638282825       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924638413138       residual = 6.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924638409211       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924638443367       residual = 3.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.559935e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924637996889       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924638081866       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924638087405       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924638111091       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924638064859       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924638080650       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924638105346       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924638104174       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.859604e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924637996889       residual = 2.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924638018286       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924638019732       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924638025950       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924638014954       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924638018827       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924638024413       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924638024076       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 9.667665e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8982e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.099371e-01 1 1  ON 0
 uu_1                 1.439465e-01 1 1  ON 1
 uu_2                 4.321473e-02 1 1  ON 2
 uu_3                -1.912833e-02 1 1  ON 3
 uu_4                -6.434781e-02 1 1  ON 4
 uu_5                -9.781361e-02 1 1  ON 5
 uu_6                -1.245407e-01 1 1  ON 6
 uu_7                -1.382636e-01 1 1  ON 7
 uu_8                -1.322265e-01 1 1  ON 8
 uu_9                -1.023623e-01 1 1  ON 9
 ud_0                 4.379182e-01 1 1  ON 10
 ud_1                 1.720920e-01 1 1  ON 11
 ud_2                 5.291354e-02 1 1  ON 12
 ud_3                -1.594772e-02 1 1  ON 13
 ud_4                -6.968181e-02 1 1  ON 14
 ud_5                -1.062119e-01 1 1  ON 15
 ud_6                -1.287804e-01 1 1  ON 16
 ud_7                -1.415624e-01 1 1  ON 17
 ud_8                -1.400585e-01 1 1  ON 18
 ud_9                -1.324294e-01 1 1  ON 19
 eO_0                -7.695027e-01 1 1  ON 20
 eO_1                -4.483829e-01 1 1  ON 21
 eO_2                -2.581164e-02 1 1  ON 22
 eO_3                 2.984232e-01 1 1  ON 23
 eO_4                 5.315703e-01 1 1  ON 24
 eO_5                 4.915836e-01 1 1  ON 25
 eO_6                 2.578450e-01 1 1  ON 26
 eO_7                -4.671470e-02 1 1  ON 27
 eO_8                -2.137942e-01 1 1  ON 28
 eO_9                -7.493869e-02 1 1  ON 29
eH1_0                -2.362252e-01 1 1  ON 30
eH1_1                -1.382619e-01 1 1  ON 31
eH1_2                -9.374634e-02 1 1  ON 32
eH1_3                -3.895095e-02 1 1  ON 33
eH1_4                 5.470211e-03 1 1  ON 34
eH1_5                 3.926021e-02 1 1  ON 35
eH1_6                 9.464125e-02 1 1  ON 36
eH1_7                 1.480306e-01 1 1  ON 37
eH1_8                 1.673712e-01 1 1  ON 38
eH1_9                 5.529295e-02 1 1  ON 39
eH2_0                -2.328708e-01 1 1  ON 40
eH2_1                -1.350504e-01 1 1  ON 41
eH2_2                -9.053595e-02 1 1  ON 42
eH2_3                -3.561449e-02 1 1  ON 43
eH2_4                 8.493138e-03 1 1  ON 44
eH2_5                 4.201287e-02 1 1  ON 45
eH2_6                 9.783365e-02 1 1  ON 46
eH2_7                 1.512152e-01 1 1  ON 47
eH2_8                 1.725060e-01 1 1  ON 48
eH2_9                 3.963106e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.27682
====================================================
  Execution time = 2.0640e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.0000e+06
  Execution time = 1.9030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338172187264
                                         uncertainty =       0.004431446833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338172187264
                                         uncertainty =       0.004431446833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411153158
  error estimate for blocks of size 2^( 2) =       0.000423720335
  error estimate for blocks of size 2^( 3) =       0.000436452714
  error estimate for blocks of size 2^( 4) =       0.000447850339
  error estimate for blocks of size 2^( 5) =       0.000456591878
  error estimate for blocks of size 2^( 6) =       0.000463374633
  error estimate for blocks of size 2^( 7) =       0.000468645004

      target function =                  N/A
              le_mean =     -16.925022517587
             les_mean =     286.794480891228
             stat err =       0.000459115463
             autocorr =       1.246914223025
              std dev =       0.581458372929
             le_variance =       0.338093839450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338103142637
                                         uncertainty =       0.004428839955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338103142637
                                         uncertainty =       0.004428839955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411111207
  error estimate for blocks of size 2^( 2) =       0.000423679903
  error estimate for blocks of size 2^( 3) =       0.000436413849
  error estimate for blocks of size 2^( 4) =       0.000447812269
  error estimate for blocks of size 2^( 5) =       0.000456556073
  error estimate for blocks of size 2^( 6) =       0.000463338001
  error estimate for blocks of size 2^( 7) =       0.000468608121

      target function =                  N/A
              le_mean =     -16.925023071877
             les_mean =     286.794430664104
             stat err =       0.000459078616
             autocorr =       1.246968533723
              std dev =       0.581399045026
             le_variance =       0.338024849558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134121585
                                         uncertainty =       0.004430033463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134121585
                                         uncertainty =       0.004430033463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411130030
  error estimate for blocks of size 2^( 2) =       0.000423698028
  error estimate for blocks of size 2^( 3) =       0.000436431264
  error estimate for blocks of size 2^( 4) =       0.000447829323
  error estimate for blocks of size 2^( 5) =       0.000456572131
  error estimate for blocks of size 2^( 6) =       0.000463354439
  error estimate for blocks of size 2^( 7) =       0.000468624702

      target function =                  N/A
              le_mean =     -16.925022809518
             les_mean =     286.794452736645
             stat err =       0.000459095149
             autocorr =       1.246944166001
              std dev =       0.581425664171
             le_variance =       0.338055802957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338167364519
                                         uncertainty =       0.004431267411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338167364519
                                         uncertainty =       0.004431267411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411150228
  error estimate for blocks of size 2^( 2) =       0.000423717508
  error estimate for blocks of size 2^( 3) =       0.000436449996
  error estimate for blocks of size 2^( 4) =       0.000447847677
  error estimate for blocks of size 2^( 5) =       0.000456589379
  error estimate for blocks of size 2^( 6) =       0.000463372078
  error estimate for blocks of size 2^( 7) =       0.000468642441

      target function =                  N/A
              le_mean =     -16.925022552564
             les_mean =     286.794477256152
             stat err =       0.000459112894
             autocorr =       1.246918038484
              std dev =       0.581454228969
             le_variance =       0.338089020386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925022517587        initial
     2.5000e+00     2.5000e+01             1.5599e-04       -16.925023071877  <--
     1.0000e+01     1.0000e+02             3.8596e-05       -16.925022809518
     4.0000e+01     4.0000e+02             9.6677e-06       -16.925022552564

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 3.0271e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.099785e-01 1 1  ON 0
 uu_1                 1.440017e-01 1 1  ON 1
 uu_2                 4.322882e-02 1 1  ON 2
 uu_3                -1.912268e-02 1 1  ON 3
 uu_4                -6.436436e-02 1 1  ON 4
 uu_5                -9.781282e-02 1 1  ON 5
 uu_6                -1.245377e-01 1 1  ON 6
 uu_7                -1.382951e-01 1 1  ON 7
 uu_8                -1.322764e-01 1 1  ON 8
 uu_9                -1.024170e-01 1 1  ON 9
 ud_0                 4.378175e-01 1 1  ON 10
 ud_1                 1.720251e-01 1 1  ON 11
 ud_2                 5.290555e-02 1 1  ON 12
 ud_3                -1.593371e-02 1 1  ON 13
 ud_4                -6.968060e-02 1 1  ON 14
 ud_5                -1.062124e-01 1 1  ON 15
 ud_6                -1.287578e-01 1 1  ON 16
 ud_7                -1.414836e-01 1 1  ON 17
 ud_8                -1.400069e-01 1 1  ON 18
 ud_9                -1.324123e-01 1 1  ON 19
 eO_0                -7.695610e-01 1 1  ON 20
 eO_1                -4.484135e-01 1 1  ON 21
 eO_2                -2.588708e-02 1 1  ON 22
 eO_3                 2.983590e-01 1 1  ON 23
 eO_4                 5.316492e-01 1 1  ON 24
 eO_5                 4.917010e-01 1 1  ON 25
 eO_6                 2.579386e-01 1 1  ON 26
 eO_7                -4.667172e-02 1 1  ON 27
 eO_8                -2.138433e-01 1 1  ON 28
 eO_9                -7.498721e-02 1 1  ON 29
eH1_0                -2.362232e-01 1 1  ON 30
eH1_1                -1.382934e-01 1 1  ON 31
eH1_2                -9.375652e-02 1 1  ON 32
eH1_3                -3.893401e-02 1 1  ON 33
eH1_4                 5.443736e-03 1 1  ON 34
eH1_5                 3.923722e-02 1 1  ON 35
eH1_6                 9.463129e-02 1 1  ON 36
eH1_7                 1.480315e-01 1 1  ON 37
eH1_8                 1.674001e-01 1 1  ON 38
eH1_9                 5.533977e-02 1 1  ON 39
eH2_0                -2.328237e-01 1 1  ON 40
eH2_1                -1.350518e-01 1 1  ON 41
eH2_2                -9.051848e-02 1 1  ON 42
eH2_3                -3.564420e-02 1 1  ON 43
eH2_4                 8.466485e-03 1 1  ON 44
eH2_5                 4.199987e-02 1 1  ON 45
eH2_6                 9.778504e-02 1 1  ON 46
eH2_7                 1.511983e-01 1 1  ON 47
eH2_8                 1.725314e-01 1 1  ON 48
eH2_9                 3.968156e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9259e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.225041
====================================================
  Execution time = 2.3060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.8921e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389171841432
                                         uncertainty =       0.053732421058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.389171841432
                                         uncertainty =       0.053732421058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000441138817
  error estimate for blocks of size 2^( 2) =       0.000452792277
  error estimate for blocks of size 2^( 3) =       0.000464195843
  error estimate for blocks of size 2^( 4) =       0.000476125451
  error estimate for blocks of size 2^( 5) =       0.000485602668
  error estimate for blocks of size 2^( 6) =       0.000491227636
  error estimate for blocks of size 2^( 7) =       0.000495844792

      target function =                  N/A
              le_mean =     -16.925287174704
             les_mean =     286.854552663736
             stat err =       0.000487200137
             autocorr =       1.219731540602
              std dev =       0.623864498226
             le_variance =       0.389206912146


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692528717470e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287174704       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925289302523       residual = 8.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925289009380       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925290391567       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925291365114       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925291552566       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925291947056       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925291863444       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.925292113369       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.925292065149       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.990748e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287174704       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925287766379       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925287684286       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925288146016       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925288340707       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925288358938       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925288490449       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925288457521       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.925288505561       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.319717e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925287174704       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925287326894       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925287305858       residual = 4.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925287431544       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925287474690       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925287478110       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925287512606       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925287503653       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.344281e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8639e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.100590e-01 1 1  ON 0
 uu_1                 1.440900e-01 1 1  ON 1
 uu_2                 4.325593e-02 1 1  ON 2
 uu_3                -1.910997e-02 1 1  ON 3
 uu_4                -6.438983e-02 1 1  ON 4
 uu_5                -9.785592e-02 1 1  ON 5
 uu_6                -1.245851e-01 1 1  ON 6
 uu_7                -1.383392e-01 1 1  ON 7
 uu_8                -1.323212e-01 1 1  ON 8
 uu_9                -1.024575e-01 1 1  ON 9
 ud_0                 4.377304e-01 1 1  ON 10
 ud_1                 1.719272e-01 1 1  ON 11
 ud_2                 5.283981e-02 1 1  ON 12
 ud_3                -1.596923e-02 1 1  ON 13
 ud_4                -6.969183e-02 1 1  ON 14
 ud_5                -1.061863e-01 1 1  ON 15
 ud_6                -1.286898e-01 1 1  ON 16
 ud_7                -1.413784e-01 1 1  ON 17
 ud_8                -1.399457e-01 1 1  ON 18
 ud_9                -1.323785e-01 1 1  ON 19
 eO_0                -7.696431e-01 1 1  ON 20
 eO_1                -4.484929e-01 1 1  ON 21
 eO_2                -2.595617e-02 1 1  ON 22
 eO_3                 2.983093e-01 1 1  ON 23
 eO_4                 5.317812e-01 1 1  ON 24
 eO_5                 4.918193e-01 1 1  ON 25
 eO_6                 2.580278e-01 1 1  ON 26
 eO_7                -4.662827e-02 1 1  ON 27
 eO_8                -2.138788e-01 1 1  ON 28
 eO_9                -7.504444e-02 1 1  ON 29
eH1_0                -2.361868e-01 1 1  ON 30
eH1_1                -1.382748e-01 1 1  ON 31
eH1_2                -9.377200e-02 1 1  ON 32
eH1_3                -3.894150e-02 1 1  ON 33
eH1_4                 5.417184e-03 1 1  ON 34
eH1_5                 3.918757e-02 1 1  ON 35
eH1_6                 9.460001e-02 1 1  ON 36
eH1_7                 1.480184e-01 1 1  ON 37
eH1_8                 1.674382e-01 1 1  ON 38
eH1_9                 5.539565e-02 1 1  ON 39
eH2_0                -2.328019e-01 1 1  ON 40
eH2_1                -1.350750e-01 1 1  ON 41
eH2_2                -9.056810e-02 1 1  ON 42
eH2_3                -3.563633e-02 1 1  ON 43
eH2_4                 8.494278e-03 1 1  ON 44
eH2_5                 4.193258e-02 1 1  ON 45
eH2_6                 9.775318e-02 1 1  ON 46
eH2_7                 1.511738e-01 1 1  ON 47
eH2_8                 1.725818e-01 1 1  ON 48
eH2_9                 3.976530e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9085
    reference variance = 0.354926
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4450e-01
  Total weights = 2.0000e+06
  Execution time = 1.9040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344527180603
                                         uncertainty =       0.005618349511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344527180603
                                         uncertainty =       0.005618349511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415016950
  error estimate for blocks of size 2^( 2) =       0.000427181633
  error estimate for blocks of size 2^( 3) =       0.000439179218
  error estimate for blocks of size 2^( 4) =       0.000450198165
  error estimate for blocks of size 2^( 5) =       0.000459836534
  error estimate for blocks of size 2^( 6) =       0.000466196346
  error estimate for blocks of size 2^( 7) =       0.000470866838

      target function =                  N/A
              le_mean =     -16.925104897500
             les_mean =     286.803653757015
             stat err =       0.000461774471
             autocorr =       1.238021450383
              std dev =       0.586922599573
             le_variance =       0.344478137889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344600134262
                                         uncertainty =       0.005614113310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344600134262
                                         uncertainty =       0.005614113310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415060846
  error estimate for blocks of size 2^( 2) =       0.000427222322
  error estimate for blocks of size 2^( 3) =       0.000439214730
  error estimate for blocks of size 2^( 4) =       0.000450229496
  error estimate for blocks of size 2^( 5) =       0.000459860653
  error estimate for blocks of size 2^( 6) =       0.000466215075
  error estimate for blocks of size 2^( 7) =       0.000470885346

      target function =                  N/A
              le_mean =     -16.925104989868
             les_mean =     286.803729757897
             stat err =       0.000461797643
             autocorr =       1.237883826422
              std dev =       0.586984677928
             le_variance =       0.344551012122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576845637
                                         uncertainty =       0.005615972902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344576845637
                                         uncertainty =       0.005615972902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415046835
  error estimate for blocks of size 2^( 2) =       0.000427209346
  error estimate for blocks of size 2^( 3) =       0.000439203588
  error estimate for blocks of size 2^( 4) =       0.000450220202
  error estimate for blocks of size 2^( 5) =       0.000459854730
  error estimate for blocks of size 2^( 6) =       0.000466211866
  error estimate for blocks of size 2^( 7) =       0.000470882806

      target function =                  N/A
              le_mean =     -16.925104745054
             les_mean =     286.803698210016
             stat err =       0.000461792401
             autocorr =       1.237939300259
              std dev =       0.586964863697
             le_variance =       0.344527751215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344534563146
                                         uncertainty =       0.005618051048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344534563146
                                         uncertainty =       0.005618051048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415021393
  error estimate for blocks of size 2^( 2) =       0.000427185751
  error estimate for blocks of size 2^( 3) =       0.000439182858
  error estimate for blocks of size 2^( 4) =       0.000450201476
  error estimate for blocks of size 2^( 5) =       0.000459839312
  error estimate for blocks of size 2^( 6) =       0.000466198786
  error estimate for blocks of size 2^( 7) =       0.000470869330

      target function =                  N/A
              le_mean =     -16.925104854418
             les_mean =     286.803659674716
             stat err =       0.000461777226
             autocorr =       1.238009715141
              std dev =       0.586928883177
             le_variance =       0.344485513908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925104897500        initial
     6.2500e-01     6.2500e+00             4.9907e-04       -16.925104989868  <--
     2.5000e+00     2.5000e+01             1.3197e-04       -16.925104745054
     1.0000e+01     1.0000e+02             3.3443e-05       -16.925104854418

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0225e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.102885e-01 1 1  ON 0
 uu_1                 1.442990e-01 1 1  ON 1
 uu_2                 4.335601e-02 1 1  ON 2
 uu_3                -1.907517e-02 1 1  ON 3
 uu_4                -6.445634e-02 1 1  ON 4
 uu_5                -9.797173e-02 1 1  ON 5
 uu_6                -1.247083e-01 1 1  ON 6
 uu_7                -1.384658e-01 1 1  ON 7
 uu_8                -1.324529e-01 1 1  ON 8
 uu_9                -1.025776e-01 1 1  ON 9
 ud_0                 4.374844e-01 1 1  ON 10
 ud_1                 1.716748e-01 1 1  ON 11
 ud_2                 5.265225e-02 1 1  ON 12
 ud_3                -1.607857e-02 1 1  ON 13
 ud_4                -6.972792e-02 1 1  ON 14
 ud_5                -1.061284e-01 1 1  ON 15
 ud_6                -1.285147e-01 1 1  ON 16
 ud_7                -1.410858e-01 1 1  ON 17
 ud_8                -1.397567e-01 1 1  ON 18
 ud_9                -1.322725e-01 1 1  ON 19
 eO_0                -7.698882e-01 1 1  ON 20
 eO_1                -4.487279e-01 1 1  ON 21
 eO_2                -2.616967e-02 1 1  ON 22
 eO_3                 2.981768e-01 1 1  ON 23
 eO_4                 5.321483e-01 1 1  ON 24
 eO_5                 4.921796e-01 1 1  ON 25
 eO_6                 2.583029e-01 1 1  ON 26
 eO_7                -4.649687e-02 1 1  ON 27
 eO_8                -2.139850e-01 1 1  ON 28
 eO_9                -7.521663e-02 1 1  ON 29
eH1_0                -2.360839e-01 1 1  ON 30
eH1_1                -1.382384e-01 1 1  ON 31
eH1_2                -9.380916e-02 1 1  ON 32
eH1_3                -3.896294e-02 1 1  ON 33
eH1_4                 5.349983e-03 1 1  ON 34
eH1_5                 3.903946e-02 1 1  ON 35
eH1_6                 9.450383e-02 1 1  ON 36
eH1_7                 1.479811e-01 1 1  ON 37
eH1_8                 1.675542e-01 1 1  ON 38
eH1_9                 5.556448e-02 1 1  ON 39
eH2_0                -2.327481e-01 1 1  ON 40
eH2_1                -1.351361e-01 1 1  ON 41
eH2_2                -9.068220e-02 1 1  ON 42
eH2_3                -3.563596e-02 1 1  ON 43
eH2_4                 8.557900e-03 1 1  ON 44
eH2_5                 4.174347e-02 1 1  ON 45
eH2_6                 9.765447e-02 1 1  ON 46
eH2_7                 1.511004e-01 1 1  ON 47
eH2_8                 1.727332e-01 1 1  ON 48
eH2_9                 4.001762e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8870e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9059
    reference variance = 0.800926
====================================================
  Execution time = 2.1282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346612521866
                                         uncertainty =       0.007291979074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346612521866
                                         uncertainty =       0.007291979074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416254346
  error estimate for blocks of size 2^( 2) =       0.000428637700
  error estimate for blocks of size 2^( 3) =       0.000440681094
  error estimate for blocks of size 2^( 4) =       0.000451578403
  error estimate for blocks of size 2^( 5) =       0.000460285677
  error estimate for blocks of size 2^( 6) =       0.000467838924
  error estimate for blocks of size 2^( 7) =       0.000469908602

      target function =                  N/A
              le_mean =     -16.924894848251
             les_mean =     286.798600811594
             stat err =       0.000462402901
             autocorr =       1.234023811041
              std dev =       0.588672540993
             le_variance =       0.346535360519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692489484825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924894848251       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924895648712       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924894246332       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924892760973       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924898704805       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924900124111       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924901286318       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924901740262       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924901561600       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924901404384       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924901924430       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.924901964945       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.220841e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924894848251       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924895125473       residual = 6.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924894695327       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924893581178       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924895417480       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924895969491       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924896314180       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924896299906       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924896183834       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924896188753       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.848353e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924894848251       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924894924944       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924894815632       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924894415423       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924894856538       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924894960656       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924895092305       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924895074079       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924895052027       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.479674e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.016620 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6879e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.106176e-01 1 1  ON 0
 uu_1                 1.444458e-01 1 1  ON 1
 uu_2                 4.349724e-02 1 1  ON 2
 uu_3                -1.905224e-02 1 1  ON 3
 uu_4                -6.449047e-02 1 1  ON 4
 uu_5                -9.814777e-02 1 1  ON 5
 uu_6                -1.246851e-01 1 1  ON 6
 uu_7                -1.383997e-01 1 1  ON 7
 uu_8                -1.326808e-01 1 1  ON 8
 uu_9                -1.029130e-01 1 1  ON 9
 ud_0                 4.370958e-01 1 1  ON 10
 ud_1                 1.713728e-01 1 1  ON 11
 ud_2                 5.258582e-02 1 1  ON 12
 ud_3                -1.604592e-02 1 1  ON 13
 ud_4                -6.965707e-02 1 1  ON 14
 ud_5                -1.059947e-01 1 1  ON 15
 ud_6                -1.283938e-01 1 1  ON 16
 ud_7                -1.408615e-01 1 1  ON 17
 ud_8                -1.395875e-01 1 1  ON 18
 ud_9                -1.322112e-01 1 1  ON 19
 eO_0                -7.700518e-01 1 1  ON 20
 eO_1                -4.490281e-01 1 1  ON 21
 eO_2                -2.657331e-02 1 1  ON 22
 eO_3                 2.978954e-01 1 1  ON 23
 eO_4                 5.325408e-01 1 1  ON 24
 eO_5                 4.927645e-01 1 1  ON 25
 eO_6                 2.588173e-01 1 1  ON 26
 eO_7                -4.625874e-02 1 1  ON 27
 eO_8                -2.142607e-01 1 1  ON 28
 eO_9                -7.547530e-02 1 1  ON 29
eH1_0                -2.358740e-01 1 1  ON 30
eH1_1                -1.382363e-01 1 1  ON 31
eH1_2                -9.373823e-02 1 1  ON 32
eH1_3                -3.900842e-02 1 1  ON 33
eH1_4                 5.062386e-03 1 1  ON 34
eH1_5                 3.883028e-02 1 1  ON 35
eH1_6                 9.443098e-02 1 1  ON 36
eH1_7                 1.479825e-01 1 1  ON 37
eH1_8                 1.677293e-01 1 1  ON 38
eH1_9                 5.574523e-02 1 1  ON 39
eH2_0                -2.326530e-01 1 1  ON 40
eH2_1                -1.350318e-01 1 1  ON 41
eH2_2                -9.063841e-02 1 1  ON 42
eH2_3                -3.573601e-02 1 1  ON 43
eH2_4                 8.370153e-03 1 1  ON 44
eH2_5                 4.149679e-02 1 1  ON 45
eH2_6                 9.754144e-02 1 1  ON 46
eH2_7                 1.510725e-01 1 1  ON 47
eH2_8                 1.729022e-01 1 1  ON 48
eH2_9                 4.031645e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9188
    reference variance = 0.346731
====================================================
  Execution time = 2.1193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3505e-01
  Total weights = 2.0000e+06
  Execution time = 1.9008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256593849
                                         uncertainty =       0.003771209280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335256593849
                                         uncertainty =       0.003771209280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409392596
  error estimate for blocks of size 2^( 2) =       0.000421348456
  error estimate for blocks of size 2^( 3) =       0.000433703587
  error estimate for blocks of size 2^( 4) =       0.000444377907
  error estimate for blocks of size 2^( 5) =       0.000453298763
  error estimate for blocks of size 2^( 6) =       0.000460284057
  error estimate for blocks of size 2^( 7) =       0.000461720802

      target function =                  N/A
              le_mean =     -16.924981648550
             les_mean =     286.790208231736
             stat err =       0.000454920382
             autocorr =       1.234783514565
              std dev =       0.578968561830
             le_variance =       0.335204595587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334895585896
                                         uncertainty =       0.003769691947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334895585896
                                         uncertainty =       0.003769691947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409172194
  error estimate for blocks of size 2^( 2) =       0.000421137657
  error estimate for blocks of size 2^( 3) =       0.000433499560
  error estimate for blocks of size 2^( 4) =       0.000444172602
  error estimate for blocks of size 2^( 5) =       0.000453087192
  error estimate for blocks of size 2^( 6) =       0.000460047137
  error estimate for blocks of size 2^( 7) =       0.000461475650

      target function =                  N/A
              le_mean =     -16.924982688968
             les_mean =     286.789882622545
             stat err =       0.000454695645
             autocorr =       1.234893102388
              std dev =       0.578656865607
             le_variance =       0.334843768115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945897506
                                         uncertainty =       0.003770378532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334945897506
                                         uncertainty =       0.003770378532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409202932
  error estimate for blocks of size 2^( 2) =       0.000421167757
  error estimate for blocks of size 2^( 3) =       0.000433531501
  error estimate for blocks of size 2^( 4) =       0.000444207889
  error estimate for blocks of size 2^( 5) =       0.000453127249
  error estimate for blocks of size 2^( 6) =       0.000460096661
  error estimate for blocks of size 2^( 7) =       0.000461523654

      target function =                  N/A
              le_mean =     -16.924981900759
             les_mean =     286.789906252071
             stat err =       0.000454738863
             autocorr =       1.234942312805
              std dev =       0.578700335667
             le_variance =       0.334894078501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335202923306
                                         uncertainty =       0.003771115289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335202923306
                                         uncertainty =       0.003771115289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409359838
  error estimate for blocks of size 2^( 2) =       0.000421317270
  error estimate for blocks of size 2^( 3) =       0.000433674003
  error estimate for blocks of size 2^( 4) =       0.000444348826
  error estimate for blocks of size 2^( 5) =       0.000453269611
  error estimate for blocks of size 2^( 6) =       0.000460252797
  error estimate for blocks of size 2^( 7) =       0.000461687642

      target function =                  N/A
              le_mean =     -16.924981474172
             les_mean =     286.790148686799
             stat err =       0.000454889719
             autocorr =       1.234814667095
              std dev =       0.578922234259
             le_variance =       0.335150953319


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924981648550        initial
     1.5625e-01     1.5625e+00             2.2208e-03       -16.924982688968  <--
     6.2500e-01     6.2500e+00             5.8484e-04       -16.924981900759
     2.5000e+00     2.5000e+01             1.4797e-04       -16.924981474172

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0789e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.112087e-01 1 1  ON 0
 uu_1                 1.448335e-01 1 1  ON 1
 uu_2                 4.384764e-02 1 1  ON 2
 uu_3                -1.887996e-02 1 1  ON 3
 uu_4                -6.447614e-02 1 1  ON 4
 uu_5                -9.839106e-02 1 1  ON 5
 uu_6                -1.247266e-01 1 1  ON 6
 uu_7                -1.383201e-01 1 1  ON 7
 uu_8                -1.332012e-01 1 1  ON 8
 uu_9                -1.038313e-01 1 1  ON 9
 ud_0                 4.363884e-01 1 1  ON 10
 ud_1                 1.708691e-01 1 1  ON 11
 ud_2                 5.231869e-02 1 1  ON 12
 ud_3                -1.609178e-02 1 1  ON 13
 ud_4                -6.961442e-02 1 1  ON 14
 ud_5                -1.058211e-01 1 1  ON 15
 ud_6                -1.281743e-01 1 1  ON 16
 ud_7                -1.403749e-01 1 1  ON 17
 ud_8                -1.390592e-01 1 1  ON 18
 ud_9                -1.319807e-01 1 1  ON 19
 eO_0                -7.708241e-01 1 1  ON 20
 eO_1                -4.498647e-01 1 1  ON 21
 eO_2                -2.750626e-02 1 1  ON 22
 eO_3                 2.973371e-01 1 1  ON 23
 eO_4                 5.334445e-01 1 1  ON 24
 eO_5                 4.944005e-01 1 1  ON 25
 eO_6                 2.603456e-01 1 1  ON 26
 eO_7                -4.554029e-02 1 1  ON 27
 eO_8                -2.150484e-01 1 1  ON 28
 eO_9                -7.623570e-02 1 1  ON 29
eH1_0                -2.354606e-01 1 1  ON 30
eH1_1                -1.381995e-01 1 1  ON 31
eH1_2                -9.365455e-02 1 1  ON 32
eH1_3                -3.910802e-02 1 1  ON 33
eH1_4                 4.543737e-03 1 1  ON 34
eH1_5                 3.819676e-02 1 1  ON 35
eH1_6                 9.414035e-02 1 1  ON 36
eH1_7                 1.479889e-01 1 1  ON 37
eH1_8                 1.682586e-01 1 1  ON 38
eH1_9                 5.628926e-02 1 1  ON 39
eH2_0                -2.324178e-01 1 1  ON 40
eH2_1                -1.348708e-01 1 1  ON 41
eH2_2                -9.058023e-02 1 1  ON 42
eH2_3                -3.594711e-02 1 1  ON 43
eH2_4                 7.970501e-03 1 1  ON 44
eH2_5                 4.082666e-02 1 1  ON 45
eH2_6                 9.715461e-02 1 1  ON 46
eH2_7                 1.509911e-01 1 1  ON 47
eH2_8                 1.734087e-01 1 1  ON 48
eH2_9                 4.120668e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7674e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8982
    reference variance = 0.256793
====================================================
  Execution time = 2.0918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339747309620
                                         uncertainty =       0.003974185985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339747309620
                                         uncertainty =       0.003974185985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412143920
  error estimate for blocks of size 2^( 2) =       0.000425102743
  error estimate for blocks of size 2^( 3) =       0.000438326414
  error estimate for blocks of size 2^( 4) =       0.000449703359
  error estimate for blocks of size 2^( 5) =       0.000460327210
  error estimate for blocks of size 2^( 6) =       0.000468754964
  error estimate for blocks of size 2^( 7) =       0.000473334279

      target function =                  N/A
              le_mean =     -16.924932472362
             les_mean =     286.793064246490
             stat err =       0.000463029953
             autocorr =       1.262177332306
              std dev =       0.582859521965
             le_variance =       0.339725222345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692493247236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932472362       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924938608347       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924941616677       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924945793886       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924939736642       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924943455817       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924945250901       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924949991779       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924950434214       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924953833601       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924956003672       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.924956463873       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.924955418829       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.924956042205       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.924956171825       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.274425e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932472362       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924935916613       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924937035194       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924939151206       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924934385659       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924937241653       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924938455181       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924939243305       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924939185500       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924939693605       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924939721485       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 2.131250e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932472362       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924933722669       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924933990030       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924934705263       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924932891955       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924933685047       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924934125095       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924934122781       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.547808e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6538e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451638e-01 1 1  ON 1
 uu_2                 4.416204e-02 1 1  ON 2
 uu_3                -1.870918e-02 1 1  ON 3
 uu_4                -6.451631e-02 1 1  ON 4
 uu_5                -9.825550e-02 1 1  ON 5
 uu_6                -1.249020e-01 1 1  ON 6
 uu_7                -1.391429e-01 1 1  ON 7
 uu_8                -1.342728e-01 1 1  ON 8
 uu_9                -1.042235e-01 1 1  ON 9
 ud_0                 4.356137e-01 1 1  ON 10
 ud_1                 1.704693e-01 1 1  ON 11
 ud_2                 5.191486e-02 1 1  ON 12
 ud_3                -1.637373e-02 1 1  ON 13
 ud_4                -6.986342e-02 1 1  ON 14
 ud_5                -1.061967e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398967e-01 1 1  ON 17
 ud_8                -1.384238e-01 1 1  ON 18
 ud_9                -1.310347e-01 1 1  ON 19
 eO_0                -7.720582e-01 1 1  ON 20
 eO_1                -4.509248e-01 1 1  ON 21
 eO_2                -2.863490e-02 1 1  ON 22
 eO_3                 2.971258e-01 1 1  ON 23
 eO_4                 5.342106e-01 1 1  ON 24
 eO_5                 4.965317e-01 1 1  ON 25
 eO_6                 2.621971e-01 1 1  ON 26
 eO_7                -4.497214e-02 1 1  ON 27
 eO_8                -2.159364e-01 1 1  ON 28
 eO_9                -7.696664e-02 1 1  ON 29
eH1_0                -2.352129e-01 1 1  ON 30
eH1_1                -1.385854e-01 1 1  ON 31
eH1_2                -9.410785e-02 1 1  ON 32
eH1_3                -3.935821e-02 1 1  ON 33
eH1_4                 4.008600e-03 1 1  ON 34
eH1_5                 3.752045e-02 1 1  ON 35
eH1_6                 9.331258e-02 1 1  ON 36
eH1_7                 1.483135e-01 1 1  ON 37
eH1_8                 1.694804e-01 1 1  ON 38
eH1_9                 5.749613e-02 1 1  ON 39
eH2_0                -2.322654e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069395e-02 1 1  ON 42
eH2_3                -3.603600e-02 1 1  ON 43
eH2_4                 7.940621e-03 1 1  ON 44
eH2_5                 4.077635e-02 1 1  ON 45
eH2_6                 9.629636e-02 1 1  ON 46
eH2_7                 1.506127e-01 1 1  ON 47
eH2_8                 1.740840e-01 1 1  ON 48
eH2_9                 4.222148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.911
    reference variance = 0.215285
====================================================
  Execution time = 2.0747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3369e-01
  Total weights = 2.0000e+06
  Execution time = 1.9075e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699020139
                                         uncertainty =       0.003223231963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699020139
                                         uncertainty =       0.003223231963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569651
  error estimate for blocks of size 2^( 2) =       0.000420818302
  error estimate for blocks of size 2^( 3) =       0.000433005993
  error estimate for blocks of size 2^( 4) =       0.000444193522
  error estimate for blocks of size 2^( 5) =       0.000453525174
  error estimate for blocks of size 2^( 6) =       0.000459978404
  error estimate for blocks of size 2^( 7) =       0.000463748672

      target function =                  N/A
              le_mean =     -16.925105075801
             les_mean =     286.793039980099
             stat err =       0.000455361443
             autocorr =       1.242167896214
              std dev =       0.577804742220
             le_variance =       0.333858320132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333714739285
                                         uncertainty =       0.003221573153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333714739285
                                         uncertainty =       0.003221573153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408579323
  error estimate for blocks of size 2^( 2) =       0.000420835304
  error estimate for blocks of size 2^( 3) =       0.000433014514
  error estimate for blocks of size 2^( 4) =       0.000444172718
  error estimate for blocks of size 2^( 5) =       0.000453475454
  error estimate for blocks of size 2^( 6) =       0.000459888000
  error estimate for blocks of size 2^( 7) =       0.000463623343

      target function =                  N/A
              le_mean =     -16.925104539878
             les_mean =     286.793037645038
             stat err =       0.000455289879
             autocorr =       1.241718704643
              std dev =       0.577818419725
             le_variance =       0.333874126174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333377311911
                                         uncertainty =       0.003218931042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333377311911
                                         uncertainty =       0.003218931042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408372750
  error estimate for blocks of size 2^( 2) =       0.000420636259
  error estimate for blocks of size 2^( 3) =       0.000432828800
  error estimate for blocks of size 2^( 4) =       0.000444000770
  error estimate for blocks of size 2^( 5) =       0.000453320987
  error estimate for blocks of size 2^( 6) =       0.000459752637
  error estimate for blocks of size 2^( 7) =       0.000463490248

      target function =                  N/A
              le_mean =     -16.925106809683
             les_mean =     286.792776957504
             stat err =       0.000455141160
             autocorr =       1.242163364421
              std dev =       0.577526280877
             le_variance =       0.333536605104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333584905654
                                         uncertainty =       0.003221938929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333584905654
                                         uncertainty =       0.003221938929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408499792
  error estimate for blocks of size 2^( 2) =       0.000420752221
  error estimate for blocks of size 2^( 3) =       0.000432942198
  error estimate for blocks of size 2^( 4) =       0.000444127888
  error estimate for blocks of size 2^( 5) =       0.000453458857
  error estimate for blocks of size 2^( 6) =       0.000459909941
  error estimate for blocks of size 2^( 7) =       0.000463673521

      target function =                  N/A
              le_mean =     -16.925104952310
             les_mean =     286.792921639197
             stat err =       0.000455292552
             autocorr =       1.242216840311
              std dev =       0.577705945409
             le_variance =       0.333744159361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925105075801        initial
     3.9062e-02     3.9062e-01             7.2744e-03       -16.925104539878
     1.5625e-01     1.5625e+00             2.1312e-03       -16.925106809683  <--
     6.2500e-01     6.2500e+00             5.5478e-04       -16.925104952310

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0373e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451638e-01 1 1  ON 1
 uu_2                 4.416204e-02 1 1  ON 2
 uu_3                -1.870918e-02 1 1  ON 3
 uu_4                -6.451631e-02 1 1  ON 4
 uu_5                -9.825550e-02 1 1  ON 5
 uu_6                -1.249020e-01 1 1  ON 6
 uu_7                -1.391429e-01 1 1  ON 7
 uu_8                -1.342728e-01 1 1  ON 8
 uu_9                -1.042235e-01 1 1  ON 9
 ud_0                 4.356137e-01 1 1  ON 10
 ud_1                 1.704693e-01 1 1  ON 11
 ud_2                 5.191486e-02 1 1  ON 12
 ud_3                -1.637373e-02 1 1  ON 13
 ud_4                -6.986342e-02 1 1  ON 14
 ud_5                -1.061967e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398967e-01 1 1  ON 17
 ud_8                -1.384238e-01 1 1  ON 18
 ud_9                -1.310347e-01 1 1  ON 19
 eO_0                -7.720582e-01 1 1  ON 20
 eO_1                -4.509248e-01 1 1  ON 21
 eO_2                -2.863490e-02 1 1  ON 22
 eO_3                 2.971258e-01 1 1  ON 23
 eO_4                 5.342106e-01 1 1  ON 24
 eO_5                 4.965317e-01 1 1  ON 25
 eO_6                 2.621971e-01 1 1  ON 26
 eO_7                -4.497214e-02 1 1  ON 27
 eO_8                -2.159364e-01 1 1  ON 28
 eO_9                -7.696664e-02 1 1  ON 29
eH1_0                -2.352129e-01 1 1  ON 30
eH1_1                -1.385854e-01 1 1  ON 31
eH1_2                -9.410785e-02 1 1  ON 32
eH1_3                -3.935821e-02 1 1  ON 33
eH1_4                 4.008600e-03 1 1  ON 34
eH1_5                 3.752045e-02 1 1  ON 35
eH1_6                 9.331258e-02 1 1  ON 36
eH1_7                 1.483135e-01 1 1  ON 37
eH1_8                 1.694804e-01 1 1  ON 38
eH1_9                 5.749613e-02 1 1  ON 39
eH2_0                -2.322654e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069395e-02 1 1  ON 42
eH2_3                -3.603600e-02 1 1  ON 43
eH2_4                 7.940621e-03 1 1  ON 44
eH2_5                 4.077635e-02 1 1  ON 45
eH2_6                 9.629636e-02 1 1  ON 46
eH2_7                 1.506127e-01 1 1  ON 47
eH2_8                 1.740840e-01 1 1  ON 48
eH2_9                 4.222148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6917e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9549
    reference variance = 0.341507
====================================================
  Execution time = 2.1073e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.5052e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350662474547
                                         uncertainty =       0.005792239056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350662474547
                                         uncertainty =       0.005792239056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418640483
  error estimate for blocks of size 2^( 2) =       0.000431049269
  error estimate for blocks of size 2^( 3) =       0.000443233922
  error estimate for blocks of size 2^( 4) =       0.000454725874
  error estimate for blocks of size 2^( 5) =       0.000464694231
  error estimate for blocks of size 2^( 6) =       0.000471149289
  error estimate for blocks of size 2^( 7) =       0.000474819256

      target function =                  N/A
              le_mean =     -16.924523849928
             les_mean =     286.790027079993
             stat err =       0.000466347163
             autocorr =       1.240898419004
              std dev =       0.592047049208
             le_variance =       0.350519708475


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692452384993e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924523849928       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924524838306       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924527128233       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924525450363       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924524496488       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924528687482       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924529052570       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924531281712       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924532205391       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924532239129       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.924531890088       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.924532591673       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.924532021213       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.924531842794       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.924532085002       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 7.265858e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924523849928       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924524433591       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924525552294       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924525052152       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924524905559       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924526641193       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924525841208       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924526357882       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924526559901       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.924526387463       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.997366e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924523849928       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924524071189       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924524499737       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924524451069       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924524586397       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924524668375       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924524590133       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924524592054       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.924524646240       residual = 1.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 5.137088e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6733e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.117919e-01 1 1  ON 0
 uu_1                 1.454741e-01 1 1  ON 1
 uu_2                 4.440412e-02 1 1  ON 2
 uu_3                -1.843321e-02 1 1  ON 3
 uu_4                -6.452222e-02 1 1  ON 4
 uu_5                -9.837822e-02 1 1  ON 5
 uu_6                -1.253214e-01 1 1  ON 6
 uu_7                -1.389322e-01 1 1  ON 7
 uu_8                -1.344296e-01 1 1  ON 8
 uu_9                -1.050997e-01 1 1  ON 9
 ud_0                 4.355017e-01 1 1  ON 10
 ud_1                 1.703329e-01 1 1  ON 11
 ud_2                 5.177403e-02 1 1  ON 12
 ud_3                -1.659272e-02 1 1  ON 13
 ud_4                -6.994769e-02 1 1  ON 14
 ud_5                -1.062776e-01 1 1  ON 15
 ud_6                -1.280945e-01 1 1  ON 16
 ud_7                -1.396076e-01 1 1  ON 17
 ud_8                -1.382686e-01 1 1  ON 18
 ud_9                -1.308647e-01 1 1  ON 19
 eO_0                -7.730751e-01 1 1  ON 20
 eO_1                -4.519377e-01 1 1  ON 21
 eO_2                -2.927755e-02 1 1  ON 22
 eO_3                 2.966963e-01 1 1  ON 23
 eO_4                 5.348541e-01 1 1  ON 24
 eO_5                 4.983225e-01 1 1  ON 25
 eO_6                 2.641944e-01 1 1  ON 26
 eO_7                -4.444604e-02 1 1  ON 27
 eO_8                -2.168954e-01 1 1  ON 28
 eO_9                -7.778260e-02 1 1  ON 29
eH1_0                -2.352647e-01 1 1  ON 30
eH1_1                -1.386712e-01 1 1  ON 31
eH1_2                -9.422275e-02 1 1  ON 32
eH1_3                -3.962492e-02 1 1  ON 33
eH1_4                 3.687219e-03 1 1  ON 34
eH1_5                 3.710021e-02 1 1  ON 35
eH1_6                 9.271595e-02 1 1  ON 36
eH1_7                 1.485152e-01 1 1  ON 37
eH1_8                 1.702022e-01 1 1  ON 38
eH1_9                 5.844998e-02 1 1  ON 39
eH2_0                -2.325972e-01 1 1  ON 40
eH2_1                -1.351993e-01 1 1  ON 41
eH2_2                -9.065177e-02 1 1  ON 42
eH2_3                -3.639235e-02 1 1  ON 43
eH2_4                 7.416916e-03 1 1  ON 44
eH2_5                 4.015093e-02 1 1  ON 45
eH2_6                 9.578547e-02 1 1  ON 46
eH2_7                 1.509499e-01 1 1  ON 47
eH2_8                 1.749292e-01 1 1  ON 48
eH2_9                 4.325582e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0481
    reference variance = 0.654929
====================================================
  Execution time = 2.0791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3929e-01
  Total weights = 2.0000e+06
  Execution time = 1.8964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339327059108
                                         uncertainty =       0.003776178387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339327059108
                                         uncertainty =       0.003776178387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411891305
  error estimate for blocks of size 2^( 2) =       0.000423779447
  error estimate for blocks of size 2^( 3) =       0.000436260808
  error estimate for blocks of size 2^( 4) =       0.000447432564
  error estimate for blocks of size 2^( 5) =       0.000456124387
  error estimate for blocks of size 2^( 6) =       0.000463089409
  error estimate for blocks of size 2^( 7) =       0.000465996294

      target function =                  N/A
              le_mean =     -16.925221666391
             les_mean =     286.802437181557
             stat err =       0.000458160664
             autocorr =       1.237286713599
              std dev =       0.582502270172
             le_variance =       0.339308894755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339527967407
                                         uncertainty =       0.003777134263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339527967407
                                         uncertainty =       0.003777134263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412013328
  error estimate for blocks of size 2^( 2) =       0.000423899710
  error estimate for blocks of size 2^( 3) =       0.000436368321
  error estimate for blocks of size 2^( 4) =       0.000447528485
  error estimate for blocks of size 2^( 5) =       0.000456206615
  error estimate for blocks of size 2^( 6) =       0.000463159120
  error estimate for blocks of size 2^( 7) =       0.000466050379

      target function =                  N/A
              le_mean =     -16.925217392558
             les_mean =     286.802493579958
             stat err =       0.000458236150
             autocorr =       1.236961449944
              std dev =       0.582674835866
             le_variance =       0.339509964351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339288554108
                                         uncertainty =       0.003773041585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339288554108
                                         uncertainty =       0.003773041585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411868040
  error estimate for blocks of size 2^( 2) =       0.000423757987
  error estimate for blocks of size 2^( 3) =       0.000436235961
  error estimate for blocks of size 2^( 4) =       0.000447408585
  error estimate for blocks of size 2^( 5) =       0.000456100907
  error estimate for blocks of size 2^( 6) =       0.000463056935
  error estimate for blocks of size 2^( 7) =       0.000465957127

      target function =                  N/A
              le_mean =     -16.925216345112
             les_mean =     286.802218723213
             stat err =       0.000458130889
             autocorr =       1.237265671259
              std dev =       0.582469367433
             le_variance =       0.339270563997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339297553243
                                         uncertainty =       0.003775174334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339297553243
                                         uncertainty =       0.003775174334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411873415
  error estimate for blocks of size 2^( 2) =       0.000423762065
  error estimate for blocks of size 2^( 3) =       0.000436243230
  error estimate for blocks of size 2^( 4) =       0.000447415839
  error estimate for blocks of size 2^( 5) =       0.000456109387
  error estimate for blocks of size 2^( 6) =       0.000463072520
  error estimate for blocks of size 2^( 7) =       0.000465979157

      target function =                  N/A
              le_mean =     -16.925220187867
             les_mean =     286.802357658603
             stat err =       0.000458144226
             autocorr =       1.237305412962
              std dev =       0.582476969897
             le_variance =       0.339279420460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925221666391        initial  <--
     3.9062e-02     3.9062e-01             7.2659e-03       -16.925217392558
     1.5625e-01     1.5625e+00             1.9974e-03       -16.925216345112
     6.2500e-01     6.2500e+00             5.1371e-04       -16.925220187867

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4008
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451638e-01 1 1  ON 1
 uu_2                 4.416204e-02 1 1  ON 2
 uu_3                -1.870918e-02 1 1  ON 3
 uu_4                -6.451631e-02 1 1  ON 4
 uu_5                -9.825550e-02 1 1  ON 5
 uu_6                -1.249020e-01 1 1  ON 6
 uu_7                -1.391429e-01 1 1  ON 7
 uu_8                -1.342728e-01 1 1  ON 8
 uu_9                -1.042235e-01 1 1  ON 9
 ud_0                 4.356137e-01 1 1  ON 10
 ud_1                 1.704693e-01 1 1  ON 11
 ud_2                 5.191486e-02 1 1  ON 12
 ud_3                -1.637373e-02 1 1  ON 13
 ud_4                -6.986342e-02 1 1  ON 14
 ud_5                -1.061967e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398967e-01 1 1  ON 17
 ud_8                -1.384238e-01 1 1  ON 18
 ud_9                -1.310347e-01 1 1  ON 19
 eO_0                -7.720582e-01 1 1  ON 20
 eO_1                -4.509248e-01 1 1  ON 21
 eO_2                -2.863490e-02 1 1  ON 22
 eO_3                 2.971258e-01 1 1  ON 23
 eO_4                 5.342106e-01 1 1  ON 24
 eO_5                 4.965317e-01 1 1  ON 25
 eO_6                 2.621971e-01 1 1  ON 26
 eO_7                -4.497214e-02 1 1  ON 27
 eO_8                -2.159364e-01 1 1  ON 28
 eO_9                -7.696664e-02 1 1  ON 29
eH1_0                -2.352129e-01 1 1  ON 30
eH1_1                -1.385854e-01 1 1  ON 31
eH1_2                -9.410785e-02 1 1  ON 32
eH1_3                -3.935821e-02 1 1  ON 33
eH1_4                 4.008600e-03 1 1  ON 34
eH1_5                 3.752045e-02 1 1  ON 35
eH1_6                 9.331258e-02 1 1  ON 36
eH1_7                 1.483135e-01 1 1  ON 37
eH1_8                 1.694804e-01 1 1  ON 38
eH1_9                 5.749613e-02 1 1  ON 39
eH2_0                -2.322654e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069395e-02 1 1  ON 42
eH2_3                -3.603600e-02 1 1  ON 43
eH2_4                 7.940621e-03 1 1  ON 44
eH2_5                 4.077635e-02 1 1  ON 45
eH2_6                 9.629636e-02 1 1  ON 46
eH2_7                 1.506127e-01 1 1  ON 47
eH2_8                 1.740840e-01 1 1  ON 48
eH2_9                 4.222148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9887
    reference variance = 0.718832
====================================================
  Execution time = 2.0996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341139492521
                                         uncertainty =       0.003735667129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341139492521
                                         uncertainty =       0.003735667129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413008460
  error estimate for blocks of size 2^( 2) =       0.000425620419
  error estimate for blocks of size 2^( 3) =       0.000437930378
  error estimate for blocks of size 2^( 4) =       0.000449074787
  error estimate for blocks of size 2^( 5) =       0.000458488246
  error estimate for blocks of size 2^( 6) =       0.000464976998
  error estimate for blocks of size 2^( 7) =       0.000471531651

      target function =                  N/A
              le_mean =     -16.925203446443
             les_mean =     286.803663508747
             stat err =       0.000461017920
             autocorr =       1.245999073978
              std dev =       0.584082165327
             le_variance =       0.341151975853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692520344644e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925203446443       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925203548897       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925202261516       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925202692313       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925202516988       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925202383472       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925203574031       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925203456463       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.925203625904       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.629043e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925203446443       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925203475530       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925203003194       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925203146334       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925202963565       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925202935274       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925203187447       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925203201183       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.183725e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925203446443       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925203453969       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925203320103       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925203357268       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925203295556       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925203289133       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925203341724       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925203345531       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 5.503016e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.029826 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7244e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.117503e-01 1 1  ON 0
 uu_1                 1.452445e-01 1 1  ON 1
 uu_2                 4.422557e-02 1 1  ON 2
 uu_3                -1.867396e-02 1 1  ON 3
 uu_4                -6.450901e-02 1 1  ON 4
 uu_5                -9.830006e-02 1 1  ON 5
 uu_6                -1.249681e-01 1 1  ON 6
 uu_7                -1.391769e-01 1 1  ON 7
 uu_8                -1.343122e-01 1 1  ON 8
 uu_9                -1.042924e-01 1 1  ON 9
 ud_0                 4.355752e-01 1 1  ON 10
 ud_1                 1.703583e-01 1 1  ON 11
 ud_2                 5.186417e-02 1 1  ON 12
 ud_3                -1.644379e-02 1 1  ON 13
 ud_4                -6.991313e-02 1 1  ON 14
 ud_5                -1.062014e-01 1 1  ON 15
 ud_6                -1.280337e-01 1 1  ON 16
 ud_7                -1.398364e-01 1 1  ON 17
 ud_8                -1.383332e-01 1 1  ON 18
 ud_9                -1.309172e-01 1 1  ON 19
 eO_0                -7.722009e-01 1 1  ON 20
 eO_1                -4.510105e-01 1 1  ON 21
 eO_2                -2.871040e-02 1 1  ON 22
 eO_3                 2.970525e-01 1 1  ON 23
 eO_4                 5.343225e-01 1 1  ON 24
 eO_5                 4.966757e-01 1 1  ON 25
 eO_6                 2.624154e-01 1 1  ON 26
 eO_7                -4.490477e-02 1 1  ON 27
 eO_8                -2.160142e-01 1 1  ON 28
 eO_9                -7.704270e-02 1 1  ON 29
eH1_0                -2.351786e-01 1 1  ON 30
eH1_1                -1.385451e-01 1 1  ON 31
eH1_2                -9.412157e-02 1 1  ON 32
eH1_3                -3.938298e-02 1 1  ON 33
eH1_4                 3.982038e-03 1 1  ON 34
eH1_5                 3.744910e-02 1 1  ON 35
eH1_6                 9.323749e-02 1 1  ON 36
eH1_7                 1.483111e-01 1 1  ON 37
eH1_8                 1.695377e-01 1 1  ON 38
eH1_9                 5.756894e-02 1 1  ON 39
eH2_0                -2.322403e-01 1 1  ON 40
eH2_1                -1.352341e-01 1 1  ON 41
eH2_2                -9.070373e-02 1 1  ON 42
eH2_3                -3.607153e-02 1 1  ON 43
eH2_4                 7.898470e-03 1 1  ON 44
eH2_5                 4.069402e-02 1 1  ON 45
eH2_6                 9.621603e-02 1 1  ON 46
eH2_7                 1.506545e-01 1 1  ON 47
eH2_8                 1.741534e-01 1 1  ON 48
eH2_9                 4.234418e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0254
    reference variance = 0.490326
====================================================
  Execution time = 2.0859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4137e-01
  Total weights = 2.0000e+06
  Execution time = 1.8989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429762285
                                         uncertainty =       0.005684185200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341429762285
                                         uncertainty =       0.005684185200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413125004
  error estimate for blocks of size 2^( 2) =       0.000425525919
  error estimate for blocks of size 2^( 3) =       0.000438069049
  error estimate for blocks of size 2^( 4) =       0.000449139300
  error estimate for blocks of size 2^( 5) =       0.000458410143
  error estimate for blocks of size 2^( 6) =       0.000463634089
  error estimate for blocks of size 2^( 7) =       0.000466936135

      target function =                  N/A
              le_mean =     -16.925034494778
             les_mean =     286.798137016196
             stat err =       0.000459529917
             autocorr =       1.237270388251
              std dev =       0.584246983267
             le_variance =       0.341344537456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478306191
                                         uncertainty =       0.005688015793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341478306191
                                         uncertainty =       0.005688015793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413154378
  error estimate for blocks of size 2^( 2) =       0.000425553918
  error estimate for blocks of size 2^( 3) =       0.000438094599
  error estimate for blocks of size 2^( 4) =       0.000449163241
  error estimate for blocks of size 2^( 5) =       0.000458428401
  error estimate for blocks of size 2^( 6) =       0.000463646089
  error estimate for blocks of size 2^( 7) =       0.000466955297

      target function =                  N/A
              le_mean =     -16.925034052745
             les_mean =     286.798170596822
             stat err =       0.000459548257
             autocorr =       1.237193207992
              std dev =       0.584288525415
             le_variance =       0.341393080931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341484469928
                                         uncertainty =       0.005687578070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341484469928
                                         uncertainty =       0.005687578070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413158113
  error estimate for blocks of size 2^( 2) =       0.000425557320
  error estimate for blocks of size 2^( 3) =       0.000438098049
  error estimate for blocks of size 2^( 4) =       0.000449166978
  error estimate for blocks of size 2^( 5) =       0.000458433710
  error estimate for blocks of size 2^( 6) =       0.000463653361
  error estimate for blocks of size 2^( 7) =       0.000466961800

      target function =                  N/A
              le_mean =     -16.925033974381
             les_mean =     286.798174115662
             stat err =       0.000459553962
             autocorr =       1.237201562487
              std dev =       0.584293806573
             le_variance =       0.341399252399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341438951691
                                         uncertainty =       0.005684729014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341438951691
                                         uncertainty =       0.005684729014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413130566
  error estimate for blocks of size 2^( 2) =       0.000425531201
  error estimate for blocks of size 2^( 3) =       0.000438073957
  error estimate for blocks of size 2^( 4) =       0.000449143998
  error estimate for blocks of size 2^( 5) =       0.000458414240
  error estimate for blocks of size 2^( 6) =       0.000463637540
  error estimate for blocks of size 2^( 7) =       0.000466940590

      target function =                  N/A
              le_mean =     -16.925034387959
             les_mean =     286.798142591702
             stat err =       0.000459534092
             autocorr =       1.237259556245
              std dev =       0.584254849177
             le_variance =       0.341353728787


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925034494778        initial  <--
     3.9062e-01     3.9062e+00             8.6290e-04       -16.925034052745
     1.5625e+00     1.5625e+01             2.1837e-04       -16.925033974381
     6.2500e+00     6.2500e+01             5.5030e-05       -16.925034387959

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4923
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451638e-01 1 1  ON 1
 uu_2                 4.416204e-02 1 1  ON 2
 uu_3                -1.870918e-02 1 1  ON 3
 uu_4                -6.451631e-02 1 1  ON 4
 uu_5                -9.825550e-02 1 1  ON 5
 uu_6                -1.249020e-01 1 1  ON 6
 uu_7                -1.391429e-01 1 1  ON 7
 uu_8                -1.342728e-01 1 1  ON 8
 uu_9                -1.042235e-01 1 1  ON 9
 ud_0                 4.356137e-01 1 1  ON 10
 ud_1                 1.704693e-01 1 1  ON 11
 ud_2                 5.191486e-02 1 1  ON 12
 ud_3                -1.637373e-02 1 1  ON 13
 ud_4                -6.986342e-02 1 1  ON 14
 ud_5                -1.061967e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398967e-01 1 1  ON 17
 ud_8                -1.384238e-01 1 1  ON 18
 ud_9                -1.310347e-01 1 1  ON 19
 eO_0                -7.720582e-01 1 1  ON 20
 eO_1                -4.509248e-01 1 1  ON 21
 eO_2                -2.863490e-02 1 1  ON 22
 eO_3                 2.971258e-01 1 1  ON 23
 eO_4                 5.342106e-01 1 1  ON 24
 eO_5                 4.965317e-01 1 1  ON 25
 eO_6                 2.621971e-01 1 1  ON 26
 eO_7                -4.497214e-02 1 1  ON 27
 eO_8                -2.159364e-01 1 1  ON 28
 eO_9                -7.696664e-02 1 1  ON 29
eH1_0                -2.352129e-01 1 1  ON 30
eH1_1                -1.385854e-01 1 1  ON 31
eH1_2                -9.410785e-02 1 1  ON 32
eH1_3                -3.935821e-02 1 1  ON 33
eH1_4                 4.008600e-03 1 1  ON 34
eH1_5                 3.752045e-02 1 1  ON 35
eH1_6                 9.331258e-02 1 1  ON 36
eH1_7                 1.483135e-01 1 1  ON 37
eH1_8                 1.694804e-01 1 1  ON 38
eH1_9                 5.749613e-02 1 1  ON 39
eH2_0                -2.322654e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069395e-02 1 1  ON 42
eH2_3                -3.603600e-02 1 1  ON 43
eH2_4                 7.940621e-03 1 1  ON 44
eH2_5                 4.077635e-02 1 1  ON 45
eH2_6                 9.629636e-02 1 1  ON 46
eH2_7                 1.506127e-01 1 1  ON 47
eH2_8                 1.740840e-01 1 1  ON 48
eH2_9                 4.222148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7742e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6942e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9561
    reference variance = 0.184995
====================================================
  Execution time = 2.3271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341536095739
                                         uncertainty =       0.006218440914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341536095739
                                         uncertainty =       0.006218440914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413382474
  error estimate for blocks of size 2^( 2) =       0.000425673047
  error estimate for blocks of size 2^( 3) =       0.000438190502
  error estimate for blocks of size 2^( 4) =       0.000449683614
  error estimate for blocks of size 2^( 5) =       0.000457525322
  error estimate for blocks of size 2^( 6) =       0.000464973513
  error estimate for blocks of size 2^( 7) =       0.000469338458

      target function =                  N/A
              le_mean =     -16.925272260519
             les_mean =     286.806611061192
             stat err =       0.000460380227
             autocorr =       1.240307029216
              std dev =       0.584611100979
             le_variance =       0.341770139388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692527226052e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925272260519       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925272342057       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925272489521       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925272474089       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925272451480       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925272519685       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925272502750       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925272503677       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.955771e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925272260519       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925272281326       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925272319973       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925272315755       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925272310079       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925272325768       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925272321732       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925272321380       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.989016e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925272260519       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925272265748       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925272275530       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925272274453       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925272273035       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925272276860       residual = 9.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925272275858       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925272275739       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.972996e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8765e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.117666e-01 1 1  ON 0
 uu_1                 1.451700e-01 1 1  ON 1
 uu_2                 4.416803e-02 1 1  ON 2
 uu_3                -1.870496e-02 1 1  ON 3
 uu_4                -6.451072e-02 1 1  ON 4
 uu_5                -9.825617e-02 1 1  ON 5
 uu_6                -1.249036e-01 1 1  ON 6
 uu_7                -1.391485e-01 1 1  ON 7
 uu_8                -1.342762e-01 1 1  ON 8
 uu_9                -1.042311e-01 1 1  ON 9
 ud_0                 4.356023e-01 1 1  ON 10
 ud_1                 1.704613e-01 1 1  ON 11
 ud_2                 5.191359e-02 1 1  ON 12
 ud_3                -1.637825e-02 1 1  ON 13
 ud_4                -6.986426e-02 1 1  ON 14
 ud_5                -1.061938e-01 1 1  ON 15
 ud_6                -1.280488e-01 1 1  ON 16
 ud_7                -1.399006e-01 1 1  ON 17
 ud_8                -1.384235e-01 1 1  ON 18
 ud_9                -1.310231e-01 1 1  ON 19
 eO_0                -7.720755e-01 1 1  ON 20
 eO_1                -4.509286e-01 1 1  ON 21
 eO_2                -2.863949e-02 1 1  ON 22
 eO_3                 2.971157e-01 1 1  ON 23
 eO_4                 5.342188e-01 1 1  ON 24
 eO_5                 4.965505e-01 1 1  ON 25
 eO_6                 2.622169e-01 1 1  ON 26
 eO_7                -4.496418e-02 1 1  ON 27
 eO_8                -2.159458e-01 1 1  ON 28
 eO_9                -7.697489e-02 1 1  ON 29
eH1_0                -2.352125e-01 1 1  ON 30
eH1_1                -1.385852e-01 1 1  ON 31
eH1_2                -9.411490e-02 1 1  ON 32
eH1_3                -3.936105e-02 1 1  ON 33
eH1_4                 4.005691e-03 1 1  ON 34
eH1_5                 3.751678e-02 1 1  ON 35
eH1_6                 9.330876e-02 1 1  ON 36
eH1_7                 1.483119e-01 1 1  ON 37
eH1_8                 1.694905e-01 1 1  ON 38
eH1_9                 5.750735e-02 1 1  ON 39
eH2_0                -2.322671e-01 1 1  ON 40
eH2_1                -1.352087e-01 1 1  ON 41
eH2_2                -9.068659e-02 1 1  ON 42
eH2_3                -3.604077e-02 1 1  ON 43
eH2_4                 7.933732e-03 1 1  ON 44
eH2_5                 4.076915e-02 1 1  ON 45
eH2_6                 9.629087e-02 1 1  ON 46
eH2_7                 1.506104e-01 1 1  ON 47
eH2_8                 1.740913e-01 1 1  ON 48
eH2_9                 4.223440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9124
    reference variance = 0.170182
====================================================
  Execution time = 2.1026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3143e-01
  Total weights = 2.0000e+06
  Execution time = 1.9059e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331501973631
                                         uncertainty =       0.002243727029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331501973631
                                         uncertainty =       0.002243727029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407085079
  error estimate for blocks of size 2^( 2) =       0.000419496240
  error estimate for blocks of size 2^( 3) =       0.000431181123
  error estimate for blocks of size 2^( 4) =       0.000441664198
  error estimate for blocks of size 2^( 5) =       0.000449952307
  error estimate for blocks of size 2^( 6) =       0.000456347192
  error estimate for blocks of size 2^( 7) =       0.000457091483

      target function =                  N/A
              le_mean =     -16.925428669903
             les_mean =     286.801572016871
             stat err =       0.000451263795
             autocorr =       1.228826628559
              std dev =       0.575705239350
             le_variance =       0.331436522615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331467362771
                                         uncertainty =       0.002243371466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331467362771
                                         uncertainty =       0.002243371466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407063848
  error estimate for blocks of size 2^( 2) =       0.000419476036
  error estimate for blocks of size 2^( 3) =       0.000431161518
  error estimate for blocks of size 2^( 4) =       0.000441645008
  error estimate for blocks of size 2^( 5) =       0.000449933013
  error estimate for blocks of size 2^( 6) =       0.000456329293
  error estimate for blocks of size 2^( 7) =       0.000457073708

      target function =                  N/A
              le_mean =     -16.925428575452
             les_mean =     286.801534249990
             stat err =       0.000451245255
             autocorr =       1.228853836035
              std dev =       0.575675214816
             le_variance =       0.331401952954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331483505072
                                         uncertainty =       0.002243540209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331483505072
                                         uncertainty =       0.002243540209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407073750
  error estimate for blocks of size 2^( 2) =       0.000419485460
  error estimate for blocks of size 2^( 3) =       0.000431170664
  error estimate for blocks of size 2^( 4) =       0.000441653988
  error estimate for blocks of size 2^( 5) =       0.000449942063
  error estimate for blocks of size 2^( 6) =       0.000456337708
  error estimate for blocks of size 2^( 7) =       0.000457082067

      target function =                  N/A
              le_mean =     -16.925428623718
             les_mean =     286.801552007154
             stat err =       0.000451253957
             autocorr =       1.228841441764
              std dev =       0.575689218480
             le_variance =       0.331418076274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331499624340
                                         uncertainty =       0.002243703374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331499624340
                                         uncertainty =       0.002243703374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407083638
  error estimate for blocks of size 2^( 2) =       0.000419494868
  error estimate for blocks of size 2^( 3) =       0.000431179793
  error estimate for blocks of size 2^( 4) =       0.000441662899
  error estimate for blocks of size 2^( 5) =       0.000449951005
  error estimate for blocks of size 2^( 6) =       0.000456345987
  error estimate for blocks of size 2^( 7) =       0.000457090287

      target function =                  N/A
              le_mean =     -16.925428663895
             les_mean =     286.801569467029
             stat err =       0.000451262545
             autocorr =       1.228828520553
              std dev =       0.575703201448
             le_variance =       0.331434176158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925428669903        initial  <--
     3.9062e+00     3.9062e+01             7.9558e-05       -16.925428575452
     1.5625e+01     1.5625e+02             1.9890e-05       -16.925428623718
     6.2500e+01     6.2500e+02             4.9730e-06       -16.925428663895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6883
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451638e-01 1 1  ON 1
 uu_2                 4.416204e-02 1 1  ON 2
 uu_3                -1.870918e-02 1 1  ON 3
 uu_4                -6.451631e-02 1 1  ON 4
 uu_5                -9.825550e-02 1 1  ON 5
 uu_6                -1.249020e-01 1 1  ON 6
 uu_7                -1.391429e-01 1 1  ON 7
 uu_8                -1.342728e-01 1 1  ON 8
 uu_9                -1.042235e-01 1 1  ON 9
 ud_0                 4.356137e-01 1 1  ON 10
 ud_1                 1.704693e-01 1 1  ON 11
 ud_2                 5.191486e-02 1 1  ON 12
 ud_3                -1.637373e-02 1 1  ON 13
 ud_4                -6.986342e-02 1 1  ON 14
 ud_5                -1.061967e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398967e-01 1 1  ON 17
 ud_8                -1.384238e-01 1 1  ON 18
 ud_9                -1.310347e-01 1 1  ON 19
 eO_0                -7.720582e-01 1 1  ON 20
 eO_1                -4.509248e-01 1 1  ON 21
 eO_2                -2.863490e-02 1 1  ON 22
 eO_3                 2.971258e-01 1 1  ON 23
 eO_4                 5.342106e-01 1 1  ON 24
 eO_5                 4.965317e-01 1 1  ON 25
 eO_6                 2.621971e-01 1 1  ON 26
 eO_7                -4.497214e-02 1 1  ON 27
 eO_8                -2.159364e-01 1 1  ON 28
 eO_9                -7.696664e-02 1 1  ON 29
eH1_0                -2.352129e-01 1 1  ON 30
eH1_1                -1.385854e-01 1 1  ON 31
eH1_2                -9.410785e-02 1 1  ON 32
eH1_3                -3.935821e-02 1 1  ON 33
eH1_4                 4.008600e-03 1 1  ON 34
eH1_5                 3.752045e-02 1 1  ON 35
eH1_6                 9.331258e-02 1 1  ON 36
eH1_7                 1.483135e-01 1 1  ON 37
eH1_8                 1.694804e-01 1 1  ON 38
eH1_9                 5.749613e-02 1 1  ON 39
eH2_0                -2.322654e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069395e-02 1 1  ON 42
eH2_3                -3.603600e-02 1 1  ON 43
eH2_4                 7.940621e-03 1 1  ON 44
eH2_5                 4.077635e-02 1 1  ON 45
eH2_6                 9.629636e-02 1 1  ON 46
eH2_7                 1.506127e-01 1 1  ON 47
eH2_8                 1.740840e-01 1 1  ON 48
eH2_9                 4.222148e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6941e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9184
    reference variance = 0.151231
====================================================
  Execution time = 2.1212e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3630e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336369505156
                                         uncertainty =       0.003617958819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336369505156
                                         uncertainty =       0.003617958819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410062184
  error estimate for blocks of size 2^( 2) =       0.000422400294
  error estimate for blocks of size 2^( 3) =       0.000435066647
  error estimate for blocks of size 2^( 4) =       0.000447147893
  error estimate for blocks of size 2^( 5) =       0.000456496949
  error estimate for blocks of size 2^( 6) =       0.000464586778
  error estimate for blocks of size 2^( 7) =       0.000471671164

      target function =                  N/A
              le_mean =     -16.924749521399
             les_mean =     286.783448183137
             stat err =       0.000459975696
             autocorr =       1.258259825343
              std dev =       0.579915501767
             le_variance =       0.336301989190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692474952140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924749521399       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924749551676       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924749569533       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924749584435       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924749610811       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924749603635       residual = 8.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924749603853       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924749602558       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 9.462595e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924749521399       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924749528988       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924749533478       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924749537243       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924749543899       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924749542148       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924749542142       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924749541823       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.366628e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924749521399       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924749523297       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924749524422       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924749525366       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924749527033       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924749526598       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924749526592       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924749526515       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 5.917179e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035140 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6782e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.117728e-01 1 1  ON 0
 uu_1                 1.451643e-01 1 1  ON 1
 uu_2                 4.416220e-02 1 1  ON 2
 uu_3                -1.870906e-02 1 1  ON 3
 uu_4                -6.451594e-02 1 1  ON 4
 uu_5                -9.825583e-02 1 1  ON 5
 uu_6                -1.249027e-01 1 1  ON 6
 uu_7                -1.391430e-01 1 1  ON 7
 uu_8                -1.342725e-01 1 1  ON 8
 uu_9                -1.042239e-01 1 1  ON 9
 ud_0                 4.356142e-01 1 1  ON 10
 ud_1                 1.704685e-01 1 1  ON 11
 ud_2                 5.191384e-02 1 1  ON 12
 ud_3                -1.637435e-02 1 1  ON 13
 ud_4                -6.986455e-02 1 1  ON 14
 ud_5                -1.061973e-01 1 1  ON 15
 ud_6                -1.280609e-01 1 1  ON 16
 ud_7                -1.398960e-01 1 1  ON 17
 ud_8                -1.384227e-01 1 1  ON 18
 ud_9                -1.310339e-01 1 1  ON 19
 eO_0                -7.720596e-01 1 1  ON 20
 eO_1                -4.509256e-01 1 1  ON 21
 eO_2                -2.863624e-02 1 1  ON 22
 eO_3                 2.971257e-01 1 1  ON 23
 eO_4                 5.342107e-01 1 1  ON 24
 eO_5                 4.965335e-01 1 1  ON 25
 eO_6                 2.621994e-01 1 1  ON 26
 eO_7                -4.497142e-02 1 1  ON 27
 eO_8                -2.159370e-01 1 1  ON 28
 eO_9                -7.696734e-02 1 1  ON 29
eH1_0                -2.352132e-01 1 1  ON 30
eH1_1                -1.385848e-01 1 1  ON 31
eH1_2                -9.410781e-02 1 1  ON 32
eH1_3                -3.935853e-02 1 1  ON 33
eH1_4                 4.008641e-03 1 1  ON 34
eH1_5                 3.751902e-02 1 1  ON 35
eH1_6                 9.331194e-02 1 1  ON 36
eH1_7                 1.483138e-01 1 1  ON 37
eH1_8                 1.694812e-01 1 1  ON 38
eH1_9                 5.749695e-02 1 1  ON 39
eH2_0                -2.322662e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069409e-02 1 1  ON 42
eH2_3                -3.603579e-02 1 1  ON 43
eH2_4                 7.940277e-03 1 1  ON 44
eH2_5                 4.077576e-02 1 1  ON 45
eH2_6                 9.629599e-02 1 1  ON 46
eH2_7                 1.506125e-01 1 1  ON 47
eH2_8                 1.740848e-01 1 1  ON 48
eH2_9                 4.222279e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8567
    reference variance = 0.289079
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3620e-01
  Total weights = 2.0000e+06
  Execution time = 1.8996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336083502517
                                         uncertainty =       0.003799336458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336083502517
                                         uncertainty =       0.003799336458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409997556
  error estimate for blocks of size 2^( 2) =       0.000422364836
  error estimate for blocks of size 2^( 3) =       0.000434933544
  error estimate for blocks of size 2^( 4) =       0.000446009022
  error estimate for blocks of size 2^( 5) =       0.000454719496
  error estimate for blocks of size 2^( 6) =       0.000462188095
  error estimate for blocks of size 2^( 7) =       0.000464764954

      target function =                  N/A
              le_mean =     -16.925394334308
             les_mean =     286.805169196076
             stat err =       0.000456920392
             autocorr =       1.241991273171
              std dev =       0.579824104656
             le_variance =       0.336195992340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336088420977
                                         uncertainty =       0.003799393266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336088420977
                                         uncertainty =       0.003799393266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410000554
  error estimate for blocks of size 2^( 2) =       0.000422367701
  error estimate for blocks of size 2^( 3) =       0.000434936259
  error estimate for blocks of size 2^( 4) =       0.000446011667
  error estimate for blocks of size 2^( 5) =       0.000454722034
  error estimate for blocks of size 2^( 6) =       0.000462190606
  error estimate for blocks of size 2^( 7) =       0.000464767400

      target function =                  N/A
              le_mean =     -16.925394342364
             les_mean =     286.805174385415
             stat err =       0.000456922927
             autocorr =       1.241986891990
              std dev =       0.579828344406
             le_variance =       0.336200908976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336085983129
                                         uncertainty =       0.003799365084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336085983129
                                         uncertainty =       0.003799365084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409999068
  error estimate for blocks of size 2^( 2) =       0.000422366281
  error estimate for blocks of size 2^( 3) =       0.000434934913
  error estimate for blocks of size 2^( 4) =       0.000446010356
  error estimate for blocks of size 2^( 5) =       0.000454720776
  error estimate for blocks of size 2^( 6) =       0.000462189361
  error estimate for blocks of size 2^( 7) =       0.000464766188

      target function =                  N/A
              le_mean =     -16.925394338377
             les_mean =     286.805171813492
             stat err =       0.000456921670
             autocorr =       1.241989064073
              std dev =       0.579826242968
             le_variance =       0.336198472034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336083813255
                                         uncertainty =       0.003799340044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336083813255
                                         uncertainty =       0.003799340044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409997746
  error estimate for blocks of size 2^( 2) =       0.000422365017
  error estimate for blocks of size 2^( 3) =       0.000434933716
  error estimate for blocks of size 2^( 4) =       0.000446009189
  error estimate for blocks of size 2^( 5) =       0.000454719656
  error estimate for blocks of size 2^( 6) =       0.000462188253
  error estimate for blocks of size 2^( 7) =       0.000464765109

      target function =                  N/A
              le_mean =     -16.925394334816
             les_mean =     286.805169523896
             stat err =       0.000456920552
             autocorr =       1.241990996453
              std dev =       0.579824372516
             le_variance =       0.336196302964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925394334308        initial
     3.9062e+01     3.9062e+02             9.4626e-06       -16.925394342364  <--
     1.5625e+02     1.5625e+03             2.3666e-06       -16.925394338377
     6.2500e+02     6.2500e+03             5.9172e-07       -16.925394334816

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 3.0602e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.117715e-01 1 1  ON 0
 uu_1                 1.451656e-01 1 1  ON 1
 uu_2                 4.416268e-02 1 1  ON 2
 uu_3                -1.870868e-02 1 1  ON 3
 uu_4                -6.451486e-02 1 1  ON 4
 uu_5                -9.825682e-02 1 1  ON 5
 uu_6                -1.249050e-01 1 1  ON 6
 uu_7                -1.391432e-01 1 1  ON 7
 uu_8                -1.342715e-01 1 1  ON 8
 uu_9                -1.042251e-01 1 1  ON 9
 ud_0                 4.356158e-01 1 1  ON 10
 ud_1                 1.704662e-01 1 1  ON 11
 ud_2                 5.191082e-02 1 1  ON 12
 ud_3                -1.637623e-02 1 1  ON 13
 ud_4                -6.986791e-02 1 1  ON 14
 ud_5                -1.061989e-01 1 1  ON 15
 ud_6                -1.280608e-01 1 1  ON 16
 ud_7                -1.398940e-01 1 1  ON 17
 ud_8                -1.384191e-01 1 1  ON 18
 ud_9                -1.310315e-01 1 1  ON 19
 eO_0                -7.720637e-01 1 1  ON 20
 eO_1                -4.509281e-01 1 1  ON 21
 eO_2                -2.864025e-02 1 1  ON 22
 eO_3                 2.971254e-01 1 1  ON 23
 eO_4                 5.342110e-01 1 1  ON 24
 eO_5                 4.965388e-01 1 1  ON 25
 eO_6                 2.622065e-01 1 1  ON 26
 eO_7                -4.496926e-02 1 1  ON 27
 eO_8                -2.159387e-01 1 1  ON 28
 eO_9                -7.696941e-02 1 1  ON 29
eH1_0                -2.352141e-01 1 1  ON 30
eH1_1                -1.385832e-01 1 1  ON 31
eH1_2                -9.410770e-02 1 1  ON 32
eH1_3                -3.935949e-02 1 1  ON 33
eH1_4                 4.008760e-03 1 1  ON 34
eH1_5                 3.751474e-02 1 1  ON 35
eH1_6                 9.331003e-02 1 1  ON 36
eH1_7                 1.483147e-01 1 1  ON 37
eH1_8                 1.694838e-01 1 1  ON 38
eH1_9                 5.749941e-02 1 1  ON 39
eH2_0                -2.322686e-01 1 1  ON 40
eH2_1                -1.352095e-01 1 1  ON 41
eH2_2                -9.069453e-02 1 1  ON 42
eH2_3                -3.603515e-02 1 1  ON 43
eH2_4                 7.939246e-03 1 1  ON 44
eH2_5                 4.077400e-02 1 1  ON 45
eH2_6                 9.629486e-02 1 1  ON 46
eH2_7                 1.506119e-01 1 1  ON 47
eH2_8                 1.740873e-01 1 1  ON 48
eH2_9                 4.222673e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6935e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8379
    reference variance = 0.36198
====================================================
  Execution time = 2.1354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3434e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334395019847
                                         uncertainty =       0.002822161351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334395019847
                                         uncertainty =       0.002822161351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408863338
  error estimate for blocks of size 2^( 2) =       0.000421251728
  error estimate for blocks of size 2^( 3) =       0.000434191095
  error estimate for blocks of size 2^( 4) =       0.000445636118
  error estimate for blocks of size 2^( 5) =       0.000455767602
  error estimate for blocks of size 2^( 6) =       0.000463284961
  error estimate for blocks of size 2^( 7) =       0.000465912951

      target function =                  N/A
              le_mean =     -16.924201705435
             les_mean =     286.762941656681
             stat err =       0.000457650408
             autocorr =       1.252885459306
              std dev =       0.578220077128
             le_variance =       0.334338457594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692420170544e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924201705435       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924201747375       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924201771775       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924201799353       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924201785528       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924201800364       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924201811073       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924201807696       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.275212e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924201705435       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924201716014       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924201722205       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924201729081       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924201725591       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924201729334       residual = 7.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924201731803       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924201730974       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.070167e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924201705435       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924201708086       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924201709640       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924201711357       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924201710483       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924201711421       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924201712025       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924201711819       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.676280e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6866e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.117732e-01 1 1  ON 0
 uu_1                 1.451665e-01 1 1  ON 1
 uu_2                 4.416250e-02 1 1  ON 2
 uu_3                -1.870985e-02 1 1  ON 3
 uu_4                -6.451391e-02 1 1  ON 4
 uu_5                -9.825708e-02 1 1  ON 5
 uu_6                -1.249068e-01 1 1  ON 6
 uu_7                -1.391434e-01 1 1  ON 7
 uu_8                -1.342712e-01 1 1  ON 8
 uu_9                -1.042282e-01 1 1  ON 9
 ud_0                 4.356182e-01 1 1  ON 10
 ud_1                 1.704640e-01 1 1  ON 11
 ud_2                 5.190860e-02 1 1  ON 12
 ud_3                -1.637975e-02 1 1  ON 13
 ud_4                -6.986999e-02 1 1  ON 14
 ud_5                -1.062002e-01 1 1  ON 15
 ud_6                -1.280612e-01 1 1  ON 16
 ud_7                -1.398944e-01 1 1  ON 17
 ud_8                -1.384159e-01 1 1  ON 18
 ud_9                -1.310265e-01 1 1  ON 19
 eO_0                -7.720713e-01 1 1  ON 20
 eO_1                -4.509297e-01 1 1  ON 21
 eO_2                -2.864271e-02 1 1  ON 22
 eO_3                 2.971237e-01 1 1  ON 23
 eO_4                 5.342148e-01 1 1  ON 24
 eO_5                 4.965423e-01 1 1  ON 25
 eO_6                 2.622172e-01 1 1  ON 26
 eO_7                -4.496684e-02 1 1  ON 27
 eO_8                -2.159421e-01 1 1  ON 28
 eO_9                -7.697243e-02 1 1  ON 29
eH1_0                -2.352149e-01 1 1  ON 30
eH1_1                -1.385826e-01 1 1  ON 31
eH1_2                -9.410962e-02 1 1  ON 32
eH1_3                -3.936084e-02 1 1  ON 33
eH1_4                 4.008305e-03 1 1  ON 34
eH1_5                 3.750802e-02 1 1  ON 35
eH1_6                 9.330906e-02 1 1  ON 36
eH1_7                 1.483167e-01 1 1  ON 37
eH1_8                 1.694880e-01 1 1  ON 38
eH1_9                 5.750429e-02 1 1  ON 39
eH2_0                -2.322663e-01 1 1  ON 40
eH2_1                -1.352108e-01 1 1  ON 41
eH2_2                -9.069691e-02 1 1  ON 42
eH2_3                -3.603715e-02 1 1  ON 43
eH2_4                 7.938058e-03 1 1  ON 44
eH2_5                 4.077522e-02 1 1  ON 45
eH2_6                 9.629091e-02 1 1  ON 46
eH2_7                 1.506114e-01 1 1  ON 47
eH2_8                 1.740912e-01 1 1  ON 48
eH2_9                 4.223099e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8153
    reference variance = 0.228018
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.5482e-01
  Total weights = 2.0000e+06
  Execution time = 1.8972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354887676182
                                         uncertainty =       0.015598262871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354887676182
                                         uncertainty =       0.015598262871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421195089
  error estimate for blocks of size 2^( 2) =       0.000433026638
  error estimate for blocks of size 2^( 3) =       0.000445473729
  error estimate for blocks of size 2^( 4) =       0.000456799294
  error estimate for blocks of size 2^( 5) =       0.000465989460
  error estimate for blocks of size 2^( 6) =       0.000470834483
  error estimate for blocks of size 2^( 7) =       0.000475147808

      target function =                  N/A
              le_mean =     -16.924733687720
             les_mean =     286.801420828298
             stat err =       0.000467192761
             autocorr =       1.230341330410
              std dev =       0.595659806819
             le_variance =       0.354810605460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354911723857
                                         uncertainty =       0.015599490945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354911723857
                                         uncertainty =       0.015599490945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421209356
  error estimate for blocks of size 2^( 2) =       0.000433040233
  error estimate for blocks of size 2^( 3) =       0.000445486545
  error estimate for blocks of size 2^( 4) =       0.000456811464
  error estimate for blocks of size 2^( 5) =       0.000466001037
  error estimate for blocks of size 2^( 6) =       0.000470845522
  error estimate for blocks of size 2^( 7) =       0.000475158798

      target function =                  N/A
              le_mean =     -16.924733715058
             les_mean =     286.801445791469
             stat err =       0.000467204205
             autocorr =       1.230318254210
              std dev =       0.595679983943
             le_variance =       0.354834643270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354899982574
                                         uncertainty =       0.015598891825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354899982574
                                         uncertainty =       0.015598891825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421202390
  error estimate for blocks of size 2^( 2) =       0.000433033595
  error estimate for blocks of size 2^( 3) =       0.000445480288
  error estimate for blocks of size 2^( 4) =       0.000456805523
  error estimate for blocks of size 2^( 5) =       0.000465995390
  error estimate for blocks of size 2^( 6) =       0.000470840139
  error estimate for blocks of size 2^( 7) =       0.000475153441

      target function =                  N/A
              le_mean =     -16.924733701609
             les_mean =     286.801433599795
             stat err =       0.000467198623
             autocorr =       1.230329550605
              std dev =       0.595670132560
             le_variance =       0.354822906824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354889223404
                                         uncertainty =       0.015598341967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354889223404
                                         uncertainty =       0.015598341967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421196007
  error estimate for blocks of size 2^( 2) =       0.000433027513
  error estimate for blocks of size 2^( 3) =       0.000445474554
  error estimate for blocks of size 2^( 4) =       0.000456800077
  error estimate for blocks of size 2^( 5) =       0.000465990206
  error estimate for blocks of size 2^( 6) =       0.000470835195
  error estimate for blocks of size 2^( 7) =       0.000475148516

      target function =                  N/A
              le_mean =     -16.924733689440
             les_mean =     286.801422433120
             stat err =       0.000467193498
             autocorr =       1.230339850107
              std dev =       0.595661105034
             le_variance =       0.354812152051


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924733687720        initial
     9.7656e+00     9.7656e+01             4.2752e-05       -16.924733715058  <--
     3.9062e+01     3.9062e+02             1.0702e-05       -16.924733701609
     1.5625e+02     1.5625e+03             2.6763e-06       -16.924733689440

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 3.0401e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451692e-01 1 1  ON 1
 uu_2                 4.416195e-02 1 1  ON 2
 uu_3                -1.871317e-02 1 1  ON 3
 uu_4                -6.451128e-02 1 1  ON 4
 uu_5                -9.825776e-02 1 1  ON 5
 uu_6                -1.249123e-01 1 1  ON 6
 uu_7                -1.391438e-01 1 1  ON 7
 uu_8                -1.342704e-01 1 1  ON 8
 uu_9                -1.042373e-01 1 1  ON 9
 ud_0                 4.356250e-01 1 1  ON 10
 ud_1                 1.704575e-01 1 1  ON 11
 ud_2                 5.190196e-02 1 1  ON 12
 ud_3                -1.639012e-02 1 1  ON 13
 ud_4                -6.987627e-02 1 1  ON 14
 ud_5                -1.062042e-01 1 1  ON 15
 ud_6                -1.280625e-01 1 1  ON 16
 ud_7                -1.398957e-01 1 1  ON 17
 ud_8                -1.384061e-01 1 1  ON 18
 ud_9                -1.310115e-01 1 1  ON 19
 eO_0                -7.720938e-01 1 1  ON 20
 eO_1                -4.509346e-01 1 1  ON 21
 eO_2                -2.865013e-02 1 1  ON 22
 eO_3                 2.971186e-01 1 1  ON 23
 eO_4                 5.342260e-01 1 1  ON 24
 eO_5                 4.965528e-01 1 1  ON 25
 eO_6                 2.622493e-01 1 1  ON 26
 eO_7                -4.495960e-02 1 1  ON 27
 eO_8                -2.159525e-01 1 1  ON 28
 eO_9                -7.698149e-02 1 1  ON 29
eH1_0                -2.352173e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411524e-02 1 1  ON 32
eH1_3                -3.936491e-02 1 1  ON 33
eH1_4                 4.006941e-03 1 1  ON 34
eH1_5                 3.748793e-02 1 1  ON 35
eH1_6                 9.330614e-02 1 1  ON 36
eH1_7                 1.483228e-01 1 1  ON 37
eH1_8                 1.695005e-01 1 1  ON 38
eH1_9                 5.751889e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070392e-02 1 1  ON 42
eH2_3                -3.604315e-02 1 1  ON 43
eH2_4                 7.934490e-03 1 1  ON 44
eH2_5                 4.077882e-02 1 1  ON 45
eH2_6                 9.627911e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741032e-01 1 1  ON 48
eH2_9                 4.224375e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.842
    reference variance = 0.187239
====================================================
  Execution time = 2.0916e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3652e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336577598117
                                         uncertainty =       0.004649649274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336577598117
                                         uncertainty =       0.004649649274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410196168
  error estimate for blocks of size 2^( 2) =       0.000422780291
  error estimate for blocks of size 2^( 3) =       0.000435418351
  error estimate for blocks of size 2^( 4) =       0.000447154558
  error estimate for blocks of size 2^( 5) =       0.000456615900
  error estimate for blocks of size 2^( 6) =       0.000462429361
  error estimate for blocks of size 2^( 7) =       0.000467643506

      target function =                  N/A
              le_mean =     -16.925051468431
             les_mean =     286.793888834042
             stat err =       0.000458460831
             autocorr =       1.249169224739
              std dev =       0.580104984695
             le_variance =       0.336521793268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692505146843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925051468431       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925051795461       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925051801756       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925051747314       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925051525775       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925051592545       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925051641253       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925051700328       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.350999e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925051468431       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925051552577       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925051552521       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925051535356       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925051482208       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925051491426       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925051504815       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925051519105       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.391227e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925051468431       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925051489622       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925051489494       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925051484944       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925051471810       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925051473639       residual = 7.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925051476998       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925051480534       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.487080e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040431 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6418e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.117776e-01 1 1  ON 0
 uu_1                 1.451854e-01 1 1  ON 1
 uu_2                 4.416792e-02 1 1  ON 2
 uu_3                -1.871255e-02 1 1  ON 3
 uu_4                -6.450157e-02 1 1  ON 4
 uu_5                -9.826042e-02 1 1  ON 5
 uu_6                -1.249229e-01 1 1  ON 6
 uu_7                -1.391482e-01 1 1  ON 7
 uu_8                -1.342759e-01 1 1  ON 8
 uu_9                -1.042534e-01 1 1  ON 9
 ud_0                 4.356110e-01 1 1  ON 10
 ud_1                 1.704516e-01 1 1  ON 11
 ud_2                 5.189558e-02 1 1  ON 12
 ud_3                -1.639162e-02 1 1  ON 13
 ud_4                -6.988159e-02 1 1  ON 14
 ud_5                -1.061926e-01 1 1  ON 15
 ud_6                -1.280513e-01 1 1  ON 16
 ud_7                -1.398926e-01 1 1  ON 17
 ud_8                -1.383999e-01 1 1  ON 18
 ud_9                -1.310058e-01 1 1  ON 19
 eO_0                -7.721110e-01 1 1  ON 20
 eO_1                -4.509496e-01 1 1  ON 21
 eO_2                -2.866250e-02 1 1  ON 22
 eO_3                 2.971104e-01 1 1  ON 23
 eO_4                 5.342340e-01 1 1  ON 24
 eO_5                 4.965868e-01 1 1  ON 25
 eO_6                 2.622827e-01 1 1  ON 26
 eO_7                -4.495246e-02 1 1  ON 27
 eO_8                -2.159654e-01 1 1  ON 28
 eO_9                -7.699706e-02 1 1  ON 29
eH1_0                -2.352124e-01 1 1  ON 30
eH1_1                -1.385742e-01 1 1  ON 31
eH1_2                -9.411831e-02 1 1  ON 32
eH1_3                -3.936817e-02 1 1  ON 33
eH1_4                 4.008763e-03 1 1  ON 34
eH1_5                 3.747324e-02 1 1  ON 35
eH1_6                 9.329608e-02 1 1  ON 36
eH1_7                 1.483146e-01 1 1  ON 37
eH1_8                 1.695092e-01 1 1  ON 38
eH1_9                 5.753530e-02 1 1  ON 39
eH2_0                -2.322583e-01 1 1  ON 40
eH2_1                -1.352254e-01 1 1  ON 41
eH2_2                -9.070658e-02 1 1  ON 42
eH2_3                -3.604250e-02 1 1  ON 43
eH2_4                 7.938781e-03 1 1  ON 44
eH2_5                 4.076876e-02 1 1  ON 45
eH2_6                 9.626743e-02 1 1  ON 46
eH2_7                 1.506139e-01 1 1  ON 47
eH2_8                 1.741140e-01 1 1  ON 48
eH2_9                 4.225850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.966
    reference variance = 0.208414
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.6689e-01
  Total weights = 2.0000e+06
  Execution time = 1.8683e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366700817687
                                         uncertainty =       0.023695104323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366700817687
                                         uncertainty =       0.023695104323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428310648
  error estimate for blocks of size 2^( 2) =       0.000440193378
  error estimate for blocks of size 2^( 3) =       0.000452345485
  error estimate for blocks of size 2^( 4) =       0.000463139712
  error estimate for blocks of size 2^( 5) =       0.000471178411
  error estimate for blocks of size 2^( 6) =       0.000475722658
  error estimate for blocks of size 2^( 7) =       0.000475634859

      target function =                  N/A
              le_mean =     -16.924408000176
             les_mean =     286.802485995696
             stat err =       0.000471418910
             autocorr =       1.211424228643
              std dev =       0.605722727581
             le_variance =       0.366900022708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366680108378
                                         uncertainty =       0.023692059775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366680108378
                                         uncertainty =       0.023692059775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428298516
  error estimate for blocks of size 2^( 2) =       0.000440181326
  error estimate for blocks of size 2^( 3) =       0.000452333209
  error estimate for blocks of size 2^( 4) =       0.000463127420
  error estimate for blocks of size 2^( 5) =       0.000471165449
  error estimate for blocks of size 2^( 6) =       0.000475710216
  error estimate for blocks of size 2^( 7) =       0.000475624708

      target function =                  N/A
              le_mean =     -16.924407978118
             les_mean =     286.802464464382
             stat err =       0.000471406948
             autocorr =       1.211431380245
              std dev =       0.605705570421
             le_variance =       0.366879238039

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366689946177
                                         uncertainty =       0.023693525076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366689946177
                                         uncertainty =       0.023693525076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428304279
  error estimate for blocks of size 2^( 2) =       0.000440187024
  error estimate for blocks of size 2^( 3) =       0.000452338992
  error estimate for blocks of size 2^( 4) =       0.000463133216
  error estimate for blocks of size 2^( 5) =       0.000471171569
  error estimate for blocks of size 2^( 6) =       0.000475716122
  error estimate for blocks of size 2^( 7) =       0.000475629585

      target function =                  N/A
              le_mean =     -16.924407996387
             les_mean =     286.802474956227
             stat err =       0.000471412623
             autocorr =       1.211427945037
              std dev =       0.605713720760
             le_variance =       0.366889111517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366699442589
                                         uncertainty =       0.023694905272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366699442589
                                         uncertainty =       0.023694905272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428309843
  error estimate for blocks of size 2^( 2) =       0.000440192573
  error estimate for blocks of size 2^( 3) =       0.000452344662
  error estimate for blocks of size 2^( 4) =       0.000463138888
  error estimate for blocks of size 2^( 5) =       0.000471177543
  error estimate for blocks of size 2^( 6) =       0.000475721830
  error estimate for blocks of size 2^( 7) =       0.000475634192

      target function =                  N/A
              le_mean =     -16.924407999600
             les_mean =     286.802484596074
             stat err =       0.000471418113
             autocorr =       1.211424692753
              std dev =       0.605721588343
             le_variance =       0.366898642585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924408000176        initial  <--
     2.4414e+00     2.4414e+01             1.3510e-04       -16.924407978118
     9.7656e+00     9.7656e+01             3.3912e-05       -16.924407996387
     3.9062e+01     3.9062e+02             8.4871e-06       -16.924407999600

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7460
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451692e-01 1 1  ON 1
 uu_2                 4.416195e-02 1 1  ON 2
 uu_3                -1.871317e-02 1 1  ON 3
 uu_4                -6.451128e-02 1 1  ON 4
 uu_5                -9.825776e-02 1 1  ON 5
 uu_6                -1.249123e-01 1 1  ON 6
 uu_7                -1.391438e-01 1 1  ON 7
 uu_8                -1.342704e-01 1 1  ON 8
 uu_9                -1.042373e-01 1 1  ON 9
 ud_0                 4.356250e-01 1 1  ON 10
 ud_1                 1.704575e-01 1 1  ON 11
 ud_2                 5.190196e-02 1 1  ON 12
 ud_3                -1.639012e-02 1 1  ON 13
 ud_4                -6.987627e-02 1 1  ON 14
 ud_5                -1.062042e-01 1 1  ON 15
 ud_6                -1.280625e-01 1 1  ON 16
 ud_7                -1.398957e-01 1 1  ON 17
 ud_8                -1.384061e-01 1 1  ON 18
 ud_9                -1.310115e-01 1 1  ON 19
 eO_0                -7.720938e-01 1 1  ON 20
 eO_1                -4.509346e-01 1 1  ON 21
 eO_2                -2.865013e-02 1 1  ON 22
 eO_3                 2.971186e-01 1 1  ON 23
 eO_4                 5.342260e-01 1 1  ON 24
 eO_5                 4.965528e-01 1 1  ON 25
 eO_6                 2.622493e-01 1 1  ON 26
 eO_7                -4.495960e-02 1 1  ON 27
 eO_8                -2.159525e-01 1 1  ON 28
 eO_9                -7.698149e-02 1 1  ON 29
eH1_0                -2.352173e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411524e-02 1 1  ON 32
eH1_3                -3.936491e-02 1 1  ON 33
eH1_4                 4.006941e-03 1 1  ON 34
eH1_5                 3.748793e-02 1 1  ON 35
eH1_6                 9.330614e-02 1 1  ON 36
eH1_7                 1.483228e-01 1 1  ON 37
eH1_8                 1.695005e-01 1 1  ON 38
eH1_9                 5.751889e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070392e-02 1 1  ON 42
eH2_3                -3.604315e-02 1 1  ON 43
eH2_4                 7.934490e-03 1 1  ON 44
eH2_5                 4.077882e-02 1 1  ON 45
eH2_6                 9.627911e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741032e-01 1 1  ON 48
eH2_9                 4.224375e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6169e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8829
    reference variance = 0.27329
====================================================
  Execution time = 2.0617e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332785188293
                                         uncertainty =       0.002583206564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332785188293
                                         uncertainty =       0.002583206564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407880526
  error estimate for blocks of size 2^( 2) =       0.000420377064
  error estimate for blocks of size 2^( 3) =       0.000432612903
  error estimate for blocks of size 2^( 4) =       0.000443913518
  error estimate for blocks of size 2^( 5) =       0.000452270626
  error estimate for blocks of size 2^( 6) =       0.000458292756
  error estimate for blocks of size 2^( 7) =       0.000462566085

      target function =                  N/A
              le_mean =     -16.925767473327
             les_mean =     286.814337441352
             stat err =       0.000454260746
             autocorr =       1.240350651457
              std dev =       0.576830171351
             le_variance =       0.332733046581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692576747333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925767473327       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925767442583       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925767416112       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925767421905       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925767444695       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925767451079       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925767450016       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925767449356       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.526456e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925767473327       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925767465575       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925767458861       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925767460326       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925767465657       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925767467165       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925767467258       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925767467090       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 3.818852e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925767473327       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925767471385       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925767469700       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925767470067       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925767471376       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925767471756       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925767471794       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925767471751       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 9.548831e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6138e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451706e-01 1 1  ON 1
 uu_2                 4.416335e-02 1 1  ON 2
 uu_3                -1.871318e-02 1 1  ON 3
 uu_4                -6.451003e-02 1 1  ON 4
 uu_5                -9.825815e-02 1 1  ON 5
 uu_6                -1.249135e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342710e-01 1 1  ON 8
 uu_9                -1.042395e-01 1 1  ON 9
 ud_0                 4.356244e-01 1 1  ON 10
 ud_1                 1.704571e-01 1 1  ON 11
 ud_2                 5.190231e-02 1 1  ON 12
 ud_3                -1.638982e-02 1 1  ON 13
 ud_4                -6.987643e-02 1 1  ON 14
 ud_5                -1.062029e-01 1 1  ON 15
 ud_6                -1.280622e-01 1 1  ON 16
 ud_7                -1.398949e-01 1 1  ON 17
 ud_8                -1.384063e-01 1 1  ON 18
 ud_9                -1.310121e-01 1 1  ON 19
 eO_0                -7.720963e-01 1 1  ON 20
 eO_1                -4.509348e-01 1 1  ON 21
 eO_2                -2.865132e-02 1 1  ON 22
 eO_3                 2.971181e-01 1 1  ON 23
 eO_4                 5.342266e-01 1 1  ON 24
 eO_5                 4.965551e-01 1 1  ON 25
 eO_6                 2.622531e-01 1 1  ON 26
 eO_7                -4.495797e-02 1 1  ON 27
 eO_8                -2.159545e-01 1 1  ON 28
 eO_9                -7.698335e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411537e-02 1 1  ON 32
eH1_3                -3.936497e-02 1 1  ON 33
eH1_4                 4.006367e-03 1 1  ON 34
eH1_5                 3.748784e-02 1 1  ON 35
eH1_6                 9.330495e-02 1 1  ON 36
eH1_7                 1.483228e-01 1 1  ON 37
eH1_8                 1.695015e-01 1 1  ON 38
eH1_9                 5.752009e-02 1 1  ON 39
eH2_0                -2.322592e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070414e-02 1 1  ON 42
eH2_3                -3.604295e-02 1 1  ON 43
eH2_4                 7.934405e-03 1 1  ON 44
eH2_5                 4.077768e-02 1 1  ON 45
eH2_6                 9.627815e-02 1 1  ON 46
eH2_7                 1.506093e-01 1 1  ON 47
eH2_8                 1.741041e-01 1 1  ON 48
eH2_9                 4.224547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9363
    reference variance = 0.249956
====================================================
  Execution time = 2.2025e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4443e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344370215479
                                         uncertainty =       0.008513642373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344370215479
                                         uncertainty =       0.008513642373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414991365
  error estimate for blocks of size 2^( 2) =       0.000427621288
  error estimate for blocks of size 2^( 3) =       0.000439846340
  error estimate for blocks of size 2^( 4) =       0.000450079354
  error estimate for blocks of size 2^( 5) =       0.000458849591
  error estimate for blocks of size 2^( 6) =       0.000465527070
  error estimate for blocks of size 2^( 7) =       0.000467976154

      target function =                  N/A
              le_mean =     -16.925003708791
             les_mean =     286.800186036102
             stat err =       0.000460608042
             autocorr =       1.231926828272
              std dev =       0.586886416392
             le_variance =       0.344435665745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344368066525
                                         uncertainty =       0.008513616823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344368066525
                                         uncertainty =       0.008513616823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414990071
  error estimate for blocks of size 2^( 2) =       0.000427619975
  error estimate for blocks of size 2^( 3) =       0.000439844992
  error estimate for blocks of size 2^( 4) =       0.000450078052
  error estimate for blocks of size 2^( 5) =       0.000458848202
  error estimate for blocks of size 2^( 6) =       0.000465525732
  error estimate for blocks of size 2^( 7) =       0.000467974644

      target function =                  N/A
              le_mean =     -16.925003697107
             les_mean =     286.800183493244
             stat err =       0.000460606657
             autocorr =       1.231927100955
              std dev =       0.586884586941
             le_variance =       0.344433518389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344369129565
                                         uncertainty =       0.008513629591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344369129565
                                         uncertainty =       0.008513629591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414990711
  error estimate for blocks of size 2^( 2) =       0.000427620624
  error estimate for blocks of size 2^( 3) =       0.000439845659
  error estimate for blocks of size 2^( 4) =       0.000450078697
  error estimate for blocks of size 2^( 5) =       0.000458848890
  error estimate for blocks of size 2^( 6) =       0.000465526395
  error estimate for blocks of size 2^( 7) =       0.000467975391

      target function =                  N/A
              le_mean =     -16.925003702920
             les_mean =     286.800184752294
             stat err =       0.000460607343
             autocorr =       1.231926968891
              std dev =       0.586885491941
             le_variance =       0.344434580651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344370079339
                                         uncertainty =       0.008513640775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344370079339
                                         uncertainty =       0.008513640775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414991283
  error estimate for blocks of size 2^( 2) =       0.000427621205
  error estimate for blocks of size 2^( 3) =       0.000439846254
  error estimate for blocks of size 2^( 4) =       0.000450079272
  error estimate for blocks of size 2^( 5) =       0.000458849503
  error estimate for blocks of size 2^( 6) =       0.000465526986
  error estimate for blocks of size 2^( 7) =       0.000467976058

      target function =                  N/A
              le_mean =     -16.925003708052
             les_mean =     286.800185875051
             stat err =       0.000460607955
             autocorr =       1.231926845993
              std dev =       0.586886300495
             le_variance =       0.344435529708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925003708791        initial  <--
     2.4414e+01     2.4414e+02             1.5265e-05       -16.925003697107
     9.7656e+01     9.7656e+02             3.8189e-06       -16.925003702920
     3.9062e+02     3.9062e+03             9.5488e-07       -16.925003708052

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5565
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451692e-01 1 1  ON 1
 uu_2                 4.416195e-02 1 1  ON 2
 uu_3                -1.871317e-02 1 1  ON 3
 uu_4                -6.451128e-02 1 1  ON 4
 uu_5                -9.825776e-02 1 1  ON 5
 uu_6                -1.249123e-01 1 1  ON 6
 uu_7                -1.391438e-01 1 1  ON 7
 uu_8                -1.342704e-01 1 1  ON 8
 uu_9                -1.042373e-01 1 1  ON 9
 ud_0                 4.356250e-01 1 1  ON 10
 ud_1                 1.704575e-01 1 1  ON 11
 ud_2                 5.190196e-02 1 1  ON 12
 ud_3                -1.639012e-02 1 1  ON 13
 ud_4                -6.987627e-02 1 1  ON 14
 ud_5                -1.062042e-01 1 1  ON 15
 ud_6                -1.280625e-01 1 1  ON 16
 ud_7                -1.398957e-01 1 1  ON 17
 ud_8                -1.384061e-01 1 1  ON 18
 ud_9                -1.310115e-01 1 1  ON 19
 eO_0                -7.720938e-01 1 1  ON 20
 eO_1                -4.509346e-01 1 1  ON 21
 eO_2                -2.865013e-02 1 1  ON 22
 eO_3                 2.971186e-01 1 1  ON 23
 eO_4                 5.342260e-01 1 1  ON 24
 eO_5                 4.965528e-01 1 1  ON 25
 eO_6                 2.622493e-01 1 1  ON 26
 eO_7                -4.495960e-02 1 1  ON 27
 eO_8                -2.159525e-01 1 1  ON 28
 eO_9                -7.698149e-02 1 1  ON 29
eH1_0                -2.352173e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411524e-02 1 1  ON 32
eH1_3                -3.936491e-02 1 1  ON 33
eH1_4                 4.006941e-03 1 1  ON 34
eH1_5                 3.748793e-02 1 1  ON 35
eH1_6                 9.330614e-02 1 1  ON 36
eH1_7                 1.483228e-01 1 1  ON 37
eH1_8                 1.695005e-01 1 1  ON 38
eH1_9                 5.751889e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070392e-02 1 1  ON 42
eH2_3                -3.604315e-02 1 1  ON 43
eH2_4                 7.934490e-03 1 1  ON 44
eH2_5                 4.077882e-02 1 1  ON 45
eH2_6                 9.627911e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741032e-01 1 1  ON 48
eH2_9                 4.224375e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9577
    reference variance = 0.247767
====================================================
  Execution time = 2.0988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340460007571
                                         uncertainty =       0.003829742512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340460007571
                                         uncertainty =       0.003829742512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412574119
  error estimate for blocks of size 2^( 2) =       0.000424948494
  error estimate for blocks of size 2^( 3) =       0.000437424706
  error estimate for blocks of size 2^( 4) =       0.000449299325
  error estimate for blocks of size 2^( 5) =       0.000458830507
  error estimate for blocks of size 2^( 6) =       0.000464492510
  error estimate for blocks of size 2^( 7) =       0.000468411843

      target function =                  N/A
              le_mean =     -16.924484330857
             les_mean =     286.778604503141
             stat err =       0.000460258546
             autocorr =       1.244513924561
              std dev =       0.583467915083
             le_variance =       0.340434807931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692448433086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924484330857       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924484335193       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924484333687       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924484334651       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924484340363       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924484337831       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924484338163       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924484338463       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.197859e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924484330857       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924484331942       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924484331565       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924484331807       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924484333235       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924484332602       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924484332686       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924484332761       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.994831e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924484330857       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924484331128       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924484331034       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924484331095       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924484331451       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924484331294       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924484331318       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924484331330       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 7.487194e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0197e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451693e-01 1 1  ON 1
 uu_2                 4.416194e-02 1 1  ON 2
 uu_3                -1.871313e-02 1 1  ON 3
 uu_4                -6.451123e-02 1 1  ON 4
 uu_5                -9.825775e-02 1 1  ON 5
 uu_6                -1.249125e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342706e-01 1 1  ON 8
 uu_9                -1.042374e-01 1 1  ON 9
 ud_0                 4.356249e-01 1 1  ON 10
 ud_1                 1.704574e-01 1 1  ON 11
 ud_2                 5.190191e-02 1 1  ON 12
 ud_3                -1.639018e-02 1 1  ON 13
 ud_4                -6.987643e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280624e-01 1 1  ON 16
 ud_7                -1.398956e-01 1 1  ON 17
 ud_8                -1.384059e-01 1 1  ON 18
 ud_9                -1.310113e-01 1 1  ON 19
 eO_0                -7.720939e-01 1 1  ON 20
 eO_1                -4.509348e-01 1 1  ON 21
 eO_2                -2.865024e-02 1 1  ON 22
 eO_3                 2.971185e-01 1 1  ON 23
 eO_4                 5.342261e-01 1 1  ON 24
 eO_5                 4.965531e-01 1 1  ON 25
 eO_6                 2.622496e-01 1 1  ON 26
 eO_7                -4.495943e-02 1 1  ON 27
 eO_8                -2.159526e-01 1 1  ON 28
 eO_9                -7.698164e-02 1 1  ON 29
eH1_0                -2.352173e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411530e-02 1 1  ON 32
eH1_3                -3.936502e-02 1 1  ON 33
eH1_4                 4.006856e-03 1 1  ON 34
eH1_5                 3.748788e-02 1 1  ON 35
eH1_6                 9.330606e-02 1 1  ON 36
eH1_7                 1.483228e-01 1 1  ON 37
eH1_8                 1.695006e-01 1 1  ON 38
eH1_9                 5.751906e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070398e-02 1 1  ON 42
eH2_3                -3.604326e-02 1 1  ON 43
eH2_4                 7.934273e-03 1 1  ON 44
eH2_5                 4.077882e-02 1 1  ON 45
eH2_6                 9.627905e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741033e-01 1 1  ON 48
eH2_9                 4.224396e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9581
    reference variance = 0.248731
====================================================
  Execution time = 2.0055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3324e-01
  Total weights = 2.0000e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374313889
                                         uncertainty =       0.003276097686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374313889
                                         uncertainty =       0.003276097686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408193673
  error estimate for blocks of size 2^( 2) =       0.000420743847
  error estimate for blocks of size 2^( 3) =       0.000433637588
  error estimate for blocks of size 2^( 4) =       0.000444473479
  error estimate for blocks of size 2^( 5) =       0.000455243564
  error estimate for blocks of size 2^( 6) =       0.000462969946
  error estimate for blocks of size 2^( 7) =       0.000469613107

      target function =                  N/A
              le_mean =     -16.924555784992
             les_mean =     286.773832502802
             stat err =       0.000458075024
             autocorr =       1.259333300339
              std dev =       0.577273029081
             le_variance =       0.333244150105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374583049
                                         uncertainty =       0.003276101439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374583049
                                         uncertainty =       0.003276101439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408193838
  error estimate for blocks of size 2^( 2) =       0.000420744005
  error estimate for blocks of size 2^( 3) =       0.000433637742
  error estimate for blocks of size 2^( 4) =       0.000444473626
  error estimate for blocks of size 2^( 5) =       0.000455243705
  error estimate for blocks of size 2^( 6) =       0.000462970088
  error estimate for blocks of size 2^( 7) =       0.000469613241

      target function =                  N/A
              le_mean =     -16.924555786901
             les_mean =     286.773832836609
             stat err =       0.000458075165
             autocorr =       1.259333058611
              std dev =       0.577273262239
             le_variance =       0.333244419297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374448685
                                         uncertainty =       0.003276099565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374448685
                                         uncertainty =       0.003276099565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408193756
  error estimate for blocks of size 2^( 2) =       0.000420743926
  error estimate for blocks of size 2^( 3) =       0.000433637665
  error estimate for blocks of size 2^( 4) =       0.000444473552
  error estimate for blocks of size 2^( 5) =       0.000455243635
  error estimate for blocks of size 2^( 6) =       0.000462970017
  error estimate for blocks of size 2^( 7) =       0.000469613174

      target function =                  N/A
              le_mean =     -16.924555785947
             les_mean =     286.773832669936
             stat err =       0.000458075095
             autocorr =       1.259333179308
              std dev =       0.577273145848
             le_variance =       0.333244284917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374330745
                                         uncertainty =       0.003276097921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333374330745
                                         uncertainty =       0.003276097921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408193684
  error estimate for blocks of size 2^( 2) =       0.000420743857
  error estimate for blocks of size 2^( 3) =       0.000433637598
  error estimate for blocks of size 2^( 4) =       0.000444473488
  error estimate for blocks of size 2^( 5) =       0.000455243573
  error estimate for blocks of size 2^( 6) =       0.000462969955
  error estimate for blocks of size 2^( 7) =       0.000469613116

      target function =                  N/A
              le_mean =     -16.924555785112
             les_mean =     286.773832523700
             stat err =       0.000458075033
             autocorr =       1.259333285213
              std dev =       0.577273043683
             le_variance =       0.333244166963


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924555784992        initial
     2.4414e+02     2.4414e+03             1.1979e-06       -16.924555786901  <--
     9.7656e+02     9.7656e+03             2.9948e-07       -16.924555785947
     3.9062e+03     3.9062e+04             7.4872e-08       -16.924555785112

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9604e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451697e-01 1 1  ON 1
 uu_2                 4.416192e-02 1 1  ON 2
 uu_3                -1.871299e-02 1 1  ON 3
 uu_4                -6.451107e-02 1 1  ON 4
 uu_5                -9.825771e-02 1 1  ON 5
 uu_6                -1.249131e-01 1 1  ON 6
 uu_7                -1.391440e-01 1 1  ON 7
 uu_8                -1.342709e-01 1 1  ON 8
 uu_9                -1.042378e-01 1 1  ON 9
 ud_0                 4.356248e-01 1 1  ON 10
 ud_1                 1.704571e-01 1 1  ON 11
 ud_2                 5.190178e-02 1 1  ON 12
 ud_3                -1.639035e-02 1 1  ON 13
 ud_4                -6.987689e-02 1 1  ON 14
 ud_5                -1.062044e-01 1 1  ON 15
 ud_6                -1.280622e-01 1 1  ON 16
 ud_7                -1.398952e-01 1 1  ON 17
 ud_8                -1.384054e-01 1 1  ON 18
 ud_9                -1.310109e-01 1 1  ON 19
 eO_0                -7.720943e-01 1 1  ON 20
 eO_1                -4.509355e-01 1 1  ON 21
 eO_2                -2.865054e-02 1 1  ON 22
 eO_3                 2.971183e-01 1 1  ON 23
 eO_4                 5.342263e-01 1 1  ON 24
 eO_5                 4.965540e-01 1 1  ON 25
 eO_6                 2.622504e-01 1 1  ON 26
 eO_7                -4.495894e-02 1 1  ON 27
 eO_8                -2.159529e-01 1 1  ON 28
 eO_9                -7.698209e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411548e-02 1 1  ON 32
eH1_3                -3.936532e-02 1 1  ON 33
eH1_4                 4.006599e-03 1 1  ON 34
eH1_5                 3.748774e-02 1 1  ON 35
eH1_6                 9.330582e-02 1 1  ON 36
eH1_7                 1.483229e-01 1 1  ON 37
eH1_8                 1.695010e-01 1 1  ON 38
eH1_9                 5.751959e-02 1 1  ON 39
eH2_0                -2.322590e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070415e-02 1 1  ON 42
eH2_3                -3.604360e-02 1 1  ON 43
eH2_4                 7.933623e-03 1 1  ON 44
eH2_5                 4.077881e-02 1 1  ON 45
eH2_6                 9.627887e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741037e-01 1 1  ON 48
eH2_9                 4.224459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9807e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.198473
====================================================
  Execution time = 2.0673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334719333195
                                         uncertainty =       0.003433992501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334719333195
                                         uncertainty =       0.003433992501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409063696
  error estimate for blocks of size 2^( 2) =       0.000421576226
  error estimate for blocks of size 2^( 3) =       0.000434138417
  error estimate for blocks of size 2^( 4) =       0.000445898732
  error estimate for blocks of size 2^( 5) =       0.000456574016
  error estimate for blocks of size 2^( 6) =       0.000464553909
  error estimate for blocks of size 2^( 7) =       0.000470074553

      target function =                  N/A
              le_mean =     -16.924459155670
             les_mean =     286.771983759212
             stat err =       0.000459275303
             autocorr =       1.260562283029
              std dev =       0.578503426612
             le_variance =       0.334666214602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692445915567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924459155670       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924459164477       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924459186572       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924459179842       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924459188684       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924459200210       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924459194868       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924459194753       residual = 6.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 5.125403e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924459155670       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924459157874       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924459163402       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924459161775       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924459164021       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924459166848       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924459165490       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924459165464       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.282733e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924459155670       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924459156221       residual = 4.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924459157603       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924459157200       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924459157765       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924459158467       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924459158127       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924459158121       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.207699e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6262e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.117785e-01 1 1  ON 0
 uu_1                 1.451702e-01 1 1  ON 1
 uu_2                 4.416257e-02 1 1  ON 2
 uu_3                -1.871281e-02 1 1  ON 3
 uu_4                -6.451113e-02 1 1  ON 4
 uu_5                -9.825786e-02 1 1  ON 5
 uu_6                -1.249137e-01 1 1  ON 6
 uu_7                -1.391441e-01 1 1  ON 7
 uu_8                -1.342713e-01 1 1  ON 8
 uu_9                -1.042384e-01 1 1  ON 9
 ud_0                 4.356249e-01 1 1  ON 10
 ud_1                 1.704564e-01 1 1  ON 11
 ud_2                 5.190097e-02 1 1  ON 12
 ud_3                -1.639125e-02 1 1  ON 13
 ud_4                -6.987731e-02 1 1  ON 14
 ud_5                -1.062049e-01 1 1  ON 15
 ud_6                -1.280618e-01 1 1  ON 16
 ud_7                -1.398946e-01 1 1  ON 17
 ud_8                -1.384045e-01 1 1  ON 18
 ud_9                -1.310100e-01 1 1  ON 19
 eO_0                -7.720956e-01 1 1  ON 20
 eO_1                -4.509364e-01 1 1  ON 21
 eO_2                -2.865096e-02 1 1  ON 22
 eO_3                 2.971184e-01 1 1  ON 23
 eO_4                 5.342270e-01 1 1  ON 24
 eO_5                 4.965551e-01 1 1  ON 25
 eO_6                 2.622516e-01 1 1  ON 26
 eO_7                -4.495853e-02 1 1  ON 27
 eO_8                -2.159534e-01 1 1  ON 28
 eO_9                -7.698253e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385805e-01 1 1  ON 31
eH1_2                -9.411622e-02 1 1  ON 32
eH1_3                -3.936562e-02 1 1  ON 33
eH1_4                 4.006324e-03 1 1  ON 34
eH1_5                 3.748712e-02 1 1  ON 35
eH1_6                 9.330559e-02 1 1  ON 36
eH1_7                 1.483232e-01 1 1  ON 37
eH1_8                 1.695017e-01 1 1  ON 38
eH1_9                 5.752036e-02 1 1  ON 39
eH2_0                -2.322586e-01 1 1  ON 40
eH2_1                -1.352150e-01 1 1  ON 41
eH2_2                -9.070426e-02 1 1  ON 42
eH2_3                -3.604371e-02 1 1  ON 43
eH2_4                 7.933157e-03 1 1  ON 44
eH2_5                 4.077836e-02 1 1  ON 45
eH2_6                 9.627858e-02 1 1  ON 46
eH2_7                 1.506097e-01 1 1  ON 47
eH2_8                 1.741039e-01 1 1  ON 48
eH2_9                 4.224539e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.378189
====================================================
  Execution time = 2.0254e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3211e-01
  Total weights = 2.0000e+06
  Execution time = 1.8991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331836533516
                                         uncertainty =       0.002805515974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331836533516
                                         uncertainty =       0.002805515974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407498717
  error estimate for blocks of size 2^( 2) =       0.000420376417
  error estimate for blocks of size 2^( 3) =       0.000433504781
  error estimate for blocks of size 2^( 4) =       0.000445413143
  error estimate for blocks of size 2^( 5) =       0.000456503493
  error estimate for blocks of size 2^( 6) =       0.000464047894
  error estimate for blocks of size 2^( 7) =       0.000470761041

      target function =                  N/A
              le_mean =     -16.924289205177
             les_mean =     286.763675343152
             stat err =       0.000459181393
             autocorr =       1.269743712007
              std dev =       0.576290212242
             le_variance =       0.332110408726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331839543562
                                         uncertainty =       0.002805543729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331839543562
                                         uncertainty =       0.002805543729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407500566
  error estimate for blocks of size 2^( 2) =       0.000420378175
  error estimate for blocks of size 2^( 3) =       0.000433506443
  error estimate for blocks of size 2^( 4) =       0.000445414717
  error estimate for blocks of size 2^( 5) =       0.000456504960
  error estimate for blocks of size 2^( 6) =       0.000464049321
  error estimate for blocks of size 2^( 7) =       0.000470762452

      target function =                  N/A
              le_mean =     -16.924289196685
             les_mean =     286.763678068871
             stat err =       0.000459182863
             autocorr =       1.269740319862
              std dev =       0.576292826516
             le_variance =       0.332113421893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331838044032
                                         uncertainty =       0.002805529915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331838044032
                                         uncertainty =       0.002805529915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407499645
  error estimate for blocks of size 2^( 2) =       0.000420377299
  error estimate for blocks of size 2^( 3) =       0.000433505615
  error estimate for blocks of size 2^( 4) =       0.000445413933
  error estimate for blocks of size 2^( 5) =       0.000456504229
  error estimate for blocks of size 2^( 6) =       0.000464048610
  error estimate for blocks of size 2^( 7) =       0.000470761749

      target function =                  N/A
              le_mean =     -16.924289200893
             les_mean =     286.763676710225
             stat err =       0.000459182130
             autocorr =       1.269742010073
              std dev =       0.576291524151
             le_variance =       0.332111920808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331836722497
                                         uncertainty =       0.002805517718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331836722497
                                         uncertainty =       0.002805517718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407498833
  error estimate for blocks of size 2^( 2) =       0.000420376528
  error estimate for blocks of size 2^( 3) =       0.000433504885
  error estimate for blocks of size 2^( 4) =       0.000445413242
  error estimate for blocks of size 2^( 5) =       0.000456503585
  error estimate for blocks of size 2^( 6) =       0.000464047984
  error estimate for blocks of size 2^( 7) =       0.000470761130

      target function =                  N/A
              le_mean =     -16.924289204640
             les_mean =     286.763675514127
             stat err =       0.000459181485
             autocorr =       1.269743499084
              std dev =       0.576290376375
             le_variance =       0.332110597903


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924289205177        initial  <--
     6.1035e+01     6.1035e+02             5.1254e-06       -16.924289196685
     2.4414e+02     2.4414e+03             1.2827e-06       -16.924289200893
     9.7656e+02     9.7656e+03             3.2077e-07       -16.924289204640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8189
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451697e-01 1 1  ON 1
 uu_2                 4.416192e-02 1 1  ON 2
 uu_3                -1.871299e-02 1 1  ON 3
 uu_4                -6.451107e-02 1 1  ON 4
 uu_5                -9.825771e-02 1 1  ON 5
 uu_6                -1.249131e-01 1 1  ON 6
 uu_7                -1.391440e-01 1 1  ON 7
 uu_8                -1.342709e-01 1 1  ON 8
 uu_9                -1.042378e-01 1 1  ON 9
 ud_0                 4.356248e-01 1 1  ON 10
 ud_1                 1.704571e-01 1 1  ON 11
 ud_2                 5.190178e-02 1 1  ON 12
 ud_3                -1.639035e-02 1 1  ON 13
 ud_4                -6.987689e-02 1 1  ON 14
 ud_5                -1.062044e-01 1 1  ON 15
 ud_6                -1.280622e-01 1 1  ON 16
 ud_7                -1.398952e-01 1 1  ON 17
 ud_8                -1.384054e-01 1 1  ON 18
 ud_9                -1.310109e-01 1 1  ON 19
 eO_0                -7.720943e-01 1 1  ON 20
 eO_1                -4.509355e-01 1 1  ON 21
 eO_2                -2.865054e-02 1 1  ON 22
 eO_3                 2.971183e-01 1 1  ON 23
 eO_4                 5.342263e-01 1 1  ON 24
 eO_5                 4.965540e-01 1 1  ON 25
 eO_6                 2.622504e-01 1 1  ON 26
 eO_7                -4.495894e-02 1 1  ON 27
 eO_8                -2.159529e-01 1 1  ON 28
 eO_9                -7.698209e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411548e-02 1 1  ON 32
eH1_3                -3.936532e-02 1 1  ON 33
eH1_4                 4.006599e-03 1 1  ON 34
eH1_5                 3.748774e-02 1 1  ON 35
eH1_6                 9.330582e-02 1 1  ON 36
eH1_7                 1.483229e-01 1 1  ON 37
eH1_8                 1.695010e-01 1 1  ON 38
eH1_9                 5.751959e-02 1 1  ON 39
eH2_0                -2.322590e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070415e-02 1 1  ON 42
eH2_3                -3.604360e-02 1 1  ON 43
eH2_4                 7.933623e-03 1 1  ON 44
eH2_5                 4.077881e-02 1 1  ON 45
eH2_6                 9.627887e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741037e-01 1 1  ON 48
eH2_9                 4.224459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6086e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.981
    reference variance = 0.472577
====================================================
  Execution time = 2.0738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336209122888
                                         uncertainty =       0.003126746284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336209122888
                                         uncertainty =       0.003126746284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409965199
  error estimate for blocks of size 2^( 2) =       0.000422436054
  error estimate for blocks of size 2^( 3) =       0.000435443501
  error estimate for blocks of size 2^( 4) =       0.000448253224
  error estimate for blocks of size 2^( 5) =       0.000459752736
  error estimate for blocks of size 2^( 6) =       0.000469375121
  error estimate for blocks of size 2^( 7) =       0.000475061540

      target function =                  N/A
              le_mean =     -16.924932670101
             les_mean =     286.789488648741
             stat err =       0.000463110655
             autocorr =       1.276073123564
              std dev =       0.579778345027
             le_variance =       0.336142929363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692493267010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932670101       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924932671439       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924932672840       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924932674465       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924932672851       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924932673439       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924932673261       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924932673294       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.347317e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932670101       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924932670435       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924932670786       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924932671192       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924932670788       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924932670935       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924932670892       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924932670901       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.336857e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924932670101       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924932670185       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924932670272       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924932670374       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924932670272       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924932670310       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924932670295       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924932670298       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 3.342160e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.051109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6242e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451698e-01 1 1  ON 1
 uu_2                 4.416189e-02 1 1  ON 2
 uu_3                -1.871300e-02 1 1  ON 3
 uu_4                -6.451108e-02 1 1  ON 4
 uu_5                -9.825773e-02 1 1  ON 5
 uu_6                -1.249131e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342708e-01 1 1  ON 8
 uu_9                -1.042378e-01 1 1  ON 9
 ud_0                 4.356248e-01 1 1  ON 10
 ud_1                 1.704570e-01 1 1  ON 11
 ud_2                 5.190172e-02 1 1  ON 12
 ud_3                -1.639045e-02 1 1  ON 13
 ud_4                -6.987691e-02 1 1  ON 14
 ud_5                -1.062044e-01 1 1  ON 15
 ud_6                -1.280622e-01 1 1  ON 16
 ud_7                -1.398952e-01 1 1  ON 17
 ud_8                -1.384053e-01 1 1  ON 18
 ud_9                -1.310108e-01 1 1  ON 19
 eO_0                -7.720944e-01 1 1  ON 20
 eO_1                -4.509355e-01 1 1  ON 21
 eO_2                -2.865057e-02 1 1  ON 22
 eO_3                 2.971182e-01 1 1  ON 23
 eO_4                 5.342263e-01 1 1  ON 24
 eO_5                 4.965542e-01 1 1  ON 25
 eO_6                 2.622505e-01 1 1  ON 26
 eO_7                -4.495889e-02 1 1  ON 27
 eO_8                -2.159530e-01 1 1  ON 28
 eO_9                -7.698213e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385809e-01 1 1  ON 31
eH1_2                -9.411549e-02 1 1  ON 32
eH1_3                -3.936536e-02 1 1  ON 33
eH1_4                 4.006580e-03 1 1  ON 34
eH1_5                 3.748767e-02 1 1  ON 35
eH1_6                 9.330580e-02 1 1  ON 36
eH1_7                 1.483229e-01 1 1  ON 37
eH1_8                 1.695011e-01 1 1  ON 38
eH1_9                 5.751967e-02 1 1  ON 39
eH2_0                -2.322590e-01 1 1  ON 40
eH2_1                -1.352149e-01 1 1  ON 41
eH2_2                -9.070415e-02 1 1  ON 42
eH2_3                -3.604363e-02 1 1  ON 43
eH2_4                 7.933596e-03 1 1  ON 44
eH2_5                 4.077873e-02 1 1  ON 45
eH2_6                 9.627885e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741038e-01 1 1  ON 48
eH2_9                 4.224468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9483
    reference variance = 0.218512
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3763e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723334610
                                         uncertainty =       0.006202386152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723334610
                                         uncertainty =       0.006202386152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872812
  error estimate for blocks of size 2^( 2) =       0.000422674198
  error estimate for blocks of size 2^( 3) =       0.000435359206
  error estimate for blocks of size 2^( 4) =       0.000446432044
  error estimate for blocks of size 2^( 5) =       0.000455940117
  error estimate for blocks of size 2^( 6) =       0.000464584677
  error estimate for blocks of size 2^( 7) =       0.000469176208

      target function =                  N/A
              le_mean =     -16.925226880704
             les_mean =     286.800937729432
             stat err =       0.000459033262
             autocorr =       1.248169318562
              std dev =       0.581061902858
             le_variance =       0.337632934953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723424163
                                         uncertainty =       0.006202392880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723424163
                                         uncertainty =       0.006202392880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872866
  error estimate for blocks of size 2^( 2) =       0.000422674252
  error estimate for blocks of size 2^( 3) =       0.000435359259
  error estimate for blocks of size 2^( 4) =       0.000446432094
  error estimate for blocks of size 2^( 5) =       0.000455940164
  error estimate for blocks of size 2^( 6) =       0.000464584718
  error estimate for blocks of size 2^( 7) =       0.000469176246

      target function =                  N/A
              le_mean =     -16.925226881874
             les_mean =     286.800937858596
             stat err =       0.000459033306
             autocorr =       1.248169228406
              std dev =       0.581061979922
             le_variance =       0.337633024511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723379400
                                         uncertainty =       0.006202389516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723379400
                                         uncertainty =       0.006202389516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872839
  error estimate for blocks of size 2^( 2) =       0.000422674225
  error estimate for blocks of size 2^( 3) =       0.000435359232
  error estimate for blocks of size 2^( 4) =       0.000446432069
  error estimate for blocks of size 2^( 5) =       0.000455940140
  error estimate for blocks of size 2^( 6) =       0.000464584698
  error estimate for blocks of size 2^( 7) =       0.000469176227

      target function =                  N/A
              le_mean =     -16.925226881288
             les_mean =     286.800937794012
             stat err =       0.000459033284
             autocorr =       1.248169273466
              std dev =       0.581061941401
             le_variance =       0.337632979745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723340209
                                         uncertainty =       0.006202386572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337723340209
                                         uncertainty =       0.006202386572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410872815
  error estimate for blocks of size 2^( 2) =       0.000422674201
  error estimate for blocks of size 2^( 3) =       0.000435359209
  error estimate for blocks of size 2^( 4) =       0.000446432047
  error estimate for blocks of size 2^( 5) =       0.000455940120
  error estimate for blocks of size 2^( 6) =       0.000464584680
  error estimate for blocks of size 2^( 7) =       0.000469176210

      target function =                  N/A
              le_mean =     -16.925226880777
             les_mean =     286.800937737504
             stat err =       0.000459033264
             autocorr =       1.248169312930
              std dev =       0.581061907677
             le_variance =       0.337632940553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925226880704        initial
     6.1035e+02     6.1035e+03             5.3473e-07       -16.925226881874  <--
     2.4414e+03     2.4414e+04             1.3369e-07       -16.925226881288
     9.7656e+03     9.7656e+04             3.3422e-08       -16.925226880777

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9708e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.117786e-01 1 1  ON 0
 uu_1                 1.451698e-01 1 1  ON 1
 uu_2                 4.416179e-02 1 1  ON 2
 uu_3                -1.871300e-02 1 1  ON 3
 uu_4                -6.451112e-02 1 1  ON 4
 uu_5                -9.825781e-02 1 1  ON 5
 uu_6                -1.249134e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342706e-01 1 1  ON 8
 uu_9                -1.042378e-01 1 1  ON 9
 ud_0                 4.356247e-01 1 1  ON 10
 ud_1                 1.704569e-01 1 1  ON 11
 ud_2                 5.190155e-02 1 1  ON 12
 ud_3                -1.639074e-02 1 1  ON 13
 ud_4                -6.987697e-02 1 1  ON 14
 ud_5                -1.062044e-01 1 1  ON 15
 ud_6                -1.280624e-01 1 1  ON 16
 ud_7                -1.398952e-01 1 1  ON 17
 ud_8                -1.384049e-01 1 1  ON 18
 ud_9                -1.310104e-01 1 1  ON 19
 eO_0                -7.720948e-01 1 1  ON 20
 eO_1                -4.509357e-01 1 1  ON 21
 eO_2                -2.865066e-02 1 1  ON 22
 eO_3                 2.971181e-01 1 1  ON 23
 eO_4                 5.342263e-01 1 1  ON 24
 eO_5                 4.965545e-01 1 1  ON 25
 eO_6                 2.622509e-01 1 1  ON 26
 eO_7                -4.495876e-02 1 1  ON 27
 eO_8                -2.159530e-01 1 1  ON 28
 eO_9                -7.698224e-02 1 1  ON 29
eH1_0                -2.352173e-01 1 1  ON 30
eH1_1                -1.385808e-01 1 1  ON 31
eH1_2                -9.411552e-02 1 1  ON 32
eH1_3                -3.936546e-02 1 1  ON 33
eH1_4                 4.006522e-03 1 1  ON 34
eH1_5                 3.748746e-02 1 1  ON 35
eH1_6                 9.330572e-02 1 1  ON 36
eH1_7                 1.483230e-01 1 1  ON 37
eH1_8                 1.695013e-01 1 1  ON 38
eH1_9                 5.751989e-02 1 1  ON 39
eH2_0                -2.322591e-01 1 1  ON 40
eH2_1                -1.352148e-01 1 1  ON 41
eH2_2                -9.070414e-02 1 1  ON 42
eH2_3                -3.604373e-02 1 1  ON 43
eH2_4                 7.933515e-03 1 1  ON 44
eH2_5                 4.077847e-02 1 1  ON 45
eH2_6                 9.627878e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741039e-01 1 1  ON 48
eH2_9                 4.224498e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.885
    reference variance = 0.160424
====================================================
  Execution time = 2.0730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334043503404
                                         uncertainty =       0.003334850195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334043503404
                                         uncertainty =       0.003334850195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408604481
  error estimate for blocks of size 2^( 2) =       0.000420822054
  error estimate for blocks of size 2^( 3) =       0.000433068229
  error estimate for blocks of size 2^( 4) =       0.000443915815
  error estimate for blocks of size 2^( 5) =       0.000452573506
  error estimate for blocks of size 2^( 6) =       0.000458176274
  error estimate for blocks of size 2^( 7) =       0.000462102445

      target function =                  N/A
              le_mean =     -16.924663287851
             les_mean =     286.778142483521
             stat err =       0.000454192010
             autocorr =       1.235585294684
              std dev =       0.577853998290
             le_variance =       0.333915243340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692466328785e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924663287851       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924663292677       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924663294249       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924663296168       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924663295425       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924663295698       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924663295610       residual = 8.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.418345e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924663287851       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924663289058       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924663289452       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924663289932       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924663289747       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924663289814       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924663289793       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 6.046140e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924663287851       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924663288153       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924663288252       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924663288372       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924663288325       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924663288343       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924663288338       residual = 8.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.511552e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053340 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6293e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.117784e-01 1 1  ON 0
 uu_1                 1.451700e-01 1 1  ON 1
 uu_2                 4.416183e-02 1 1  ON 2
 uu_3                -1.871287e-02 1 1  ON 3
 uu_4                -6.451101e-02 1 1  ON 4
 uu_5                -9.825781e-02 1 1  ON 5
 uu_6                -1.249133e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342707e-01 1 1  ON 8
 uu_9                -1.042380e-01 1 1  ON 9
 ud_0                 4.356248e-01 1 1  ON 10
 ud_1                 1.704567e-01 1 1  ON 11
 ud_2                 5.190150e-02 1 1  ON 12
 ud_3                -1.639090e-02 1 1  ON 13
 ud_4                -6.987721e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280624e-01 1 1  ON 16
 ud_7                -1.398952e-01 1 1  ON 17
 ud_8                -1.384049e-01 1 1  ON 18
 ud_9                -1.310103e-01 1 1  ON 19
 eO_0                -7.720950e-01 1 1  ON 20
 eO_1                -4.509360e-01 1 1  ON 21
 eO_2                -2.865085e-02 1 1  ON 22
 eO_3                 2.971180e-01 1 1  ON 23
 eO_4                 5.342264e-01 1 1  ON 24
 eO_5                 4.965550e-01 1 1  ON 25
 eO_6                 2.622515e-01 1 1  ON 26
 eO_7                -4.495857e-02 1 1  ON 27
 eO_8                -2.159533e-01 1 1  ON 28
 eO_9                -7.698248e-02 1 1  ON 29
eH1_0                -2.352172e-01 1 1  ON 30
eH1_1                -1.385808e-01 1 1  ON 31
eH1_2                -9.411554e-02 1 1  ON 32
eH1_3                -3.936565e-02 1 1  ON 33
eH1_4                 4.006455e-03 1 1  ON 34
eH1_5                 3.748723e-02 1 1  ON 35
eH1_6                 9.330557e-02 1 1  ON 36
eH1_7                 1.483230e-01 1 1  ON 37
eH1_8                 1.695015e-01 1 1  ON 38
eH1_9                 5.752011e-02 1 1  ON 39
eH2_0                -2.322591e-01 1 1  ON 40
eH2_1                -1.352148e-01 1 1  ON 41
eH2_2                -9.070424e-02 1 1  ON 42
eH2_3                -3.604363e-02 1 1  ON 43
eH2_4                 7.933328e-03 1 1  ON 44
eH2_5                 4.077839e-02 1 1  ON 45
eH2_6                 9.627862e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741042e-01 1 1  ON 48
eH2_9                 4.224527e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9135
    reference variance = 0.291347
====================================================
  Execution time = 2.0500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3963e-01
  Total weights = 2.0000e+06
  Execution time = 1.8749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532617623
                                         uncertainty =       0.003484911045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532617623
                                         uncertainty =       0.003484911045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412083386
  error estimate for blocks of size 2^( 2) =       0.000424528967
  error estimate for blocks of size 2^( 3) =       0.000436879728
  error estimate for blocks of size 2^( 4) =       0.000448262671
  error estimate for blocks of size 2^( 5) =       0.000457249199
  error estimate for blocks of size 2^( 6) =       0.000463935129
  error estimate for blocks of size 2^( 7) =       0.000467106808

      target function =                  N/A
              le_mean =     -16.924749859671
             les_mean =     286.786783075909
             stat err =       0.000459138452
             autocorr =       1.241415379010
              std dev =       0.582773912676
             le_variance =       0.339625433295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339533331031
                                         uncertainty =       0.003484917789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339533331031
                                         uncertainty =       0.003484917789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412083819
  error estimate for blocks of size 2^( 2) =       0.000424529382
  error estimate for blocks of size 2^( 3) =       0.000436880116
  error estimate for blocks of size 2^( 4) =       0.000448263025
  error estimate for blocks of size 2^( 5) =       0.000457249545
  error estimate for blocks of size 2^( 6) =       0.000463935466
  error estimate for blocks of size 2^( 7) =       0.000467107100

      target function =                  N/A
              le_mean =     -16.924749867606
             les_mean =     286.786784058359
             stat err =       0.000459138784
             autocorr =       1.241414566956
              std dev =       0.582774525131
             le_variance =       0.339626147141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532975255
                                         uncertainty =       0.003484914427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532975255
                                         uncertainty =       0.003484914427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412083603
  error estimate for blocks of size 2^( 2) =       0.000424529175
  error estimate for blocks of size 2^( 3) =       0.000436879922
  error estimate for blocks of size 2^( 4) =       0.000448262848
  error estimate for blocks of size 2^( 5) =       0.000457249372
  error estimate for blocks of size 2^( 6) =       0.000463935298
  error estimate for blocks of size 2^( 7) =       0.000467106955

      target function =                  N/A
              le_mean =     -16.924749863642
             les_mean =     286.786783568175
             stat err =       0.000459138619
             autocorr =       1.241414972139
              std dev =       0.582774219700
             le_variance =       0.339625791147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532662355
                                         uncertainty =       0.003484911468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339532662355
                                         uncertainty =       0.003484911468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412083413
  error estimate for blocks of size 2^( 2) =       0.000424528993
  error estimate for blocks of size 2^( 3) =       0.000436879752
  error estimate for blocks of size 2^( 4) =       0.000448262693
  error estimate for blocks of size 2^( 5) =       0.000457249221
  error estimate for blocks of size 2^( 6) =       0.000463935151
  error estimate for blocks of size 2^( 7) =       0.000467106827

      target function =                  N/A
              le_mean =     -16.924749860167
             les_mean =     286.786783137471
             stat err =       0.000459138473
             autocorr =       1.241415328127
              std dev =       0.582773951078
             le_variance =       0.339625478055


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924749859671        initial
     1.5259e+02     1.5259e+03             2.4183e-06       -16.924749867606  <--
     6.1035e+02     6.1035e+03             6.0461e-07       -16.924749863642
     2.4414e+03     2.4414e+04             1.5116e-07       -16.924749860167

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.9996e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.117778e-01 1 1  ON 0
 uu_1                 1.451705e-01 1 1  ON 1
 uu_2                 4.416195e-02 1 1  ON 2
 uu_3                -1.871247e-02 1 1  ON 3
 uu_4                -6.451068e-02 1 1  ON 4
 uu_5                -9.825779e-02 1 1  ON 5
 uu_6                -1.249133e-01 1 1  ON 6
 uu_7                -1.391438e-01 1 1  ON 7
 uu_8                -1.342711e-01 1 1  ON 8
 uu_9                -1.042387e-01 1 1  ON 9
 ud_0                 4.356253e-01 1 1  ON 10
 ud_1                 1.704563e-01 1 1  ON 11
 ud_2                 5.190135e-02 1 1  ON 12
 ud_3                -1.639138e-02 1 1  ON 13
 ud_4                -6.987791e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280623e-01 1 1  ON 16
 ud_7                -1.398951e-01 1 1  ON 17
 ud_8                -1.384047e-01 1 1  ON 18
 ud_9                -1.310098e-01 1 1  ON 19
 eO_0                -7.720956e-01 1 1  ON 20
 eO_1                -4.509369e-01 1 1  ON 21
 eO_2                -2.865142e-02 1 1  ON 22
 eO_3                 2.971176e-01 1 1  ON 23
 eO_4                 5.342267e-01 1 1  ON 24
 eO_5                 4.965563e-01 1 1  ON 25
 eO_6                 2.622533e-01 1 1  ON 26
 eO_7                -4.495799e-02 1 1  ON 27
 eO_8                -2.159541e-01 1 1  ON 28
 eO_9                -7.698320e-02 1 1  ON 29
eH1_0                -2.352169e-01 1 1  ON 30
eH1_1                -1.385806e-01 1 1  ON 31
eH1_2                -9.411560e-02 1 1  ON 32
eH1_3                -3.936619e-02 1 1  ON 33
eH1_4                 4.006254e-03 1 1  ON 34
eH1_5                 3.748655e-02 1 1  ON 35
eH1_6                 9.330512e-02 1 1  ON 36
eH1_7                 1.483233e-01 1 1  ON 37
eH1_8                 1.695023e-01 1 1  ON 38
eH1_9                 5.752078e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352150e-01 1 1  ON 41
eH2_2                -9.070453e-02 1 1  ON 42
eH2_3                -3.604333e-02 1 1  ON 43
eH2_4                 7.932768e-03 1 1  ON 44
eH2_5                 4.077817e-02 1 1  ON 45
eH2_6                 9.627812e-02 1 1  ON 46
eH2_7                 1.506097e-01 1 1  ON 47
eH2_8                 1.741048e-01 1 1  ON 48
eH2_9                 4.224614e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9808
    reference variance = 0.432163
====================================================
  Execution time = 2.1026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4015e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340160422996
                                         uncertainty =       0.004101240318

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340160422996
                                         uncertainty =       0.004101240318

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412402519
  error estimate for blocks of size 2^( 2) =       0.000425032085
  error estimate for blocks of size 2^( 3) =       0.000437418391
  error estimate for blocks of size 2^( 4) =       0.000449358413
  error estimate for blocks of size 2^( 5) =       0.000458443291
  error estimate for blocks of size 2^( 6) =       0.000464759306
  error estimate for blocks of size 2^( 7) =       0.000469038799

      target function =                  N/A
              le_mean =     -16.924780788565
             les_mean =     286.788356245689
             stat err =       0.000460399952
             autocorr =       1.246315285582
              std dev =       0.583225235026
             le_variance =       0.340151674771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692478078857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924780788565       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924780798608       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924780799878       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924780802616       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924780813843       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924780803913       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924780810969       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924780811721       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.161242e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924780788565       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924780791080       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924780791407       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924780792095       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924780794909       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924780792389       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924780794164       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924780794352       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.040571e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924780788565       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924780789194       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924780789277       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924780789449       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924780790153       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924780789521       residual = 8.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924780789965       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924780790013       residual = 5.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.101583e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055993 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6643e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.117779e-01 1 1  ON 0
 uu_1                 1.451713e-01 1 1  ON 1
 uu_2                 4.416261e-02 1 1  ON 2
 uu_3                -1.871206e-02 1 1  ON 3
 uu_4                -6.451082e-02 1 1  ON 4
 uu_5                -9.825788e-02 1 1  ON 5
 uu_6                -1.249142e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342715e-01 1 1  ON 8
 uu_9                -1.042396e-01 1 1  ON 9
 ud_0                 4.356248e-01 1 1  ON 10
 ud_1                 1.704555e-01 1 1  ON 11
 ud_2                 5.190023e-02 1 1  ON 12
 ud_3                -1.639211e-02 1 1  ON 13
 ud_4                -6.987864e-02 1 1  ON 14
 ud_5                -1.062032e-01 1 1  ON 15
 ud_6                -1.280615e-01 1 1  ON 16
 ud_7                -1.398945e-01 1 1  ON 17
 ud_8                -1.384041e-01 1 1  ON 18
 ud_9                -1.310094e-01 1 1  ON 19
 eO_0                -7.720964e-01 1 1  ON 20
 eO_1                -4.509390e-01 1 1  ON 21
 eO_2                -2.865172e-02 1 1  ON 22
 eO_3                 2.971175e-01 1 1  ON 23
 eO_4                 5.342272e-01 1 1  ON 24
 eO_5                 4.965577e-01 1 1  ON 25
 eO_6                 2.622554e-01 1 1  ON 26
 eO_7                -4.495704e-02 1 1  ON 27
 eO_8                -2.159548e-01 1 1  ON 28
 eO_9                -7.698400e-02 1 1  ON 29
eH1_0                -2.352166e-01 1 1  ON 30
eH1_1                -1.385808e-01 1 1  ON 31
eH1_2                -9.411522e-02 1 1  ON 32
eH1_3                -3.936682e-02 1 1  ON 33
eH1_4                 4.006174e-03 1 1  ON 34
eH1_5                 3.748528e-02 1 1  ON 35
eH1_6                 9.330419e-02 1 1  ON 36
eH1_7                 1.483235e-01 1 1  ON 37
eH1_8                 1.695033e-01 1 1  ON 38
eH1_9                 5.752190e-02 1 1  ON 39
eH2_0                -2.322593e-01 1 1  ON 40
eH2_1                -1.352141e-01 1 1  ON 41
eH2_2                -9.070481e-02 1 1  ON 42
eH2_3                -3.604323e-02 1 1  ON 43
eH2_4                 7.931958e-03 1 1  ON 44
eH2_5                 4.077681e-02 1 1  ON 45
eH2_6                 9.627802e-02 1 1  ON 46
eH2_7                 1.506098e-01 1 1  ON 47
eH2_8                 1.741053e-01 1 1  ON 48
eH2_9                 4.224721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.254237
====================================================
  Execution time = 2.0455e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3109e-01
  Total weights = 2.0000e+06
  Execution time = 2.4171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082351422
                                         uncertainty =       0.002457667027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082351422
                                         uncertainty =       0.002457667027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406872668
  error estimate for blocks of size 2^( 2) =       0.000419444687
  error estimate for blocks of size 2^( 3) =       0.000432519322
  error estimate for blocks of size 2^( 4) =       0.000443242547
  error estimate for blocks of size 2^( 5) =       0.000453677051
  error estimate for blocks of size 2^( 6) =       0.000460775761
  error estimate for blocks of size 2^( 7) =       0.000469079706

      target function =                  N/A
              le_mean =     -16.924336032362
             les_mean =     286.764240706229
             stat err =       0.000456693766
             autocorr =       1.259891466718
              std dev =       0.575404844839
             le_variance =       0.331090735465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331083379591
                                         uncertainty =       0.002457676035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331083379591
                                         uncertainty =       0.002457676035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406873299
  error estimate for blocks of size 2^( 2) =       0.000419445256
  error estimate for blocks of size 2^( 3) =       0.000432519830
  error estimate for blocks of size 2^( 4) =       0.000443242973
  error estimate for blocks of size 2^( 5) =       0.000453677461
  error estimate for blocks of size 2^( 6) =       0.000460776109
  error estimate for blocks of size 2^( 7) =       0.000469080193

      target function =                  N/A
              le_mean =     -16.924336052272
             les_mean =     286.764242407869
             stat err =       0.000456694184
             autocorr =       1.259889860507
              std dev =       0.575405737868
             le_variance =       0.331091763172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082873196
                                         uncertainty =       0.002457671606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082873196
                                         uncertainty =       0.002457671606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406872988
  error estimate for blocks of size 2^( 2) =       0.000419444976
  error estimate for blocks of size 2^( 3) =       0.000432519580
  error estimate for blocks of size 2^( 4) =       0.000443242763
  error estimate for blocks of size 2^( 5) =       0.000453677260
  error estimate for blocks of size 2^( 6) =       0.000460775938
  error estimate for blocks of size 2^( 7) =       0.000469079954

      target function =                  N/A
              le_mean =     -16.924336042376
             les_mean =     286.764241566721
             stat err =       0.000456693979
             autocorr =       1.259890654719
              std dev =       0.575405298034
             le_variance =       0.331091257006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082416876
                                         uncertainty =       0.002457667601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331082416876
                                         uncertainty =       0.002457667601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406872708
  error estimate for blocks of size 2^( 2) =       0.000419444724
  error estimate for blocks of size 2^( 3) =       0.000432519355
  error estimate for blocks of size 2^( 4) =       0.000443242574
  error estimate for blocks of size 2^( 5) =       0.000453677078
  error estimate for blocks of size 2^( 6) =       0.000460775783
  error estimate for blocks of size 2^( 7) =       0.000469079737

      target function =                  N/A
              le_mean =     -16.924336033614
             les_mean =     286.764240814019
             stat err =       0.000456693793
             autocorr =       1.259891364936
              std dev =       0.575404901691
             le_variance =       0.331090800890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924336032362        initial
     3.8147e+01     3.8147e+02             8.1612e-06       -16.924336052272  <--
     1.5259e+02     1.5259e+03             2.0406e-06       -16.924336042376
     6.1035e+02     6.1035e+03             5.1016e-07       -16.924336033614

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 3.0880e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.117781e-01 1 1  ON 0
 uu_1                 1.451738e-01 1 1  ON 1
 uu_2                 4.416455e-02 1 1  ON 2
 uu_3                -1.871086e-02 1 1  ON 3
 uu_4                -6.451123e-02 1 1  ON 4
 uu_5                -9.825814e-02 1 1  ON 5
 uu_6                -1.249169e-01 1 1  ON 6
 uu_7                -1.391439e-01 1 1  ON 7
 uu_8                -1.342725e-01 1 1  ON 8
 uu_9                -1.042423e-01 1 1  ON 9
 ud_0                 4.356231e-01 1 1  ON 10
 ud_1                 1.704533e-01 1 1  ON 11
 ud_2                 5.189688e-02 1 1  ON 12
 ud_3                -1.639431e-02 1 1  ON 13
 ud_4                -6.988080e-02 1 1  ON 14
 ud_5                -1.062006e-01 1 1  ON 15
 ud_6                -1.280591e-01 1 1  ON 16
 ud_7                -1.398926e-01 1 1  ON 17
 ud_8                -1.384020e-01 1 1  ON 18
 ud_9                -1.310080e-01 1 1  ON 19
 eO_0                -7.720988e-01 1 1  ON 20
 eO_1                -4.509450e-01 1 1  ON 21
 eO_2                -2.865262e-02 1 1  ON 22
 eO_3                 2.971169e-01 1 1  ON 23
 eO_4                 5.342288e-01 1 1  ON 24
 eO_5                 4.965619e-01 1 1  ON 25
 eO_6                 2.622615e-01 1 1  ON 26
 eO_7                -4.495418e-02 1 1  ON 27
 eO_8                -2.159570e-01 1 1  ON 28
 eO_9                -7.698638e-02 1 1  ON 29
eH1_0                -2.352156e-01 1 1  ON 30
eH1_1                -1.385814e-01 1 1  ON 31
eH1_2                -9.411411e-02 1 1  ON 32
eH1_3                -3.936867e-02 1 1  ON 33
eH1_4                 4.005922e-03 1 1  ON 34
eH1_5                 3.748147e-02 1 1  ON 35
eH1_6                 9.330138e-02 1 1  ON 36
eH1_7                 1.483241e-01 1 1  ON 37
eH1_8                 1.695065e-01 1 1  ON 38
eH1_9                 5.752529e-02 1 1  ON 39
eH2_0                -2.322595e-01 1 1  ON 40
eH2_1                -1.352116e-01 1 1  ON 41
eH2_2                -9.070564e-02 1 1  ON 42
eH2_3                -3.604292e-02 1 1  ON 43
eH2_4                 7.929529e-03 1 1  ON 44
eH2_5                 4.077275e-02 1 1  ON 45
eH2_6                 9.627771e-02 1 1  ON 46
eH2_7                 1.506100e-01 1 1  ON 47
eH2_8                 1.741066e-01 1 1  ON 48
eH2_9                 4.225042e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9334
    reference variance = 0.173075
====================================================
  Execution time = 2.1193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5347e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338825102456
                                         uncertainty =       0.004459701688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338825102456
                                         uncertainty =       0.004459701688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411535874
  error estimate for blocks of size 2^( 2) =       0.000423438306
  error estimate for blocks of size 2^( 3) =       0.000435425082
  error estimate for blocks of size 2^( 4) =       0.000446226169
  error estimate for blocks of size 2^( 5) =       0.000454901958
  error estimate for blocks of size 2^( 6) =       0.000461239328
  error estimate for blocks of size 2^( 7) =       0.000465317124

      target function =                  N/A
              le_mean =     -16.924029194660
             les_mean =     286.761487563082
             stat err =       0.000456921145
             autocorr =       1.232727584974
              std dev =       0.581999614026
             le_variance =       0.338723550726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692402919466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029194660       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924029216835       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924029281708       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924029261937       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924029288788       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924029283215       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924029290369       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924029286613       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 3.413582e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029194660       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924029200275       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924029216676       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924029211522       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924029218444       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924029217199       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924029218989       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924029218069       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.542990e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924029194660       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924029196069       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924029200181       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924029198879       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924029200621       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924029200320       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924029200768       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924029200540       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.136246e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058657 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6739e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.117800e-01 1 1  ON 0
 uu_1                 1.451764e-01 1 1  ON 1
 uu_2                 4.416514e-02 1 1  ON 2
 uu_3                -1.870873e-02 1 1  ON 3
 uu_4                -6.450728e-02 1 1  ON 4
 uu_5                -9.825816e-02 1 1  ON 5
 uu_6                -1.249229e-01 1 1  ON 6
 uu_7                -1.391435e-01 1 1  ON 7
 uu_8                -1.342754e-01 1 1  ON 8
 uu_9                -1.042475e-01 1 1  ON 9
 ud_0                 4.356279e-01 1 1  ON 10
 ud_1                 1.704505e-01 1 1  ON 11
 ud_2                 5.189443e-02 1 1  ON 12
 ud_3                -1.639586e-02 1 1  ON 13
 ud_4                -6.988362e-02 1 1  ON 14
 ud_5                -1.062014e-01 1 1  ON 15
 ud_6                -1.280576e-01 1 1  ON 16
 ud_7                -1.398914e-01 1 1  ON 17
 ud_8                -1.383995e-01 1 1  ON 18
 ud_9                -1.310067e-01 1 1  ON 19
 eO_0                -7.721008e-01 1 1  ON 20
 eO_1                -4.509514e-01 1 1  ON 21
 eO_2                -2.865613e-02 1 1  ON 22
 eO_3                 2.971139e-01 1 1  ON 23
 eO_4                 5.342336e-01 1 1  ON 24
 eO_5                 4.965697e-01 1 1  ON 25
 eO_6                 2.622700e-01 1 1  ON 26
 eO_7                -4.495089e-02 1 1  ON 27
 eO_8                -2.159620e-01 1 1  ON 28
 eO_9                -7.699027e-02 1 1  ON 29
eH1_0                -2.352145e-01 1 1  ON 30
eH1_1                -1.385802e-01 1 1  ON 31
eH1_2                -9.411417e-02 1 1  ON 32
eH1_3                -3.937075e-02 1 1  ON 33
eH1_4                 4.006659e-03 1 1  ON 34
eH1_5                 3.747698e-02 1 1  ON 35
eH1_6                 9.329706e-02 1 1  ON 36
eH1_7                 1.483244e-01 1 1  ON 37
eH1_8                 1.695100e-01 1 1  ON 38
eH1_9                 5.752949e-02 1 1  ON 39
eH2_0                -2.322579e-01 1 1  ON 40
eH2_1                -1.352099e-01 1 1  ON 41
eH2_2                -9.070546e-02 1 1  ON 42
eH2_3                -3.604484e-02 1 1  ON 43
eH2_4                 7.928544e-03 1 1  ON 44
eH2_5                 4.076971e-02 1 1  ON 45
eH2_6                 9.627556e-02 1 1  ON 46
eH2_7                 1.506079e-01 1 1  ON 47
eH2_8                 1.741084e-01 1 1  ON 48
eH2_9                 4.225522e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.7675
    reference variance = 3.38581
====================================================
  Execution time = 2.2151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3821e-01
  Total weights = 2.0000e+06
  Execution time = 1.8824e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133089558
                                         uncertainty =       0.005502725566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338133089558
                                         uncertainty =       0.005502725566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411219172
  error estimate for blocks of size 2^( 2) =       0.000423223457
  error estimate for blocks of size 2^( 3) =       0.000435515814
  error estimate for blocks of size 2^( 4) =       0.000446471585
  error estimate for blocks of size 2^( 5) =       0.000456517646
  error estimate for blocks of size 2^( 6) =       0.000463005160
  error estimate for blocks of size 2^( 7) =       0.000465825478

      target function =                  N/A
              le_mean =     -16.924675996414
             les_mean =     286.782859830145
             stat err =       0.000457954967
             autocorr =       1.240220307680
              std dev =       0.581551730841
             le_variance =       0.338202415644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338158984649
                                         uncertainty =       0.005503211587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338158984649
                                         uncertainty =       0.005503211587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411234915
  error estimate for blocks of size 2^( 2) =       0.000423238360
  error estimate for blocks of size 2^( 3) =       0.000435530042
  error estimate for blocks of size 2^( 4) =       0.000446485206
  error estimate for blocks of size 2^( 5) =       0.000456530674
  error estimate for blocks of size 2^( 6) =       0.000463017859
  error estimate for blocks of size 2^( 7) =       0.000465837008

      target function =                  N/A
              le_mean =     -16.924676102277
             les_mean =     286.782889308716
             stat err =       0.000457967687
             autocorr =       1.240194243294
              std dev =       0.581573994304
             le_variance =       0.338228310851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146534329
                                         uncertainty =       0.005502979211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338146534329
                                         uncertainty =       0.005502979211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411227346
  error estimate for blocks of size 2^( 2) =       0.000423231194
  error estimate for blocks of size 2^( 3) =       0.000435523203
  error estimate for blocks of size 2^( 4) =       0.000446478661
  error estimate for blocks of size 2^( 5) =       0.000456524416
  error estimate for blocks of size 2^( 6) =       0.000463011761
  error estimate for blocks of size 2^( 7) =       0.000465831477

      target function =                  N/A
              le_mean =     -16.924676051401
             les_mean =     286.782875136143
             stat err =       0.000457961579
             autocorr =       1.240206815689
              std dev =       0.581563290107
             le_variance =       0.338215860401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134786077
                                         uncertainty =       0.005502757619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338134786077
                                         uncertainty =       0.005502757619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411220204
  error estimate for blocks of size 2^( 2) =       0.000423224434
  error estimate for blocks of size 2^( 3) =       0.000435516747
  error estimate for blocks of size 2^( 4) =       0.000446472478
  error estimate for blocks of size 2^( 5) =       0.000456518500
  error estimate for blocks of size 2^( 6) =       0.000463005993
  error estimate for blocks of size 2^( 7) =       0.000465826236

      target function =                  N/A
              le_mean =     -16.924676003311
             les_mean =     286.782861760120
             stat err =       0.000457955802
             autocorr =       1.240218606113
              std dev =       0.581553189449
             le_variance =       0.338204112158


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924675996414        initial
     9.5367e+00     9.5367e+01             3.4136e-05       -16.924676102277  <--
     3.8147e+01     3.8147e+02             8.5430e-06       -16.924676051401
     1.5259e+02     1.5259e+03             2.1362e-06       -16.924676003311

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 3.1693e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.117858e-01 1 1  ON 0
 uu_1                 1.451840e-01 1 1  ON 1
 uu_2                 4.416714e-02 1 1  ON 2
 uu_3                -1.870232e-02 1 1  ON 3
 uu_4                -6.449572e-02 1 1  ON 4
 uu_5                -9.825813e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042630e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704424e-01 1 1  ON 11
 ud_2                 5.188727e-02 1 1  ON 12
 ud_3                -1.640053e-02 1 1  ON 13
 ud_4                -6.989177e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280531e-01 1 1  ON 16
 ud_7                -1.398876e-01 1 1  ON 17
 ud_8                -1.383919e-01 1 1  ON 18
 ud_9                -1.310028e-01 1 1  ON 19
 eO_0                -7.721070e-01 1 1  ON 20
 eO_1                -4.509701e-01 1 1  ON 21
 eO_2                -2.866682e-02 1 1  ON 22
 eO_3                 2.971049e-01 1 1  ON 23
 eO_4                 5.342480e-01 1 1  ON 24
 eO_5                 4.965929e-01 1 1  ON 25
 eO_6                 2.622956e-01 1 1  ON 26
 eO_7                -4.494105e-02 1 1  ON 27
 eO_8                -2.159768e-01 1 1  ON 28
 eO_9                -7.700190e-02 1 1  ON 29
eH1_0                -2.352113e-01 1 1  ON 30
eH1_1                -1.385767e-01 1 1  ON 31
eH1_2                -9.411438e-02 1 1  ON 32
eH1_3                -3.937679e-02 1 1  ON 33
eH1_4                 4.008768e-03 1 1  ON 34
eH1_5                 3.746356e-02 1 1  ON 35
eH1_6                 9.328411e-02 1 1  ON 36
eH1_7                 1.483255e-01 1 1  ON 37
eH1_8                 1.695204e-01 1 1  ON 38
eH1_9                 5.754208e-02 1 1  ON 39
eH2_0                -2.322531e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070499e-02 1 1  ON 42
eH2_3                -3.605043e-02 1 1  ON 43
eH2_4                 7.925558e-03 1 1  ON 44
eH2_5                 4.076063e-02 1 1  ON 45
eH2_6                 9.626910e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741137e-01 1 1  ON 48
eH2_9                 4.226956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9149
    reference variance = 0.170198
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332198410453
                                         uncertainty =       0.003061311931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332198410453
                                         uncertainty =       0.003061311931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407527644
  error estimate for blocks of size 2^( 2) =       0.000420122305
  error estimate for blocks of size 2^( 3) =       0.000431808106
  error estimate for blocks of size 2^( 4) =       0.000442906497
  error estimate for blocks of size 2^( 5) =       0.000451286558
  error estimate for blocks of size 2^( 6) =       0.000457740860
  error estimate for blocks of size 2^( 7) =       0.000461826416

      target function =                  N/A
              le_mean =     -16.924848226633
             les_mean =     286.782644889945
             stat err =       0.000453440083
             autocorr =       1.238014319325
              std dev =       0.576331121372
             le_variance =       0.332157561462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692484822663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924848226633       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924848488905       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924848596809       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924848649303       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924848948471       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924848885728       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924848917328       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924848914657       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.791560e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924848226633       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924848294589       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924848327814       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924848342450       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924848417881       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924848399110       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924848404915       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924848405682       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 4.498459e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924848226633       residual = 7.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924848243778       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924848252567       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924848256318       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924848275185       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924848270290       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924848271579       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924848271872       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.125917e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6082e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.117788e-01 1 1  ON 0
 uu_1                 1.451900e-01 1 1  ON 1
 uu_2                 4.418166e-02 1 1  ON 2
 uu_3                -1.869745e-02 1 1  ON 3
 uu_4                -6.448586e-02 1 1  ON 4
 uu_5                -9.827010e-02 1 1  ON 5
 uu_6                -1.249371e-01 1 1  ON 6
 uu_7                -1.391384e-01 1 1  ON 7
 uu_8                -1.342978e-01 1 1  ON 8
 uu_9                -1.042860e-01 1 1  ON 9
 ud_0                 4.356483e-01 1 1  ON 10
 ud_1                 1.704363e-01 1 1  ON 11
 ud_2                 5.188084e-02 1 1  ON 12
 ud_3                -1.640801e-02 1 1  ON 13
 ud_4                -6.989111e-02 1 1  ON 14
 ud_5                -1.062049e-01 1 1  ON 15
 ud_6                -1.280492e-01 1 1  ON 16
 ud_7                -1.398775e-01 1 1  ON 17
 ud_8                -1.383943e-01 1 1  ON 18
 ud_9                -1.310016e-01 1 1  ON 19
 eO_0                -7.721284e-01 1 1  ON 20
 eO_1                -4.509868e-01 1 1  ON 21
 eO_2                -2.868697e-02 1 1  ON 22
 eO_3                 2.970952e-01 1 1  ON 23
 eO_4                 5.342589e-01 1 1  ON 24
 eO_5                 4.966261e-01 1 1  ON 25
 eO_6                 2.623406e-01 1 1  ON 26
 eO_7                -4.492748e-02 1 1  ON 27
 eO_8                -2.159953e-01 1 1  ON 28
 eO_9                -7.701623e-02 1 1  ON 29
eH1_0                -2.352110e-01 1 1  ON 30
eH1_1                -1.385700e-01 1 1  ON 31
eH1_2                -9.411914e-02 1 1  ON 32
eH1_3                -3.937758e-02 1 1  ON 33
eH1_4                 4.009178e-03 1 1  ON 34
eH1_5                 3.745443e-02 1 1  ON 35
eH1_6                 9.327380e-02 1 1  ON 36
eH1_7                 1.483200e-01 1 1  ON 37
eH1_8                 1.695306e-01 1 1  ON 38
eH1_9                 5.755550e-02 1 1  ON 39
eH2_0                -2.322477e-01 1 1  ON 40
eH2_1                -1.352107e-01 1 1  ON 41
eH2_2                -9.069833e-02 1 1  ON 42
eH2_3                -3.605830e-02 1 1  ON 43
eH2_4                 7.915978e-03 1 1  ON 44
eH2_5                 4.075980e-02 1 1  ON 45
eH2_6                 9.625718e-02 1 1  ON 46
eH2_7                 1.505991e-01 1 1  ON 47
eH2_8                 1.741231e-01 1 1  ON 48
eH2_9                 4.228547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9706
    reference variance = 0.309064
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8687e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334962758418
                                         uncertainty =       0.003350734237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334962758418
                                         uncertainty =       0.003350734237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409233574
  error estimate for blocks of size 2^( 2) =       0.000421718286
  error estimate for blocks of size 2^( 3) =       0.000434165151
  error estimate for blocks of size 2^( 4) =       0.000445035915
  error estimate for blocks of size 2^( 5) =       0.000454148957
  error estimate for blocks of size 2^( 6) =       0.000460948596
  error estimate for blocks of size 2^( 7) =       0.000464285132

      target function =                  N/A
              le_mean =     -16.924556619508
             les_mean =     286.775560835008
             stat err =       0.000456104650
             autocorr =       1.242185591681
              std dev =       0.578743670000
             le_variance =       0.334944235565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985203482
                                         uncertainty =       0.003350876935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334985203482
                                         uncertainty =       0.003350876935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409247285
  error estimate for blocks of size 2^( 2) =       0.000421731362
  error estimate for blocks of size 2^( 3) =       0.000434177044
  error estimate for blocks of size 2^( 4) =       0.000445047306
  error estimate for blocks of size 2^( 5) =       0.000454160121
  error estimate for blocks of size 2^( 6) =       0.000460958608
  error estimate for blocks of size 2^( 7) =       0.000464294204

      target function =                  N/A
              le_mean =     -16.924556150231
             les_mean =     286.775567395384
             stat err =       0.000456115060
             autocorr =       1.242159055044
              std dev =       0.578763060785
             le_variance =       0.334966680529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334975611044
                                         uncertainty =       0.003350808155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334975611044
                                         uncertainty =       0.003350808155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409241425
  error estimate for blocks of size 2^( 2) =       0.000421725792
  error estimate for blocks of size 2^( 3) =       0.000434172012
  error estimate for blocks of size 2^( 4) =       0.000445042533
  error estimate for blocks of size 2^( 5) =       0.000454155484
  error estimate for blocks of size 2^( 6) =       0.000460954474
  error estimate for blocks of size 2^( 7) =       0.000464290455

      target function =                  N/A
              le_mean =     -16.924556358775
             les_mean =     286.775564861599
             stat err =       0.000456110737
             autocorr =       1.242171082752
              std dev =       0.578754773403
             le_variance =       0.334957087737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334964415443
                                         uncertainty =       0.003350743510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334964415443
                                         uncertainty =       0.003350743510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409234586
  error estimate for blocks of size 2^( 2) =       0.000421719254
  error estimate for blocks of size 2^( 3) =       0.000434166037
  error estimate for blocks of size 2^( 4) =       0.000445036771
  error estimate for blocks of size 2^( 5) =       0.000454149802
  error estimate for blocks of size 2^( 6) =       0.000460949357
  error estimate for blocks of size 2^( 7) =       0.000464285821

      target function =                  N/A
              le_mean =     -16.924556585548
             les_mean =     286.775561342460
             stat err =       0.000456105438
             autocorr =       1.242183738520
              std dev =       0.578745101507
             le_variance =       0.334945892519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924556619508        initial  <--
     2.3842e+00     2.3842e+01             1.7916e-04       -16.924556150231
     9.5367e+00     9.5367e+01             4.4985e-05       -16.924556358775
     3.8147e+01     3.8147e+02             1.1259e-05       -16.924556585548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6424
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.117858e-01 1 1  ON 0
 uu_1                 1.451840e-01 1 1  ON 1
 uu_2                 4.416714e-02 1 1  ON 2
 uu_3                -1.870232e-02 1 1  ON 3
 uu_4                -6.449572e-02 1 1  ON 4
 uu_5                -9.825813e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042630e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704424e-01 1 1  ON 11
 ud_2                 5.188727e-02 1 1  ON 12
 ud_3                -1.640053e-02 1 1  ON 13
 ud_4                -6.989177e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280531e-01 1 1  ON 16
 ud_7                -1.398876e-01 1 1  ON 17
 ud_8                -1.383919e-01 1 1  ON 18
 ud_9                -1.310028e-01 1 1  ON 19
 eO_0                -7.721070e-01 1 1  ON 20
 eO_1                -4.509701e-01 1 1  ON 21
 eO_2                -2.866682e-02 1 1  ON 22
 eO_3                 2.971049e-01 1 1  ON 23
 eO_4                 5.342480e-01 1 1  ON 24
 eO_5                 4.965929e-01 1 1  ON 25
 eO_6                 2.622956e-01 1 1  ON 26
 eO_7                -4.494105e-02 1 1  ON 27
 eO_8                -2.159768e-01 1 1  ON 28
 eO_9                -7.700190e-02 1 1  ON 29
eH1_0                -2.352113e-01 1 1  ON 30
eH1_1                -1.385767e-01 1 1  ON 31
eH1_2                -9.411438e-02 1 1  ON 32
eH1_3                -3.937679e-02 1 1  ON 33
eH1_4                 4.008768e-03 1 1  ON 34
eH1_5                 3.746356e-02 1 1  ON 35
eH1_6                 9.328411e-02 1 1  ON 36
eH1_7                 1.483255e-01 1 1  ON 37
eH1_8                 1.695204e-01 1 1  ON 38
eH1_9                 5.754208e-02 1 1  ON 39
eH2_0                -2.322531e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070499e-02 1 1  ON 42
eH2_3                -3.605043e-02 1 1  ON 43
eH2_4                 7.925558e-03 1 1  ON 44
eH2_5                 4.076063e-02 1 1  ON 45
eH2_6                 9.626910e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741137e-01 1 1  ON 48
eH2_9                 4.226956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8954
    reference variance = 0.544397
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766800080
                                         uncertainty =       0.005695133478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766800080
                                         uncertainty =       0.005695133478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410278750
  error estimate for blocks of size 2^( 2) =       0.000422647286
  error estimate for blocks of size 2^( 3) =       0.000434902043
  error estimate for blocks of size 2^( 4) =       0.000445908200
  error estimate for blocks of size 2^( 5) =       0.000455303992
  error estimate for blocks of size 2^( 6) =       0.000462665368
  error estimate for blocks of size 2^( 7) =       0.000468248761

      target function =                  N/A
              le_mean =     -16.924281942984
             les_mean =     286.767976423029
             stat err =       0.000458031580
             autocorr =       1.246329278090
              std dev =       0.580221772893
             le_variance =       0.336657305739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692428194298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924281942984       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924281986911       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924282004360       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924282065530       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924282088732       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924282072097       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924282070779       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924282069842       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.316857e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924281942984       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924281954013       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924281958449       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924281973945       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924281979861       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924281975700       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924281975380       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924281975137       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.291623e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924281942984       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924281945744       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924281946858       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924281950745       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924281952231       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924281951190       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924281951111       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924281951050       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 8.228698e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6051e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.117866e-01 1 1  ON 0
 uu_1                 1.451854e-01 1 1  ON 1
 uu_2                 4.416756e-02 1 1  ON 2
 uu_3                -1.870178e-02 1 1  ON 3
 uu_4                -6.449572e-02 1 1  ON 4
 uu_5                -9.825911e-02 1 1  ON 5
 uu_6                -1.249427e-01 1 1  ON 6
 uu_7                -1.391422e-01 1 1  ON 7
 uu_8                -1.342845e-01 1 1  ON 8
 uu_9                -1.042640e-01 1 1  ON 9
 ud_0                 4.356409e-01 1 1  ON 10
 ud_1                 1.704402e-01 1 1  ON 11
 ud_2                 5.188738e-02 1 1  ON 12
 ud_3                -1.640208e-02 1 1  ON 13
 ud_4                -6.989275e-02 1 1  ON 14
 ud_5                -1.062032e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398870e-01 1 1  ON 17
 ud_8                -1.383904e-01 1 1  ON 18
 ud_9                -1.310010e-01 1 1  ON 19
 eO_0                -7.721089e-01 1 1  ON 20
 eO_1                -4.509710e-01 1 1  ON 21
 eO_2                -2.866899e-02 1 1  ON 22
 eO_3                 2.971036e-01 1 1  ON 23
 eO_4                 5.342492e-01 1 1  ON 24
 eO_5                 4.965962e-01 1 1  ON 25
 eO_6                 2.622988e-01 1 1  ON 26
 eO_7                -4.494017e-02 1 1  ON 27
 eO_8                -2.159778e-01 1 1  ON 28
 eO_9                -7.700299e-02 1 1  ON 29
eH1_0                -2.352114e-01 1 1  ON 30
eH1_1                -1.385768e-01 1 1  ON 31
eH1_2                -9.411490e-02 1 1  ON 32
eH1_3                -3.937734e-02 1 1  ON 33
eH1_4                 4.008864e-03 1 1  ON 34
eH1_5                 3.746202e-02 1 1  ON 35
eH1_6                 9.328365e-02 1 1  ON 36
eH1_7                 1.483256e-01 1 1  ON 37
eH1_8                 1.695215e-01 1 1  ON 38
eH1_9                 5.754373e-02 1 1  ON 39
eH2_0                -2.322525e-01 1 1  ON 40
eH2_1                -1.352053e-01 1 1  ON 41
eH2_2                -9.070599e-02 1 1  ON 42
eH2_3                -3.605071e-02 1 1  ON 43
eH2_4                 7.924113e-03 1 1  ON 44
eH2_5                 4.075962e-02 1 1  ON 45
eH2_6                 9.626843e-02 1 1  ON 46
eH2_7                 1.506020e-01 1 1  ON 47
eH2_8                 1.741154e-01 1 1  ON 48
eH2_9                 4.227162e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9154
    reference variance = 0.199391
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5543e-01
  Total weights = 2.0000e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355500779587
                                         uncertainty =       0.015654864517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355500779587
                                         uncertainty =       0.015654864517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421560054
  error estimate for blocks of size 2^( 2) =       0.000433758740
  error estimate for blocks of size 2^( 3) =       0.000445625032
  error estimate for blocks of size 2^( 4) =       0.000456809311
  error estimate for blocks of size 2^( 5) =       0.000466952010
  error estimate for blocks of size 2^( 6) =       0.000472971617
  error estimate for blocks of size 2^( 7) =       0.000479435461

      target function =                  N/A
              le_mean =     -16.924342658427
             les_mean =     286.788800000451
             stat err =       0.000469042100
             autocorr =       1.237954686307
              std dev =       0.596175945757
             le_variance =       0.355425758299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355503976949
                                         uncertainty =       0.015654840580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355503976949
                                         uncertainty =       0.015654840580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421561946
  error estimate for blocks of size 2^( 2) =       0.000433760567
  error estimate for blocks of size 2^( 3) =       0.000445626804
  error estimate for blocks of size 2^( 4) =       0.000456811064
  error estimate for blocks of size 2^( 5) =       0.000466953564
  error estimate for blocks of size 2^( 6) =       0.000472973197
  error estimate for blocks of size 2^( 7) =       0.000479437200

      target function =                  N/A
              le_mean =     -16.924342624875
             les_mean =     286.788802055605
             stat err =       0.000469043756
             autocorr =       1.237952314394
              std dev =       0.596178621864
             le_variance =       0.355428949167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355502414508
                                         uncertainty =       0.015654852964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355502414508
                                         uncertainty =       0.015654852964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421561022
  error estimate for blocks of size 2^( 2) =       0.000433759675
  error estimate for blocks of size 2^( 3) =       0.000445625939
  error estimate for blocks of size 2^( 4) =       0.000456810208
  error estimate for blocks of size 2^( 5) =       0.000466952807
  error estimate for blocks of size 2^( 6) =       0.000472972428
  error estimate for blocks of size 2^( 7) =       0.000479436353

      target function =                  N/A
              le_mean =     -16.924342640999
             les_mean =     286.788801042132
             stat err =       0.000469042949
             autocorr =       1.237953484942
              std dev =       0.596177314156
             le_variance =       0.355427389914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355500985048
                                         uncertainty =       0.015654863086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355500985048
                                         uncertainty =       0.015654863086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421560176
  error estimate for blocks of size 2^( 2) =       0.000433758858
  error estimate for blocks of size 2^( 3) =       0.000445625146
  error estimate for blocks of size 2^( 4) =       0.000456809424
  error estimate for blocks of size 2^( 5) =       0.000466952110
  error estimate for blocks of size 2^( 6) =       0.000472971719
  error estimate for blocks of size 2^( 7) =       0.000479435574

      target function =                  N/A
              le_mean =     -16.924342656222
             les_mean =     286.788800130841
             stat err =       0.000469042207
             autocorr =       1.237954535670
              std dev =       0.596176117724
             le_variance =       0.355425963345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924342658427        initial  <--
     2.3842e+01     2.3842e+02             1.3169e-05       -16.924342624875
     9.5367e+01     9.5367e+02             3.2916e-06       -16.924342640999
     3.8147e+02     3.8147e+03             8.2287e-07       -16.924342656222

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5365
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.117858e-01 1 1  ON 0
 uu_1                 1.451840e-01 1 1  ON 1
 uu_2                 4.416714e-02 1 1  ON 2
 uu_3                -1.870232e-02 1 1  ON 3
 uu_4                -6.449572e-02 1 1  ON 4
 uu_5                -9.825813e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042630e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704424e-01 1 1  ON 11
 ud_2                 5.188727e-02 1 1  ON 12
 ud_3                -1.640053e-02 1 1  ON 13
 ud_4                -6.989177e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280531e-01 1 1  ON 16
 ud_7                -1.398876e-01 1 1  ON 17
 ud_8                -1.383919e-01 1 1  ON 18
 ud_9                -1.310028e-01 1 1  ON 19
 eO_0                -7.721070e-01 1 1  ON 20
 eO_1                -4.509701e-01 1 1  ON 21
 eO_2                -2.866682e-02 1 1  ON 22
 eO_3                 2.971049e-01 1 1  ON 23
 eO_4                 5.342480e-01 1 1  ON 24
 eO_5                 4.965929e-01 1 1  ON 25
 eO_6                 2.622956e-01 1 1  ON 26
 eO_7                -4.494105e-02 1 1  ON 27
 eO_8                -2.159768e-01 1 1  ON 28
 eO_9                -7.700190e-02 1 1  ON 29
eH1_0                -2.352113e-01 1 1  ON 30
eH1_1                -1.385767e-01 1 1  ON 31
eH1_2                -9.411438e-02 1 1  ON 32
eH1_3                -3.937679e-02 1 1  ON 33
eH1_4                 4.008768e-03 1 1  ON 34
eH1_5                 3.746356e-02 1 1  ON 35
eH1_6                 9.328411e-02 1 1  ON 36
eH1_7                 1.483255e-01 1 1  ON 37
eH1_8                 1.695204e-01 1 1  ON 38
eH1_9                 5.754208e-02 1 1  ON 39
eH2_0                -2.322531e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070499e-02 1 1  ON 42
eH2_3                -3.605043e-02 1 1  ON 43
eH2_4                 7.925558e-03 1 1  ON 44
eH2_5                 4.076063e-02 1 1  ON 45
eH2_6                 9.626910e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741137e-01 1 1  ON 48
eH2_9                 4.226956e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9172
    reference variance = 0.217256
====================================================
  Execution time = 2.0950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.5281e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352888515234
                                         uncertainty =       0.017964118982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352888515234
                                         uncertainty =       0.017964118982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420003767
  error estimate for blocks of size 2^( 2) =       0.000432240229
  error estimate for blocks of size 2^( 3) =       0.000444987817
  error estimate for blocks of size 2^( 4) =       0.000456552708
  error estimate for blocks of size 2^( 5) =       0.000466482647
  error estimate for blocks of size 2^( 6) =       0.000471690310
  error estimate for blocks of size 2^( 7) =       0.000476626840

      target function =                  N/A
              le_mean =     -16.924748968894
             les_mean =     286.799933811905
             stat err =       0.000467838126
             autocorr =       1.240751624032
              std dev =       0.593975023245
             le_variance =       0.352806328239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692474896889e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924748968894       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924748973790       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924748971453       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924748972817       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924748975934       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924748975567       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924748975440       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924748975479       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.230269e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924748968894       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924748970118       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924748969534       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924748969875       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924748970655       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924748970563       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924748970531       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924748970540       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.075748e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924748968894       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924748969200       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924748969054       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924748969139       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924748969334       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924748969312       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924748969304       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924748969297       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.689417e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6632e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.117858e-01 1 1  ON 0
 uu_1                 1.451840e-01 1 1  ON 1
 uu_2                 4.416711e-02 1 1  ON 2
 uu_3                -1.870235e-02 1 1  ON 3
 uu_4                -6.449566e-02 1 1  ON 4
 uu_5                -9.825832e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342840e-01 1 1  ON 8
 uu_9                -1.042631e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704423e-01 1 1  ON 11
 ud_2                 5.188719e-02 1 1  ON 12
 ud_3                -1.640062e-02 1 1  ON 13
 ud_4                -6.989190e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398876e-01 1 1  ON 17
 ud_8                -1.383917e-01 1 1  ON 18
 ud_9                -1.310026e-01 1 1  ON 19
 eO_0                -7.721073e-01 1 1  ON 20
 eO_1                -4.509702e-01 1 1  ON 21
 eO_2                -2.866688e-02 1 1  ON 22
 eO_3                 2.971047e-01 1 1  ON 23
 eO_4                 5.342482e-01 1 1  ON 24
 eO_5                 4.965932e-01 1 1  ON 25
 eO_6                 2.622959e-01 1 1  ON 26
 eO_7                -4.494097e-02 1 1  ON 27
 eO_8                -2.159769e-01 1 1  ON 28
 eO_9                -7.700204e-02 1 1  ON 29
eH1_0                -2.352114e-01 1 1  ON 30
eH1_1                -1.385769e-01 1 1  ON 31
eH1_2                -9.411440e-02 1 1  ON 32
eH1_3                -3.937690e-02 1 1  ON 33
eH1_4                 4.008868e-03 1 1  ON 34
eH1_5                 3.746338e-02 1 1  ON 35
eH1_6                 9.328415e-02 1 1  ON 36
eH1_7                 1.483256e-01 1 1  ON 37
eH1_8                 1.695205e-01 1 1  ON 38
eH1_9                 5.754224e-02 1 1  ON 39
eH2_0                -2.322530e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070502e-02 1 1  ON 42
eH2_3                -3.605041e-02 1 1  ON 43
eH2_4                 7.925464e-03 1 1  ON 44
eH2_5                 4.076051e-02 1 1  ON 45
eH2_6                 9.626885e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741139e-01 1 1  ON 48
eH2_9                 4.226978e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9632
    reference variance = 0.293818
====================================================
  Execution time = 2.0177e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4802e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348093690951
                                         uncertainty =       0.008002164329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348093690951
                                         uncertainty =       0.008002164329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417145526
  error estimate for blocks of size 2^( 2) =       0.000429511852
  error estimate for blocks of size 2^( 3) =       0.000442266295
  error estimate for blocks of size 2^( 4) =       0.000453049575
  error estimate for blocks of size 2^( 5) =       0.000462107803
  error estimate for blocks of size 2^( 6) =       0.000467626252
  error estimate for blocks of size 2^( 7) =       0.000471045180

      target function =                  N/A
              le_mean =     -16.925830517416
             les_mean =     286.831759310621
             stat err =       0.000463457202
             autocorr =       1.234366397215
              std dev =       0.589932860876
             le_variance =       0.348020780342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348094481537
                                         uncertainty =       0.008002187788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348094481537
                                         uncertainty =       0.008002187788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417146000
  error estimate for blocks of size 2^( 2) =       0.000429512305
  error estimate for blocks of size 2^( 3) =       0.000442266723
  error estimate for blocks of size 2^( 4) =       0.000453049982
  error estimate for blocks of size 2^( 5) =       0.000462108197
  error estimate for blocks of size 2^( 6) =       0.000467626620
  error estimate for blocks of size 2^( 7) =       0.000471045537

      target function =                  N/A
              le_mean =     -16.925830517966
             les_mean =     286.831760119447
             stat err =       0.000463457584
             autocorr =       1.234365628565
              std dev =       0.589933530629
             le_variance =       0.348021570560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348094086755
                                         uncertainty =       0.008002176076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348094086755
                                         uncertainty =       0.008002176076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417145763
  error estimate for blocks of size 2^( 2) =       0.000429512078
  error estimate for blocks of size 2^( 3) =       0.000442266509
  error estimate for blocks of size 2^( 4) =       0.000453049779
  error estimate for blocks of size 2^( 5) =       0.000462108000
  error estimate for blocks of size 2^( 6) =       0.000467626436
  error estimate for blocks of size 2^( 7) =       0.000471045359

      target function =                  N/A
              le_mean =     -16.925830517689
             les_mean =     286.831759715500
             stat err =       0.000463457394
             autocorr =       1.234366012460
              std dev =       0.589933196186
             le_variance =       0.348021175962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348093740442
                                         uncertainty =       0.008002165798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348093740442
                                         uncertainty =       0.008002165798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417145556
  error estimate for blocks of size 2^( 2) =       0.000429511880
  error estimate for blocks of size 2^( 3) =       0.000442266322
  error estimate for blocks of size 2^( 4) =       0.000453049600
  error estimate for blocks of size 2^( 5) =       0.000462107828
  error estimate for blocks of size 2^( 6) =       0.000467626275
  error estimate for blocks of size 2^( 7) =       0.000471045203

      target function =                  N/A
              le_mean =     -16.925830517450
             les_mean =     286.831759361243
             stat err =       0.000463457226
             autocorr =       1.234366349108
              std dev =       0.589932902803
             le_variance =       0.348020829810


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925830517416        initial
     2.3842e+02     2.3842e+03             1.2303e-06       -16.925830517966  <--
     9.5367e+02     9.5367e+03             3.0757e-07       -16.925830517689
     3.8147e+03     3.8147e+04             7.6894e-08       -16.925830517450

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 2.9718e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416700e-02 1 1  ON 2
 uu_3                -1.870244e-02 1 1  ON 3
 uu_4                -6.449549e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042632e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188695e-02 1 1  ON 12
 ud_3                -1.640090e-02 1 1  ON 13
 ud_4                -6.989230e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721081e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866705e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965941e-01 1 1  ON 25
 eO_6                 2.622968e-01 1 1  ON 26
 eO_7                -4.494073e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700245e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411446e-02 1 1  ON 32
eH1_3                -3.937724e-02 1 1  ON 33
eH1_4                 4.009168e-03 1 1  ON 34
eH1_5                 3.746284e-02 1 1  ON 35
eH1_6                 9.328425e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754273e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070511e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925181e-03 1 1  ON 44
eH2_5                 4.076014e-02 1 1  ON 45
eH2_6                 9.626810e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8479
    reference variance = 0.291724
====================================================
  Execution time = 2.0990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3189e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5052e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331442497273
                                         uncertainty =       0.002537025515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331442497273
                                         uncertainty =       0.002537025515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407366539
  error estimate for blocks of size 2^( 2) =       0.000420205962
  error estimate for blocks of size 2^( 3) =       0.000432952632
  error estimate for blocks of size 2^( 4) =       0.000444014994
  error estimate for blocks of size 2^( 5) =       0.000454681431
  error estimate for blocks of size 2^( 6) =       0.000462199619
  error estimate for blocks of size 2^( 7) =       0.000470496426

      target function =                  N/A
              le_mean =     -16.924466342622
             les_mean =     286.769455810320
             stat err =       0.000457848117
             autocorr =       1.263200124255
              std dev =       0.576103283897
             le_variance =       0.331894993716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692446634262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924466342622       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924466358840       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924466366535       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924466368312       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924466377539       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924466379285       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924466383535       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924466382391       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.305962e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924466342622       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924466346684       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924466348623       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924466349073       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924466351384       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924466351815       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924466352876       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924466352594       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.326988e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924466342622       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924466343638       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924466344124       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924466344237       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924466344815       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924466344922       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924466345188       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924466345117       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.317782e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6506e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.117856e-01 1 1  ON 0
 uu_1                 1.451852e-01 1 1  ON 1
 uu_2                 4.416703e-02 1 1  ON 2
 uu_3                -1.870239e-02 1 1  ON 3
 uu_4                -6.449519e-02 1 1  ON 4
 uu_5                -9.825897e-02 1 1  ON 5
 uu_6                -1.249407e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042641e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704416e-01 1 1  ON 11
 ud_2                 5.188652e-02 1 1  ON 12
 ud_3                -1.640129e-02 1 1  ON 13
 ud_4                -6.989253e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398867e-01 1 1  ON 17
 ud_8                -1.383906e-01 1 1  ON 18
 ud_9                -1.310018e-01 1 1  ON 19
 eO_0                -7.721094e-01 1 1  ON 20
 eO_1                -4.509714e-01 1 1  ON 21
 eO_2                -2.866722e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342496e-01 1 1  ON 24
 eO_5                 4.965952e-01 1 1  ON 25
 eO_6                 2.622982e-01 1 1  ON 26
 eO_7                -4.494021e-02 1 1  ON 27
 eO_8                -2.159779e-01 1 1  ON 28
 eO_9                -7.700303e-02 1 1  ON 29
eH1_0                -2.352113e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411430e-02 1 1  ON 32
eH1_3                -3.937752e-02 1 1  ON 33
eH1_4                 4.008813e-03 1 1  ON 34
eH1_5                 3.746222e-02 1 1  ON 35
eH1_6                 9.328379e-02 1 1  ON 36
eH1_7                 1.483257e-01 1 1  ON 37
eH1_8                 1.695214e-01 1 1  ON 38
eH1_9                 5.754342e-02 1 1  ON 39
eH2_0                -2.322528e-01 1 1  ON 40
eH2_1                -1.352051e-01 1 1  ON 41
eH2_2                -9.070506e-02 1 1  ON 42
eH2_3                -3.605044e-02 1 1  ON 43
eH2_4                 7.924692e-03 1 1  ON 44
eH2_5                 4.075983e-02 1 1  ON 45
eH2_6                 9.626795e-02 1 1  ON 46
eH2_7                 1.506018e-01 1 1  ON 47
eH2_8                 1.741148e-01 1 1  ON 48
eH2_9                 4.227114e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9254
    reference variance = 0.741422
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4096e-01
  Total weights = 2.0000e+06
  Execution time = 1.8790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340930826980
                                         uncertainty =       0.006523028544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340930826980
                                         uncertainty =       0.006523028544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412895164
  error estimate for blocks of size 2^( 2) =       0.000424826944
  error estimate for blocks of size 2^( 3) =       0.000437055671
  error estimate for blocks of size 2^( 4) =       0.000448614313
  error estimate for blocks of size 2^( 5) =       0.000459394524
  error estimate for blocks of size 2^( 6) =       0.000464585197
  error estimate for blocks of size 2^( 7) =       0.000468459261

      target function =                  N/A
              le_mean =     -16.925203920662
             les_mean =     286.803492418819
             stat err =       0.000460263324
             autocorr =       1.242605138681
              std dev =       0.583921941099
             le_variance =       0.340964833297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931772734
                                         uncertainty =       0.006522973484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931772734
                                         uncertainty =       0.006522973484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412895736
  error estimate for blocks of size 2^( 2) =       0.000424827481
  error estimate for blocks of size 2^( 3) =       0.000437056192
  error estimate for blocks of size 2^( 4) =       0.000448614802
  error estimate for blocks of size 2^( 5) =       0.000459394980
  error estimate for blocks of size 2^( 6) =       0.000464585663
  error estimate for blocks of size 2^( 7) =       0.000468459726

      target function =                  N/A
              le_mean =     -16.925203916568
             les_mean =     286.803493224990
             stat err =       0.000460263793
             autocorr =       1.242604228450
              std dev =       0.583922750089
             le_variance =       0.340965778071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931301520
                                         uncertainty =       0.006523000802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340931301520
                                         uncertainty =       0.006523000802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412895451
  error estimate for blocks of size 2^( 2) =       0.000424827213
  error estimate for blocks of size 2^( 3) =       0.000437055933
  error estimate for blocks of size 2^( 4) =       0.000448614558
  error estimate for blocks of size 2^( 5) =       0.000459394752
  error estimate for blocks of size 2^( 6) =       0.000464585430
  error estimate for blocks of size 2^( 7) =       0.000468459495

      target function =                  N/A
              le_mean =     -16.925203918601
             les_mean =     286.803492823079
             stat err =       0.000460263559
             autocorr =       1.242604682065
              std dev =       0.583922347017
             le_variance =       0.340965307346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340930886344
                                         uncertainty =       0.006523025070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340930886344
                                         uncertainty =       0.006523025070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412895200
  error estimate for blocks of size 2^( 2) =       0.000424826977
  error estimate for blocks of size 2^( 3) =       0.000437055704
  error estimate for blocks of size 2^( 4) =       0.000448614343
  error estimate for blocks of size 2^( 5) =       0.000459394552
  error estimate for blocks of size 2^( 6) =       0.000464585226
  error estimate for blocks of size 2^( 7) =       0.000468459291

      target function =                  N/A
              le_mean =     -16.925203920404
             les_mean =     286.803492469362
             stat err =       0.000460263353
             autocorr =       1.242605081563
              std dev =       0.583921991879
             le_variance =       0.340964892600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925203920662        initial  <--
     5.9605e+01     5.9605e+02             5.3060e-06       -16.925203916568
     2.3842e+02     2.3842e+03             1.3270e-06       -16.925203918601
     9.5367e+02     9.5367e+03             3.3178e-07       -16.925203920404

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6074
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416700e-02 1 1  ON 2
 uu_3                -1.870244e-02 1 1  ON 3
 uu_4                -6.449549e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042632e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188695e-02 1 1  ON 12
 ud_3                -1.640090e-02 1 1  ON 13
 ud_4                -6.989230e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721081e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866705e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965941e-01 1 1  ON 25
 eO_6                 2.622968e-01 1 1  ON 26
 eO_7                -4.494073e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700245e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411446e-02 1 1  ON 32
eH1_3                -3.937724e-02 1 1  ON 33
eH1_4                 4.009168e-03 1 1  ON 34
eH1_5                 3.746284e-02 1 1  ON 35
eH1_6                 9.328425e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754273e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070511e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925181e-03 1 1  ON 44
eH2_5                 4.076014e-02 1 1  ON 45
eH2_6                 9.626810e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9252
    reference variance = 0.382027
====================================================
  Execution time = 2.2680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3678e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336731484730
                                         uncertainty =       0.006386558111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336731484730
                                         uncertainty =       0.006386558111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410355743
  error estimate for blocks of size 2^( 2) =       0.000422400651
  error estimate for blocks of size 2^( 3) =       0.000435201309
  error estimate for blocks of size 2^( 4) =       0.000446879989
  error estimate for blocks of size 2^( 5) =       0.000457420712
  error estimate for blocks of size 2^( 6) =       0.000464091826
  error estimate for blocks of size 2^( 7) =       0.000468985521

      target function =                  N/A
              le_mean =     -16.924853885371
             les_mean =     286.787462543600
             stat err =       0.000459344512
             autocorr =       1.253014316413
              std dev =       0.580330656465
             le_variance =       0.336783670834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692485388537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924853885371       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924853885772       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924853886258       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924853886584       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924853886632       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924853887572       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924853887542       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924853887566       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.623615e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924853885371       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924853885471       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924853885593       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924853885674       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924853885688       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924853885921       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924853885915       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924853885919       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.405941e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924853885371       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924853885396       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924853885426       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924853885446       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924853885451       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924853885500       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924853885492       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924853885516       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.514877e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071856 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8256e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.117858e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416701e-02 1 1  ON 2
 uu_3                -1.870243e-02 1 1  ON 3
 uu_4                -6.449549e-02 1 1  ON 4
 uu_5                -9.825892e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042633e-01 1 1  ON 9
 ud_0                 4.356415e-01 1 1  ON 10
 ud_1                 1.704418e-01 1 1  ON 11
 ud_2                 5.188692e-02 1 1  ON 12
 ud_3                -1.640091e-02 1 1  ON 13
 ud_4                -6.989235e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383913e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721082e-01 1 1  ON 20
 eO_1                -4.509706e-01 1 1  ON 21
 eO_2                -2.866709e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965943e-01 1 1  ON 25
 eO_6                 2.622970e-01 1 1  ON 26
 eO_7                -4.494068e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700250e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411447e-02 1 1  ON 32
eH1_3                -3.937727e-02 1 1  ON 33
eH1_4                 4.009144e-03 1 1  ON 34
eH1_5                 3.746281e-02 1 1  ON 35
eH1_6                 9.328421e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695210e-01 1 1  ON 38
eH1_9                 5.754280e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070514e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925142e-03 1 1  ON 44
eH2_5                 4.076009e-02 1 1  ON 45
eH2_6                 9.626809e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9068
    reference variance = 0.241771
====================================================
  Execution time = 2.0394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4281e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894943500
                                         uncertainty =       0.005861594440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894943500
                                         uncertainty =       0.005861594440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414011424
  error estimate for blocks of size 2^( 2) =       0.000426775232
  error estimate for blocks of size 2^( 3) =       0.000439064157
  error estimate for blocks of size 2^( 4) =       0.000449966176
  error estimate for blocks of size 2^( 5) =       0.000460136136
  error estimate for blocks of size 2^( 6) =       0.000466856745
  error estimate for blocks of size 2^( 7) =       0.000469700224

      target function =                  N/A
              le_mean =     -16.924605574605
             les_mean =     286.785084602207
             stat err =       0.000461664820
             autocorr =       1.243451683028
              std dev =       0.585500570177
             le_variance =       0.342810917678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894921866
                                         uncertainty =       0.005861593481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894921866
                                         uncertainty =       0.005861593481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414011410
  error estimate for blocks of size 2^( 2) =       0.000426775221
  error estimate for blocks of size 2^( 3) =       0.000439064147
  error estimate for blocks of size 2^( 4) =       0.000449966165
  error estimate for blocks of size 2^( 5) =       0.000460136125
  error estimate for blocks of size 2^( 6) =       0.000466856735
  error estimate for blocks of size 2^( 7) =       0.000469700210

      target function =                  N/A
              le_mean =     -16.924605572943
             les_mean =     286.785084524289
             stat err =       0.000461664809
             autocorr =       1.243451700419
              std dev =       0.585500551680
             le_variance =       0.342810896018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894932685
                                         uncertainty =       0.005861593961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894932685
                                         uncertainty =       0.005861593961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414011417
  error estimate for blocks of size 2^( 2) =       0.000426775226
  error estimate for blocks of size 2^( 3) =       0.000439064152
  error estimate for blocks of size 2^( 4) =       0.000449966171
  error estimate for blocks of size 2^( 5) =       0.000460136131
  error estimate for blocks of size 2^( 6) =       0.000466856740
  error estimate for blocks of size 2^( 7) =       0.000469700217

      target function =                  N/A
              le_mean =     -16.924605573773
             les_mean =     286.785084563236
             stat err =       0.000461664815
             autocorr =       1.243451691718
              std dev =       0.585500560931
             le_variance =       0.342810906850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894942148
                                         uncertainty =       0.005861594380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342894942148
                                         uncertainty =       0.005861594380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414011423
  error estimate for blocks of size 2^( 2) =       0.000426775231
  error estimate for blocks of size 2^( 3) =       0.000439064157
  error estimate for blocks of size 2^( 4) =       0.000449966175
  error estimate for blocks of size 2^( 5) =       0.000460136136
  error estimate for blocks of size 2^( 6) =       0.000466856744
  error estimate for blocks of size 2^( 7) =       0.000469700223

      target function =                  N/A
              le_mean =     -16.924605574501
             les_mean =     286.785084597335
             stat err =       0.000461664820
             autocorr =       1.243451684107
              std dev =       0.585500569022
             le_variance =       0.342810916325


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924605574605        initial  <--
     5.9605e+02     5.9605e+03             5.6236e-07       -16.924605572943
     2.3842e+03     2.3842e+04             1.4059e-07       -16.924605573773
     9.5367e+03     9.5367e+04             3.5149e-08       -16.924605574501

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.6380
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416700e-02 1 1  ON 2
 uu_3                -1.870244e-02 1 1  ON 3
 uu_4                -6.449549e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042632e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188695e-02 1 1  ON 12
 ud_3                -1.640090e-02 1 1  ON 13
 ud_4                -6.989230e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721081e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866705e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965941e-01 1 1  ON 25
 eO_6                 2.622968e-01 1 1  ON 26
 eO_7                -4.494073e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700245e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411446e-02 1 1  ON 32
eH1_3                -3.937724e-02 1 1  ON 33
eH1_4                 4.009168e-03 1 1  ON 34
eH1_5                 3.746284e-02 1 1  ON 35
eH1_6                 9.328425e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754273e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070511e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925181e-03 1 1  ON 44
eH2_5                 4.076014e-02 1 1  ON 45
eH2_6                 9.626810e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227043e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.948
    reference variance = 0.334653
====================================================
  Execution time = 2.0874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4520e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345251864067
                                         uncertainty =       0.009686422328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345251864067
                                         uncertainty =       0.009686422328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415449005
  error estimate for blocks of size 2^( 2) =       0.000427435337
  error estimate for blocks of size 2^( 3) =       0.000439721968
  error estimate for blocks of size 2^( 4) =       0.000450147800
  error estimate for blocks of size 2^( 5) =       0.000458788753
  error estimate for blocks of size 2^( 6) =       0.000465744595
  error estimate for blocks of size 2^( 7) =       0.000468842076

      target function =                  N/A
              le_mean =     -16.924861475412
             les_mean =     286.796131540713
             stat err =       0.000460880806
             autocorr =       1.230670518562
              std dev =       0.587533617261
             le_variance =       0.345195751412


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692486147541e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924861475412       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924861475584       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924861475670       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924861475652       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924861475631       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924861475585       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924861475607       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924861475631       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 6.082852e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924861475412       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924861475455       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924861475477       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924861475491       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924861475467       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924861475455       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924861475471       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924861475468       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.520714e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924861475412       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924861475423       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924861475428       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924861475427       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924861475446       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924861475384       residual = 8.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924861475439       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924861475480       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 3.801785e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6525e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416700e-02 1 1  ON 2
 uu_3                -1.870244e-02 1 1  ON 3
 uu_4                -6.449548e-02 1 1  ON 4
 uu_5                -9.825889e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042632e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188694e-02 1 1  ON 12
 ud_3                -1.640090e-02 1 1  ON 13
 ud_4                -6.989230e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721081e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866706e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965942e-01 1 1  ON 25
 eO_6                 2.622969e-01 1 1  ON 26
 eO_7                -4.494073e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700245e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411446e-02 1 1  ON 32
eH1_3                -3.937724e-02 1 1  ON 33
eH1_4                 4.009171e-03 1 1  ON 34
eH1_5                 3.746284e-02 1 1  ON 35
eH1_6                 9.328424e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754274e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070511e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925179e-03 1 1  ON 44
eH2_5                 4.076014e-02 1 1  ON 45
eH2_6                 9.626810e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227044e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9273
    reference variance = 0.226707
====================================================
  Execution time = 2.0444e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.2954e-01
  Total weights = 2.0000e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591438572
                                         uncertainty =       0.002563959669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591438572
                                         uncertainty =       0.002563959669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405916260
  error estimate for blocks of size 2^( 2) =       0.000417969869
  error estimate for blocks of size 2^( 3) =       0.000430465831
  error estimate for blocks of size 2^( 4) =       0.000440783056
  error estimate for blocks of size 2^( 5) =       0.000450491415
  error estimate for blocks of size 2^( 6) =       0.000457044388
  error estimate for blocks of size 2^( 7) =       0.000461712271

      target function =                  N/A
              le_mean =     -16.925216722395
             les_mean =     286.792496955981
             stat err =       0.000452507783
             autocorr =       1.242736941666
              std dev =       0.574052280476
             le_variance =       0.329536020719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591470709
                                         uncertainty =       0.002563959827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591470709
                                         uncertainty =       0.002563959827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405916280
  error estimate for blocks of size 2^( 2) =       0.000417969887
  error estimate for blocks of size 2^( 3) =       0.000430465849
  error estimate for blocks of size 2^( 4) =       0.000440783073
  error estimate for blocks of size 2^( 5) =       0.000450491431
  error estimate for blocks of size 2^( 6) =       0.000457044403
  error estimate for blocks of size 2^( 7) =       0.000461712286

      target function =                  N/A
              le_mean =     -16.925216722524
             les_mean =     286.792496992465
             stat err =       0.000452507798
             autocorr =       1.242736905448
              std dev =       0.574052308456
             le_variance =       0.329536052843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591454641
                                         uncertainty =       0.002563959748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591454641
                                         uncertainty =       0.002563959748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405916270
  error estimate for blocks of size 2^( 2) =       0.000417969878
  error estimate for blocks of size 2^( 3) =       0.000430465840
  error estimate for blocks of size 2^( 4) =       0.000440783064
  error estimate for blocks of size 2^( 5) =       0.000450491423
  error estimate for blocks of size 2^( 6) =       0.000457044396
  error estimate for blocks of size 2^( 7) =       0.000461712278

      target function =                  N/A
              le_mean =     -16.925216722459
             les_mean =     286.792496974224
             stat err =       0.000452507790
             autocorr =       1.242736923555
              std dev =       0.574052294467
             le_variance =       0.329536036782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591440580
                                         uncertainty =       0.002563959679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329591440580
                                         uncertainty =       0.002563959679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405916262
  error estimate for blocks of size 2^( 2) =       0.000417969870
  error estimate for blocks of size 2^( 3) =       0.000430465832
  error estimate for blocks of size 2^( 4) =       0.000440783057
  error estimate for blocks of size 2^( 5) =       0.000450491416
  error estimate for blocks of size 2^( 6) =       0.000457044389
  error estimate for blocks of size 2^( 7) =       0.000461712272

      target function =                  N/A
              le_mean =     -16.925216722403
             les_mean =     286.792496958261
             stat err =       0.000452507784
             autocorr =       1.242736939403
              std dev =       0.574052282224
             le_variance =       0.329536022727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925216722395        initial
     5.9605e+03     5.9605e+04             6.0829e-08       -16.925216722524  <--
     2.3842e+04     2.3842e+05             1.5207e-08       -16.925216722459
     9.5367e+04     9.5367e+05             3.8018e-09       -16.925216722403

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.9941e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416701e-02 1 1  ON 2
 uu_3                -1.870243e-02 1 1  ON 3
 uu_4                -6.449547e-02 1 1  ON 4
 uu_5                -9.825890e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042633e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704418e-01 1 1  ON 11
 ud_2                 5.188693e-02 1 1  ON 12
 ud_3                -1.640091e-02 1 1  ON 13
 ud_4                -6.989230e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721081e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866708e-02 1 1  ON 22
 eO_3                 2.971041e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965942e-01 1 1  ON 25
 eO_6                 2.622969e-01 1 1  ON 26
 eO_7                -4.494071e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700247e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411445e-02 1 1  ON 32
eH1_3                -3.937725e-02 1 1  ON 33
eH1_4                 4.009177e-03 1 1  ON 34
eH1_5                 3.746283e-02 1 1  ON 35
eH1_6                 9.328422e-02 1 1  ON 36
eH1_7                 1.483257e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754276e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070512e-02 1 1  ON 42
eH2_3                -3.605037e-02 1 1  ON 43
eH2_4                 7.925173e-03 1 1  ON 44
eH2_5                 4.076013e-02 1 1  ON 45
eH2_6                 9.626810e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227046e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.919
    reference variance = 0.276703
====================================================
  Execution time = 2.0522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.7509e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375204542480
                                         uncertainty =       0.025022751952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375204542480
                                         uncertainty =       0.025022751952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433063391
  error estimate for blocks of size 2^( 2) =       0.000444679694
  error estimate for blocks of size 2^( 3) =       0.000456662550
  error estimate for blocks of size 2^( 4) =       0.000467726549
  error estimate for blocks of size 2^( 5) =       0.000476552583
  error estimate for blocks of size 2^( 6) =       0.000482562330
  error estimate for blocks of size 2^( 7) =       0.000486855808

      target function =                  N/A
              le_mean =     -16.925535221477
             les_mean =     286.848830146892
             stat err =       0.000478424318
             autocorr =       1.220459994262
              std dev =       0.612444120710
             le_variance =       0.375087800993


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692553522148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925535221477       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925535222185       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925535221402       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925535221302       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925535221375       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925535221556       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925535221760       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925535221783       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.363584e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925535221477       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925535221654       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925535221458       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925535221430       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925535221454       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925535221497       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925535221551       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925535221556       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.909614e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925535221477       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925535221521       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925535221472       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925535221466       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925535221467       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925535221477       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925535221495       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925535221484       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.477445e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077116 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6111e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416702e-02 1 1  ON 2
 uu_3                -1.870244e-02 1 1  ON 3
 uu_4                -6.449545e-02 1 1  ON 4
 uu_5                -9.825890e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391424e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042633e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188692e-02 1 1  ON 12
 ud_3                -1.640092e-02 1 1  ON 13
 ud_4                -6.989231e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383914e-01 1 1  ON 18
 ud_9                -1.310020e-01 1 1  ON 19
 eO_0                -7.721082e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866709e-02 1 1  ON 22
 eO_3                 2.971040e-01 1 1  ON 23
 eO_4                 5.342489e-01 1 1  ON 24
 eO_5                 4.965942e-01 1 1  ON 25
 eO_6                 2.622970e-01 1 1  ON 26
 eO_7                -4.494069e-02 1 1  ON 27
 eO_8                -2.159773e-01 1 1  ON 28
 eO_9                -7.700249e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411446e-02 1 1  ON 32
eH1_3                -3.937725e-02 1 1  ON 33
eH1_4                 4.009181e-03 1 1  ON 34
eH1_5                 3.746281e-02 1 1  ON 35
eH1_6                 9.328421e-02 1 1  ON 36
eH1_7                 1.483257e-01 1 1  ON 37
eH1_8                 1.695209e-01 1 1  ON 38
eH1_9                 5.754279e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352050e-01 1 1  ON 41
eH2_2                -9.070512e-02 1 1  ON 42
eH2_3                -3.605037e-02 1 1  ON 43
eH2_4                 7.925151e-03 1 1  ON 44
eH2_5                 4.076011e-02 1 1  ON 45
eH2_6                 9.626809e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741143e-01 1 1  ON 48
eH2_9                 4.227050e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.153023
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4255e-01
  Total weights = 2.0000e+06
  Execution time = 1.8799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690757104
                                         uncertainty =       0.006418073114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690757104
                                         uncertainty =       0.006418073114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413855444
  error estimate for blocks of size 2^( 2) =       0.000426456480
  error estimate for blocks of size 2^( 3) =       0.000439317072
  error estimate for blocks of size 2^( 4) =       0.000450458938
  error estimate for blocks of size 2^( 5) =       0.000461139512
  error estimate for blocks of size 2^( 6) =       0.000468030191
  error estimate for blocks of size 2^( 7) =       0.000473106838

      target function =                  N/A
              le_mean =     -16.924581200183
             les_mean =     286.784001286537
             stat err =       0.000463183870
             autocorr =       1.252591641536
              std dev =       0.585279981062
             le_variance =       0.342552656232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690696404
                                         uncertainty =       0.006418072255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690696404
                                         uncertainty =       0.006418072255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413855407
  error estimate for blocks of size 2^( 2) =       0.000426456444
  error estimate for blocks of size 2^( 3) =       0.000439317033
  error estimate for blocks of size 2^( 4) =       0.000450458900
  error estimate for blocks of size 2^( 5) =       0.000461139474
  error estimate for blocks of size 2^( 6) =       0.000468030153
  error estimate for blocks of size 2^( 7) =       0.000473106798

      target function =                  N/A
              le_mean =     -16.924581200960
             les_mean =     286.784001252219
             stat err =       0.000463183831
             autocorr =       1.252591656279
              std dev =       0.585279929259
             le_variance =       0.342552595594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690726743
                                         uncertainty =       0.006418072684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690726743
                                         uncertainty =       0.006418072684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413855425
  error estimate for blocks of size 2^( 2) =       0.000426456462
  error estimate for blocks of size 2^( 3) =       0.000439317053
  error estimate for blocks of size 2^( 4) =       0.000450458919
  error estimate for blocks of size 2^( 5) =       0.000461139493
  error estimate for blocks of size 2^( 6) =       0.000468030172
  error estimate for blocks of size 2^( 7) =       0.000473106818

      target function =                  N/A
              le_mean =     -16.924581200572
             les_mean =     286.784001269369
             stat err =       0.000463183850
             autocorr =       1.252591648909
              std dev =       0.585279955151
             le_variance =       0.342552625902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690753309
                                         uncertainty =       0.006418073061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342690753309
                                         uncertainty =       0.006418073061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413855441
  error estimate for blocks of size 2^( 2) =       0.000426456478
  error estimate for blocks of size 2^( 3) =       0.000439317069
  error estimate for blocks of size 2^( 4) =       0.000450458935
  error estimate for blocks of size 2^( 5) =       0.000461139509
  error estimate for blocks of size 2^( 6) =       0.000468030188
  error estimate for blocks of size 2^( 7) =       0.000473106835

      target function =                  N/A
              le_mean =     -16.924581200231
             les_mean =     286.784001284390
             stat err =       0.000463183867
             autocorr =       1.252591642454
              std dev =       0.585279977822
             le_variance =       0.342552652440


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924581200183        initial
     1.4901e+03     1.4901e+04             2.3636e-07       -16.924581200960  <--
     5.9605e+03     5.9605e+04             5.9096e-08       -16.924581200572
     2.3842e+04     2.3842e+05             1.4774e-08       -16.924581200231

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 2.9855e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.117857e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416706e-02 1 1  ON 2
 uu_3                -1.870247e-02 1 1  ON 3
 uu_4                -6.449540e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042634e-01 1 1  ON 9
 ud_0                 4.356415e-01 1 1  ON 10
 ud_1                 1.704419e-01 1 1  ON 11
 ud_2                 5.188689e-02 1 1  ON 12
 ud_3                -1.640094e-02 1 1  ON 13
 ud_4                -6.989234e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398874e-01 1 1  ON 17
 ud_8                -1.383913e-01 1 1  ON 18
 ud_9                -1.310019e-01 1 1  ON 19
 eO_0                -7.721084e-01 1 1  ON 20
 eO_1                -4.509705e-01 1 1  ON 21
 eO_2                -2.866711e-02 1 1  ON 22
 eO_3                 2.971040e-01 1 1  ON 23
 eO_4                 5.342490e-01 1 1  ON 24
 eO_5                 4.965944e-01 1 1  ON 25
 eO_6                 2.622971e-01 1 1  ON 26
 eO_7                -4.494061e-02 1 1  ON 27
 eO_8                -2.159774e-01 1 1  ON 28
 eO_9                -7.700256e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385772e-01 1 1  ON 31
eH1_2                -9.411448e-02 1 1  ON 32
eH1_3                -3.937727e-02 1 1  ON 33
eH1_4                 4.009193e-03 1 1  ON 34
eH1_5                 3.746278e-02 1 1  ON 35
eH1_6                 9.328418e-02 1 1  ON 36
eH1_7                 1.483257e-01 1 1  ON 37
eH1_8                 1.695210e-01 1 1  ON 38
eH1_9                 5.754286e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352051e-01 1 1  ON 41
eH2_2                -9.070514e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.925085e-03 1 1  ON 44
eH2_5                 4.076004e-02 1 1  ON 45
eH2_6                 9.626806e-02 1 1  ON 46
eH2_7                 1.506017e-01 1 1  ON 47
eH2_8                 1.741144e-01 1 1  ON 48
eH2_9                 4.227061e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9073
    reference variance = 0.207854
====================================================
  Execution time = 2.0698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3568e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335762425182
                                         uncertainty =       0.003503835957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335762425182
                                         uncertainty =       0.003503835957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409683616
  error estimate for blocks of size 2^( 2) =       0.000422300043
  error estimate for blocks of size 2^( 3) =       0.000434220596
  error estimate for blocks of size 2^( 4) =       0.000446117740
  error estimate for blocks of size 2^( 5) =       0.000456125337
  error estimate for blocks of size 2^( 6) =       0.000462686731
  error estimate for blocks of size 2^( 7) =       0.000468402693

      target function =                  N/A
              le_mean =     -16.925729961967
             les_mean =     286.816015908546
             stat err =       0.000458333125
             autocorr =       1.251599266230
              std dev =       0.579380126490
             le_variance =       0.335681330972


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692572996197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925729961967       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925729966007       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925729966051       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925729966808       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925729966559       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925729967653       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925729968208       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925729968270       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 8.972589e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925729961967       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925729962977       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925729962988       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925729963177       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925729963115       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925729963388       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925729963528       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925729963544       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.243211e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925729961967       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925729962219       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925729962222       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925729962269       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925729962254       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925729962323       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925729962358       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925729962356       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 5.608067e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6280e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.117856e-01 1 1  ON 0
 uu_1                 1.451843e-01 1 1  ON 1
 uu_2                 4.416715e-02 1 1  ON 2
 uu_3                -1.870247e-02 1 1  ON 3
 uu_4                -6.449536e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249405e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342839e-01 1 1  ON 8
 uu_9                -1.042635e-01 1 1  ON 9
 ud_0                 4.356415e-01 1 1  ON 10
 ud_1                 1.704417e-01 1 1  ON 11
 ud_2                 5.188687e-02 1 1  ON 12
 ud_3                -1.640105e-02 1 1  ON 13
 ud_4                -6.989239e-02 1 1  ON 14
 ud_5                -1.062043e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398873e-01 1 1  ON 17
 ud_8                -1.383912e-01 1 1  ON 18
 ud_9                -1.310018e-01 1 1  ON 19
 eO_0                -7.721084e-01 1 1  ON 20
 eO_1                -4.509707e-01 1 1  ON 21
 eO_2                -2.866721e-02 1 1  ON 22
 eO_3                 2.971039e-01 1 1  ON 23
 eO_4                 5.342491e-01 1 1  ON 24
 eO_5                 4.965946e-01 1 1  ON 25
 eO_6                 2.622973e-01 1 1  ON 26
 eO_7                -4.494052e-02 1 1  ON 27
 eO_8                -2.159775e-01 1 1  ON 28
 eO_9                -7.700265e-02 1 1  ON 29
eH1_0                -2.352116e-01 1 1  ON 30
eH1_1                -1.385771e-01 1 1  ON 31
eH1_2                -9.411447e-02 1 1  ON 32
eH1_3                -3.937730e-02 1 1  ON 33
eH1_4                 4.009264e-03 1 1  ON 34
eH1_5                 3.746267e-02 1 1  ON 35
eH1_6                 9.328410e-02 1 1  ON 36
eH1_7                 1.483257e-01 1 1  ON 37
eH1_8                 1.695210e-01 1 1  ON 38
eH1_9                 5.754295e-02 1 1  ON 39
eH2_0                -2.322526e-01 1 1  ON 40
eH2_1                -1.352051e-01 1 1  ON 41
eH2_2                -9.070516e-02 1 1  ON 42
eH2_3                -3.605040e-02 1 1  ON 43
eH2_4                 7.925029e-03 1 1  ON 44
eH2_5                 4.076000e-02 1 1  ON 45
eH2_6                 9.626796e-02 1 1  ON 46
eH2_7                 1.506017e-01 1 1  ON 47
eH2_8                 1.741145e-01 1 1  ON 48
eH2_9                 4.227072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9514
    reference variance = 0.19809
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3811e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081127775
                                         uncertainty =       0.003482315538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081127775
                                         uncertainty =       0.003482315538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411162806
  error estimate for blocks of size 2^( 2) =       0.000423387929
  error estimate for blocks of size 2^( 3) =       0.000435764552
  error estimate for blocks of size 2^( 4) =       0.000447049063
  error estimate for blocks of size 2^( 5) =       0.000456215675
  error estimate for blocks of size 2^( 6) =       0.000462103306
  error estimate for blocks of size 2^( 7) =       0.000467808825

      target function =                  N/A
              le_mean =     -16.925362202337
             les_mean =     286.805995217353
             stat err =       0.000458294217
             autocorr =       1.242399055295
              std dev =       0.581472016608
             le_variance =       0.338109706098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081307376
                                         uncertainty =       0.003482318186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081307376
                                         uncertainty =       0.003482318186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411162915
  error estimate for blocks of size 2^( 2) =       0.000423388038
  error estimate for blocks of size 2^( 3) =       0.000435764663
  error estimate for blocks of size 2^( 4) =       0.000447049171
  error estimate for blocks of size 2^( 5) =       0.000456215774
  error estimate for blocks of size 2^( 6) =       0.000462103393
  error estimate for blocks of size 2^( 7) =       0.000467808913

      target function =                  N/A
              le_mean =     -16.925362203314
             les_mean =     286.805995430276
             stat err =       0.000458294313
             autocorr =       1.242398910810
              std dev =       0.581472171261
             le_variance =       0.338109885951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081217678
                                         uncertainty =       0.003482316864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081217678
                                         uncertainty =       0.003482316864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411162861
  error estimate for blocks of size 2^( 2) =       0.000423387983
  error estimate for blocks of size 2^( 3) =       0.000435764608
  error estimate for blocks of size 2^( 4) =       0.000447049117
  error estimate for blocks of size 2^( 5) =       0.000456215725
  error estimate for blocks of size 2^( 6) =       0.000462103349
  error estimate for blocks of size 2^( 7) =       0.000467808869

      target function =                  N/A
              le_mean =     -16.925362202826
             les_mean =     286.805995323931
             stat err =       0.000458294265
             autocorr =       1.242398983018
              std dev =       0.581472094023
             le_variance =       0.338109796128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081139016
                                         uncertainty =       0.003482315704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338081139016
                                         uncertainty =       0.003482315704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411162813
  error estimate for blocks of size 2^( 2) =       0.000423387936
  error estimate for blocks of size 2^( 3) =       0.000435764559
  error estimate for blocks of size 2^( 4) =       0.000447049070
  error estimate for blocks of size 2^( 5) =       0.000456215682
  error estimate for blocks of size 2^( 6) =       0.000462103311
  error estimate for blocks of size 2^( 7) =       0.000467808831

      target function =                  N/A
              le_mean =     -16.925362202398
             les_mean =     286.805995230678
             stat err =       0.000458294223
             autocorr =       1.242399046259
              std dev =       0.581472026288
             le_variance =       0.338109717355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925362202337        initial
     3.7253e+02     3.7253e+03             8.9726e-07       -16.925362203314  <--
     1.4901e+03     1.4901e+04             2.2432e-07       -16.925362202826
     5.9605e+03     5.9605e+04             5.6081e-08       -16.925362202398

*****************************************************************************
Applying the update for shift_i =   3.7253e+02     and shift_s =   3.7253e+03
*****************************************************************************

  Execution time = 2.9735e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.117855e-01 1 1  ON 0
 uu_1                 1.451844e-01 1 1  ON 1
 uu_2                 4.416743e-02 1 1  ON 2
 uu_3                -1.870245e-02 1 1  ON 3
 uu_4                -6.449523e-02 1 1  ON 4
 uu_5                -9.825888e-02 1 1  ON 5
 uu_6                -1.249404e-01 1 1  ON 6
 uu_7                -1.391423e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042639e-01 1 1  ON 9
 ud_0                 4.356417e-01 1 1  ON 10
 ud_1                 1.704414e-01 1 1  ON 11
 ud_2                 5.188682e-02 1 1  ON 12
 ud_3                -1.640137e-02 1 1  ON 13
 ud_4                -6.989256e-02 1 1  ON 14
 ud_5                -1.062045e-01 1 1  ON 15
 ud_6                -1.280531e-01 1 1  ON 16
 ud_7                -1.398869e-01 1 1  ON 17
 ud_8                -1.383909e-01 1 1  ON 18
 ud_9                -1.310016e-01 1 1  ON 19
 eO_0                -7.721086e-01 1 1  ON 20
 eO_1                -4.509712e-01 1 1  ON 21
 eO_2                -2.866751e-02 1 1  ON 22
 eO_3                 2.971037e-01 1 1  ON 23
 eO_4                 5.342494e-01 1 1  ON 24
 eO_5                 4.965951e-01 1 1  ON 25
 eO_6                 2.622980e-01 1 1  ON 26
 eO_7                -4.494024e-02 1 1  ON 27
 eO_8                -2.159778e-01 1 1  ON 28
 eO_9                -7.700294e-02 1 1  ON 29
eH1_0                -2.352117e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411442e-02 1 1  ON 32
eH1_3                -3.937738e-02 1 1  ON 33
eH1_4                 4.009476e-03 1 1  ON 34
eH1_5                 3.746235e-02 1 1  ON 35
eH1_6                 9.328383e-02 1 1  ON 36
eH1_7                 1.483256e-01 1 1  ON 37
eH1_8                 1.695212e-01 1 1  ON 38
eH1_9                 5.754320e-02 1 1  ON 39
eH2_0                -2.322524e-01 1 1  ON 40
eH2_1                -1.352051e-01 1 1  ON 41
eH2_2                -9.070522e-02 1 1  ON 42
eH2_3                -3.605054e-02 1 1  ON 43
eH2_4                 7.924861e-03 1 1  ON 44
eH2_5                 4.075987e-02 1 1  ON 45
eH2_6                 9.626768e-02 1 1  ON 46
eH2_7                 1.506018e-01 1 1  ON 47
eH2_8                 1.741148e-01 1 1  ON 48
eH2_9                 4.227107e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.972
    reference variance = 0.225831
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343101471612
                                         uncertainty =       0.003845269860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343101471612
                                         uncertainty =       0.003845269860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414190623
  error estimate for blocks of size 2^( 2) =       0.000426385074
  error estimate for blocks of size 2^( 3) =       0.000439084324
  error estimate for blocks of size 2^( 4) =       0.000450969062
  error estimate for blocks of size 2^( 5) =       0.000460028233
  error estimate for blocks of size 2^( 6) =       0.000467075895
  error estimate for blocks of size 2^( 7) =       0.000470625391

      target function =                  N/A
              le_mean =     -16.924984456301
             les_mean =     286.798206418095
             stat err =       0.000462174645
             autocorr =       1.245121431761
              std dev =       0.585753995834
             le_variance =       0.343107743635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692498445630e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924984456301       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924984464797       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924984475387       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924984486901       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924984490133       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924984492309       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924984487534       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924984487953       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 4.007939e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924984456301       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924984458427       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924984461081       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924984463963       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924984464774       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924984465323       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924984464128       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924984464231       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 1.002118e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924984456301       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924984456832       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924984457496       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924984458217       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924984458420       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924984458557       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924984458259       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924984458284       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 2.505380e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.082551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6078e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.117853e-01 1 1  ON 0
 uu_1                 1.451850e-01 1 1  ON 1
 uu_2                 4.416764e-02 1 1  ON 2
 uu_3                -1.870203e-02 1 1  ON 3
 uu_4                -6.449538e-02 1 1  ON 4
 uu_5                -9.825902e-02 1 1  ON 5
 uu_6                -1.249408e-01 1 1  ON 6
 uu_7                -1.391422e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042645e-01 1 1  ON 9
 ud_0                 4.356416e-01 1 1  ON 10
 ud_1                 1.704410e-01 1 1  ON 11
 ud_2                 5.188666e-02 1 1  ON 12
 ud_3                -1.640162e-02 1 1  ON 13
 ud_4                -6.989250e-02 1 1  ON 14
 ud_5                -1.062041e-01 1 1  ON 15
 ud_6                -1.280531e-01 1 1  ON 16
 ud_7                -1.398865e-01 1 1  ON 17
 ud_8                -1.383908e-01 1 1  ON 18
 ud_9                -1.310016e-01 1 1  ON 19
 eO_0                -7.721092e-01 1 1  ON 20
 eO_1                -4.509714e-01 1 1  ON 21
 eO_2                -2.866787e-02 1 1  ON 22
 eO_3                 2.971034e-01 1 1  ON 23
 eO_4                 5.342498e-01 1 1  ON 24
 eO_5                 4.965958e-01 1 1  ON 25
 eO_6                 2.622990e-01 1 1  ON 26
 eO_7                -4.493982e-02 1 1  ON 27
 eO_8                -2.159783e-01 1 1  ON 28
 eO_9                -7.700341e-02 1 1  ON 29
eH1_0                -2.352119e-01 1 1  ON 30
eH1_1                -1.385771e-01 1 1  ON 31
eH1_2                -9.411451e-02 1 1  ON 32
eH1_3                -3.937734e-02 1 1  ON 33
eH1_4                 4.009446e-03 1 1  ON 34
eH1_5                 3.746211e-02 1 1  ON 35
eH1_6                 9.328366e-02 1 1  ON 36
eH1_7                 1.483258e-01 1 1  ON 37
eH1_8                 1.695216e-01 1 1  ON 38
eH1_9                 5.754350e-02 1 1  ON 39
eH2_0                -2.322528e-01 1 1  ON 40
eH2_1                -1.352051e-01 1 1  ON 41
eH2_2                -9.070498e-02 1 1  ON 42
eH2_3                -3.605052e-02 1 1  ON 43
eH2_4                 7.924773e-03 1 1  ON 44
eH2_5                 4.075968e-02 1 1  ON 45
eH2_6                 9.626724e-02 1 1  ON 46
eH2_7                 1.506016e-01 1 1  ON 47
eH2_8                 1.741152e-01 1 1  ON 48
eH2_9                 4.227160e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8901
    reference variance = 0.195655
====================================================
  Execution time = 2.0280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3948e-01
  Total weights = 2.0000e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459399323
                                         uncertainty =       0.004759278560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459399323
                                         uncertainty =       0.004759278560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411998170
  error estimate for blocks of size 2^( 2) =       0.000424832513
  error estimate for blocks of size 2^( 3) =       0.000437631410
  error estimate for blocks of size 2^( 4) =       0.000448077548
  error estimate for blocks of size 2^( 5) =       0.000456567868
  error estimate for blocks of size 2^( 6) =       0.000466548989
  error estimate for blocks of size 2^( 7) =       0.000471708088

      target function =                  N/A
              le_mean =     -16.924568805445
             les_mean =     286.780514065042
             stat err =       0.000460725623
             autocorr =       1.250530125162
              std dev =       0.582653400000
             le_variance =       0.339484984532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459602276
                                         uncertainty =       0.004759252111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459602276
                                         uncertainty =       0.004759252111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411998293
  error estimate for blocks of size 2^( 2) =       0.000424832615
  error estimate for blocks of size 2^( 3) =       0.000437631491
  error estimate for blocks of size 2^( 4) =       0.000448077615
  error estimate for blocks of size 2^( 5) =       0.000456567943
  error estimate for blocks of size 2^( 6) =       0.000466549020
  error estimate for blocks of size 2^( 7) =       0.000471708134

      target function =                  N/A
              le_mean =     -16.924568808297
             les_mean =     286.780514363824
             stat err =       0.000460725678
             autocorr =       1.250529677337
              std dev =       0.582653573560
             le_variance =       0.339485186782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459502362
                                         uncertainty =       0.004759265313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459502362
                                         uncertainty =       0.004759265313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411998233
  error estimate for blocks of size 2^( 2) =       0.000424832565
  error estimate for blocks of size 2^( 3) =       0.000437631451
  error estimate for blocks of size 2^( 4) =       0.000448077583
  error estimate for blocks of size 2^( 5) =       0.000456567907
  error estimate for blocks of size 2^( 6) =       0.000466549005
  error estimate for blocks of size 2^( 7) =       0.000471708112

      target function =                  N/A
              le_mean =     -16.924568806878
             les_mean =     286.780514216213
             stat err =       0.000460725652
             autocorr =       1.250529899701
              std dev =       0.582653488120
             le_variance =       0.339485087218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459412249
                                         uncertainty =       0.004759276904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339459412249
                                         uncertainty =       0.004759276904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411998178
  error estimate for blocks of size 2^( 2) =       0.000424832520
  error estimate for blocks of size 2^( 3) =       0.000437631415
  error estimate for blocks of size 2^( 4) =       0.000448077553
  error estimate for blocks of size 2^( 5) =       0.000456567873
  error estimate for blocks of size 2^( 6) =       0.000466548991
  error estimate for blocks of size 2^( 7) =       0.000471708091

      target function =                  N/A
              le_mean =     -16.924568805624
             les_mean =     286.780514083981
             stat err =       0.000460725627
             autocorr =       1.250530096934
              std dev =       0.582653411055
             le_variance =       0.339484997414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924568805445        initial
     9.3132e+01     9.3132e+02             4.0079e-06       -16.924568808297  <--
     3.7253e+02     3.7253e+03             1.0021e-06       -16.924568806878
     1.4901e+03     1.4901e+04             2.5054e-07       -16.924568805624

*****************************************************************************
Applying the update for shift_i =   9.3132e+01     and shift_s =   9.3132e+02
*****************************************************************************

  Execution time = 2.9777e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.117845e-01 1 1  ON 0
 uu_1                 1.451868e-01 1 1  ON 1
 uu_2                 4.416828e-02 1 1  ON 2
 uu_3                -1.870079e-02 1 1  ON 3
 uu_4                -6.449584e-02 1 1  ON 4
 uu_5                -9.825943e-02 1 1  ON 5
 uu_6                -1.249419e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342842e-01 1 1  ON 8
 uu_9                -1.042664e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704400e-01 1 1  ON 11
 ud_2                 5.188617e-02 1 1  ON 12
 ud_3                -1.640238e-02 1 1  ON 13
 ud_4                -6.989231e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280530e-01 1 1  ON 16
 ud_7                -1.398854e-01 1 1  ON 17
 ud_8                -1.383906e-01 1 1  ON 18
 ud_9                -1.310017e-01 1 1  ON 19
 eO_0                -7.721110e-01 1 1  ON 20
 eO_1                -4.509721e-01 1 1  ON 21
 eO_2                -2.866894e-02 1 1  ON 22
 eO_3                 2.971022e-01 1 1  ON 23
 eO_4                 5.342512e-01 1 1  ON 24
 eO_5                 4.965981e-01 1 1  ON 25
 eO_6                 2.623020e-01 1 1  ON 26
 eO_7                -4.493857e-02 1 1  ON 27
 eO_8                -2.159799e-01 1 1  ON 28
 eO_9                -7.700483e-02 1 1  ON 29
eH1_0                -2.352124e-01 1 1  ON 30
eH1_1                -1.385774e-01 1 1  ON 31
eH1_2                -9.411477e-02 1 1  ON 32
eH1_3                -3.937723e-02 1 1  ON 33
eH1_4                 4.009359e-03 1 1  ON 34
eH1_5                 3.746138e-02 1 1  ON 35
eH1_6                 9.328316e-02 1 1  ON 36
eH1_7                 1.483265e-01 1 1  ON 37
eH1_8                 1.695228e-01 1 1  ON 38
eH1_9                 5.754440e-02 1 1  ON 39
eH2_0                -2.322541e-01 1 1  ON 40
eH2_1                -1.352049e-01 1 1  ON 41
eH2_2                -9.070427e-02 1 1  ON 42
eH2_3                -3.605045e-02 1 1  ON 43
eH2_4                 7.924510e-03 1 1  ON 44
eH2_5                 4.075909e-02 1 1  ON 45
eH2_6                 9.626591e-02 1 1  ON 46
eH2_7                 1.506008e-01 1 1  ON 47
eH2_8                 1.741165e-01 1 1  ON 48
eH2_9                 4.227319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8606
    reference variance = 0.254848
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9943e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342764858127
                                         uncertainty =       0.006488232808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342764858127
                                         uncertainty =       0.006488232808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413960549
  error estimate for blocks of size 2^( 2) =       0.000426728411
  error estimate for blocks of size 2^( 3) =       0.000439327017
  error estimate for blocks of size 2^( 4) =       0.000451038215
  error estimate for blocks of size 2^( 5) =       0.000460742050
  error estimate for blocks of size 2^( 6) =       0.000466969606
  error estimate for blocks of size 2^( 7) =       0.000469856915

      target function =                  N/A
              le_mean =     -16.924343940870
             les_mean =     286.776144329161
             stat err =       0.000462151696
             autocorr =       1.246382076380
              std dev =       0.585428622180
             le_variance =       0.342726671668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692434394087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924343940870       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924343952143       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924343969024       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924343987908       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924344009752       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924344011542       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924344011021       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924344012978       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 1.219429e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924343940870       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924343943702       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924343947945       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924343952720       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924343958165       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924343958664       residual = 9.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924343958549       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924343959023       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 3.049821e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924343940870       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924343941579       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924343942641       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924343943838       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924343945198       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924343945326       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924343945298       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924343945417       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 7.625338e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.085191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6557e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.117849e-01 1 1  ON 0
 uu_1                 1.451884e-01 1 1  ON 1
 uu_2                 4.416869e-02 1 1  ON 2
 uu_3                -1.870099e-02 1 1  ON 3
 uu_4                -6.449651e-02 1 1  ON 4
 uu_5                -9.826050e-02 1 1  ON 5
 uu_6                -1.249428e-01 1 1  ON 6
 uu_7                -1.391413e-01 1 1  ON 7
 uu_8                -1.342838e-01 1 1  ON 8
 uu_9                -1.042679e-01 1 1  ON 9
 ud_0                 4.356418e-01 1 1  ON 10
 ud_1                 1.704389e-01 1 1  ON 11
 ud_2                 5.188536e-02 1 1  ON 12
 ud_3                -1.640327e-02 1 1  ON 13
 ud_4                -6.989208e-02 1 1  ON 14
 ud_5                -1.062029e-01 1 1  ON 15
 ud_6                -1.280522e-01 1 1  ON 16
 ud_7                -1.398849e-01 1 1  ON 17
 ud_8                -1.383903e-01 1 1  ON 18
 ud_9                -1.310014e-01 1 1  ON 19
 eO_0                -7.721129e-01 1 1  ON 20
 eO_1                -4.509736e-01 1 1  ON 21
 eO_2                -2.866961e-02 1 1  ON 22
 eO_3                 2.971011e-01 1 1  ON 23
 eO_4                 5.342521e-01 1 1  ON 24
 eO_5                 4.966009e-01 1 1  ON 25
 eO_6                 2.623051e-01 1 1  ON 26
 eO_7                -4.493694e-02 1 1  ON 27
 eO_8                -2.159813e-01 1 1  ON 28
 eO_9                -7.700646e-02 1 1  ON 29
eH1_0                -2.352122e-01 1 1  ON 30
eH1_1                -1.385765e-01 1 1  ON 31
eH1_2                -9.411490e-02 1 1  ON 32
eH1_3                -3.937790e-02 1 1  ON 33
eH1_4                 4.009835e-03 1 1  ON 34
eH1_5                 3.745926e-02 1 1  ON 35
eH1_6                 9.328217e-02 1 1  ON 36
eH1_7                 1.483261e-01 1 1  ON 37
eH1_8                 1.695238e-01 1 1  ON 38
eH1_9                 5.754590e-02 1 1  ON 39
eH2_0                -2.322546e-01 1 1  ON 40
eH2_1                -1.352059e-01 1 1  ON 41
eH2_2                -9.070397e-02 1 1  ON 42
eH2_3                -3.605036e-02 1 1  ON 43
eH2_4                 7.924630e-03 1 1  ON 44
eH2_5                 4.075687e-02 1 1  ON 45
eH2_6                 9.626549e-02 1 1  ON 46
eH2_7                 1.506010e-01 1 1  ON 47
eH2_8                 1.741178e-01 1 1  ON 48
eH2_9                 4.227531e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9282
    reference variance = 0.185199
====================================================
  Execution time = 2.0312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3261e-01
  Total weights = 2.0000e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332532171944
                                         uncertainty =       0.002839517044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332532171944
                                         uncertainty =       0.002839517044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407805825
  error estimate for blocks of size 2^( 2) =       0.000420090716
  error estimate for blocks of size 2^( 3) =       0.000432465402
  error estimate for blocks of size 2^( 4) =       0.000443606846
  error estimate for blocks of size 2^( 5) =       0.000453407655
  error estimate for blocks of size 2^( 6) =       0.000461070775
  error estimate for blocks of size 2^( 7) =       0.000464417079

      target function =                  N/A
              le_mean =     -16.925268490757
             les_mean =     286.797324499907
             stat err =       0.000455625588
             autocorr =       1.248272385970
              std dev =       0.576724528684
             le_variance =       0.332611181986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332537690987
                                         uncertainty =       0.002839597358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332537690987
                                         uncertainty =       0.002839597358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407809212
  error estimate for blocks of size 2^( 2) =       0.000420093908
  error estimate for blocks of size 2^( 3) =       0.000432468430
  error estimate for blocks of size 2^( 4) =       0.000443609719
  error estimate for blocks of size 2^( 5) =       0.000453410487
  error estimate for blocks of size 2^( 6) =       0.000461073703
  error estimate for blocks of size 2^( 7) =       0.000464420012

      target function =                  N/A
              le_mean =     -16.925268475412
             les_mean =     286.797329505139
             stat err =       0.000455628480
             autocorr =       1.248267496896
              std dev =       0.576729318375
             le_variance =       0.332616706673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332534970107
                                         uncertainty =       0.002839557653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332534970107
                                         uncertainty =       0.002839557653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407807542
  error estimate for blocks of size 2^( 2) =       0.000420092334
  error estimate for blocks of size 2^( 3) =       0.000432466938
  error estimate for blocks of size 2^( 4) =       0.000443608303
  error estimate for blocks of size 2^( 5) =       0.000453409092
  error estimate for blocks of size 2^( 6) =       0.000461072261
  error estimate for blocks of size 2^( 7) =       0.000464418568

      target function =                  N/A
              le_mean =     -16.925268482837
             les_mean =     286.797327032826
             stat err =       0.000455627056
             autocorr =       1.248269913388
              std dev =       0.576726957062
             le_variance =       0.332613983002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332532522915
                                         uncertainty =       0.002839522134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332532522915
                                         uncertainty =       0.002839522134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407806040
  error estimate for blocks of size 2^( 2) =       0.000420090919
  error estimate for blocks of size 2^( 3) =       0.000432465594
  error estimate for blocks of size 2^( 4) =       0.000443607028
  error estimate for blocks of size 2^( 5) =       0.000453407835
  error estimate for blocks of size 2^( 6) =       0.000461070961
  error estimate for blocks of size 2^( 7) =       0.000464417265

      target function =                  N/A
              le_mean =     -16.925268489756
             les_mean =     286.797324817322
             stat err =       0.000455625773
             autocorr =       1.248272076006
              std dev =       0.576724833274
             le_variance =       0.332611533314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925268490757        initial  <--
     2.3283e+01     2.3283e+02             1.2194e-05       -16.925268475412
     9.3132e+01     9.3132e+02             3.0498e-06       -16.925268482837
     3.7253e+02     3.7253e+03             7.6253e-07       -16.925268489756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7840
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.117845e-01 1 1  ON 0
 uu_1                 1.451868e-01 1 1  ON 1
 uu_2                 4.416828e-02 1 1  ON 2
 uu_3                -1.870079e-02 1 1  ON 3
 uu_4                -6.449584e-02 1 1  ON 4
 uu_5                -9.825943e-02 1 1  ON 5
 uu_6                -1.249419e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342842e-01 1 1  ON 8
 uu_9                -1.042664e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704400e-01 1 1  ON 11
 ud_2                 5.188617e-02 1 1  ON 12
 ud_3                -1.640238e-02 1 1  ON 13
 ud_4                -6.989231e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280530e-01 1 1  ON 16
 ud_7                -1.398854e-01 1 1  ON 17
 ud_8                -1.383906e-01 1 1  ON 18
 ud_9                -1.310017e-01 1 1  ON 19
 eO_0                -7.721110e-01 1 1  ON 20
 eO_1                -4.509721e-01 1 1  ON 21
 eO_2                -2.866894e-02 1 1  ON 22
 eO_3                 2.971022e-01 1 1  ON 23
 eO_4                 5.342512e-01 1 1  ON 24
 eO_5                 4.965981e-01 1 1  ON 25
 eO_6                 2.623020e-01 1 1  ON 26
 eO_7                -4.493857e-02 1 1  ON 27
 eO_8                -2.159799e-01 1 1  ON 28
 eO_9                -7.700483e-02 1 1  ON 29
eH1_0                -2.352124e-01 1 1  ON 30
eH1_1                -1.385774e-01 1 1  ON 31
eH1_2                -9.411477e-02 1 1  ON 32
eH1_3                -3.937723e-02 1 1  ON 33
eH1_4                 4.009359e-03 1 1  ON 34
eH1_5                 3.746138e-02 1 1  ON 35
eH1_6                 9.328316e-02 1 1  ON 36
eH1_7                 1.483265e-01 1 1  ON 37
eH1_8                 1.695228e-01 1 1  ON 38
eH1_9                 5.754440e-02 1 1  ON 39
eH2_0                -2.322541e-01 1 1  ON 40
eH2_1                -1.352049e-01 1 1  ON 41
eH2_2                -9.070427e-02 1 1  ON 42
eH2_3                -3.605045e-02 1 1  ON 43
eH2_4                 7.924510e-03 1 1  ON 44
eH2_5                 4.075909e-02 1 1  ON 45
eH2_6                 9.626591e-02 1 1  ON 46
eH2_7                 1.506008e-01 1 1  ON 47
eH2_8                 1.741165e-01 1 1  ON 48
eH2_9                 4.227319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6346e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8976
    reference variance = 0.173084
====================================================
  Execution time = 2.2477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4458e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638084303
                                         uncertainty =       0.010147476088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344638084303
                                         uncertainty =       0.010147476088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415078544
  error estimate for blocks of size 2^( 2) =       0.000427631885
  error estimate for blocks of size 2^( 3) =       0.000440223155
  error estimate for blocks of size 2^( 4) =       0.000452064633
  error estimate for blocks of size 2^( 5) =       0.000461449222
  error estimate for blocks of size 2^( 6) =       0.000468581163
  error estimate for blocks of size 2^( 7) =       0.000473194464

      target function =                  N/A
              le_mean =     -16.924778342929
             les_mean =     286.792702180687
             stat err =       0.000463822371
             autocorr =       1.248656012331
              std dev =       0.587009706644
             le_variance =       0.344580395695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692477834293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924778342929       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924778347911       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924778346231       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924778349178       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924778351144       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924778350802       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924778351340       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924778351269       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.388701e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924778342929       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924778344175       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924778343755       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924778344493       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924778344985       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924778344899       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924778345034       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924778345015       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.472266e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924778342929       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924778343241       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924778343136       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924778343320       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924778343443       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924778343422       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924778343455       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924778343451       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 8.680987e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7993e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451869e-01 1 1  ON 1
 uu_2                 4.416835e-02 1 1  ON 2
 uu_3                -1.870086e-02 1 1  ON 3
 uu_4                -6.449586e-02 1 1  ON 4
 uu_5                -9.825954e-02 1 1  ON 5
 uu_6                -1.249420e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042664e-01 1 1  ON 9
 ud_0                 4.356414e-01 1 1  ON 10
 ud_1                 1.704399e-01 1 1  ON 11
 ud_2                 5.188607e-02 1 1  ON 12
 ud_3                -1.640257e-02 1 1  ON 13
 ud_4                -6.989238e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280532e-01 1 1  ON 16
 ud_7                -1.398853e-01 1 1  ON 17
 ud_8                -1.383903e-01 1 1  ON 18
 ud_9                -1.310015e-01 1 1  ON 19
 eO_0                -7.721112e-01 1 1  ON 20
 eO_1                -4.509723e-01 1 1  ON 21
 eO_2                -2.866908e-02 1 1  ON 22
 eO_3                 2.971021e-01 1 1  ON 23
 eO_4                 5.342514e-01 1 1  ON 24
 eO_5                 4.965983e-01 1 1  ON 25
 eO_6                 2.623022e-01 1 1  ON 26
 eO_7                -4.493839e-02 1 1  ON 27
 eO_8                -2.159799e-01 1 1  ON 28
 eO_9                -7.700493e-02 1 1  ON 29
eH1_0                -2.352125e-01 1 1  ON 30
eH1_1                -1.385773e-01 1 1  ON 31
eH1_2                -9.411482e-02 1 1  ON 32
eH1_3                -3.937731e-02 1 1  ON 33
eH1_4                 4.009279e-03 1 1  ON 34
eH1_5                 3.746120e-02 1 1  ON 35
eH1_6                 9.328312e-02 1 1  ON 36
eH1_7                 1.483265e-01 1 1  ON 37
eH1_8                 1.695229e-01 1 1  ON 38
eH1_9                 5.754457e-02 1 1  ON 39
eH2_0                -2.322540e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070427e-02 1 1  ON 42
eH2_3                -3.605052e-02 1 1  ON 43
eH2_4                 7.924382e-03 1 1  ON 44
eH2_5                 4.075900e-02 1 1  ON 45
eH2_6                 9.626573e-02 1 1  ON 46
eH2_7                 1.506008e-01 1 1  ON 47
eH2_8                 1.741167e-01 1 1  ON 48
eH2_9                 4.227346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9017
    reference variance = 0.275414
====================================================
  Execution time = 2.0189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3027e-01
  Total weights = 2.0000e+06
  Execution time = 1.8801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370540754
                                         uncertainty =       0.002908601573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370540754
                                         uncertainty =       0.002908601573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406370182
  error estimate for blocks of size 2^( 2) =       0.000419202736
  error estimate for blocks of size 2^( 3) =       0.000432348344
  error estimate for blocks of size 2^( 4) =       0.000443338842
  error estimate for blocks of size 2^( 5) =       0.000452725932
  error estimate for blocks of size 2^( 6) =       0.000459499903
  error estimate for blocks of size 2^( 7) =       0.000466222733

      target function =                  N/A
              le_mean =     -16.925088922968
             les_mean =     286.788908334775
             stat err =       0.000455446853
             autocorr =       1.256121772939
              std dev =       0.574694222633
             le_variance =       0.330273449527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370855575
                                         uncertainty =       0.002908603448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370855575
                                         uncertainty =       0.002908603448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406370376
  error estimate for blocks of size 2^( 2) =       0.000419202922
  error estimate for blocks of size 2^( 3) =       0.000432348520
  error estimate for blocks of size 2^( 4) =       0.000443339007
  error estimate for blocks of size 2^( 5) =       0.000452726090
  error estimate for blocks of size 2^( 6) =       0.000459500040
  error estimate for blocks of size 2^( 7) =       0.000466222860

      target function =                  N/A
              le_mean =     -16.925088924867
             les_mean =     286.788908713841
             stat err =       0.000455446999
             autocorr =       1.256121385370
              std dev =       0.574694496515
             le_variance =       0.330273764324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370698385
                                         uncertainty =       0.002908602513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370698385
                                         uncertainty =       0.002908602513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406370279
  error estimate for blocks of size 2^( 2) =       0.000419202829
  error estimate for blocks of size 2^( 3) =       0.000432348432
  error estimate for blocks of size 2^( 4) =       0.000443338925
  error estimate for blocks of size 2^( 5) =       0.000452726011
  error estimate for blocks of size 2^( 6) =       0.000459499972
  error estimate for blocks of size 2^( 7) =       0.000466222797

      target function =                  N/A
              le_mean =     -16.925088923920
             les_mean =     286.788908524615
             stat err =       0.000455446926
             autocorr =       1.256121578949
              std dev =       0.574694359766
             le_variance =       0.330273607147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370560464
                                         uncertainty =       0.002908601691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330370560464
                                         uncertainty =       0.002908601691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406370194
  error estimate for blocks of size 2^( 2) =       0.000419202748
  error estimate for blocks of size 2^( 3) =       0.000432348355
  error estimate for blocks of size 2^( 4) =       0.000443338852
  error estimate for blocks of size 2^( 5) =       0.000452725942
  error estimate for blocks of size 2^( 6) =       0.000459499912
  error estimate for blocks of size 2^( 7) =       0.000466222741

      target function =                  N/A
              le_mean =     -16.925088923087
             les_mean =     286.788908358512
             stat err =       0.000455446862
             autocorr =       1.256121748694
              std dev =       0.574694239780
             le_variance =       0.330273469236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925088922968        initial
     2.3283e+02     2.3283e+03             1.3887e-06       -16.925088924867  <--
     9.3132e+02     9.3132e+03             3.4723e-07       -16.925088923920
     3.7253e+03     3.7253e+04             8.6810e-08       -16.925088923087

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.9703e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.117842e-01 1 1  ON 0
 uu_1                 1.451871e-01 1 1  ON 1
 uu_2                 4.416854e-02 1 1  ON 2
 uu_3                -1.870104e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825985e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342839e-01 1 1  ON 8
 uu_9                -1.042664e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704393e-01 1 1  ON 11
 ud_2                 5.188577e-02 1 1  ON 12
 ud_3                -1.640314e-02 1 1  ON 13
 ud_4                -6.989258e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280538e-01 1 1  ON 16
 ud_7                -1.398849e-01 1 1  ON 17
 ud_8                -1.383892e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721120e-01 1 1  ON 20
 eO_1                -4.509729e-01 1 1  ON 21
 eO_2                -2.866949e-02 1 1  ON 22
 eO_3                 2.971020e-01 1 1  ON 23
 eO_4                 5.342519e-01 1 1  ON 24
 eO_5                 4.965990e-01 1 1  ON 25
 eO_6                 2.623029e-01 1 1  ON 26
 eO_7                -4.493785e-02 1 1  ON 27
 eO_8                -2.159800e-01 1 1  ON 28
 eO_9                -7.700521e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411495e-02 1 1  ON 32
eH1_3                -3.937754e-02 1 1  ON 33
eH1_4                 4.009037e-03 1 1  ON 34
eH1_5                 3.746065e-02 1 1  ON 35
eH1_6                 9.328300e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695233e-01 1 1  ON 38
eH1_9                 5.754509e-02 1 1  ON 39
eH2_0                -2.322538e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070426e-02 1 1  ON 42
eH2_3                -3.605071e-02 1 1  ON 43
eH2_4                 7.923999e-03 1 1  ON 44
eH2_5                 4.075873e-02 1 1  ON 45
eH2_6                 9.626522e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741171e-01 1 1  ON 48
eH2_9                 4.227425e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9392
    reference variance = 0.292255
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4692e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346998681089
                                         uncertainty =       0.009112167846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346998681089
                                         uncertainty =       0.009112167846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416484804
  error estimate for blocks of size 2^( 2) =       0.000428568289
  error estimate for blocks of size 2^( 3) =       0.000441236967
  error estimate for blocks of size 2^( 4) =       0.000452662389
  error estimate for blocks of size 2^( 5) =       0.000461420068
  error estimate for blocks of size 2^( 6) =       0.000467009732
  error estimate for blocks of size 2^( 7) =       0.000471452014

      target function =                  N/A
              le_mean =     -16.924871083033
             les_mean =     286.798180186952
             stat err =       0.000463136051
             autocorr =       1.236570428613
              std dev =       0.588998457654
             le_variance =       0.346919183119


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692487108303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924871083033       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924871094337       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924871108599       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924871115454       residual = 9.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924871117274       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924871115089       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924871117294       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924871117115       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 4.659444e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924871083033       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924871085862       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924871089441       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924871091177       residual = 8.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924871091608       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924871091061       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924871091610       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924871091563       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 1.165098e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924871083033       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924871083741       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924871084636       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924871085072       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924871085179       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924871085041       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924871085178       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924871085167       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.912897e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090564 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5961e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.117841e-01 1 1  ON 0
 uu_1                 1.451873e-01 1 1  ON 1
 uu_2                 4.416895e-02 1 1  ON 2
 uu_3                -1.870111e-02 1 1  ON 3
 uu_4                -6.449635e-02 1 1  ON 4
 uu_5                -9.825972e-02 1 1  ON 5
 uu_6                -1.249426e-01 1 1  ON 6
 uu_7                -1.391417e-01 1 1  ON 7
 uu_8                -1.342837e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356406e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188537e-02 1 1  ON 12
 ud_3                -1.640315e-02 1 1  ON 13
 ud_4                -6.989275e-02 1 1  ON 14
 ud_5                -1.062029e-01 1 1  ON 15
 ud_6                -1.280539e-01 1 1  ON 16
 ud_7                -1.398846e-01 1 1  ON 17
 ud_8                -1.383888e-01 1 1  ON 18
 ud_9                -1.310002e-01 1 1  ON 19
 eO_0                -7.721125e-01 1 1  ON 20
 eO_1                -4.509735e-01 1 1  ON 21
 eO_2                -2.867028e-02 1 1  ON 22
 eO_3                 2.971015e-01 1 1  ON 23
 eO_4                 5.342525e-01 1 1  ON 24
 eO_5                 4.965999e-01 1 1  ON 25
 eO_6                 2.623041e-01 1 1  ON 26
 eO_7                -4.493716e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700581e-02 1 1  ON 29
eH1_0                -2.352123e-01 1 1  ON 30
eH1_1                -1.385775e-01 1 1  ON 31
eH1_2                -9.411552e-02 1 1  ON 32
eH1_3                -3.937817e-02 1 1  ON 33
eH1_4                 4.009166e-03 1 1  ON 34
eH1_5                 3.746020e-02 1 1  ON 35
eH1_6                 9.328307e-02 1 1  ON 36
eH1_7                 1.483270e-01 1 1  ON 37
eH1_8                 1.695239e-01 1 1  ON 38
eH1_9                 5.754578e-02 1 1  ON 39
eH2_0                -2.322537e-01 1 1  ON 40
eH2_1                -1.352043e-01 1 1  ON 41
eH2_2                -9.070402e-02 1 1  ON 42
eH2_3                -3.605120e-02 1 1  ON 43
eH2_4                 7.923692e-03 1 1  ON 44
eH2_5                 4.075811e-02 1 1  ON 45
eH2_6                 9.626432e-02 1 1  ON 46
eH2_7                 1.506002e-01 1 1  ON 47
eH2_8                 1.741178e-01 1 1  ON 48
eH2_9                 4.227532e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.216487
====================================================
  Execution time = 1.9975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.6126e-01
  Total weights = 2.0000e+06
  Execution time = 1.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361402440295
                                         uncertainty =       0.019416307323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361402440295
                                         uncertainty =       0.019416307323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425006262
  error estimate for blocks of size 2^( 2) =       0.000436901729
  error estimate for blocks of size 2^( 3) =       0.000449308947
  error estimate for blocks of size 2^( 4) =       0.000459821588
  error estimate for blocks of size 2^( 5) =       0.000469101822
  error estimate for blocks of size 2^( 6) =       0.000475151686
  error estimate for blocks of size 2^( 7) =       0.000477791310

      target function =                  N/A
              le_mean =     -16.925358274730
             les_mean =     286.829013192729
             stat err =       0.000470466601
             autocorr =       1.225369139604
              std dev =       0.601049619741
             le_variance =       0.361260645391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361401102235
                                         uncertainty =       0.019416111033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361401102235
                                         uncertainty =       0.019416111033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425005475
  error estimate for blocks of size 2^( 2) =       0.000436900959
  error estimate for blocks of size 2^( 3) =       0.000449308190
  error estimate for blocks of size 2^( 4) =       0.000459820836
  error estimate for blocks of size 2^( 5) =       0.000469101070
  error estimate for blocks of size 2^( 6) =       0.000475150964
  error estimate for blocks of size 2^( 7) =       0.000477790591

      target function =                  N/A
              le_mean =     -16.925358268872
             les_mean =     286.829011656776
             stat err =       0.000470465865
             autocorr =       1.225369841784
              std dev =       0.601048506983
             le_variance =       0.361259307747

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361401768636
                                         uncertainty =       0.019416208893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361401768636
                                         uncertainty =       0.019416208893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425005867
  error estimate for blocks of size 2^( 2) =       0.000436901342
  error estimate for blocks of size 2^( 3) =       0.000449308567
  error estimate for blocks of size 2^( 4) =       0.000459821211
  error estimate for blocks of size 2^( 5) =       0.000469101445
  error estimate for blocks of size 2^( 6) =       0.000475151324
  error estimate for blocks of size 2^( 7) =       0.000477790949

      target function =                  N/A
              le_mean =     -16.925358271779
             les_mean =     286.829012421380
             stat err =       0.000470466232
             autocorr =       1.225369492083
              std dev =       0.601049061176
             le_variance =       0.361259973941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361402356251
                                         uncertainty =       0.019416295010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361402356251
                                         uncertainty =       0.019416295010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425006213
  error estimate for blocks of size 2^( 2) =       0.000436901681
  error estimate for blocks of size 2^( 3) =       0.000449308900
  error estimate for blocks of size 2^( 4) =       0.000459821540
  error estimate for blocks of size 2^( 5) =       0.000469101775
  error estimate for blocks of size 2^( 6) =       0.000475151641
  error estimate for blocks of size 2^( 7) =       0.000477791265

      target function =                  N/A
              le_mean =     -16.925358274360
             les_mean =     286.829013096178
             stat err =       0.000470466555
             autocorr =       1.225369183705
              std dev =       0.601049549849
             le_variance =       0.361260561373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925358274730        initial  <--
     5.8208e+01     5.8208e+02             4.6594e-06       -16.925358268872
     2.3283e+02     2.3283e+03             1.1651e-06       -16.925358271779
     9.3132e+02     9.3132e+03             2.9129e-07       -16.925358274360

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5163
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.117842e-01 1 1  ON 0
 uu_1                 1.451871e-01 1 1  ON 1
 uu_2                 4.416854e-02 1 1  ON 2
 uu_3                -1.870104e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825985e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342839e-01 1 1  ON 8
 uu_9                -1.042664e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704393e-01 1 1  ON 11
 ud_2                 5.188577e-02 1 1  ON 12
 ud_3                -1.640314e-02 1 1  ON 13
 ud_4                -6.989258e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280538e-01 1 1  ON 16
 ud_7                -1.398849e-01 1 1  ON 17
 ud_8                -1.383892e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721120e-01 1 1  ON 20
 eO_1                -4.509729e-01 1 1  ON 21
 eO_2                -2.866949e-02 1 1  ON 22
 eO_3                 2.971020e-01 1 1  ON 23
 eO_4                 5.342519e-01 1 1  ON 24
 eO_5                 4.965990e-01 1 1  ON 25
 eO_6                 2.623029e-01 1 1  ON 26
 eO_7                -4.493785e-02 1 1  ON 27
 eO_8                -2.159800e-01 1 1  ON 28
 eO_9                -7.700521e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411495e-02 1 1  ON 32
eH1_3                -3.937754e-02 1 1  ON 33
eH1_4                 4.009037e-03 1 1  ON 34
eH1_5                 3.746065e-02 1 1  ON 35
eH1_6                 9.328300e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695233e-01 1 1  ON 38
eH1_9                 5.754509e-02 1 1  ON 39
eH2_0                -2.322538e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070426e-02 1 1  ON 42
eH2_3                -3.605071e-02 1 1  ON 43
eH2_4                 7.923999e-03 1 1  ON 44
eH2_5                 4.075873e-02 1 1  ON 45
eH2_6                 9.626522e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741171e-01 1 1  ON 48
eH2_9                 4.227425e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5482e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8817
    reference variance = 0.623416
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3960e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339593877864
                                         uncertainty =       0.003743268893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339593877864
                                         uncertainty =       0.003743268893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412067153
  error estimate for blocks of size 2^( 2) =       0.000424125840
  error estimate for blocks of size 2^( 3) =       0.000436157282
  error estimate for blocks of size 2^( 4) =       0.000447455914
  error estimate for blocks of size 2^( 5) =       0.000456578961
  error estimate for blocks of size 2^( 6) =       0.000462516553
  error estimate for blocks of size 2^( 7) =       0.000464615673

      target function =                  N/A
              le_mean =     -16.925385657803
             les_mean =     286.808278172446
             stat err =       0.000457791775
             autocorr =       1.234241025677
              std dev =       0.582750956147
             le_variance =       0.339598676890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692538565780e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925385657803       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925385659330       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925385660605       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925385660833       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925385661190       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925385661804       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925385661215       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925385661301       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 6.211295e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925385657803       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925385658185       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925385658504       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925385658561       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925385658648       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925385658803       residual = 9.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925385658655       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925385658679       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.552833e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925385657803       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925385657898       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925385657978       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925385657992       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925385658017       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925385658055       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925385658021       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925385658022       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.882087e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093209 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6287e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.117843e-01 1 1  ON 0
 uu_1                 1.451872e-01 1 1  ON 1
 uu_2                 4.416857e-02 1 1  ON 2
 uu_3                -1.870102e-02 1 1  ON 3
 uu_4                -6.449592e-02 1 1  ON 4
 uu_5                -9.825986e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391418e-01 1 1  ON 7
 uu_8                -1.342839e-01 1 1  ON 8
 uu_9                -1.042665e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704393e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640317e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280538e-01 1 1  ON 16
 ud_7                -1.398849e-01 1 1  ON 17
 ud_8                -1.383892e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721120e-01 1 1  ON 20
 eO_1                -4.509730e-01 1 1  ON 21
 eO_2                -2.866958e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342520e-01 1 1  ON 24
 eO_5                 4.965991e-01 1 1  ON 25
 eO_6                 2.623031e-01 1 1  ON 26
 eO_7                -4.493780e-02 1 1  ON 27
 eO_8                -2.159800e-01 1 1  ON 28
 eO_9                -7.700528e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411496e-02 1 1  ON 32
eH1_3                -3.937755e-02 1 1  ON 33
eH1_4                 4.009054e-03 1 1  ON 34
eH1_5                 3.746060e-02 1 1  ON 35
eH1_6                 9.328296e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695234e-01 1 1  ON 38
eH1_9                 5.754514e-02 1 1  ON 39
eH2_0                -2.322537e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070428e-02 1 1  ON 42
eH2_3                -3.605068e-02 1 1  ON 43
eH2_4                 7.923970e-03 1 1  ON 44
eH2_5                 4.075866e-02 1 1  ON 45
eH2_6                 9.626520e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741171e-01 1 1  ON 48
eH2_9                 4.227431e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9822
    reference variance = 0.461155
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3432e-01
  Total weights = 2.0000e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346070041
                                         uncertainty =       0.002283013336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346070041
                                         uncertainty =       0.002283013336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408850031
  error estimate for blocks of size 2^( 2) =       0.000421345400
  error estimate for blocks of size 2^( 3) =       0.000434155104
  error estimate for blocks of size 2^( 4) =       0.000446508785
  error estimate for blocks of size 2^( 5) =       0.000455965666
  error estimate for blocks of size 2^( 6) =       0.000464862191
  error estimate for blocks of size 2^( 7) =       0.000468381496

      target function =                  N/A
              le_mean =     -16.924866900653
             les_mean =     286.785436134135
             stat err =       0.000458929534
             autocorr =       1.259980848241
              std dev =       0.578201259485
             le_variance =       0.334316696470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346181652
                                         uncertainty =       0.002283014186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346181652
                                         uncertainty =       0.002283014186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408850100
  error estimate for blocks of size 2^( 2) =       0.000421345466
  error estimate for blocks of size 2^( 3) =       0.000434155165
  error estimate for blocks of size 2^( 4) =       0.000446508843
  error estimate for blocks of size 2^( 5) =       0.000455965718
  error estimate for blocks of size 2^( 6) =       0.000464862239
  error estimate for blocks of size 2^( 7) =       0.000468381537

      target function =                  N/A
              le_mean =     -16.924866901099
             les_mean =     286.785436260746
             stat err =       0.000458929584
             autocorr =       1.259980702166
              std dev =       0.578201355921
             le_variance =       0.334316807989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346125896
                                         uncertainty =       0.002283013761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346125896
                                         uncertainty =       0.002283013761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408850066
  error estimate for blocks of size 2^( 2) =       0.000421345433
  error estimate for blocks of size 2^( 3) =       0.000434155134
  error estimate for blocks of size 2^( 4) =       0.000446508814
  error estimate for blocks of size 2^( 5) =       0.000455965692
  error estimate for blocks of size 2^( 6) =       0.000464862215
  error estimate for blocks of size 2^( 7) =       0.000468381516

      target function =                  N/A
              le_mean =     -16.924866900876
             les_mean =     286.785436197496
             stat err =       0.000458929559
             autocorr =       1.259980775158
              std dev =       0.578201307746
             le_variance =       0.334316752279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346077024
                                         uncertainty =       0.002283013389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334346077024
                                         uncertainty =       0.002283013389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408850036
  error estimate for blocks of size 2^( 2) =       0.000421345404
  error estimate for blocks of size 2^( 3) =       0.000434155108
  error estimate for blocks of size 2^( 4) =       0.000446508788
  error estimate for blocks of size 2^( 5) =       0.000455965669
  error estimate for blocks of size 2^( 6) =       0.000464862194
  error estimate for blocks of size 2^( 7) =       0.000468381499

      target function =                  N/A
              le_mean =     -16.924866900681
             les_mean =     286.785436142057
             stat err =       0.000458929537
             autocorr =       1.259980839111
              std dev =       0.578201265519
             le_variance =       0.334316703448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924866900653        initial
     5.8208e+02     5.8208e+03             6.2113e-07       -16.924866901099  <--
     2.3283e+03     2.3283e+04             1.5528e-07       -16.924866900876
     9.3132e+03     9.3132e+04             3.8821e-08       -16.924866900681

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 2.9629e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009104e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5921e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8934
    reference variance = 0.230861
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355390330613
                                         uncertainty =       0.018077711810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355390330613
                                         uncertainty =       0.018077711810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421535148
  error estimate for blocks of size 2^( 2) =       0.000433740425
  error estimate for blocks of size 2^( 3) =       0.000445734749
  error estimate for blocks of size 2^( 4) =       0.000456211309
  error estimate for blocks of size 2^( 5) =       0.000463698545
  error estimate for blocks of size 2^( 6) =       0.000469336771
  error estimate for blocks of size 2^( 7) =       0.000472698798

      target function =                  N/A
              le_mean =     -16.924194399478
             les_mean =     286.783739655300
             stat err =       0.000465486356
             autocorr =       1.219400381140
              std dev =       0.596140723048
             le_variance =       0.355383761677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692419439948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924194399478       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924194402320       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924194397754       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924194397529       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924194396836       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924194400724       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924194403167       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924194403160       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 2.308950e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924194399478       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924194400189       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924194399044       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924194398988       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924194398814       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924194399786       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924194400398       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924194400396       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 5.772334e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924194399478       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924194399656       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924194399369       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924194399355       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924194399312       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924194399555       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924194399703       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924194399711       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 1.443081e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5862e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.117846e-01 1 1  ON 0
 uu_1                 1.451876e-01 1 1  ON 1
 uu_2                 4.416875e-02 1 1  ON 2
 uu_3                -1.870073e-02 1 1  ON 3
 uu_4                -6.449596e-02 1 1  ON 4
 uu_5                -9.826007e-02 1 1  ON 5
 uu_6                -1.249426e-01 1 1  ON 6
 uu_7                -1.391420e-01 1 1  ON 7
 uu_8                -1.342842e-01 1 1  ON 8
 uu_9                -1.042670e-01 1 1  ON 9
 ud_0                 4.356411e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188546e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989289e-02 1 1  ON 14
 ud_5                -1.062028e-01 1 1  ON 15
 ud_6                -1.280535e-01 1 1  ON 16
 ud_7                -1.398845e-01 1 1  ON 17
 ud_8                -1.383890e-01 1 1  ON 18
 ud_9                -1.310006e-01 1 1  ON 19
 eO_0                -7.721124e-01 1 1  ON 20
 eO_1                -4.509736e-01 1 1  ON 21
 eO_2                -2.866997e-02 1 1  ON 22
 eO_3                 2.971017e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.966000e-01 1 1  ON 25
 eO_6                 2.623041e-01 1 1  ON 26
 eO_7                -4.493740e-02 1 1  ON 27
 eO_8                -2.159805e-01 1 1  ON 28
 eO_9                -7.700579e-02 1 1  ON 29
eH1_0                -2.352127e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411495e-02 1 1  ON 32
eH1_3                -3.937791e-02 1 1  ON 33
eH1_4                 4.009074e-03 1 1  ON 34
eH1_5                 3.746030e-02 1 1  ON 35
eH1_6                 9.328296e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754550e-02 1 1  ON 39
eH2_0                -2.322537e-01 1 1  ON 40
eH2_1                -1.352047e-01 1 1  ON 41
eH2_2                -9.070449e-02 1 1  ON 42
eH2_3                -3.605068e-02 1 1  ON 43
eH2_4                 7.923787e-03 1 1  ON 44
eH2_5                 4.075839e-02 1 1  ON 45
eH2_6                 9.626500e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741175e-01 1 1  ON 48
eH2_9                 4.227473e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.219997
====================================================
  Execution time = 2.0079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4222e-01
  Total weights = 2.0000e+06
  Execution time = 1.8717e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342207985603
                                         uncertainty =       0.004202547941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342207985603
                                         uncertainty =       0.004202547941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413657038
  error estimate for blocks of size 2^( 2) =       0.000425774888
  error estimate for blocks of size 2^( 3) =       0.000437909469
  error estimate for blocks of size 2^( 4) =       0.000449562291
  error estimate for blocks of size 2^( 5) =       0.000458823220
  error estimate for blocks of size 2^( 6) =       0.000467818106
  error estimate for blocks of size 2^( 7) =       0.000472393139

      target function =                  N/A
              le_mean =     -16.925386167322
             les_mean =     286.810921031692
             stat err =       0.000462149189
             autocorr =       1.248198209755
              std dev =       0.584999393006
             le_variance =       0.342224289817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208296080
                                         uncertainty =       0.004202551275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208296080
                                         uncertainty =       0.004202551275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413657225
  error estimate for blocks of size 2^( 2) =       0.000425775059
  error estimate for blocks of size 2^( 3) =       0.000437909624
  error estimate for blocks of size 2^( 4) =       0.000449562429
  error estimate for blocks of size 2^( 5) =       0.000458823359
  error estimate for blocks of size 2^( 6) =       0.000467818229
  error estimate for blocks of size 2^( 7) =       0.000472393261

      target function =                  N/A
              le_mean =     -16.925386156090
             les_mean =     286.810920962012
             stat err =       0.000462149319
             autocorr =       1.248197780973
              std dev =       0.584999658423
             le_variance =       0.342224600355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208141200
                                         uncertainty =       0.004202549609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208141200
                                         uncertainty =       0.004202549609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413657132
  error estimate for blocks of size 2^( 2) =       0.000425774974
  error estimate for blocks of size 2^( 3) =       0.000437909547
  error estimate for blocks of size 2^( 4) =       0.000449562360
  error estimate for blocks of size 2^( 5) =       0.000458823289
  error estimate for blocks of size 2^( 6) =       0.000467818168
  error estimate for blocks of size 2^( 7) =       0.000472393200

      target function =                  N/A
              le_mean =     -16.925386161691
             les_mean =     286.810920996700
             stat err =       0.000462149254
             autocorr =       1.248197994972
              std dev =       0.584999526020
             le_variance =       0.342224445444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208005062
                                         uncertainty =       0.004202548149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342208005062
                                         uncertainty =       0.004202548149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413657050
  error estimate for blocks of size 2^( 2) =       0.000425774899
  error estimate for blocks of size 2^( 3) =       0.000437909479
  error estimate for blocks of size 2^( 4) =       0.000449562300
  error estimate for blocks of size 2^( 5) =       0.000458823229
  error estimate for blocks of size 2^( 6) =       0.000467818114
  error estimate for blocks of size 2^( 7) =       0.000472393147

      target function =                  N/A
              le_mean =     -16.925386166618
             les_mean =     286.810921027305
             stat err =       0.000462149197
             autocorr =       1.248198182899
              std dev =       0.584999409640
             le_variance =       0.342224309280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925386167322        initial  <--
     1.4552e+02     1.4552e+03             2.3089e-06       -16.925386156090
     5.8208e+02     5.8208e+03             5.7723e-07       -16.925386161691
     2.3283e+03     2.3283e+04             1.4431e-07       -16.925386166618

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5750
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009104e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9737
    reference variance = 0.134368
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.2959e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5481e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329664058388
                                         uncertainty =       0.002541080624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329664058388
                                         uncertainty =       0.002541080624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405952025
  error estimate for blocks of size 2^( 2) =       0.000418357799
  error estimate for blocks of size 2^( 3) =       0.000430756222
  error estimate for blocks of size 2^( 4) =       0.000441875953
  error estimate for blocks of size 2^( 5) =       0.000450627802
  error estimate for blocks of size 2^( 6) =       0.000455401684
  error estimate for blocks of size 2^( 7) =       0.000457706125

      target function =                  N/A
              le_mean =     -16.925386120063
             les_mean =     286.798289241487
             stat err =       0.000451402891
             autocorr =       1.236457655911
              std dev =       0.574102859311
             le_variance =       0.329594093069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692538612006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925386120063       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925386120754       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925386120660       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925386121011       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925386121238       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925386121155       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925386121340       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925386121343       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 2.414908e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925386120063       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925386120236       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925386120212       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925386120300       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925386120356       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925386120336       residual = 8.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925386120383       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925386120388       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 6.037276e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925386120063       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925386120106       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925386120100       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925386120128       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925386120138       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925386120127       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925386120139       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925386120133       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.509319e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5896e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416869e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449594e-02 1 1  ON 4
 uu_5                -9.825992e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989260e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866988e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623036e-01 1 1  ON 26
 eO_7                -4.493763e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700551e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009097e-03 1 1  ON 34
eH1_5                 3.746041e-02 1 1  ON 35
eH1_6                 9.328285e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754533e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070434e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923870e-03 1 1  ON 44
eH2_5                 4.075844e-02 1 1  ON 45
eH2_6                 9.626513e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9817
    reference variance = 0.26627
====================================================
  Execution time = 2.2128e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.3732e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354484533
                                         uncertainty =       0.003217358485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354484533
                                         uncertainty =       0.003217358485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410680927
  error estimate for blocks of size 2^( 2) =       0.000423221082
  error estimate for blocks of size 2^( 3) =       0.000435592813
  error estimate for blocks of size 2^( 4) =       0.000446253670
  error estimate for blocks of size 2^( 5) =       0.000455689658
  error estimate for blocks of size 2^( 6) =       0.000462057909
  error estimate for blocks of size 2^( 7) =       0.000466470651

      target function =                  N/A
              le_mean =     -16.925810996492
             les_mean =     286.820395367996
             stat err =       0.000457617972
             autocorr =       1.241643950422
              std dev =       0.580790536845
             le_variance =       0.337317647689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354451881
                                         uncertainty =       0.003217358219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354451881
                                         uncertainty =       0.003217358219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410680907
  error estimate for blocks of size 2^( 2) =       0.000423221063
  error estimate for blocks of size 2^( 3) =       0.000435592795
  error estimate for blocks of size 2^( 4) =       0.000446253653
  error estimate for blocks of size 2^( 5) =       0.000455689640
  error estimate for blocks of size 2^( 6) =       0.000462057891
  error estimate for blocks of size 2^( 7) =       0.000466470632

      target function =                  N/A
              le_mean =     -16.925810995900
             les_mean =     286.820395315269
             stat err =       0.000457617954
             autocorr =       1.241643973693
              std dev =       0.580790508709
             le_variance =       0.337317615006

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354468208
                                         uncertainty =       0.003217358352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354468208
                                         uncertainty =       0.003217358352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410680917
  error estimate for blocks of size 2^( 2) =       0.000423221072
  error estimate for blocks of size 2^( 3) =       0.000435592804
  error estimate for blocks of size 2^( 4) =       0.000446253662
  error estimate for blocks of size 2^( 5) =       0.000455689649
  error estimate for blocks of size 2^( 6) =       0.000462057900
  error estimate for blocks of size 2^( 7) =       0.000466470641

      target function =                  N/A
              le_mean =     -16.925810996196
             les_mean =     286.820395341628
             stat err =       0.000457617963
             autocorr =       1.241643962059
              std dev =       0.580790522778
             le_variance =       0.337317631349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354482492
                                         uncertainty =       0.003217358468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337354482492
                                         uncertainty =       0.003217358468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410680926
  error estimate for blocks of size 2^( 2) =       0.000423221081
  error estimate for blocks of size 2^( 3) =       0.000435592812
  error estimate for blocks of size 2^( 4) =       0.000446253669
  error estimate for blocks of size 2^( 5) =       0.000455689657
  error estimate for blocks of size 2^( 6) =       0.000462057908
  error estimate for blocks of size 2^( 7) =       0.000466470649

      target function =                  N/A
              le_mean =     -16.925810996455
             les_mean =     286.820395364700
             stat err =       0.000457617971
             autocorr =       1.241643951871
              std dev =       0.580790535086
             le_variance =       0.337317645646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925810996492        initial  <--
     1.4552e+03     1.4552e+04             2.4149e-07       -16.925810995900
     5.8208e+03     5.8208e+04             6.0373e-08       -16.925810996196
     2.3283e+04     2.3283e+05             1.5093e-08       -16.925810996455

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6611
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009104e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7563e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.141246
====================================================
  Execution time = 2.0812e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3734e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337459720502
                                         uncertainty =       0.003640580461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337459720502
                                         uncertainty =       0.003640580461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410693027
  error estimate for blocks of size 2^( 2) =       0.000422947994
  error estimate for blocks of size 2^( 3) =       0.000435436466
  error estimate for blocks of size 2^( 4) =       0.000446548366
  error estimate for blocks of size 2^( 5) =       0.000455642839
  error estimate for blocks of size 2^( 6) =       0.000464495117
  error estimate for blocks of size 2^( 7) =       0.000469099227

      target function =                  N/A
              le_mean =     -16.924479148257
             les_mean =     286.775331796216
             stat err =       0.000458946387
             autocorr =       1.248789540414
              std dev =       0.580807648975
             le_variance =       0.337337525107


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692447914826e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924479148257       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924479148311       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924479148346       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924479148361       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924479148356       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924479148378       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924479148367       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924479148360       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.490573e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924479148257       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924479148270       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924479148279       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924479148209       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924479148285       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924479148282       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924479148272       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924479148306       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 6.226434e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924479148257       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924479148260       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924479148262       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924479148262       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924479148338       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924479148264       residual = 7.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924479148457       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924479148531       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.556609e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101136 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6488e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188575e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009103e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328285e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8951
    reference variance = 0.176522
====================================================
  Execution time = 2.2243e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4702e-01
  Total weights = 2.0000e+06
  Execution time = 1.8849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489550
                                         uncertainty =       0.007421718854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489550
                                         uncertainty =       0.007421718854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416543233
  error estimate for blocks of size 2^( 2) =       0.000429199222
  error estimate for blocks of size 2^( 3) =       0.000440881751
  error estimate for blocks of size 2^( 4) =       0.000451643935
  error estimate for blocks of size 2^( 5) =       0.000462361451
  error estimate for blocks of size 2^( 6) =       0.000469858660
  error estimate for blocks of size 2^( 7) =       0.000473614878

      target function =                  N/A
              le_mean =     -16.925766508230
             les_mean =     286.828588247552
             stat err =       0.000464369731
             autocorr =       1.242818302196
              std dev =       0.589081089453
             le_variance =       0.347016529951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785490017
                                         uncertainty =       0.007421718988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785490017
                                         uncertainty =       0.007421718988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416543233
  error estimate for blocks of size 2^( 2) =       0.000429199222
  error estimate for blocks of size 2^( 3) =       0.000440881751
  error estimate for blocks of size 2^( 4) =       0.000451643935
  error estimate for blocks of size 2^( 5) =       0.000462361451
  error estimate for blocks of size 2^( 6) =       0.000469858660
  error estimate for blocks of size 2^( 7) =       0.000473614878

      target function =                  N/A
              le_mean =     -16.925766508185
             les_mean =     286.828588246491
             stat err =       0.000464369731
             autocorr =       1.242818299474
              std dev =       0.589081089846
             le_variance =       0.347016530414

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489783
                                         uncertainty =       0.007421718921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489783
                                         uncertainty =       0.007421718921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416543233
  error estimate for blocks of size 2^( 2) =       0.000429199222
  error estimate for blocks of size 2^( 3) =       0.000440881751
  error estimate for blocks of size 2^( 4) =       0.000451643935
  error estimate for blocks of size 2^( 5) =       0.000462361451
  error estimate for blocks of size 2^( 6) =       0.000469858660
  error estimate for blocks of size 2^( 7) =       0.000473614878

      target function =                  N/A
              le_mean =     -16.925766508207
             les_mean =     286.828588247022
             stat err =       0.000464369731
             autocorr =       1.242818300832
              std dev =       0.589081089649
             le_variance =       0.347016530182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489579
                                         uncertainty =       0.007421718862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346785489579
                                         uncertainty =       0.007421718862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416543233
  error estimate for blocks of size 2^( 2) =       0.000429199222
  error estimate for blocks of size 2^( 3) =       0.000440881751
  error estimate for blocks of size 2^( 4) =       0.000451643935
  error estimate for blocks of size 2^( 5) =       0.000462361451
  error estimate for blocks of size 2^( 6) =       0.000469858660
  error estimate for blocks of size 2^( 7) =       0.000473614878

      target function =                  N/A
              le_mean =     -16.925766508227
             les_mean =     286.828588247486
             stat err =       0.000464369731
             autocorr =       1.242818302028
              std dev =       0.589081089477
             le_variance =       0.347016529980


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925766508230        initial  <--
     1.4552e+04     1.4552e+05             2.4906e-08       -16.925766508185
     5.8208e+04     5.8208e+05             6.2264e-09       -16.925766508207
     2.3283e+05     2.3283e+06             1.5566e-09       -16.925766508227

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7927
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009104e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227448e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9883
    reference variance = 0.246243
====================================================
  Execution time = 2.0555e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4130e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341367327721
                                         uncertainty =       0.005139717997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341367327721
                                         uncertainty =       0.005139717997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413096950
  error estimate for blocks of size 2^( 2) =       0.000425431504
  error estimate for blocks of size 2^( 3) =       0.000438002121
  error estimate for blocks of size 2^( 4) =       0.000449651619
  error estimate for blocks of size 2^( 5) =       0.000459419143
  error estimate for blocks of size 2^( 6) =       0.000466197893
  error estimate for blocks of size 2^( 7) =       0.000472436386

      target function =                  N/A
              le_mean =     -16.925400001292
             les_mean =     286.810463212818
             stat err =       0.000461926260
             autocorr =       1.250378012696
              std dev =       0.584207308865
             le_variance =       0.341298179732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692540000129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925400001292       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925400001294       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925400001298       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925400001296       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925400001451       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925400001301       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925400001290       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925400001282       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.566472e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925400001292       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925400001293       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925400001293       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925400001562       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925400001560       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925400001468       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925400001266       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925400001106       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 6.416183e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925400001292       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925400001292       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925400001292       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925400001292       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925400001324       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925399999190       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925400003240       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925399998902       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.604044e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103734 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6115e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009104e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0049
    reference variance = 0.364236
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3738e-01
  Total weights = 2.0000e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868910
                                         uncertainty =       0.004310966571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868910
                                         uncertainty =       0.004310966571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410718422
  error estimate for blocks of size 2^( 2) =       0.000422903417
  error estimate for blocks of size 2^( 3) =       0.000434626344
  error estimate for blocks of size 2^( 4) =       0.000445209876
  error estimate for blocks of size 2^( 5) =       0.000455051039
  error estimate for blocks of size 2^( 6) =       0.000462260740
  error estimate for blocks of size 2^( 7) =       0.000465657516

      target function =                  N/A
              le_mean =     -16.925301339990
             les_mean =     286.803204525823
             stat err =       0.000457044793
             autocorr =       1.238309384284
              std dev =       0.580843563328
             le_variance =       0.337379245060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868083
                                         uncertainty =       0.004310966569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868083
                                         uncertainty =       0.004310966569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410718422
  error estimate for blocks of size 2^( 2) =       0.000422903417
  error estimate for blocks of size 2^( 3) =       0.000434626344
  error estimate for blocks of size 2^( 4) =       0.000445209875
  error estimate for blocks of size 2^( 5) =       0.000455051039
  error estimate for blocks of size 2^( 6) =       0.000462260740
  error estimate for blocks of size 2^( 7) =       0.000465657515

      target function =                  N/A
              le_mean =     -16.925301339995
             les_mean =     286.803204525164
             stat err =       0.000457044792
             autocorr =       1.238309384678
              std dev =       0.580843562617
             le_variance =       0.337379244234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868497
                                         uncertainty =       0.004310966570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868497
                                         uncertainty =       0.004310966570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410718422
  error estimate for blocks of size 2^( 2) =       0.000422903417
  error estimate for blocks of size 2^( 3) =       0.000434626344
  error estimate for blocks of size 2^( 4) =       0.000445209876
  error estimate for blocks of size 2^( 5) =       0.000455051039
  error estimate for blocks of size 2^( 6) =       0.000462260740
  error estimate for blocks of size 2^( 7) =       0.000465657516

      target function =                  N/A
              le_mean =     -16.925301339992
             les_mean =     286.803204525494
             stat err =       0.000457044793
             autocorr =       1.238309384477
              std dev =       0.580843562973
             le_variance =       0.337379244647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868858
                                         uncertainty =       0.004310966571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337434868858
                                         uncertainty =       0.004310966571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410718422
  error estimate for blocks of size 2^( 2) =       0.000422903417
  error estimate for blocks of size 2^( 3) =       0.000434626344
  error estimate for blocks of size 2^( 4) =       0.000445209876
  error estimate for blocks of size 2^( 5) =       0.000455051039
  error estimate for blocks of size 2^( 6) =       0.000462260740
  error estimate for blocks of size 2^( 7) =       0.000465657516

      target function =                  N/A
              le_mean =     -16.925301339990
             les_mean =     286.803204525782
             stat err =       0.000457044793
             autocorr =       1.238309384310
              std dev =       0.580843563284
             le_variance =       0.337379245008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.925301339990        initial
     1.4552e+05     1.4552e+06             2.5665e-09       -16.925301339995  <--
     5.8208e+05     5.8208e+06             6.4162e-10       -16.925301339992
     2.3283e+06     2.3283e+07             1.6040e-10       -16.925301339990

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.9657e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188576e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009103e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923884e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9809
    reference variance = 0.372198
====================================================
  Execution time = 2.0595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.5386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354029520138
                                         uncertainty =       0.017525342186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354029520138
                                         uncertainty =       0.017525342186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420633026
  error estimate for blocks of size 2^( 2) =       0.000433093459
  error estimate for blocks of size 2^( 3) =       0.000445866418
  error estimate for blocks of size 2^( 4) =       0.000457582038
  error estimate for blocks of size 2^( 5) =       0.000467806764
  error estimate for blocks of size 2^( 6) =       0.000475282688
  error estimate for blocks of size 2^( 7) =       0.000476819750

      target function =                  N/A
              le_mean =     -16.924487513288
             les_mean =     286.792141695804
             stat err =       0.000469372810
             autocorr =       1.245171348899
              std dev =       0.594864930305
             le_variance =       0.353864285307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692448751329e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924487513288       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924487513323       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924487513317       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924487513329       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924487513326       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924487513376       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924487513369       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924487513326       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 8.662237e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924487513288       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924487513297       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924487513295       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924487513299       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924487513317       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924487513250       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924487513255       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924487513291       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.165560e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924487513288       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924487513290       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924487513290       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924487513680       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924487513271       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924487513678       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924487513384       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924487513388       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 5.413905e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6176e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188575e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989259e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009103e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328286e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754531e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605060e-02 1 1  ON 43
eH2_4                 7.923883e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626515e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8731
    reference variance = 0.154874
====================================================
  Execution time = 2.0165e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3682e-01
  Total weights = 2.0000e+06
  Execution time = 1.8796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846622713
                                         uncertainty =       0.003429307382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846622713
                                         uncertainty =       0.003429307382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410377820
  error estimate for blocks of size 2^( 2) =       0.000422721980
  error estimate for blocks of size 2^( 3) =       0.000435294933
  error estimate for blocks of size 2^( 4) =       0.000446284917
  error estimate for blocks of size 2^( 5) =       0.000456105090
  error estimate for blocks of size 2^( 6) =       0.000463706717
  error estimate for blocks of size 2^( 7) =       0.000469672398

      target function =                  N/A
              le_mean =     -16.924327130568
             les_mean =     286.769668564453
             stat err =       0.000458942281
             autocorr =       1.250686259811
              std dev =       0.580361878806
             le_variance =       0.336819910371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846624280
                                         uncertainty =       0.003429307398

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846624280
                                         uncertainty =       0.003429307398

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410377821
  error estimate for blocks of size 2^( 2) =       0.000422721981
  error estimate for blocks of size 2^( 3) =       0.000435294934
  error estimate for blocks of size 2^( 4) =       0.000446284918
  error estimate for blocks of size 2^( 5) =       0.000456105091
  error estimate for blocks of size 2^( 6) =       0.000463706718
  error estimate for blocks of size 2^( 7) =       0.000469672399

      target function =                  N/A
              le_mean =     -16.924327130571
             les_mean =     286.769668566106
             stat err =       0.000458942281
             autocorr =       1.250686258225
              std dev =       0.580361880157
             le_variance =       0.336819911939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846623497
                                         uncertainty =       0.003429307390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846623497
                                         uncertainty =       0.003429307390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410377821
  error estimate for blocks of size 2^( 2) =       0.000422721980
  error estimate for blocks of size 2^( 3) =       0.000435294933
  error estimate for blocks of size 2^( 4) =       0.000446284918
  error estimate for blocks of size 2^( 5) =       0.000456105091
  error estimate for blocks of size 2^( 6) =       0.000463706717
  error estimate for blocks of size 2^( 7) =       0.000469672398

      target function =                  N/A
              le_mean =     -16.924327130570
             les_mean =     286.769668565279
             stat err =       0.000458942281
             autocorr =       1.250686259014
              std dev =       0.580361879482
             le_variance =       0.336819911155

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846622811
                                         uncertainty =       0.003429307383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846622811
                                         uncertainty =       0.003429307383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410377820
  error estimate for blocks of size 2^( 2) =       0.000422721980
  error estimate for blocks of size 2^( 3) =       0.000435294933
  error estimate for blocks of size 2^( 4) =       0.000446284917
  error estimate for blocks of size 2^( 5) =       0.000456105090
  error estimate for blocks of size 2^( 6) =       0.000463706717
  error estimate for blocks of size 2^( 7) =       0.000469672398

      target function =                  N/A
              le_mean =     -16.924327130568
             les_mean =     286.769668564556
             stat err =       0.000458942281
             autocorr =       1.250686259713
              std dev =       0.580361878891
             le_variance =       0.336819910469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924327130568        initial
     3.6380e+04     3.6380e+05             8.6622e-09       -16.924327130571  <--
     1.4552e+05     1.4552e+06             2.1656e-09       -16.924327130570
     5.8208e+05     5.8208e+06             5.4139e-10       -16.924327130568

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 2.9660e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870093e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825990e-02 1 1  ON 5
 uu_6                -1.249423e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704391e-01 1 1  ON 11
 ud_2                 5.188575e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989260e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310008e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493764e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700549e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009103e-03 1 1  ON 34
eH1_5                 3.746043e-02 1 1  ON 35
eH1_6                 9.328285e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754532e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605061e-02 1 1  ON 43
eH2_4                 7.923879e-03 1 1  ON 44
eH2_5                 4.075845e-02 1 1  ON 45
eH2_6                 9.626514e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227449e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8794
    reference variance = 0.469239
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.4258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342636168537
                                         uncertainty =       0.003816943534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342636168537
                                         uncertainty =       0.003816943534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413870653
  error estimate for blocks of size 2^( 2) =       0.000426141486
  error estimate for blocks of size 2^( 3) =       0.000438686177
  error estimate for blocks of size 2^( 4) =       0.000450200125
  error estimate for blocks of size 2^( 5) =       0.000461149354
  error estimate for blocks of size 2^( 6) =       0.000468737346
  error estimate for blocks of size 2^( 7) =       0.000473918570

      target function =                  N/A
              le_mean =     -16.924096673769
             les_mean =     286.767625886847
             stat err =       0.000463501349
             autocorr =       1.254217162842
              std dev =       0.585301490750
             le_variance =       0.342577835074


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692409667377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924096673769       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924096673879       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924096673919       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924096673964       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924096673959       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924096674049       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924096674063       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924096674062       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.691126e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924096673769       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924096673796       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924096673806       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924096673818       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924096673831       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924096673874       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924096673842       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924096673838       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 9.227824e-09

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924096673769       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924096673775       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924096673778       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924096673781       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924096673809       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924096673759       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924096673838       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924096673805       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.306957e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6129e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449595e-02 1 1  ON 4
 uu_5                -9.825991e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188575e-02 1 1  ON 12
 ud_3                -1.640325e-02 1 1  ON 13
 ud_4                -6.989260e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509732e-01 1 1  ON 21
 eO_2                -2.866984e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623035e-01 1 1  ON 26
 eO_7                -4.493763e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700550e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411498e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009105e-03 1 1  ON 34
eH1_5                 3.746042e-02 1 1  ON 35
eH1_6                 9.328285e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695235e-01 1 1  ON 38
eH1_9                 5.754532e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605061e-02 1 1  ON 43
eH2_4                 7.923877e-03 1 1  ON 44
eH2_5                 4.075844e-02 1 1  ON 45
eH2_6                 9.626514e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227450e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8633
    reference variance = 0.199626
====================================================
  Execution time = 2.0264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4445e-01
  Total weights = 2.0000e+06
  Execution time = 1.8873e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556185133
                                         uncertainty =       0.006124306296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556185133
                                         uncertainty =       0.006124306296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414999566
  error estimate for blocks of size 2^( 2) =       0.000427600631
  error estimate for blocks of size 2^( 3) =       0.000440703872
  error estimate for blocks of size 2^( 4) =       0.000451812455
  error estimate for blocks of size 2^( 5) =       0.000460885775
  error estimate for blocks of size 2^( 6) =       0.000468464414
  error estimate for blocks of size 2^( 7) =       0.000471753534

      target function =                  N/A
              le_mean =     -16.924637129908
             les_mean =     286.787791086310
             stat err =       0.000463229045
             autocorr =       1.245937562912
              std dev =       0.586898014555
             le_variance =       0.344449279489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556214562
                                         uncertainty =       0.006124307291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556214562
                                         uncertainty =       0.006124307291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414999584
  error estimate for blocks of size 2^( 2) =       0.000427600648
  error estimate for blocks of size 2^( 3) =       0.000440703888
  error estimate for blocks of size 2^( 4) =       0.000451812471
  error estimate for blocks of size 2^( 5) =       0.000460885790
  error estimate for blocks of size 2^( 6) =       0.000468464429
  error estimate for blocks of size 2^( 7) =       0.000471753548

      target function =                  N/A
              le_mean =     -16.924637130082
             les_mean =     286.787791121637
             stat err =       0.000463229060
             autocorr =       1.245937536349
              std dev =       0.586898039625
             le_variance =       0.344449308916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556199848
                                         uncertainty =       0.006124306793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556199848
                                         uncertainty =       0.006124306793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414999575
  error estimate for blocks of size 2^( 2) =       0.000427600639
  error estimate for blocks of size 2^( 3) =       0.000440703880
  error estimate for blocks of size 2^( 4) =       0.000451812463
  error estimate for blocks of size 2^( 5) =       0.000460885783
  error estimate for blocks of size 2^( 6) =       0.000468464422
  error estimate for blocks of size 2^( 7) =       0.000471753541

      target function =                  N/A
              le_mean =     -16.924637129995
             les_mean =     286.787791103975
             stat err =       0.000463229052
             autocorr =       1.245937549630
              std dev =       0.586898027091
             le_variance =       0.344449294203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556186972
                                         uncertainty =       0.006124306358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344556186972
                                         uncertainty =       0.006124306358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414999567
  error estimate for blocks of size 2^( 2) =       0.000427600632
  error estimate for blocks of size 2^( 3) =       0.000440703873
  error estimate for blocks of size 2^( 4) =       0.000451812456
  error estimate for blocks of size 2^( 5) =       0.000460885776
  error estimate for blocks of size 2^( 6) =       0.000468464415
  error estimate for blocks of size 2^( 7) =       0.000471753535

      target function =                  N/A
              le_mean =     -16.924637129918
             les_mean =     286.787791088518
             stat err =       0.000463229046
             autocorr =       1.245937561253
              std dev =       0.586898016122
             le_variance =       0.344449281328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924637129908        initial
     9.0949e+03     9.0949e+04             3.6911e-08       -16.924637130082  <--
     3.6380e+04     3.6380e+05             9.2278e-09       -16.924637129995
     1.4552e+05     1.4552e+06             2.3070e-09       -16.924637129918

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 2.9807e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416868e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449594e-02 1 1  ON 4
 uu_5                -9.825991e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188574e-02 1 1  ON 12
 ud_3                -1.640326e-02 1 1  ON 13
 ud_4                -6.989262e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509733e-01 1 1  ON 21
 eO_2                -2.866985e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623036e-01 1 1  ON 26
 eO_7                -4.493762e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700551e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411499e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009113e-03 1 1  ON 34
eH1_5                 3.746039e-02 1 1  ON 35
eH1_6                 9.328284e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754534e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605062e-02 1 1  ON 43
eH2_4                 7.923869e-03 1 1  ON 44
eH2_5                 4.075843e-02 1 1  ON 45
eH2_6                 9.626513e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227452e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5941e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9789
    reference variance = 0.227061
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343420631270
                                         uncertainty =       0.004729167842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343420631270
                                         uncertainty =       0.004729167842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414394766
  error estimate for blocks of size 2^( 2) =       0.000426724577
  error estimate for blocks of size 2^( 3) =       0.000439218007
  error estimate for blocks of size 2^( 4) =       0.000450337545
  error estimate for blocks of size 2^( 5) =       0.000458324593
  error estimate for blocks of size 2^( 6) =       0.000464573101
  error estimate for blocks of size 2^( 7) =       0.000466144013

      target function =                  N/A
              le_mean =     -16.924665200760
             les_mean =     286.787738029600
             stat err =       0.000459844813
             autocorr =       1.231385576043
              std dev =       0.586042697690
             le_variance =       0.343446043515


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692466520076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924665200760       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924665200919       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924665200856       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924665200550       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924665200719       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924665200739       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924665200814       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924665200833       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.455214e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924665200760       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924665200799       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924665200784       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924665200707       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924665200753       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924665200758       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924665200768       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924665200776       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.638050e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.924665200760       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.924665200770       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.924665200766       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.924665200747       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.924665200758       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.924665200772       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.924665200763       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.924665200733       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 9.095134e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6077e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416870e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449594e-02 1 1  ON 4
 uu_5                -9.825993e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042668e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188573e-02 1 1  ON 12
 ud_3                -1.640327e-02 1 1  ON 13
 ud_4                -6.989263e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721122e-01 1 1  ON 20
 eO_1                -4.509733e-01 1 1  ON 21
 eO_2                -2.866987e-02 1 1  ON 22
 eO_3                 2.971019e-01 1 1  ON 23
 eO_4                 5.342522e-01 1 1  ON 24
 eO_5                 4.965995e-01 1 1  ON 25
 eO_6                 2.623036e-01 1 1  ON 26
 eO_7                -4.493760e-02 1 1  ON 27
 eO_8                -2.159803e-01 1 1  ON 28
 eO_9                -7.700553e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411499e-02 1 1  ON 32
eH1_3                -3.937762e-02 1 1  ON 33
eH1_4                 4.009121e-03 1 1  ON 34
eH1_5                 3.746039e-02 1 1  ON 35
eH1_6                 9.328283e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754535e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605062e-02 1 1  ON 43
eH2_4                 7.923858e-03 1 1  ON 44
eH2_5                 4.075842e-02 1 1  ON 45
eH2_6                 9.626512e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741173e-01 1 1  ON 48
eH2_9                 4.227453e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0209
    reference variance = 0.526955
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3794e-01
  Total weights = 2.0000e+06
  Execution time = 1.8846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982702309
                                         uncertainty =       0.006246864900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982702309
                                         uncertainty =       0.006246864900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411059902
  error estimate for blocks of size 2^( 2) =       0.000423096583
  error estimate for blocks of size 2^( 3) =       0.000435953766
  error estimate for blocks of size 2^( 4) =       0.000447438791
  error estimate for blocks of size 2^( 5) =       0.000457100124
  error estimate for blocks of size 2^( 6) =       0.000464887501
  error estimate for blocks of size 2^( 7) =       0.000471134683

      target function =                  N/A
              le_mean =     -16.924562619717
             les_mean =     286.778760186413
             stat err =       0.000460140275
             autocorr =       1.253055380528
              std dev =       0.581326488865
             le_variance =       0.337940486656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982693501
                                         uncertainty =       0.006246865070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982693501
                                         uncertainty =       0.006246865070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411059897
  error estimate for blocks of size 2^( 2) =       0.000423096577
  error estimate for blocks of size 2^( 3) =       0.000435953760
  error estimate for blocks of size 2^( 4) =       0.000447438786
  error estimate for blocks of size 2^( 5) =       0.000457100119
  error estimate for blocks of size 2^( 6) =       0.000464887494
  error estimate for blocks of size 2^( 7) =       0.000471134676

      target function =                  N/A
              le_mean =     -16.924562620347
             les_mean =     286.778760198949
             stat err =       0.000460140269
             autocorr =       1.253055379643
              std dev =       0.581326481313
             le_variance =       0.337940477875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982697905
                                         uncertainty =       0.006246864985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982697905
                                         uncertainty =       0.006246864985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411059900
  error estimate for blocks of size 2^( 2) =       0.000423096580
  error estimate for blocks of size 2^( 3) =       0.000435953763
  error estimate for blocks of size 2^( 4) =       0.000447438789
  error estimate for blocks of size 2^( 5) =       0.000457100122
  error estimate for blocks of size 2^( 6) =       0.000464887497
  error estimate for blocks of size 2^( 7) =       0.000471134680

      target function =                  N/A
              le_mean =     -16.924562620032
             les_mean =     286.778760192682
             stat err =       0.000460140272
             autocorr =       1.253055380081
              std dev =       0.581326485089
             le_variance =       0.337940482266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982701759
                                         uncertainty =       0.006246864911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337982701759
                                         uncertainty =       0.006246864911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411059902
  error estimate for blocks of size 2^( 2) =       0.000423096582
  error estimate for blocks of size 2^( 3) =       0.000435953765
  error estimate for blocks of size 2^( 4) =       0.000447438791
  error estimate for blocks of size 2^( 5) =       0.000457100124
  error estimate for blocks of size 2^( 6) =       0.000464887500
  error estimate for blocks of size 2^( 7) =       0.000471134683

      target function =                  N/A
              le_mean =     -16.924562619757
             les_mean =     286.778760187197
             stat err =       0.000460140274
             autocorr =       1.253055380471
              std dev =       0.581326488393
             le_variance =       0.337940486108


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924562619717        initial
     2.2737e+03     2.2737e+04             1.4552e-07       -16.924562620347  <--
     9.0949e+03     9.0949e+04             3.6380e-08       -16.924562620032
     3.6380e+04     3.6380e+05             9.0951e-09       -16.924562619757

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.9930e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416874e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825997e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042669e-01 1 1  ON 9
 ud_0                 4.356412e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188572e-02 1 1  ON 12
 ud_3                -1.640327e-02 1 1  ON 13
 ud_4                -6.989267e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721123e-01 1 1  ON 20
 eO_1                -4.509733e-01 1 1  ON 21
 eO_2                -2.866991e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.965996e-01 1 1  ON 25
 eO_6                 2.623037e-01 1 1  ON 26
 eO_7                -4.493755e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700558e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411500e-02 1 1  ON 32
eH1_3                -3.937763e-02 1 1  ON 33
eH1_4                 4.009144e-03 1 1  ON 34
eH1_5                 3.746037e-02 1 1  ON 35
eH1_6                 9.328282e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754539e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605062e-02 1 1  ON 43
eH2_4                 7.923827e-03 1 1  ON 44
eH2_5                 4.075841e-02 1 1  ON 45
eH2_6                 9.626509e-02 1 1  ON 46
eH2_7                 1.506004e-01 1 1  ON 47
eH2_8                 1.741174e-01 1 1  ON 48
eH2_9                 4.227459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.185801
====================================================
  Execution time = 2.2430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6926e+01
  VMC Evar = 3.4063e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700457404
                                         uncertainty =       0.004293512952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340700457404
                                         uncertainty =       0.004293512952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412691572
  error estimate for blocks of size 2^( 2) =       0.000424839922
  error estimate for blocks of size 2^( 3) =       0.000436869810
  error estimate for blocks of size 2^( 4) =       0.000447208054
  error estimate for blocks of size 2^( 5) =       0.000455805654
  error estimate for blocks of size 2^( 6) =       0.000461380972
  error estimate for blocks of size 2^( 7) =       0.000463792159

      target function =                  N/A
              le_mean =     -16.926022908368
             les_mean =     286.830879991612
             stat err =       0.000457046710
             autocorr =       1.226506838763
              std dev =       0.583634018316
             le_variance =       0.340628667335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692602290837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.926022908368       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.926022909696       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.926022910769       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.926022911144       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.926022911859       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.926022911688       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.926022911893       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.926022911664       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 5.968223e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.926022908368       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.926022908700       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.926022908969       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.926022909062       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.926022909240       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.926022909197       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.926022909249       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.926022909193       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.492077e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.926022908368       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.926022908451       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.926022908518       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.926022908541       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.926022908579       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.926022908571       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.926022908585       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.926022908579       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 3.730205e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114335 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7977e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451875e-01 1 1  ON 1
 uu_2                 4.416875e-02 1 1  ON 2
 uu_3                -1.870092e-02 1 1  ON 3
 uu_4                -6.449588e-02 1 1  ON 4
 uu_5                -9.825994e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042669e-01 1 1  ON 9
 ud_0                 4.356413e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188568e-02 1 1  ON 12
 ud_3                -1.640331e-02 1 1  ON 13
 ud_4                -6.989269e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383890e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721124e-01 1 1  ON 20
 eO_1                -4.509734e-01 1 1  ON 21
 eO_2                -2.866998e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.965997e-01 1 1  ON 25
 eO_6                 2.623039e-01 1 1  ON 26
 eO_7                -4.493750e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700565e-02 1 1  ON 29
eH1_0                -2.352127e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411499e-02 1 1  ON 32
eH1_3                -3.937761e-02 1 1  ON 33
eH1_4                 4.009129e-03 1 1  ON 34
eH1_5                 3.746035e-02 1 1  ON 35
eH1_6                 9.328282e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754544e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070434e-02 1 1  ON 42
eH2_3                -3.605067e-02 1 1  ON 43
eH2_4                 7.923818e-03 1 1  ON 44
eH2_5                 4.075836e-02 1 1  ON 45
eH2_6                 9.626500e-02 1 1  ON 46
eH2_7                 1.506005e-01 1 1  ON 47
eH2_8                 1.741174e-01 1 1  ON 48
eH2_9                 4.227468e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.262974
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6924e+01
  VMC Evar = 3.3530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375065800
                                         uncertainty =       0.003332196293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375065800
                                         uncertainty =       0.003332196293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409451409
  error estimate for blocks of size 2^( 2) =       0.000421760883
  error estimate for blocks of size 2^( 3) =       0.000434451616
  error estimate for blocks of size 2^( 4) =       0.000445507435
  error estimate for blocks of size 2^( 5) =       0.000456208453
  error estimate for blocks of size 2^( 6) =       0.000467002485
  error estimate for blocks of size 2^( 7) =       0.000471635152

      target function =                  N/A
              le_mean =     -16.923674526432
             les_mean =     286.746060222072
             stat err =       0.000460088381
             autocorr =       1.262634907064
              std dev =       0.579051736137
             le_variance =       0.335300913123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375310116
                                         uncertainty =       0.003332200110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375310116
                                         uncertainty =       0.003332200110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409451558
  error estimate for blocks of size 2^( 2) =       0.000421761023
  error estimate for blocks of size 2^( 3) =       0.000434451749
  error estimate for blocks of size 2^( 4) =       0.000445507555
  error estimate for blocks of size 2^( 5) =       0.000456208567
  error estimate for blocks of size 2^( 6) =       0.000467002597
  error estimate for blocks of size 2^( 7) =       0.000471635257

      target function =                  N/A
              le_mean =     -16.923674525303
             les_mean =     286.746060428201
             stat err =       0.000460088494
             autocorr =       1.262634604499
              std dev =       0.579051947109
             le_variance =       0.335301157451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375188030
                                         uncertainty =       0.003332198202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375188030
                                         uncertainty =       0.003332198202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409451484
  error estimate for blocks of size 2^( 2) =       0.000421760953
  error estimate for blocks of size 2^( 3) =       0.000434451682
  error estimate for blocks of size 2^( 4) =       0.000445507495
  error estimate for blocks of size 2^( 5) =       0.000456208510
  error estimate for blocks of size 2^( 6) =       0.000467002541
  error estimate for blocks of size 2^( 7) =       0.000471635205

      target function =                  N/A
              le_mean =     -16.923674525867
             les_mean =     286.746060325194
             stat err =       0.000460088438
             autocorr =       1.262634755707
              std dev =       0.579051841685
             le_variance =       0.335301035359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375081081
                                         uncertainty =       0.003332196532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335375081081
                                         uncertainty =       0.003332196532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409451419
  error estimate for blocks of size 2^( 2) =       0.000421760892
  error estimate for blocks of size 2^( 3) =       0.000434451624
  error estimate for blocks of size 2^( 4) =       0.000445507442
  error estimate for blocks of size 2^( 5) =       0.000456208460
  error estimate for blocks of size 2^( 6) =       0.000467002492
  error estimate for blocks of size 2^( 7) =       0.000471635159

      target function =                  N/A
              le_mean =     -16.923674526361
             les_mean =     286.746060234964
             stat err =       0.000460088388
             autocorr =       1.262634888141
              std dev =       0.579051749332
             le_variance =       0.335300928404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.923674526432        initial  <--
     5.6843e+02     5.6843e+03             5.9682e-07       -16.923674525303
     2.2737e+03     2.2737e+04             1.4921e-07       -16.923674525867
     9.0949e+03     9.0949e+04             3.7302e-08       -16.923674526361

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1748
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416874e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825997e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042669e-01 1 1  ON 9
 ud_0                 4.356412e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188572e-02 1 1  ON 12
 ud_3                -1.640327e-02 1 1  ON 13
 ud_4                -6.989267e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721123e-01 1 1  ON 20
 eO_1                -4.509733e-01 1 1  ON 21
 eO_2                -2.866991e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.965996e-01 1 1  ON 25
 eO_6                 2.623037e-01 1 1  ON 26
 eO_7                -4.493755e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700558e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411500e-02 1 1  ON 32
eH1_3                -3.937763e-02 1 1  ON 33
eH1_4                 4.009144e-03 1 1  ON 34
eH1_5                 3.746037e-02 1 1  ON 35
eH1_6                 9.328282e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754539e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605062e-02 1 1  ON 43
eH2_4                 7.923827e-03 1 1  ON 44
eH2_5                 4.075841e-02 1 1  ON 45
eH2_6                 9.626509e-02 1 1  ON 46
eH2_7                 1.506004e-01 1 1  ON 47
eH2_8                 1.741174e-01 1 1  ON 48
eH2_9                 4.227459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.159261
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.3832e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338337592804
                                         uncertainty =       0.003845167172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338337592804
                                         uncertainty =       0.003845167172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411291869
  error estimate for blocks of size 2^( 2) =       0.000423736195
  error estimate for blocks of size 2^( 3) =       0.000435630280
  error estimate for blocks of size 2^( 4) =       0.000446697187
  error estimate for blocks of size 2^( 5) =       0.000456331947
  error estimate for blocks of size 2^( 6) =       0.000464859174
  error estimate for blocks of size 2^( 7) =       0.000467754122

      target function =                  N/A
              le_mean =     -16.925340707692
             les_mean =     286.805479906032
             stat err =       0.000458910607
             autocorr =       1.244961565141
              std dev =       0.581654539859
             le_variance =       0.338322003739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.692534070769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925340707692       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925340707816       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925340707905       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925340707921       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925340707892       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925340707897       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925340707949       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925340707951       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 6.377722e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925340707692       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925340707723       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925340707745       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925340707754       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925340707742       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925340707744       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925340707757       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925340707749       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.594435e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.925340707692       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.925340707700       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.925340707705       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.925340707706       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.925340707702       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.925340707647       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.925340707746       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.925340707704       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 3.986090e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5975e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416875e-02 1 1  ON 2
 uu_3                -1.870094e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825997e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042669e-01 1 1  ON 9
 ud_0                 4.356412e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188572e-02 1 1  ON 12
 ud_3                -1.640328e-02 1 1  ON 13
 ud_4                -6.989267e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383891e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721123e-01 1 1  ON 20
 eO_1                -4.509733e-01 1 1  ON 21
 eO_2                -2.866991e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.965996e-01 1 1  ON 25
 eO_6                 2.623037e-01 1 1  ON 26
 eO_7                -4.493754e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700559e-02 1 1  ON 29
eH1_0                -2.352126e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411500e-02 1 1  ON 32
eH1_3                -3.937763e-02 1 1  ON 33
eH1_4                 4.009148e-03 1 1  ON 34
eH1_5                 3.746037e-02 1 1  ON 35
eH1_6                 9.328281e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754539e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070433e-02 1 1  ON 42
eH2_3                -3.605063e-02 1 1  ON 43
eH2_4                 7.923826e-03 1 1  ON 44
eH2_5                 4.075841e-02 1 1  ON 45
eH2_6                 9.626508e-02 1 1  ON 46
eH2_7                 1.506004e-01 1 1  ON 47
eH2_8                 1.741174e-01 1 1  ON 48
eH2_9                 4.227459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.041
    reference variance = 0.337353
====================================================
  Execution time = 2.0450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6925e+01
  VMC Evar = 3.4108e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180461454
                                         uncertainty =       0.007310282756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180461454
                                         uncertainty =       0.007310282756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966610
  error estimate for blocks of size 2^( 2) =       0.000425161941
  error estimate for blocks of size 2^( 3) =       0.000437957658
  error estimate for blocks of size 2^( 4) =       0.000448223403
  error estimate for blocks of size 2^( 5) =       0.000456954274
  error estimate for blocks of size 2^( 6) =       0.000462399118
  error estimate for blocks of size 2^( 7) =       0.000466607718

      target function =                  N/A
              le_mean =     -16.924756501955
             les_mean =     286.788465322093
             stat err =       0.000458546128
             autocorr =       1.232923652459
              std dev =       0.584022980844
             le_variance =       0.341082842154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180462626
                                         uncertainty =       0.007310282609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180462626
                                         uncertainty =       0.007310282609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966611
  error estimate for blocks of size 2^( 2) =       0.000425161941
  error estimate for blocks of size 2^( 3) =       0.000437957658
  error estimate for blocks of size 2^( 4) =       0.000448223403
  error estimate for blocks of size 2^( 5) =       0.000456954274
  error estimate for blocks of size 2^( 6) =       0.000462399118
  error estimate for blocks of size 2^( 7) =       0.000466607719

      target function =                  N/A
              le_mean =     -16.924756502003
             les_mean =     286.788465324884
             stat err =       0.000458546129
             autocorr =       1.232923650330
              std dev =       0.584022981848
             le_variance =       0.341082843326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180462040
                                         uncertainty =       0.007310282683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180462040
                                         uncertainty =       0.007310282683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966610
  error estimate for blocks of size 2^( 2) =       0.000425161941
  error estimate for blocks of size 2^( 3) =       0.000437957658
  error estimate for blocks of size 2^( 4) =       0.000448223403
  error estimate for blocks of size 2^( 5) =       0.000456954274
  error estimate for blocks of size 2^( 6) =       0.000462399118
  error estimate for blocks of size 2^( 7) =       0.000466607718

      target function =                  N/A
              le_mean =     -16.924756501979
             les_mean =     286.788465323489
             stat err =       0.000458546128
             autocorr =       1.232923651391
              std dev =       0.584022981346
             le_variance =       0.341082842740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180461527
                                         uncertainty =       0.007310282747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341180461527
                                         uncertainty =       0.007310282747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412966610
  error estimate for blocks of size 2^( 2) =       0.000425161941
  error estimate for blocks of size 2^( 3) =       0.000437957658
  error estimate for blocks of size 2^( 4) =       0.000448223403
  error estimate for blocks of size 2^( 5) =       0.000456954274
  error estimate for blocks of size 2^( 6) =       0.000462399118
  error estimate for blocks of size 2^( 7) =       0.000466607718

      target function =                  N/A
              le_mean =     -16.924756501958
             les_mean =     286.788465322268
             stat err =       0.000458546128
             autocorr =       1.232923652328
              std dev =       0.584022980906
             le_variance =       0.341082842227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.924756501955        initial
     5.6843e+03     5.6843e+04             6.3777e-08       -16.924756502003  <--
     2.2737e+04     2.2737e+05             1.5944e-08       -16.924756501979
     9.0949e+04     9.0949e+05             3.9861e-09       -16.924756501958

*****************************************************************************
Applying the update for shift_i =   5.6843e+03     and shift_s =   5.6843e+04
*****************************************************************************

  Execution time = 3.0002e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.117844e-01 1 1  ON 0
 uu_1                 1.451874e-01 1 1  ON 1
 uu_2                 4.416876e-02 1 1  ON 2
 uu_3                -1.870092e-02 1 1  ON 3
 uu_4                -6.449591e-02 1 1  ON 4
 uu_5                -9.825998e-02 1 1  ON 5
 uu_6                -1.249424e-01 1 1  ON 6
 uu_7                -1.391419e-01 1 1  ON 7
 uu_8                -1.342841e-01 1 1  ON 8
 uu_9                -1.042669e-01 1 1  ON 9
 ud_0                 4.356412e-01 1 1  ON 10
 ud_1                 1.704390e-01 1 1  ON 11
 ud_2                 5.188571e-02 1 1  ON 12
 ud_3                -1.640328e-02 1 1  ON 13
 ud_4                -6.989267e-02 1 1  ON 14
 ud_5                -1.062030e-01 1 1  ON 15
 ud_6                -1.280536e-01 1 1  ON 16
 ud_7                -1.398847e-01 1 1  ON 17
 ud_8                -1.383890e-01 1 1  ON 18
 ud_9                -1.310007e-01 1 1  ON 19
 eO_0                -7.721123e-01 1 1  ON 20
 eO_1                -4.509734e-01 1 1  ON 21
 eO_2                -2.866993e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.342523e-01 1 1  ON 24
 eO_5                 4.965997e-01 1 1  ON 25
 eO_6                 2.623038e-01 1 1  ON 26
 eO_7                -4.493753e-02 1 1  ON 27
 eO_8                -2.159804e-01 1 1  ON 28
 eO_9                -7.700561e-02 1 1  ON 29
eH1_0                -2.352127e-01 1 1  ON 30
eH1_1                -1.385770e-01 1 1  ON 31
eH1_2                -9.411500e-02 1 1  ON 32
eH1_3                -3.937762e-02 1 1  ON 33
eH1_4                 4.009160e-03 1 1  ON 34
eH1_5                 3.746036e-02 1 1  ON 35
eH1_6                 9.328279e-02 1 1  ON 36
eH1_7                 1.483267e-01 1 1  ON 37
eH1_8                 1.695236e-01 1 1  ON 38
eH1_9                 5.754541e-02 1 1  ON 39
eH2_0                -2.322536e-01 1 1  ON 40
eH2_1                -1.352048e-01 1 1  ON 41
eH2_2                -9.070432e-02 1 1  ON 42
eH2_3                -3.605064e-02 1 1  ON 43
eH2_4                 7.923823e-03 1 1  ON 44
eH2_5                 4.075842e-02 1 1  ON 45
eH2_6                 9.626506e-02 1 1  ON 46
eH2_7                 1.506004e-01 1 1  ON 47
eH2_8                 1.741174e-01 1 1  ON 48
eH2_9                 4.227461e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5982e+01 secs
  Total Execution time = 2.2846e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
