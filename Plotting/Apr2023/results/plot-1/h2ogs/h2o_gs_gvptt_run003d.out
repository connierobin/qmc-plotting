Rank =    0  Free Memory = 89213 MB
Rank =    1  Free Memory = 89213 MB
Rank =    2  Free Memory = 89213 MB
Rank =    3  Free Memory = 89213 MB
Rank =    4  Free Memory = 89213 MB
Rank =    5  Free Memory = 89213 MB
Rank =    6  Free Memory = 89213 MB
Rank =    7  Free Memory = 89213 MB
Rank =    8  Free Memory = 89211 MB
Rank =    9  Free Memory = 89211 MB
Rank =   10  Free Memory = 89211 MB
Rank =   11  Free Memory = 89211 MB
Rank =   12  Free Memory = 89211 MB
Rank =   13  Free Memory = 89211 MB
Rank =   14  Free Memory = 89210 MB
Rank =   15  Free Memory = 89197 MB
Rank =   16  Free Memory = 89197 MB
Rank =   17  Free Memory = 89196 MB
Rank =   18  Free Memory = 89196 MB
Rank =   19  Free Memory = 89196 MB
Rank =   20  Free Memory = 89196 MB
Rank =   21  Free Memory = 89196 MB
Rank =   22  Free Memory = 89196 MB
Rank =   23  Free Memory = 89196 MB
Rank =   24  Free Memory = 89196 MB
Rank =   25  Free Memory = 89196 MB
Rank =   26  Free Memory = 89196 MB
Rank =   27  Free Memory = 89196 MB
Rank =   28  Free Memory = 89196 MB
Rank =   29  Free Memory = 89196 MB
Rank =   30  Free Memory = 89196 MB
Rank =   31  Free Memory = 89196 MB
Rank =   32  Free Memory = 88050 MB
Rank =   33  Free Memory = 88050 MB
Rank =   34  Free Memory = 88050 MB
Rank =   35  Free Memory = 88050 MB
Rank =   36  Free Memory = 88050 MB
Rank =   37  Free Memory = 88050 MB
Rank =   38  Free Memory = 88050 MB
Rank =   39  Free Memory = 88050 MB
Rank =   40  Free Memory = 88050 MB
Rank =   41  Free Memory = 88050 MB
Rank =   42  Free Memory = 88050 MB
Rank =   43  Free Memory = 88050 MB
Rank =   44  Free Memory = 88050 MB
Rank =   45  Free Memory = 88050 MB
Rank =   46  Free Memory = 88050 MB
Rank =   47  Free Memory = 88050 MB
Rank =   48  Free Memory = 88050 MB
Rank =   49  Free Memory = 88050 MB
Rank =   50  Free Memory = 88050 MB
Rank =   51  Free Memory = 88050 MB
Rank =   52  Free Memory = 88050 MB
Rank =   53  Free Memory = 88050 MB
Rank =   54  Free Memory = 88050 MB
Rank =   55  Free Memory = 88050 MB
Rank =   56  Free Memory = 88050 MB
Rank =   57  Free Memory = 88050 MB
Rank =   58  Free Memory = 88050 MB
Rank =   59  Free Memory = 88050 MB
Rank =   60  Free Memory = 88050 MB
Rank =   61  Free Memory = 88050 MB
Rank =   62  Free Memory = 88050 MB
Rank =   63  Free Memory = 88050 MB
Rank =   64  Free Memory = 90725 MB
Rank =   65  Free Memory = 90725 MB
Rank =   66  Free Memory = 90725 MB
Rank =   67  Free Memory = 90725 MB
Rank =   68  Free Memory = 90725 MB
Rank =   69  Free Memory = 90724 MB
Rank =   70  Free Memory = 90724 MB
Rank =   71  Free Memory = 90724 MB
Rank =   72  Free Memory = 90724 MB
Rank =   73  Free Memory = 90724 MB
Rank =   74  Free Memory = 90724 MB
Rank =   75  Free Memory = 90724 MB
Rank =   76  Free Memory = 90724 MB
Rank =   77  Free Memory = 90724 MB
Rank =   78  Free Memory = 90724 MB
Rank =   79  Free Memory = 90724 MB
Rank =   80  Free Memory = 90724 MB
Rank =   81  Free Memory = 90724 MB
Rank =   82  Free Memory = 90724 MB
Rank =   83  Free Memory = 90724 MB
Rank =   84  Free Memory = 90724 MB
Rank =   85  Free Memory = 90724 MB
Rank =   86  Free Memory = 90724 MB
Rank =   87  Free Memory = 90724 MB
Rank =   88  Free Memory = 90724 MB
Rank =   89  Free Memory = 90724 MB
Rank =   90  Free Memory = 90723 MB
Rank =   91  Free Memory = 90723 MB
Rank =   92  Free Memory = 90723 MB
Rank =   93  Free Memory = 90723 MB
Rank =   94  Free Memory = 90723 MB
Rank =   95  Free Memory = 90723 MB
Rank =   96  Free Memory = 89123 MB
Rank =   97  Free Memory = 89123 MB
Rank =   98  Free Memory = 89123 MB
Rank =   99  Free Memory = 89123 MB
Rank =  100  Free Memory = 89123 MB
Rank =  101  Free Memory = 89123 MB
Rank =  102  Free Memory = 89123 MB
Rank =  103  Free Memory = 89123 MB
Rank =  104  Free Memory = 89123 MB
Rank =  105  Free Memory = 89123 MB
Rank =  106  Free Memory = 89123 MB
Rank =  107  Free Memory = 89123 MB
Rank =  108  Free Memory = 89123 MB
Rank =  109  Free Memory = 89123 MB
Rank =  110  Free Memory = 89123 MB
Rank =  111  Free Memory = 89123 MB
Rank =  112  Free Memory = 89123 MB
Rank =  113  Free Memory = 89123 MB
Rank =  114  Free Memory = 89123 MB
Rank =  115  Free Memory = 89123 MB
Rank =  116  Free Memory = 89123 MB
Rank =  117  Free Memory = 89123 MB
Rank =  118  Free Memory = 89123 MB
Rank =  119  Free Memory = 89123 MB
Rank =  120  Free Memory = 89123 MB
Rank =  121  Free Memory = 89123 MB
Rank =  122  Free Memory = 89123 MB
Rank =  123  Free Memory = 89123 MB
Rank =  124  Free Memory = 89123 MB
Rank =  125  Free Memory = 89123 MB
Rank =  126  Free Memory = 89123 MB
Rank =  127  Free Memory = 89123 MB
  Input file(s): opt_h2o_gs_gvptt_run003d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run003d.xml

  Project = H2O
  date    = 2023-04-02 10:28:37 PDT
  host    = n0042.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 837

  Range of prime numbers to use as seeds over processors and threads = 6469-7607


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.097997e-01    1         1  ON     0
     uu_1                 4.810361e-02    1         1  ON     1
     uu_2                -4.517404e-02    1         1  ON     2
     uu_3                -9.942882e-02    1         1  ON     3
     uu_4                -1.325370e-01    1         1  ON     4
     uu_5                -1.385148e-01    1         1  ON     5
     uu_6                -1.150447e-01    1         1  ON     6
     uu_7                -4.257133e-02    1         1  ON     7
     uu_8                 9.777389e-02    1         1  ON     8
     uu_9                 1.225503e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.463201e-01    1         1  ON     0
     ud_1                 9.089692e-02    1         1  ON     1
     ud_2                -1.344564e-02    1         1  ON     2
     ud_3                -7.172742e-02    1         1  ON     3
     ud_4                -1.199506e-01    1         1  ON     4
     ud_5                -1.535076e-01    1         1  ON     5
     ud_6                -1.556993e-01    1         1  ON     6
     ud_7                -1.107669e-01    1         1  ON     7
     ud_8                 1.408103e-03    1         1  ON     8
     ud_9                 9.244353e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.561639e-01    1         1  ON     0
     eO_1                -4.427548e-01    1         1  ON     1
     eO_2                -4.536963e-02    1         1  ON     2
     eO_3                 2.044029e-01    1         1  ON     3
     eO_4                 2.979155e-01    1         1  ON     4
     eO_5                 3.141658e-01    1         1  ON     5
     eO_6                 2.539432e-01    1         1  ON     6
     eO_7                 1.158789e-01    1         1  ON     7
     eO_8                 2.853288e-02    1         1  ON     8
     eO_9                 1.861833e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.815314e-01    1         1  ON     0
     eH1_1                -1.033515e-01    1         1  ON     1
     eH1_2                -6.278660e-02    1         1  ON     2
     eH1_3                -2.665664e-02    1         1  ON     3
     eH1_4                 1.894665e-02    1         1  ON     4
     eH1_5                 3.447196e-02    1         1  ON     5
     eH1_6                 7.840233e-02    1         1  ON     6
     eH1_7                 1.093416e-01    1         1  ON     7
     eH1_8                 9.261191e-02    1         1  ON     8
     eH1_9                 2.499359e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.833813e-01    1         1  ON     0
     eH2_1                -1.046246e-01    1         1  ON     1
     eH2_2                -6.407569e-02    1         1  ON     2
     eH2_3                -2.758518e-02    1         1  ON     3
     eH2_4                 1.792700e-02    1         1  ON     4
     eH2_5                 3.386843e-02    1         1  ON     5
     eH2_6                 7.883758e-02    1         1  ON     6
     eH2_7                 1.133602e-01    1         1  ON     7
     eH2_8                 9.618822e-02    1         1  ON     8
     eH2_9                 2.707310e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.704691e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 7.0251e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.212043
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1507e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315025617713
                                         uncertainty =       0.003953286938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315025617713
                                         uncertainty =       0.003953286938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396904168
  error estimate for blocks of size 2^( 2) =       0.000407029032
  error estimate for blocks of size 2^( 3) =       0.000415653359
  error estimate for blocks of size 2^( 4) =       0.000421495295
  error estimate for blocks of size 2^( 5) =       0.000425452552
  error estimate for blocks of size 2^( 6) =       0.000426777646
  error estimate for blocks of size 2^( 7) =       0.000429066758

      target function =                  N/A
              le_mean =     -17.217109258232
             les_mean =     296.743916889083
             stat err =       0.000425698063
             autocorr =       1.150355384427
              std dev =       0.561307256969
             le_variance =       0.315065836726


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721710925823e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109258232       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217126484966       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217129963093       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217135665258       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217138612577       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217138982310       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217139362898       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217141547955       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217141910482       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217142011303       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217141919552       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217141730400       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.247423e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109258232       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116953316       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217118438731       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217120723997       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217122119171       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217121881622       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217121948484       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217122312840       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217122354313       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.323887e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217109258232       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217111653048       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217112123077       residual = 5.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217112823998       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217113272895       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217113175228       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217113205027       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217113235537       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217113244241       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 3.581933e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129110 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6457e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.099327e-01                 1 1 ON  0
uu_1  4.824655e-02                 1 1 ON  1
uu_2  -4.523348e-02                1 1 ON  2
uu_3  -9.950285e-02                1 1 ON  3
uu_4  -1.324341e-01                1 1 ON  4
uu_5  -1.386599e-01                1 1 ON  5
uu_6  -1.151141e-01                1 1 ON  6
uu_7  -4.266710e-02                1 1 ON  7
uu_8  9.769345e-02                 1 1 ON  8
uu_9  1.226085e-01                 1 1 ON  9
ud_0  3.472267e-01                 1 1 ON  10
ud_1  9.141348e-02                 1 1 ON  11
ud_2  -1.397565e-02                1 1 ON  12
ud_3  -7.234005e-02                1 1 ON  13
ud_4  -1.200960e-01                1 1 ON  14
ud_5  -1.534529e-01                1 1 ON  15
ud_6  -1.557904e-01                1 1 ON  16
ud_7  -1.108300e-01                1 1 ON  17
ud_8  1.297420e-03                 1 1 ON  18
ud_9  9.244234e-02                 1 1 ON  19
eO_0  -7.574877e-01                1 1 ON  20
eO_1  -4.433627e-01                1 1 ON  21
eO_2  -4.459155e-02                1 1 ON  22
eO_3  2.050005e-01                 1 1 ON  23
eO_4  2.981655e-01                 1 1 ON  24
eO_5  3.142234e-01                 1 1 ON  25
eO_6  2.540362e-01                 1 1 ON  26
eO_7  1.159965e-01                 1 1 ON  27
eO_8  2.854947e-02                 1 1 ON  28
eO_9  1.862841e-02                 1 1 ON  29
eH1_0 -1.815487e-01                1 1 ON  30
eH1_1 -1.033405e-01                1 1 ON  31
eH1_2 -6.290846e-02                1 1 ON  32
eH1_3 -2.652398e-02                1 1 ON  33
eH1_4 1.904733e-02                 1 1 ON  34
eH1_5 3.436879e-02                 1 1 ON  35
eH1_6 7.832335e-02                 1 1 ON  36
eH1_7 1.093080e-01                 1 1 ON  37
eH1_8 9.268531e-02                 1 1 ON  38
eH1_9 2.502123e-02                 1 1 ON  39
eH2_0 -1.834897e-01                1 1 ON  40
eH2_1 -1.045947e-01                1 1 ON  41
eH2_2 -6.416611e-02                1 1 ON  42
eH2_3 -2.752528e-02                1 1 ON  43
eH2_4 1.809966e-02                 1 1 ON  44
eH2_5 3.375743e-02                 1 1 ON  45
eH2_6 7.881423e-02                 1 1 ON  46
eH2_7 1.133413e-01                 1 1 ON  47
eH2_8 9.625168e-02                 1 1 ON  48
eH2_9 2.709165e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2341
    reference variance = 0.243776
====================================================
  Execution time = 1.9929e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1141e-01
  Total weights = 2.0000e+06
  Execution time = 1.8202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310577676012
                                         uncertainty =       0.003153788277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310577676012
                                         uncertainty =       0.003153788277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394070919
  error estimate for blocks of size 2^( 2) =       0.000403530842
  error estimate for blocks of size 2^( 3) =       0.000412343821
  error estimate for blocks of size 2^( 4) =       0.000418689933
  error estimate for blocks of size 2^( 5) =       0.000424389957
  error estimate for blocks of size 2^( 6) =       0.000426898264
  error estimate for blocks of size 2^( 7) =       0.000428181033

      target function =                  N/A
              le_mean =     -17.216434667730
             les_mean =     296.716206291718
             stat err =       0.000424539797
             autocorr =       1.160614632325
              std dev =       0.557300438523
             le_variance =       0.310583778778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312808203176
                                         uncertainty =       0.003173241157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312808203176
                                         uncertainty =       0.003173241157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395483710
  error estimate for blocks of size 2^( 2) =       0.000404833864
  error estimate for blocks of size 2^( 3) =       0.000413534597
  error estimate for blocks of size 2^( 4) =       0.000419825468
  error estimate for blocks of size 2^( 5) =       0.000425480674
  error estimate for blocks of size 2^( 6) =       0.000427974292
  error estimate for blocks of size 2^( 7) =       0.000429286057

      target function =                  N/A
              le_mean =     -17.216423995119
             les_mean =     296.718069753141
             stat err =       0.000425641623
             autocorr =       1.158326470694
              std dev =       0.559298426472
             le_variance =       0.312814729854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312271921879
                                         uncertainty =       0.003167111138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312271921879
                                         uncertainty =       0.003167111138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395144497
  error estimate for blocks of size 2^( 2) =       0.000404515329
  error estimate for blocks of size 2^( 3) =       0.000413236919
  error estimate for blocks of size 2^( 4) =       0.000419539685
  error estimate for blocks of size 2^( 5) =       0.000425202523
  error estimate for blocks of size 2^( 6) =       0.000427703582
  error estimate for blocks of size 2^( 7) =       0.000429011585

      target function =                  N/A
              le_mean =     -17.216421563063
             les_mean =     296.717449627937
             stat err =       0.000425364344
             autocorr =       1.158804807034
              std dev =       0.558818706701
             le_variance =       0.312278346959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310811714322
                                         uncertainty =       0.003155562677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310811714322
                                         uncertainty =       0.003155562677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394219396
  error estimate for blocks of size 2^( 2) =       0.000403665088
  error estimate for blocks of size 2^( 3) =       0.000412463651
  error estimate for blocks of size 2^( 4) =       0.000418802988
  error estimate for blocks of size 2^( 5) =       0.000424497225
  error estimate for blocks of size 2^( 6) =       0.000427004932
  error estimate for blocks of size 2^( 7) =       0.000428291665

      target function =                  N/A
              le_mean =     -17.216430660548
             les_mean =     296.716302398444
             stat err =       0.000424649202
             autocorr =       1.160338357746
              std dev =       0.557510416404
             le_variance =       0.310817864399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216434667730        initial  <--
     2.5000e-01     2.5000e+00             4.2474e-03       -17.216423995119
     1.0000e+00     1.0000e+01             1.3239e-03       -17.216421563063
     4.0000e+00     4.0000e+01             3.5819e-04       -17.216430660548

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1311
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5595e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1933
    reference variance = 0.394727
====================================================
  Execution time = 2.0059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1149e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311529383368
                                         uncertainty =       0.002635759728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311529383368
                                         uncertainty =       0.002635759728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394646538
  error estimate for blocks of size 2^( 2) =       0.000404308051
  error estimate for blocks of size 2^( 3) =       0.000413374455
  error estimate for blocks of size 2^( 4) =       0.000419929565
  error estimate for blocks of size 2^( 5) =       0.000424545247
  error estimate for blocks of size 2^( 6) =       0.000427341749
  error estimate for blocks of size 2^( 7) =       0.000426365677

      target function =                  N/A
              le_mean =     -17.216657398501
             les_mean =     296.724783601746
             stat err =       0.000424545559
             autocorr =       1.157262845646
              std dev =       0.558114486595
             le_variance =       0.311491780147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665739850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216657398501       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216660714151       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216662688647       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216662971509       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664249642       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664926932       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664937170       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216664945335       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216664889560       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 5.370924e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216657398501       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658310514       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658852095       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658941779       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216659270493       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216659420426       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216659435630       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216659440591       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216659429274       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.391284e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216657398501       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216657632365       residual = 7.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216657771245       residual = 5.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216657795171       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216657877988       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216657913692       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216657918637       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216657919705       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216657917133       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 3.511762e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5567e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.098147e-01 1 1  ON 0
 uu_1                 4.812767e-02 1 1  ON 1
 uu_2                -4.519634e-02 1 1  ON 2
 uu_3                -9.943763e-02 1 1  ON 3
 uu_4                -1.325263e-01 1 1  ON 4
 uu_5                -1.385292e-01 1 1  ON 5
 uu_6                -1.150525e-01 1 1  ON 6
 uu_7                -4.257757e-02 1 1  ON 7
 uu_8                 9.776666e-02 1 1  ON 8
 uu_9                 1.225567e-01 1 1  ON 9
 ud_0                 3.464126e-01 1 1  ON 10
 ud_1                 9.097035e-02 1 1  ON 11
 ud_2                -1.352360e-02 1 1  ON 12
 ud_3                -7.179558e-02 1 1  ON 13
 ud_4                -1.199614e-01 1 1  ON 14
 ud_5                -1.535055e-01 1 1  ON 15
 ud_6                -1.557050e-01 1 1  ON 16
 ud_7                -1.107725e-01 1 1  ON 17
 ud_8                 1.398228e-03 1 1  ON 18
 ud_9                 9.244483e-02 1 1  ON 19
 eO_0                -7.563030e-01 1 1  ON 20
 eO_1                -4.428223e-01 1 1  ON 21
 eO_2                -4.526568e-02 1 1  ON 22
 eO_3                 2.044585e-01 1 1  ON 23
 eO_4                 2.979322e-01 1 1  ON 24
 eO_5                 3.141709e-01 1 1  ON 25
 eO_6                 2.539525e-01 1 1  ON 26
 eO_7                 1.158908e-01 1 1  ON 27
 eO_8                 2.853447e-02 1 1  ON 28
 eO_9                 1.861966e-02 1 1  ON 29
eH1_0                -1.815369e-01 1 1  ON 30
eH1_1                -1.033632e-01 1 1  ON 31
eH1_2                -6.280124e-02 1 1  ON 32
eH1_3                -2.663692e-02 1 1  ON 33
eH1_4                 1.894943e-02 1 1  ON 34
eH1_5                 3.446606e-02 1 1  ON 35
eH1_6                 7.840391e-02 1 1  ON 36
eH1_7                 1.093424e-01 1 1  ON 37
eH1_8                 9.262062e-02 1 1  ON 38
eH1_9                 2.499625e-02 1 1  ON 39
eH2_0                -1.833811e-01 1 1  ON 40
eH2_1                -1.046161e-01 1 1  ON 41
eH2_2                -6.409507e-02 1 1  ON 42
eH2_3                -2.757396e-02 1 1  ON 43
eH2_4                 1.793794e-02 1 1  ON 44
eH2_5                 3.385342e-02 1 1  ON 45
eH2_6                 7.883059e-02 1 1  ON 46
eH2_7                 1.133580e-01 1 1  ON 47
eH2_8                 9.619731e-02 1 1  ON 48
eH2_9                 2.707605e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1864
    reference variance = 0.158004
====================================================
  Execution time = 2.0961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0876e-01
  Total weights = 2.0000e+06
  Execution time = 2.4799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308617377626
                                         uncertainty =       0.002565889802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308617377626
                                         uncertainty =       0.002565889802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392853192
  error estimate for blocks of size 2^( 2) =       0.000402928062
  error estimate for blocks of size 2^( 3) =       0.000411869274
  error estimate for blocks of size 2^( 4) =       0.000417895401
  error estimate for blocks of size 2^( 5) =       0.000422677871
  error estimate for blocks of size 2^( 6) =       0.000424621327
  error estimate for blocks of size 2^( 7) =       0.000427318655

      target function =                  N/A
              le_mean =     -17.216137082251
             les_mean =     296.704043141038
             stat err =       0.000423128313
             autocorr =       1.160068413976
              std dev =       0.555578311765
             le_variance =       0.308667260504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308972239655
                                         uncertainty =       0.002568573708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308972239655
                                         uncertainty =       0.002568573708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393078734
  error estimate for blocks of size 2^( 2) =       0.000403131705
  error estimate for blocks of size 2^( 3) =       0.000412054182
  error estimate for blocks of size 2^( 4) =       0.000418066427
  error estimate for blocks of size 2^( 5) =       0.000422845335
  error estimate for blocks of size 2^( 6) =       0.000424788694
  error estimate for blocks of size 2^( 7) =       0.000427476011

      target function =                  N/A
              le_mean =     -17.216136803797
             les_mean =     296.704388074893
             stat err =       0.000423294117
             autocorr =       1.159645821110
              std dev =       0.555897276810
             le_variance =       0.309021782365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308803752330
                                         uncertainty =       0.002567342375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308803752330
                                         uncertainty =       0.002567342375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392971653
  error estimate for blocks of size 2^( 2) =       0.000403034545
  error estimate for blocks of size 2^( 3) =       0.000411965606
  error estimate for blocks of size 2^( 4) =       0.000417984261
  error estimate for blocks of size 2^( 5) =       0.000422764785
  error estimate for blocks of size 2^( 6) =       0.000424708144
  error estimate for blocks of size 2^( 7) =       0.000427399870

      target function =                  N/A
              le_mean =     -17.216136645692
             les_mean =     296.704214288401
             stat err =       0.000423214265
             autocorr =       1.159840176646
              std dev =       0.555745840901
             le_variance =       0.308853439679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308640780016
                                         uncertainty =       0.002566074967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308640780016
                                         uncertainty =       0.002566074967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392868068
  error estimate for blocks of size 2^( 2) =       0.000402941396
  error estimate for blocks of size 2^( 3) =       0.000411881306
  error estimate for blocks of size 2^( 4) =       0.000417906479
  error estimate for blocks of size 2^( 5) =       0.000422688699
  error estimate for blocks of size 2^( 6) =       0.000424632139
  error estimate for blocks of size 2^( 7) =       0.000427328745

      target function =                  N/A
              le_mean =     -17.216136994155
             les_mean =     296.704063484641
             stat err =       0.000423139015
             autocorr =       1.160039240225
              std dev =       0.555599349792
             le_variance =       0.308690637490


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216137082251        initial  <--
     2.5000e+00     2.5000e+01             5.3709e-04       -17.216136803797
     1.0000e+01     1.0000e+02             1.3913e-04       -17.216136645692
     4.0000e+01     4.0000e+02             3.5118e-05       -17.216136994155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7898
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6363e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2176
    reference variance = 0.346871
====================================================
  Execution time = 2.0022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342530282248
                                         uncertainty =       0.017361348148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342530282248
                                         uncertainty =       0.017361348148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413955798
  error estimate for blocks of size 2^( 2) =       0.000423219745
  error estimate for blocks of size 2^( 3) =       0.000431879433
  error estimate for blocks of size 2^( 4) =       0.000438612130
  error estimate for blocks of size 2^( 5) =       0.000442929274
  error estimate for blocks of size 2^( 6) =       0.000445299265
  error estimate for blocks of size 2^( 7) =       0.000444574774

      target function =                  N/A
              le_mean =     -17.216775601154
             les_mean =     296.760080734660
             stat err =       0.000442853861
             autocorr =       1.144492444708
              std dev =       0.585421903861
             le_variance =       0.342718805520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677560115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775601154       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776015164       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776315579       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776507472       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776511632       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776599132       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776608110       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216776613414       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216776613669       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 6.042407e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775601154       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775705628       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775781570       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216775830251       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216775831229       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216775853048       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216775855248       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216775856545       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216775856592       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.516558e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216775601154       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216775627334       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216775646373       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216775658588       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216775658829       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216775664280       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216775664827       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216775665150       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216775665160       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 3.795159e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135383 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5629e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.098009e-01 1 1  ON 0
 uu_1                 4.810596e-02 1 1  ON 1
 uu_2                -4.517644e-02 1 1  ON 2
 uu_3                -9.942939e-02 1 1  ON 3
 uu_4                -1.325357e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150454e-01 1 1  ON 6
 uu_7                -4.257273e-02 1 1  ON 7
 uu_8                 9.777331e-02 1 1  ON 8
 uu_9                 1.225509e-01 1 1  ON 9
 ud_0                 3.463310e-01 1 1  ON 10
 ud_1                 9.090527e-02 1 1  ON 11
 ud_2                -1.345338e-02 1 1  ON 12
 ud_3                -7.173371e-02 1 1  ON 13
 ud_4                -1.199528e-01 1 1  ON 14
 ud_5                -1.535075e-01 1 1  ON 15
 ud_6                -1.557007e-01 1 1  ON 16
 ud_7                -1.107678e-01 1 1  ON 17
 ud_8                 1.406671e-03 1 1  ON 18
 ud_9                 9.244343e-02 1 1  ON 19
 eO_0                -7.561790e-01 1 1  ON 20
 eO_1                -4.427614e-01 1 1  ON 21
 eO_2                -4.535815e-02 1 1  ON 22
 eO_3                 2.044087e-01 1 1  ON 23
 eO_4                 2.979173e-01 1 1  ON 24
 eO_5                 3.141660e-01 1 1  ON 25
 eO_6                 2.539441e-01 1 1  ON 26
 eO_7                 1.158801e-01 1 1  ON 27
 eO_8                 2.853304e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815321e-01 1 1  ON 30
eH1_1                -1.033517e-01 1 1  ON 31
eH1_2                -6.278817e-02 1 1  ON 32
eH1_3                -2.665533e-02 1 1  ON 33
eH1_4                 1.894765e-02 1 1  ON 34
eH1_5                 3.447179e-02 1 1  ON 35
eH1_6                 7.840204e-02 1 1  ON 36
eH1_7                 1.093412e-01 1 1  ON 37
eH1_8                 9.261259e-02 1 1  ON 38
eH1_9                 2.499383e-02 1 1  ON 39
eH2_0                -1.833822e-01 1 1  ON 40
eH2_1                -1.046247e-01 1 1  ON 41
eH2_2                -6.407580e-02 1 1  ON 42
eH2_3                -2.758440e-02 1 1  ON 43
eH2_4                 1.792855e-02 1 1  ON 44
eH2_5                 3.386779e-02 1 1  ON 45
eH2_6                 7.883632e-02 1 1  ON 46
eH2_7                 1.133601e-01 1 1  ON 47
eH2_8                 9.618892e-02 1 1  ON 48
eH2_9                 2.707331e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1988
    reference variance = 0.145925
====================================================
  Execution time = 2.1716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2010e-01
  Total weights = 2.0000e+06
  Execution time = 1.8138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168307755
                                         uncertainty =       0.004917501901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320168307755
                                         uncertainty =       0.004917501901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400057192
  error estimate for blocks of size 2^( 2) =       0.000409802645
  error estimate for blocks of size 2^( 3) =       0.000418437870
  error estimate for blocks of size 2^( 4) =       0.000424960664
  error estimate for blocks of size 2^( 5) =       0.000428072946
  error estimate for blocks of size 2^( 6) =       0.000431014389
  error estimate for blocks of size 2^( 7) =       0.000433243492

      target function =                  N/A
              le_mean =     -17.216426306807
             les_mean =     296.725426131912
             stat err =       0.000429322873
             autocorr =       1.151658952444
              std dev =       0.565766307095
             le_variance =       0.320091514244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320210561321
                                         uncertainty =       0.004918451170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320210561321
                                         uncertainty =       0.004918451170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400083584
  error estimate for blocks of size 2^( 2) =       0.000409826728
  error estimate for blocks of size 2^( 3) =       0.000418459683
  error estimate for blocks of size 2^( 4) =       0.000424981021
  error estimate for blocks of size 2^( 5) =       0.000428093263
  error estimate for blocks of size 2^( 6) =       0.000431034487
  error estimate for blocks of size 2^( 7) =       0.000433263163

      target function =                  N/A
              le_mean =     -17.216426085536
             les_mean =     296.725460746291
             stat err =       0.000429342984
             autocorr =       1.151614903947
              std dev =       0.565803629923
             le_variance =       0.320133747635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320189533016
                                         uncertainty =       0.004917976763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320189533016
                                         uncertainty =       0.004917976763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400070450
  error estimate for blocks of size 2^( 2) =       0.000409814738
  error estimate for blocks of size 2^( 3) =       0.000418448817
  error estimate for blocks of size 2^( 4) =       0.000424970875
  error estimate for blocks of size 2^( 5) =       0.000428083140
  error estimate for blocks of size 2^( 6) =       0.000431024475
  error estimate for blocks of size 2^( 7) =       0.000433253362

      target function =                  N/A
              le_mean =     -17.216426191564
             les_mean =     296.725443378834
             stat err =       0.000429332963
             autocorr =       1.151636760533
              std dev =       0.565785055758
             le_variance =       0.320112729319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320170962401
                                         uncertainty =       0.004917561261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320170962401
                                         uncertainty =       0.004917561261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400058850
  error estimate for blocks of size 2^( 2) =       0.000409804157
  error estimate for blocks of size 2^( 3) =       0.000418439238
  error estimate for blocks of size 2^( 4) =       0.000424961940
  error estimate for blocks of size 2^( 5) =       0.000428074220
  error estimate for blocks of size 2^( 6) =       0.000431015650
  error estimate for blocks of size 2^( 7) =       0.000433244726

      target function =                  N/A
              le_mean =     -17.216426292042
             les_mean =     296.725428276896
             stat err =       0.000429324134
             autocorr =       1.151656172476
              std dev =       0.565768652025
             le_variance =       0.320094167614


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216426306807        initial  <--
     2.5000e+01     2.5000e+02             6.0424e-05       -17.216426085536
     1.0000e+02     1.0000e+03             1.5166e-05       -17.216426191564
     4.0000e+02     4.0000e+03             3.7952e-06       -17.216426292042

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8795
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6518e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.245
    reference variance = 0.308693
====================================================
  Execution time = 1.9923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322130964483
                                         uncertainty =       0.008202955766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322130964483
                                         uncertainty =       0.008202955766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401509097
  error estimate for blocks of size 2^( 2) =       0.000411564932
  error estimate for blocks of size 2^( 3) =       0.000420583202
  error estimate for blocks of size 2^( 4) =       0.000427246026
  error estimate for blocks of size 2^( 5) =       0.000431501590
  error estimate for blocks of size 2^( 6) =       0.000434186563
  error estimate for blocks of size 2^( 7) =       0.000433480665

      target function =                  N/A
              le_mean =     -17.217146246474
             les_mean =     296.752543821017
             stat err =       0.000431603711
             autocorr =       1.155525572488
              std dev =       0.567819610212
             le_variance =       0.322419109742


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714624647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146246474       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217146276356       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217146274465       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217146288994       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217146303694       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217146307202       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217146305384       residual = 9.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217146306997       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217146307032       residual = 1.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 6.081678e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146246474       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217146253952       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217146253479       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217146257115       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217146260793       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217146261671       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217146261216       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217146261618       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217146261631       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 1.521042e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217146246474       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217146248344       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217146248226       residual = 4.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217146249135       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217146250056       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217146250272       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217146250163       residual = 9.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217146250257       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217146250265       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+03 is 3.802995e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138510 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5566e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810390e-02 1 1  ON 1
 uu_2                -4.517414e-02 1 1  ON 2
 uu_3                -9.942890e-02 1 1  ON 3
 uu_4                -1.325368e-01 1 1  ON 4
 uu_5                -1.385150e-01 1 1  ON 5
 uu_6                -1.150448e-01 1 1  ON 6
 uu_7                -4.257145e-02 1 1  ON 7
 uu_8                 9.777382e-02 1 1  ON 8
 uu_9                 1.225504e-01 1 1  ON 9
 ud_0                 3.463212e-01 1 1  ON 10
 ud_1                 9.089771e-02 1 1  ON 11
 ud_2                -1.344651e-02 1 1  ON 12
 ud_3                -7.172809e-02 1 1  ON 13
 ud_4                -1.199507e-01 1 1  ON 14
 ud_5                -1.535075e-01 1 1  ON 15
 ud_6                -1.556995e-01 1 1  ON 16
 ud_7                -1.107670e-01 1 1  ON 17
 ud_8                 1.407981e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561654e-01 1 1  ON 20
 eO_1                -4.427555e-01 1 1  ON 21
 eO_2                -4.536859e-02 1 1  ON 22
 eO_3                 2.044036e-01 1 1  ON 23
 eO_4                 2.979156e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539433e-01 1 1  ON 26
 eO_7                 1.158790e-01 1 1  ON 27
 eO_8                 2.853290e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033514e-01 1 1  ON 31
eH1_2                -6.278680e-02 1 1  ON 32
eH1_3                -2.665659e-02 1 1  ON 33
eH1_4                 1.894675e-02 1 1  ON 34
eH1_5                 3.447188e-02 1 1  ON 35
eH1_6                 7.840222e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261198e-02 1 1  ON 38
eH1_9                 2.499362e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046245e-01 1 1  ON 41
eH2_2                -6.407584e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792715e-02 1 1  ON 44
eH2_5                 3.386833e-02 1 1  ON 45
eH2_6                 7.883752e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618830e-02 1 1  ON 48
eH2_9                 2.707312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.218652
====================================================
  Execution time = 1.9818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315516632850
                                         uncertainty =       0.005611758016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315516632850
                                         uncertainty =       0.005611758016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397127578
  error estimate for blocks of size 2^( 2) =       0.000407493739
  error estimate for blocks of size 2^( 3) =       0.000416046647
  error estimate for blocks of size 2^( 4) =       0.000422918203
  error estimate for blocks of size 2^( 5) =       0.000426920990
  error estimate for blocks of size 2^( 6) =       0.000427369882
  error estimate for blocks of size 2^( 7) =       0.000427177232

      target function =                  N/A
              le_mean =     -17.216569457242
             les_mean =     296.725684344212
             stat err =       0.000426096577
             autocorr =       1.151213826451
              std dev =       0.561623206326
             le_variance =       0.315420625884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315520679280
                                         uncertainty =       0.005611766772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315520679280
                                         uncertainty =       0.005611766772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397130123
  error estimate for blocks of size 2^( 2) =       0.000407496017
  error estimate for blocks of size 2^( 3) =       0.000416048690
  error estimate for blocks of size 2^( 4) =       0.000422920078
  error estimate for blocks of size 2^( 5) =       0.000426922796
  error estimate for blocks of size 2^( 6) =       0.000427371630
  error estimate for blocks of size 2^( 7) =       0.000427178981

      target function =                  N/A
              le_mean =     -17.216569451371
             les_mean =     296.725688185743
             stat err =       0.000426098371
             autocorr =       1.151208764221
              std dev =       0.561626806332
             le_variance =       0.315424669590

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315518656980
                                         uncertainty =       0.005611762356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315518656980
                                         uncertainty =       0.005611762356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397128851
  error estimate for blocks of size 2^( 2) =       0.000407494878
  error estimate for blocks of size 2^( 3) =       0.000416047669
  error estimate for blocks of size 2^( 4) =       0.000422919141
  error estimate for blocks of size 2^( 5) =       0.000426921893
  error estimate for blocks of size 2^( 6) =       0.000427370756
  error estimate for blocks of size 2^( 7) =       0.000427178107

      target function =                  N/A
              le_mean =     -17.216569454279
             les_mean =     296.725686264936
             stat err =       0.000426097474
             autocorr =       1.151211293225
              std dev =       0.561625007145
             le_variance =       0.315422648651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315516885878
                                         uncertainty =       0.005611758557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315516885878
                                         uncertainty =       0.005611758557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397127737
  error estimate for blocks of size 2^( 2) =       0.000407493881
  error estimate for blocks of size 2^( 3) =       0.000416046775
  error estimate for blocks of size 2^( 4) =       0.000422918320
  error estimate for blocks of size 2^( 5) =       0.000426921103
  error estimate for blocks of size 2^( 6) =       0.000427369991
  error estimate for blocks of size 2^( 7) =       0.000427177341

      target function =                  N/A
              le_mean =     -17.216569456868
             les_mean =     296.725684584205
             stat err =       0.000426096689
             autocorr =       1.151213509715
              std dev =       0.561623431440
             le_variance =       0.315420878742


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216569457242        initial  <--
     2.5000e+02     2.5000e+03             6.0817e-06       -17.216569451371
     1.0000e+03     1.0000e+04             1.5210e-06       -17.216569454279
     4.0000e+03     4.0000e+04             3.8030e-07       -17.216569456868

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9952
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810361e-02 1 1  ON 1
 uu_2                -4.517404e-02 1 1  ON 2
 uu_3                -9.942882e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257133e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463201e-01 1 1  ON 10
 ud_1                 9.089692e-02 1 1  ON 11
 ud_2                -1.344564e-02 1 1  ON 12
 ud_3                -7.172742e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556993e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408103e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561639e-01 1 1  ON 20
 eO_1                -4.427548e-01 1 1  ON 21
 eO_2                -4.536963e-02 1 1  ON 22
 eO_3                 2.044029e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278660e-02 1 1  ON 32
eH1_3                -2.665664e-02 1 1  ON 33
eH1_4                 1.894665e-02 1 1  ON 34
eH1_5                 3.447196e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261191e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407569e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792700e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883758e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618822e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.174783
====================================================
  Execution time = 2.0150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1158e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311642741059
                                         uncertainty =       0.004214750423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311642741059
                                         uncertainty =       0.004214750423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394701248
  error estimate for blocks of size 2^( 2) =       0.000404705933
  error estimate for blocks of size 2^( 3) =       0.000413333998
  error estimate for blocks of size 2^( 4) =       0.000420465797
  error estimate for blocks of size 2^( 5) =       0.000424702310
  error estimate for blocks of size 2^( 6) =       0.000425838279
  error estimate for blocks of size 2^( 7) =       0.000425216593

      target function =                  N/A
              le_mean =     -17.216540904460
             les_mean =     296.720858709878
             stat err =       0.000424055745
             autocorr =       1.154273971980
              std dev =       0.558191858356
             le_variance =       0.311578150734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654090446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540904460       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540909538       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540910320       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216540911435       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540911992       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216540912710       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216540912674       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216540912760       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216540912731       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 5.955763e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540904460       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540905729       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540905925       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216540906204       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540906340       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216540906528       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216540906517       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216540906531       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216540906521       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 1.488995e-07

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216540904460       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216540904777       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216540904826       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216540904896       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216540904937       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216540904969       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216540904968       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216540904983       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216540904977       residual = 1.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+04 is 3.722523e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5671e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810364e-02 1 1  ON 1
 uu_2                -4.517405e-02 1 1  ON 2
 uu_3                -9.942883e-02 1 1  ON 3
 uu_4                -1.325370e-01 1 1  ON 4
 uu_5                -1.385148e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257134e-02 1 1  ON 7
 uu_8                 9.777389e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463202e-01 1 1  ON 10
 ud_1                 9.089700e-02 1 1  ON 11
 ud_2                -1.344573e-02 1 1  ON 12
 ud_3                -7.172748e-02 1 1  ON 13
 ud_4                -1.199506e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556994e-01 1 1  ON 16
 ud_7                -1.107669e-01 1 1  ON 17
 ud_8                 1.408090e-03 1 1  ON 18
 ud_9                 9.244353e-02 1 1  ON 19
 eO_0                -7.561640e-01 1 1  ON 20
 eO_1                -4.427549e-01 1 1  ON 21
 eO_2                -4.536952e-02 1 1  ON 22
 eO_3                 2.044030e-01 1 1  ON 23
 eO_4                 2.979155e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861833e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278661e-02 1 1  ON 32
eH1_3                -2.665663e-02 1 1  ON 33
eH1_4                 1.894666e-02 1 1  ON 34
eH1_5                 3.447195e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261192e-02 1 1  ON 38
eH1_9                 2.499359e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046246e-01 1 1  ON 41
eH2_2                -6.407571e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792702e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883757e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618823e-02 1 1  ON 48
eH2_9                 2.707310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1632
    reference variance = 0.341061
====================================================
  Execution time = 1.9572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2908e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157000372
                                         uncertainty =       0.011618714941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157000372
                                         uncertainty =       0.011618714941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405637502
  error estimate for blocks of size 2^( 2) =       0.000415437336
  error estimate for blocks of size 2^( 3) =       0.000424392880
  error estimate for blocks of size 2^( 4) =       0.000430514681
  error estimate for blocks of size 2^( 5) =       0.000435330407
  error estimate for blocks of size 2^( 6) =       0.000436925139
  error estimate for blocks of size 2^( 7) =       0.000437511198

      target function =                  N/A
              le_mean =     -17.216767630612
             les_mean =     296.746171047734
             stat err =       0.000435070356
             autocorr =       1.150383881253
              std dev =       0.573658056502
             le_variance =       0.329083565789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157436290
                                         uncertainty =       0.011618730992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157436290
                                         uncertainty =       0.011618730992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405637770
  error estimate for blocks of size 2^( 2) =       0.000415437580
  error estimate for blocks of size 2^( 3) =       0.000424393102
  error estimate for blocks of size 2^( 4) =       0.000430514889
  error estimate for blocks of size 2^( 5) =       0.000435330608
  error estimate for blocks of size 2^( 6) =       0.000436925329
  error estimate for blocks of size 2^( 7) =       0.000437511377

      target function =                  N/A
              le_mean =     -17.216767636900
             les_mean =     296.746171699953
             stat err =       0.000435070551
             autocorr =       1.150383387318
              std dev =       0.573658436243
             le_variance =       0.329084001473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157218342
                                         uncertainty =       0.011618722967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157218342
                                         uncertainty =       0.011618722967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405637636
  error estimate for blocks of size 2^( 2) =       0.000415437458
  error estimate for blocks of size 2^( 3) =       0.000424392991
  error estimate for blocks of size 2^( 4) =       0.000430514785
  error estimate for blocks of size 2^( 5) =       0.000435330508
  error estimate for blocks of size 2^( 6) =       0.000436925234
  error estimate for blocks of size 2^( 7) =       0.000437511288

      target function =                  N/A
              le_mean =     -17.216767633757
             les_mean =     296.746171373866
             stat err =       0.000435070453
             autocorr =       1.150383634267
              std dev =       0.573658246382
             le_variance =       0.329083783642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157027619
                                         uncertainty =       0.011618715945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157027619
                                         uncertainty =       0.011618715945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405637519
  error estimate for blocks of size 2^( 2) =       0.000415437351
  error estimate for blocks of size 2^( 3) =       0.000424392894
  error estimate for blocks of size 2^( 4) =       0.000430514694
  error estimate for blocks of size 2^( 5) =       0.000435330419
  error estimate for blocks of size 2^( 6) =       0.000436925151
  error estimate for blocks of size 2^( 7) =       0.000437511210

      target function =                  N/A
              le_mean =     -17.216767631005
             les_mean =     296.746171088501
             stat err =       0.000435070368
             autocorr =       1.150383850378
              std dev =       0.573658080237
             le_variance =       0.329083593021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216767630612        initial
     2.5000e+03     2.5000e+04             5.9558e-07       -17.216767636900  <--
     1.0000e+04     1.0000e+05             1.4890e-07       -17.216767633757
     4.0000e+04     4.0000e+05             3.7225e-08       -17.216767631005

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 2.8716e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.097997e-01 1 1  ON 0
 uu_1                 4.810373e-02 1 1  ON 1
 uu_2                -4.517409e-02 1 1  ON 2
 uu_3                -9.942887e-02 1 1  ON 3
 uu_4                -1.325369e-01 1 1  ON 4
 uu_5                -1.385149e-01 1 1  ON 5
 uu_6                -1.150447e-01 1 1  ON 6
 uu_7                -4.257136e-02 1 1  ON 7
 uu_8                 9.777387e-02 1 1  ON 8
 uu_9                 1.225503e-01 1 1  ON 9
 ud_0                 3.463206e-01 1 1  ON 10
 ud_1                 9.089723e-02 1 1  ON 11
 ud_2                -1.344598e-02 1 1  ON 12
 ud_3                -7.172768e-02 1 1  ON 13
 ud_4                -1.199507e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556994e-01 1 1  ON 16
 ud_7                -1.107670e-01 1 1  ON 17
 ud_8                 1.408050e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561644e-01 1 1  ON 20
 eO_1                -4.427551e-01 1 1  ON 21
 eO_2                -4.536918e-02 1 1  ON 22
 eO_3                 2.044032e-01 1 1  ON 23
 eO_4                 2.979156e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539432e-01 1 1  ON 26
 eO_7                 1.158789e-01 1 1  ON 27
 eO_8                 2.853288e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278666e-02 1 1  ON 32
eH1_3                -2.665661e-02 1 1  ON 33
eH1_4                 1.894668e-02 1 1  ON 34
eH1_5                 3.447192e-02 1 1  ON 35
eH1_6                 7.840233e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261194e-02 1 1  ON 38
eH1_9                 2.499360e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046245e-01 1 1  ON 41
eH2_2                -6.407576e-02 1 1  ON 42
eH2_3                -2.758518e-02 1 1  ON 43
eH2_4                 1.792707e-02 1 1  ON 44
eH2_5                 3.386843e-02 1 1  ON 45
eH2_6                 7.883753e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618825e-02 1 1  ON 48
eH2_9                 2.707311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2317
    reference variance = 0.181619
====================================================
  Execution time = 1.9869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315332724766
                                         uncertainty =       0.003734106551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315332724766
                                         uncertainty =       0.003734106551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397127157
  error estimate for blocks of size 2^( 2) =       0.000406975924
  error estimate for blocks of size 2^( 3) =       0.000416000366
  error estimate for blocks of size 2^( 4) =       0.000423111711
  error estimate for blocks of size 2^( 5) =       0.000427123260
  error estimate for blocks of size 2^( 6) =       0.000430340021
  error estimate for blocks of size 2^( 7) =       0.000431631330

      target function =                  N/A
              le_mean =     -17.215892862062
             les_mean =     296.702386838666
             stat err =       0.000428051580
             autocorr =       1.161804448968
              std dev =       0.561622612063
             le_variance =       0.315419958380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589286206e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215892862062       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215892876652       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215892883799       residual = 5.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215892890696       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215892895095       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215892895376       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215892894209       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215892895072       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215892895154       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.490045e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215892862062       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215892865711       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215892867498       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215892869225       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215892870323       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215892870393       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215892870102       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215892870312       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215892870340       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 6.226072e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215892862062       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215892862974       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215892863421       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215892863853       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215892864120       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215892864143       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215892864071       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215892864130       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215892864121       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+04 is 1.556578e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5491e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.097998e-01 1 1  ON 0
 uu_1                 4.810381e-02 1 1  ON 1
 uu_2                -4.517418e-02 1 1  ON 2
 uu_3                -9.942890e-02 1 1  ON 3
 uu_4                -1.325369e-01 1 1  ON 4
 uu_5                -1.385149e-01 1 1  ON 5
 uu_6                -1.150448e-01 1 1  ON 6
 uu_7                -4.257139e-02 1 1  ON 7
 uu_8                 9.777384e-02 1 1  ON 8
 uu_9                 1.225504e-01 1 1  ON 9
 ud_0                 3.463210e-01 1 1  ON 10
 ud_1                 9.089757e-02 1 1  ON 11
 ud_2                -1.344633e-02 1 1  ON 12
 ud_3                -7.172796e-02 1 1  ON 13
 ud_4                -1.199507e-01 1 1  ON 14
 ud_5                -1.535076e-01 1 1  ON 15
 ud_6                -1.556995e-01 1 1  ON 16
 ud_7                -1.107670e-01 1 1  ON 17
 ud_8                 1.408006e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561651e-01 1 1  ON 20
 eO_1                -4.427554e-01 1 1  ON 21
 eO_2                -4.536871e-02 1 1  ON 22
 eO_3                 2.044034e-01 1 1  ON 23
 eO_4                 2.979157e-01 1 1  ON 24
 eO_5                 3.141658e-01 1 1  ON 25
 eO_6                 2.539433e-01 1 1  ON 26
 eO_7                 1.158790e-01 1 1  ON 27
 eO_8                 2.853289e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815314e-01 1 1  ON 30
eH1_1                -1.033515e-01 1 1  ON 31
eH1_2                -6.278670e-02 1 1  ON 32
eH1_3                -2.665656e-02 1 1  ON 33
eH1_4                 1.894672e-02 1 1  ON 34
eH1_5                 3.447185e-02 1 1  ON 35
eH1_6                 7.840229e-02 1 1  ON 36
eH1_7                 1.093416e-01 1 1  ON 37
eH1_8                 9.261196e-02 1 1  ON 38
eH1_9                 2.499361e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046245e-01 1 1  ON 41
eH2_2                -6.407580e-02 1 1  ON 42
eH2_3                -2.758516e-02 1 1  ON 43
eH2_4                 1.792707e-02 1 1  ON 44
eH2_5                 3.386840e-02 1 1  ON 45
eH2_6                 7.883753e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618827e-02 1 1  ON 48
eH2_9                 2.707311e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.174404
====================================================
  Execution time = 1.9658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0973e-01
  Total weights = 2.0000e+06
  Execution time = 1.8260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592089703
                                         uncertainty =       0.002653773784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592089703
                                         uncertainty =       0.002653773784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393530760
  error estimate for blocks of size 2^( 2) =       0.000403557930
  error estimate for blocks of size 2^( 3) =       0.000412199243
  error estimate for blocks of size 2^( 4) =       0.000418735530
  error estimate for blocks of size 2^( 5) =       0.000422637149
  error estimate for blocks of size 2^( 6) =       0.000424779531
  error estimate for blocks of size 2^( 7) =       0.000426321240

      target function =                  N/A
              le_mean =     -17.217174426783
             les_mean =     296.740828004887
             stat err =       0.000423118362
             autocorr =       1.156022744116
              std dev =       0.556536537424
             le_variance =       0.309732917487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309593790074
                                         uncertainty =       0.002653789213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309593790074
                                         uncertainty =       0.002653789213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393531840
  error estimate for blocks of size 2^( 2) =       0.000403558916
  error estimate for blocks of size 2^( 3) =       0.000412200135
  error estimate for blocks of size 2^( 4) =       0.000418736342
  error estimate for blocks of size 2^( 5) =       0.000422637947
  error estimate for blocks of size 2^( 6) =       0.000424780342
  error estimate for blocks of size 2^( 7) =       0.000426322046

      target function =                  N/A
              le_mean =     -17.217174427976
             les_mean =     296.740829746556
             stat err =       0.000423119169
             autocorr =       1.156020806335
              std dev =       0.556538065249
             le_variance =       0.309734618071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592940045
                                         uncertainty =       0.002653781501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592940045
                                         uncertainty =       0.002653781501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393531300
  error estimate for blocks of size 2^( 2) =       0.000403558423
  error estimate for blocks of size 2^( 3) =       0.000412199689
  error estimate for blocks of size 2^( 4) =       0.000418735936
  error estimate for blocks of size 2^( 5) =       0.000422637548
  error estimate for blocks of size 2^( 6) =       0.000424779937
  error estimate for blocks of size 2^( 7) =       0.000426321643

      target function =                  N/A
              le_mean =     -17.217174427375
             les_mean =     296.740828875727
             stat err =       0.000423118766
             autocorr =       1.156021774874
              std dev =       0.556537301477
             le_variance =       0.309733767935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592195998
                                         uncertainty =       0.002653774749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309592195998
                                         uncertainty =       0.002653774749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393530827
  error estimate for blocks of size 2^( 2) =       0.000403557992
  error estimate for blocks of size 2^( 3) =       0.000412199298
  error estimate for blocks of size 2^( 4) =       0.000418735581
  error estimate for blocks of size 2^( 5) =       0.000422637199
  error estimate for blocks of size 2^( 6) =       0.000424779581
  error estimate for blocks of size 2^( 7) =       0.000426321290

      target function =                  N/A
              le_mean =     -17.217174426856
             les_mean =     296.740828113726
             stat err =       0.000423118413
             autocorr =       1.156022622955
              std dev =       0.556536632932
             le_variance =       0.309733023795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217174426783        initial
     6.2500e+02     6.2500e+03             2.4900e-06       -17.217174427976  <--
     2.5000e+03     2.5000e+04             6.2261e-07       -17.217174427375
     1.0000e+04     1.0000e+05             1.5566e-07       -17.217174426856

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.8835e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810404e-02 1 1  ON 1
 uu_2                -4.517445e-02 1 1  ON 2
 uu_3                -9.942897e-02 1 1  ON 3
 uu_4                -1.325367e-01 1 1  ON 4
 uu_5                -1.385151e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257150e-02 1 1  ON 7
 uu_8                 9.777377e-02 1 1  ON 8
 uu_9                 1.225504e-01 1 1  ON 9
 ud_0                 3.463224e-01 1 1  ON 10
 ud_1                 9.089857e-02 1 1  ON 11
 ud_2                -1.344737e-02 1 1  ON 12
 ud_3                -7.172879e-02 1 1  ON 13
 ud_4                -1.199509e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556997e-01 1 1  ON 16
 ud_7                -1.107671e-01 1 1  ON 17
 ud_8                 1.407874e-03 1 1  ON 18
 ud_9                 9.244351e-02 1 1  ON 19
 eO_0                -7.561669e-01 1 1  ON 20
 eO_1                -4.427562e-01 1 1  ON 21
 eO_2                -4.536733e-02 1 1  ON 22
 eO_3                 2.044041e-01 1 1  ON 23
 eO_4                 2.979159e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158791e-01 1 1  ON 27
 eO_8                 2.853292e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278679e-02 1 1  ON 32
eH1_3                -2.665642e-02 1 1  ON 33
eH1_4                 1.894682e-02 1 1  ON 34
eH1_5                 3.447163e-02 1 1  ON 35
eH1_6                 7.840217e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261203e-02 1 1  ON 38
eH1_9                 2.499364e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407591e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792706e-02 1 1  ON 44
eH2_5                 3.386831e-02 1 1  ON 45
eH2_6                 7.883753e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618833e-02 1 1  ON 48
eH2_9                 2.707313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.207596
====================================================
  Execution time = 1.9887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309304034638
                                         uncertainty =       0.002846624709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309304034638
                                         uncertainty =       0.002846624709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393294519
  error estimate for blocks of size 2^( 2) =       0.000403261325
  error estimate for blocks of size 2^( 3) =       0.000412452064
  error estimate for blocks of size 2^( 4) =       0.000419840016
  error estimate for blocks of size 2^( 5) =       0.000424160086
  error estimate for blocks of size 2^( 6) =       0.000426187992
  error estimate for blocks of size 2^( 7) =       0.000425814398

      target function =                  N/A
              le_mean =     -17.216562884142
             les_mean =     296.719398545746
             stat err =       0.000424000623
             autocorr =       1.162243704218
              std dev =       0.556202442302
             le_variance =       0.309361156823


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656288414e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562884142       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562946427       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562952695       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562970123       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562985613       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562987731       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562987663       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562988170       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562988668       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 9.991293e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562884142       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562899737       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562901309       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562905673       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562909550       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562910087       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562910066       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562910193       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562910318       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.499554e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562884142       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562888042       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562888435       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562889527       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562890496       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562890632       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562890625       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562890659       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562890686       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 6.249969e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5452e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.098003e-01 1 1  ON 0
 uu_1                 4.810431e-02 1 1  ON 1
 uu_2                -4.517475e-02 1 1  ON 2
 uu_3                -9.942908e-02 1 1  ON 3
 uu_4                -1.325365e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150451e-01 1 1  ON 6
 uu_7                -4.257163e-02 1 1  ON 7
 uu_8                 9.777375e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463240e-01 1 1  ON 10
 ud_1                 9.089988e-02 1 1  ON 11
 ud_2                -1.344869e-02 1 1  ON 12
 ud_3                -7.172991e-02 1 1  ON 13
 ud_4                -1.199512e-01 1 1  ON 14
 ud_5                -1.535073e-01 1 1  ON 15
 ud_6                -1.557000e-01 1 1  ON 16
 ud_7                -1.107673e-01 1 1  ON 17
 ud_8                 1.407738e-03 1 1  ON 18
 ud_9                 9.244354e-02 1 1  ON 19
 eO_0                -7.561694e-01 1 1  ON 20
 eO_1                -4.427571e-01 1 1  ON 21
 eO_2                -4.536572e-02 1 1  ON 22
 eO_3                 2.044052e-01 1 1  ON 23
 eO_4                 2.979161e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539435e-01 1 1  ON 26
 eO_7                 1.158793e-01 1 1  ON 27
 eO_8                 2.853296e-02 1 1  ON 28
 eO_9                 1.861836e-02 1 1  ON 29
eH1_0                -1.815317e-01 1 1  ON 30
eH1_1                -1.033512e-01 1 1  ON 31
eH1_2                -6.278701e-02 1 1  ON 32
eH1_3                -2.665613e-02 1 1  ON 33
eH1_4                 1.894695e-02 1 1  ON 34
eH1_5                 3.447150e-02 1 1  ON 35
eH1_6                 7.840209e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261215e-02 1 1  ON 38
eH1_9                 2.499368e-02 1 1  ON 39
eH2_0                -1.833814e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407606e-02 1 1  ON 42
eH2_3                -2.758490e-02 1 1  ON 43
eH2_4                 1.792723e-02 1 1  ON 44
eH2_5                 3.386818e-02 1 1  ON 45
eH2_6                 7.883735e-02 1 1  ON 46
eH2_7                 1.133601e-01 1 1  ON 47
eH2_8                 9.618848e-02 1 1  ON 48
eH2_9                 2.707319e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1932
    reference variance = 0.299976
====================================================
  Execution time = 1.9569e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1107e-01
  Total weights = 2.0000e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311180960998
                                         uncertainty =       0.002614172105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311180960998
                                         uncertainty =       0.002614172105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394380272
  error estimate for blocks of size 2^( 2) =       0.000404434204
  error estimate for blocks of size 2^( 3) =       0.000413887079
  error estimate for blocks of size 2^( 4) =       0.000420781058
  error estimate for blocks of size 2^( 5) =       0.000425090535
  error estimate for blocks of size 2^( 6) =       0.000426227650
  error estimate for blocks of size 2^( 7) =       0.000426353057

      target function =                  N/A
              le_mean =     -17.216727728135
             les_mean =     296.726785106838
             stat err =       0.000424613075
             autocorr =       1.159194636133
              std dev =       0.557737929189
             le_variance =       0.311071597656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311187176295
                                         uncertainty =       0.002614205098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311187176295
                                         uncertainty =       0.002614205098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394384210
  error estimate for blocks of size 2^( 2) =       0.000404437743
  error estimate for blocks of size 2^( 3) =       0.000413890279
  error estimate for blocks of size 2^( 4) =       0.000420784046
  error estimate for blocks of size 2^( 5) =       0.000425093420
  error estimate for blocks of size 2^( 6) =       0.000426230316
  error estimate for blocks of size 2^( 7) =       0.000426355670

      target function =                  N/A
              le_mean =     -17.216727692350
             les_mean =     296.726790087690
             stat err =       0.000424615863
             autocorr =       1.159186703922
              std dev =       0.557743499032
             le_variance =       0.311077810713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311184070642
                                         uncertainty =       0.002614188614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311184070642
                                         uncertainty =       0.002614188614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394382242
  error estimate for blocks of size 2^( 2) =       0.000404435975
  error estimate for blocks of size 2^( 3) =       0.000413888680
  error estimate for blocks of size 2^( 4) =       0.000420782553
  error estimate for blocks of size 2^( 5) =       0.000425091978
  error estimate for blocks of size 2^( 6) =       0.000426228984
  error estimate for blocks of size 2^( 7) =       0.000426354364

      target function =                  N/A
              le_mean =     -17.216727710118
             les_mean =     296.726787594978
             stat err =       0.000424614470
             autocorr =       1.159190664896
              std dev =       0.557740715907
             le_variance =       0.311074706180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311181349725
                                         uncertainty =       0.002614174169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311181349725
                                         uncertainty =       0.002614174169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394380518
  error estimate for blocks of size 2^( 2) =       0.000404434426
  error estimate for blocks of size 2^( 3) =       0.000413887279
  error estimate for blocks of size 2^( 4) =       0.000420781245
  error estimate for blocks of size 2^( 5) =       0.000425090716
  error estimate for blocks of size 2^( 6) =       0.000426227817
  error estimate for blocks of size 2^( 7) =       0.000426353221

      target function =                  N/A
              le_mean =     -17.216727725873
             les_mean =     296.726785417548
             stat err =       0.000424613250
             autocorr =       1.159194139549
              std dev =       0.557738277549
             le_variance =       0.311071986244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216727728135        initial  <--
     1.5625e+02     1.5625e+03             9.9913e-06       -17.216727692350
     6.2500e+02     6.2500e+03             2.4996e-06       -17.216727710118
     2.5000e+03     2.5000e+04             6.2500e-07       -17.216727725873

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7777
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810404e-02 1 1  ON 1
 uu_2                -4.517445e-02 1 1  ON 2
 uu_3                -9.942897e-02 1 1  ON 3
 uu_4                -1.325367e-01 1 1  ON 4
 uu_5                -1.385151e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257150e-02 1 1  ON 7
 uu_8                 9.777377e-02 1 1  ON 8
 uu_9                 1.225504e-01 1 1  ON 9
 ud_0                 3.463224e-01 1 1  ON 10
 ud_1                 9.089857e-02 1 1  ON 11
 ud_2                -1.344737e-02 1 1  ON 12
 ud_3                -7.172879e-02 1 1  ON 13
 ud_4                -1.199509e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556997e-01 1 1  ON 16
 ud_7                -1.107671e-01 1 1  ON 17
 ud_8                 1.407874e-03 1 1  ON 18
 ud_9                 9.244351e-02 1 1  ON 19
 eO_0                -7.561669e-01 1 1  ON 20
 eO_1                -4.427562e-01 1 1  ON 21
 eO_2                -4.536733e-02 1 1  ON 22
 eO_3                 2.044041e-01 1 1  ON 23
 eO_4                 2.979159e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158791e-01 1 1  ON 27
 eO_8                 2.853292e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278679e-02 1 1  ON 32
eH1_3                -2.665642e-02 1 1  ON 33
eH1_4                 1.894682e-02 1 1  ON 34
eH1_5                 3.447163e-02 1 1  ON 35
eH1_6                 7.840217e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261203e-02 1 1  ON 38
eH1_9                 2.499364e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407591e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792706e-02 1 1  ON 44
eH2_5                 3.386831e-02 1 1  ON 45
eH2_6                 7.883753e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618833e-02 1 1  ON 48
eH2_9                 2.707313e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0865
    reference variance = 0.77964
====================================================
  Execution time = 2.2119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2823e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328135278962
                                         uncertainty =       0.010827342921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328135278962
                                         uncertainty =       0.010827342921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405108379
  error estimate for blocks of size 2^( 2) =       0.000414751641
  error estimate for blocks of size 2^( 3) =       0.000423015057
  error estimate for blocks of size 2^( 4) =       0.000429686416
  error estimate for blocks of size 2^( 5) =       0.000435271560
  error estimate for blocks of size 2^( 6) =       0.000437715335
  error estimate for blocks of size 2^( 7) =       0.000439484286

      target function =                  N/A
              le_mean =     -17.216683322433
             les_mean =     296.742410058195
             stat err =       0.000435539399
             autocorr =       1.155879187304
              std dev =       0.572909763732
             le_variance =       0.328225597380


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668332243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683322433       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216683329476       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216683331430       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216683332609       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216683335251       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216683336321       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216683336262       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216683336243       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216683336314       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 9.227558e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683322433       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216683324194       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216683324682       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216683324975       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216683325637       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216683325904       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216683325893       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216683325895       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216683325903       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.307029e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216683322433       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216683322873       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216683322995       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216683323058       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216683323232       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216683323313       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216683323293       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216683323303       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216683323322       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 5.767661e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150936 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7622e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810409e-02 1 1  ON 1
 uu_2                -4.517446e-02 1 1  ON 2
 uu_3                -9.942898e-02 1 1  ON 3
 uu_4                -1.325367e-01 1 1  ON 4
 uu_5                -1.385151e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257152e-02 1 1  ON 7
 uu_8                 9.777376e-02 1 1  ON 8
 uu_9                 1.225504e-01 1 1  ON 9
 ud_0                 3.463225e-01 1 1  ON 10
 ud_1                 9.089869e-02 1 1  ON 11
 ud_2                -1.344750e-02 1 1  ON 12
 ud_3                -7.172890e-02 1 1  ON 13
 ud_4                -1.199509e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556997e-01 1 1  ON 16
 ud_7                -1.107671e-01 1 1  ON 17
 ud_8                 1.407856e-03 1 1  ON 18
 ud_9                 9.244351e-02 1 1  ON 19
 eO_0                -7.561672e-01 1 1  ON 20
 eO_1                -4.427563e-01 1 1  ON 21
 eO_2                -4.536716e-02 1 1  ON 22
 eO_3                 2.044042e-01 1 1  ON 23
 eO_4                 2.979159e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158791e-01 1 1  ON 27
 eO_8                 2.853292e-02 1 1  ON 28
 eO_9                 1.861834e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278682e-02 1 1  ON 32
eH1_3                -2.665641e-02 1 1  ON 33
eH1_4                 1.894685e-02 1 1  ON 34
eH1_5                 3.447162e-02 1 1  ON 35
eH1_6                 7.840216e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261204e-02 1 1  ON 38
eH1_9                 2.499364e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407595e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792710e-02 1 1  ON 44
eH2_5                 3.386830e-02 1 1  ON 45
eH2_6                 7.883752e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618834e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.228
    reference variance = 0.121716
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1993e-01
  Total weights = 2.0000e+06
  Execution time = 1.8146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007230106
                                         uncertainty =       0.006248098608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007230106
                                         uncertainty =       0.006248098608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399953285
  error estimate for blocks of size 2^( 2) =       0.000409869258
  error estimate for blocks of size 2^( 3) =       0.000419529823
  error estimate for blocks of size 2^( 4) =       0.000426354780
  error estimate for blocks of size 2^( 5) =       0.000430352269
  error estimate for blocks of size 2^( 6) =       0.000433633284
  error estimate for blocks of size 2^( 7) =       0.000432691820

      target function =                  N/A
              le_mean =     -17.215778198369
             les_mean =     296.702944075794
             stat err =       0.000430758038
             autocorr =       1.159973971166
              std dev =       0.565619359920
             le_variance =       0.319925260317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007933380
                                         uncertainty =       0.006248117401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007933380
                                         uncertainty =       0.006248117401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399953724
  error estimate for blocks of size 2^( 2) =       0.000409869655
  error estimate for blocks of size 2^( 3) =       0.000419530188
  error estimate for blocks of size 2^( 4) =       0.000426355123
  error estimate for blocks of size 2^( 5) =       0.000430352597
  error estimate for blocks of size 2^( 6) =       0.000433633614
  error estimate for blocks of size 2^( 7) =       0.000432692187

      target function =                  N/A
              le_mean =     -17.215778198933
             les_mean =     296.702944798311
             stat err =       0.000430758380
             autocorr =       1.159973265419
              std dev =       0.565619981450
             le_variance =       0.319925963415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007581771
                                         uncertainty =       0.006248108005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007581771
                                         uncertainty =       0.006248108005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399953505
  error estimate for blocks of size 2^( 2) =       0.000409869456
  error estimate for blocks of size 2^( 3) =       0.000419530005
  error estimate for blocks of size 2^( 4) =       0.000426354952
  error estimate for blocks of size 2^( 5) =       0.000430352433
  error estimate for blocks of size 2^( 6) =       0.000433633449
  error estimate for blocks of size 2^( 7) =       0.000432692003

      target function =                  N/A
              le_mean =     -17.215778198650
             les_mean =     296.702944437059
             stat err =       0.000430758209
             autocorr =       1.159973618245
              std dev =       0.565619670710
             le_variance =       0.319925611894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007274064
                                         uncertainty =       0.006248099782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007274064
                                         uncertainty =       0.006248099782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399953312
  error estimate for blocks of size 2^( 2) =       0.000409869282
  error estimate for blocks of size 2^( 3) =       0.000419529846
  error estimate for blocks of size 2^( 4) =       0.000426354802
  error estimate for blocks of size 2^( 5) =       0.000430352289
  error estimate for blocks of size 2^( 6) =       0.000433633304
  error estimate for blocks of size 2^( 7) =       0.000432691842

      target function =                  N/A
              le_mean =     -17.215778198404
             les_mean =     296.702944120950
             stat err =       0.000430758059
             autocorr =       1.159973927060
              std dev =       0.565619398769
             le_variance =       0.319925304264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215778198369        initial
     1.5625e+03     1.5625e+04             9.2276e-07       -17.215778198933  <--
     6.2500e+03     6.2500e+04             2.3070e-07       -17.215778198650
     2.5000e+04     2.5000e+05             5.7677e-08       -17.215778198404

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 3.3029e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0658e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2038
    reference variance = 0.20216
====================================================
  Execution time = 1.9964e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1213e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312190404402
                                         uncertainty =       0.003148065700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312190404402
                                         uncertainty =       0.003148065700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395053362
  error estimate for blocks of size 2^( 2) =       0.000405266793
  error estimate for blocks of size 2^( 3) =       0.000414596810
  error estimate for blocks of size 2^( 4) =       0.000421485166
  error estimate for blocks of size 2^( 5) =       0.000425316056
  error estimate for blocks of size 2^( 6) =       0.000426630215
  error estimate for blocks of size 2^( 7) =       0.000428728292

      target function =                  N/A
              le_mean =     -17.216370083207
             les_mean =     296.715533004068
             stat err =       0.000425539932
             autocorr =       1.160296854815
              std dev =       0.558689822886
             le_variance =       0.312134318196


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637008321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216370083207       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216370128980       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216370147330       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216370161526       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216370156052       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216370163570       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216370162213       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216370162667       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216370162830       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 3.926420e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216370083207       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216370094658       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216370099250       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216370102800       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216370101432       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216370103309       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216370102975       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216370103077       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216370103128       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 9.818743e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216370083207       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216370086070       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216370087218       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216370088106       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216370087764       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216370088236       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216370088143       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216370088191       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216370088186       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 2.454854e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5558e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.098001e-01 1 1  ON 0
 uu_1                 4.810436e-02 1 1  ON 1
 uu_2                -4.517464e-02 1 1  ON 2
 uu_3                -9.942905e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385151e-01 1 1  ON 5
 uu_6                -1.150450e-01 1 1  ON 6
 uu_7                -4.257167e-02 1 1  ON 7
 uu_8                 9.777365e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463238e-01 1 1  ON 10
 ud_1                 9.089958e-02 1 1  ON 11
 ud_2                -1.344840e-02 1 1  ON 12
 ud_3                -7.172968e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556999e-01 1 1  ON 16
 ud_7                -1.107673e-01 1 1  ON 17
 ud_8                 1.407694e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561688e-01 1 1  ON 20
 eO_1                -4.427570e-01 1 1  ON 21
 eO_2                -4.536603e-02 1 1  ON 22
 eO_3                 2.044049e-01 1 1  ON 23
 eO_4                 2.979162e-01 1 1  ON 24
 eO_5                 3.141660e-01 1 1  ON 25
 eO_6                 2.539435e-01 1 1  ON 26
 eO_7                 1.158793e-01 1 1  ON 27
 eO_8                 2.853294e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815316e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278693e-02 1 1  ON 32
eH1_3                -2.665623e-02 1 1  ON 33
eH1_4                 1.894706e-02 1 1  ON 34
eH1_5                 3.447149e-02 1 1  ON 35
eH1_6                 7.840210e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261210e-02 1 1  ON 38
eH1_9                 2.499366e-02 1 1  ON 39
eH2_0                -1.833814e-01 1 1  ON 40
eH2_1                -1.046243e-01 1 1  ON 41
eH2_2                -6.407616e-02 1 1  ON 42
eH2_3                -2.758503e-02 1 1  ON 43
eH2_4                 1.792734e-02 1 1  ON 44
eH2_5                 3.386823e-02 1 1  ON 45
eH2_6                 7.883743e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618842e-02 1 1  ON 48
eH2_9                 2.707316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2542
    reference variance = 0.460808
====================================================
  Execution time = 1.9780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1071e-01
  Total weights = 2.0000e+06
  Execution time = 1.8244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310798247994
                                         uncertainty =       0.002999280430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310798247994
                                         uncertainty =       0.002999280430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394153598
  error estimate for blocks of size 2^( 2) =       0.000404252587
  error estimate for blocks of size 2^( 3) =       0.000413253863
  error estimate for blocks of size 2^( 4) =       0.000419482976
  error estimate for blocks of size 2^( 5) =       0.000423831429
  error estimate for blocks of size 2^( 6) =       0.000426230129
  error estimate for blocks of size 2^( 7) =       0.000429143869

      target function =                  N/A
              le_mean =     -17.216798156771
             les_mean =     296.728852733090
             stat err =       0.000424672101
             autocorr =       1.160850975411
              std dev =       0.557417363783
             le_variance =       0.310714117447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310800828345
                                         uncertainty =       0.002999314753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310800828345
                                         uncertainty =       0.002999314753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394155233
  error estimate for blocks of size 2^( 2) =       0.000404254050
  error estimate for blocks of size 2^( 3) =       0.000413255174
  error estimate for blocks of size 2^( 4) =       0.000419484205
  error estimate for blocks of size 2^( 5) =       0.000423832566
  error estimate for blocks of size 2^( 6) =       0.000426231217
  error estimate for blocks of size 2^( 7) =       0.000429144918

      target function =                  N/A
              le_mean =     -17.216798144206
             les_mean =     296.728854878750
             stat err =       0.000424673226
             autocorr =       1.160847496546
              std dev =       0.557419676529
             le_variance =       0.310716695781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310799538535
                                         uncertainty =       0.002999297599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310799538535
                                         uncertainty =       0.002999297599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394154416
  error estimate for blocks of size 2^( 2) =       0.000404253319
  error estimate for blocks of size 2^( 3) =       0.000413254518
  error estimate for blocks of size 2^( 4) =       0.000419483591
  error estimate for blocks of size 2^( 5) =       0.000423831998
  error estimate for blocks of size 2^( 6) =       0.000426230673
  error estimate for blocks of size 2^( 7) =       0.000429144394

      target function =                  N/A
              le_mean =     -17.216798150469
             les_mean =     296.728853805622
             stat err =       0.000424672664
             autocorr =       1.160849234982
              std dev =       0.557418520484
             le_variance =       0.310715406979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310798409317
                                         uncertainty =       0.002999282576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310798409317
                                         uncertainty =       0.002999282576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394153700
  error estimate for blocks of size 2^( 2) =       0.000404252678
  error estimate for blocks of size 2^( 3) =       0.000413253945
  error estimate for blocks of size 2^( 4) =       0.000419483053
  error estimate for blocks of size 2^( 5) =       0.000423831500
  error estimate for blocks of size 2^( 6) =       0.000426230197
  error estimate for blocks of size 2^( 7) =       0.000429143934

      target function =                  N/A
              le_mean =     -17.216798155982
             les_mean =     296.728852867109
             stat err =       0.000424672171
             autocorr =       1.160850757821
              std dev =       0.557417508375
             le_variance =       0.310714278643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216798156771        initial  <--
     3.9062e+02     3.9062e+03             3.9264e-06       -17.216798144206
     1.5625e+03     1.5625e+04             9.8187e-07       -17.216798150469
     6.2500e+03     6.2500e+04             2.4549e-07       -17.216798155982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0022
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1638
    reference variance = 0.235514
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.5473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5011e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354825882557
                                         uncertainty =       0.029257064114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354825882557
                                         uncertainty =       0.029257064114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421147272
  error estimate for blocks of size 2^( 2) =       0.000430759309
  error estimate for blocks of size 2^( 3) =       0.000438863488
  error estimate for blocks of size 2^( 4) =       0.000445691863
  error estimate for blocks of size 2^( 5) =       0.000449188158
  error estimate for blocks of size 2^( 6) =       0.000451415071
  error estimate for blocks of size 2^( 7) =       0.000452934054

      target function =                  N/A
              le_mean =     -17.216218088741
             les_mean =     296.752895151394
             stat err =       0.000449807286
             autocorr =       1.140735582504
              std dev =       0.595592184022
             le_variance =       0.354730049668


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621808874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216218088741       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216218091969       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216218091681       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216218091901       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216218093443       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216218093299       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216218093440       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216218093403       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216218093443       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 3.999885e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216218088741       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216218089548       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216218089476       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216218089520       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216218089926       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216218089884       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216218089905       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216218089904       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216218089914       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 9.999977e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216218088741       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216218088943       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216218088925       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216218088952       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216218089054       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216218089028       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216218088980       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216218089062       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216218089007       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 2.500011e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157135 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5852e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810423e-02 1 1  ON 1
 uu_2                -4.517453e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777372e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089909e-02 1 1  ON 11
 ud_2                -1.344795e-02 1 1  ON 12
 ud_3                -7.172930e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407794e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561680e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536661e-02 1 1  ON 22
 eO_3                 2.044046e-01 1 1  ON 23
 eO_4                 2.979161e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278691e-02 1 1  ON 32
eH1_3                -2.665634e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840213e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407605e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792721e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707315e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2439
    reference variance = 0.119883
====================================================
  Execution time = 1.9692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1528e-01
  Total weights = 2.0000e+06
  Execution time = 1.8202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345622186
                                         uncertainty =       0.005362870891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345622186
                                         uncertainty =       0.005362870891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397037810
  error estimate for blocks of size 2^( 2) =       0.000406860580
  error estimate for blocks of size 2^( 3) =       0.000416444318
  error estimate for blocks of size 2^( 4) =       0.000423636196
  error estimate for blocks of size 2^( 5) =       0.000428173719
  error estimate for blocks of size 2^( 6) =       0.000430037260
  error estimate for blocks of size 2^( 7) =       0.000431564790

      target function =                  N/A
              le_mean =     -17.215753773957
             les_mean =     296.697455892434
             stat err =       0.000428352991
             autocorr =       1.163964875036
              std dev =       0.561496255165
             le_variance =       0.315278044565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345865409
                                         uncertainty =       0.005362875704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345865409
                                         uncertainty =       0.005362875704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397037963
  error estimate for blocks of size 2^( 2) =       0.000406860716
  error estimate for blocks of size 2^( 3) =       0.000416444440
  error estimate for blocks of size 2^( 4) =       0.000423636309
  error estimate for blocks of size 2^( 5) =       0.000428173833
  error estimate for blocks of size 2^( 6) =       0.000430037365
  error estimate for blocks of size 2^( 7) =       0.000431564901

      target function =                  N/A
              le_mean =     -17.215753772512
             les_mean =     296.697456085930
             stat err =       0.000428353102
             autocorr =       1.163964580007
              std dev =       0.561496471754
             le_variance =       0.315278287793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345743801
                                         uncertainty =       0.005362873298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345743801
                                         uncertainty =       0.005362873298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397037886
  error estimate for blocks of size 2^( 2) =       0.000406860648
  error estimate for blocks of size 2^( 3) =       0.000416444379
  error estimate for blocks of size 2^( 4) =       0.000423636253
  error estimate for blocks of size 2^( 5) =       0.000428173776
  error estimate for blocks of size 2^( 6) =       0.000430037312
  error estimate for blocks of size 2^( 7) =       0.000431564845

      target function =                  N/A
              le_mean =     -17.215753773234
             les_mean =     296.697455989179
             stat err =       0.000428353046
             autocorr =       1.163964727512
              std dev =       0.561496363462
             le_variance =       0.315278166181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345637388
                                         uncertainty =       0.005362871192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315345637388
                                         uncertainty =       0.005362871192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397037819
  error estimate for blocks of size 2^( 2) =       0.000406860588
  error estimate for blocks of size 2^( 3) =       0.000416444325
  error estimate for blocks of size 2^( 4) =       0.000423636203
  error estimate for blocks of size 2^( 5) =       0.000428173726
  error estimate for blocks of size 2^( 6) =       0.000430037266
  error estimate for blocks of size 2^( 7) =       0.000431564796

      target function =                  N/A
              le_mean =     -17.215753773867
             les_mean =     296.697455904527
             stat err =       0.000428352998
             autocorr =       1.163964856592
              std dev =       0.561496268703
             le_variance =       0.315278059767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215753773957        initial  <--
     3.9062e+03     3.9062e+04             3.9999e-07       -17.215753772512
     1.5625e+04     1.5625e+05             1.0000e-07       -17.215753773234
     6.2500e+04     6.2500e+05             2.5000e-08       -17.215753773867

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8803
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4738e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1685
    reference variance = 0.357972
====================================================
  Execution time = 2.0044e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2129e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398994861
                                         uncertainty =       0.005334766488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320398994861
                                         uncertainty =       0.005334766488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400803795
  error estimate for blocks of size 2^( 2) =       0.000410642083
  error estimate for blocks of size 2^( 3) =       0.000419346849
  error estimate for blocks of size 2^( 4) =       0.000426196614
  error estimate for blocks of size 2^( 5) =       0.000429573182
  error estimate for blocks of size 2^( 6) =       0.000431453687
  error estimate for blocks of size 2^( 7) =       0.000431395949

      target function =                  N/A
              le_mean =     -17.216600348002
             les_mean =     296.732614745967
             stat err =       0.000429654858
             autocorr =       1.149147572075
              std dev =       0.566822162399
             le_variance =       0.321287363786


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660034800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600348002       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216600348249       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216600348304       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216600348408       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216600348506       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216600348532       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216600348549       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216600348445       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216600348551       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 3.783856e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600348002       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216600348064       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216600348077       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216600348115       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216600348121       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216600348278       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216600348091       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216600347942       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216600348128       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 9.459665e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216600348002       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216600348017       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216600348021       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216600348027       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216600348034       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216600347621       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216600348002       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216600348047       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216600347981       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 2.364918e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5626e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172926e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407800e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536667e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447159e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.15
    reference variance = 0.311208
====================================================
  Execution time = 1.9790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1683e-01
  Total weights = 2.0000e+06
  Execution time = 1.8252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861471782
                                         uncertainty =       0.004923483155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861471782
                                         uncertainty =       0.004923483155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398013878
  error estimate for blocks of size 2^( 2) =       0.000407843497
  error estimate for blocks of size 2^( 3) =       0.000417232321
  error estimate for blocks of size 2^( 4) =       0.000424573203
  error estimate for blocks of size 2^( 5) =       0.000429451311
  error estimate for blocks of size 2^( 6) =       0.000432307999
  error estimate for blocks of size 2^( 7) =       0.000432453665

      target function =                  N/A
              le_mean =     -17.216321967886
             les_mean =     296.718572037433
             stat err =       0.000429696545
             autocorr =       1.165540294085
              std dev =       0.562876624091
             le_variance =       0.316830093948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861501154
                                         uncertainty =       0.004923483907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861501154
                                         uncertainty =       0.004923483907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398013896
  error estimate for blocks of size 2^( 2) =       0.000407843514
  error estimate for blocks of size 2^( 3) =       0.000417232336
  error estimate for blocks of size 2^( 4) =       0.000424573218
  error estimate for blocks of size 2^( 5) =       0.000429451325
  error estimate for blocks of size 2^( 6) =       0.000432308013
  error estimate for blocks of size 2^( 7) =       0.000432453679

      target function =                  N/A
              le_mean =     -17.216321967847
             les_mean =     296.718572065451
             stat err =       0.000429696559
             autocorr =       1.165540261689
              std dev =       0.562876650166
             le_variance =       0.316830123302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861486468
                                         uncertainty =       0.004923483531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861486468
                                         uncertainty =       0.004923483531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398013887
  error estimate for blocks of size 2^( 2) =       0.000407843505
  error estimate for blocks of size 2^( 3) =       0.000417232328
  error estimate for blocks of size 2^( 4) =       0.000424573210
  error estimate for blocks of size 2^( 5) =       0.000429451318
  error estimate for blocks of size 2^( 6) =       0.000432308006
  error estimate for blocks of size 2^( 7) =       0.000432453672

      target function =                  N/A
              le_mean =     -17.216321967866
             les_mean =     296.718572051442
             stat err =       0.000429696552
             autocorr =       1.165540277890
              std dev =       0.562876637129
             le_variance =       0.316830108625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861473618
                                         uncertainty =       0.004923483202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316861473618
                                         uncertainty =       0.004923483202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398013879
  error estimate for blocks of size 2^( 2) =       0.000407843498
  error estimate for blocks of size 2^( 3) =       0.000417232322
  error estimate for blocks of size 2^( 4) =       0.000424573204
  error estimate for blocks of size 2^( 5) =       0.000429451312
  error estimate for blocks of size 2^( 6) =       0.000432308000
  error estimate for blocks of size 2^( 7) =       0.000432453666

      target function =                  N/A
              le_mean =     -17.216321967883
             les_mean =     296.718572039184
             stat err =       0.000429696545
             autocorr =       1.165540292054
              std dev =       0.562876625721
             le_variance =       0.316830095783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216321967886        initial  <--
     3.9062e+04     3.9062e+05             3.7839e-08       -17.216321967847
     1.5625e+05     1.5625e+06             9.4597e-09       -17.216321967866
     6.2500e+05     6.2500e+06             2.3649e-09       -17.216321967883

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9500
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.216386
====================================================
  Execution time = 2.0077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1814e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6523e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318199622913
                                         uncertainty =       0.003678373965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318199622913
                                         uncertainty =       0.003678373965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398836549
  error estimate for blocks of size 2^( 2) =       0.000408155307
  error estimate for blocks of size 2^( 3) =       0.000417105540
  error estimate for blocks of size 2^( 4) =       0.000423838227
  error estimate for blocks of size 2^( 5) =       0.000428339694
  error estimate for blocks of size 2^( 6) =       0.000430768877
  error estimate for blocks of size 2^( 7) =       0.000432921372

      target function =                  N/A
              le_mean =     -17.217153281363
             les_mean =     296.748508141291
             stat err =       0.000428967043
             autocorr =       1.156799129036
              std dev =       0.564040057463
             le_variance =       0.318141186423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715328136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153281363       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153281394       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153281401       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153281406       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217153281041       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217153281504       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217153281609       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217153281434       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217153281262       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 3.615901e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153281363       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153281371       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153281372       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153281374       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217153280871       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217153280082       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217153281346       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217153280883       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217153281524       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 9.039758e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217153281363       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217153281365       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217153281365       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217153281403       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217153278504       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217153282795       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217153265951       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217153283234       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217153271422       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 2.259941e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5736e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1572
    reference variance = 3.61078
====================================================
  Execution time = 2.0012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1951e-01
  Total weights = 2.0000e+06
  Execution time = 1.8044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143369875
                                         uncertainty =       0.003300406235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143369875
                                         uncertainty =       0.003300406235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399694217
  error estimate for blocks of size 2^( 2) =       0.000409596210
  error estimate for blocks of size 2^( 3) =       0.000418159685
  error estimate for blocks of size 2^( 4) =       0.000425285713
  error estimate for blocks of size 2^( 5) =       0.000429189417
  error estimate for blocks of size 2^( 6) =       0.000432896517
  error estimate for blocks of size 2^( 7) =       0.000433802555

      target function =                  N/A
              le_mean =     -17.217099710733
             les_mean =     296.748033223479
             stat err =       0.000430293550
             autocorr =       1.158974669812
              std dev =       0.565252982233
             le_variance =       0.319510933924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143372337
                                         uncertainty =       0.003300406257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143372337
                                         uncertainty =       0.003300406257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399694218
  error estimate for blocks of size 2^( 2) =       0.000409596212
  error estimate for blocks of size 2^( 3) =       0.000418159686
  error estimate for blocks of size 2^( 4) =       0.000425285714
  error estimate for blocks of size 2^( 5) =       0.000429189418
  error estimate for blocks of size 2^( 6) =       0.000432896518
  error estimate for blocks of size 2^( 7) =       0.000433802556

      target function =                  N/A
              le_mean =     -17.217099710725
             les_mean =     296.748033225678
             stat err =       0.000430293552
             autocorr =       1.158974666914
              std dev =       0.565252984416
             le_variance =       0.319510936391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143371106
                                         uncertainty =       0.003300406246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143371106
                                         uncertainty =       0.003300406246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399694218
  error estimate for blocks of size 2^( 2) =       0.000409596211
  error estimate for blocks of size 2^( 3) =       0.000418159686
  error estimate for blocks of size 2^( 4) =       0.000425285713
  error estimate for blocks of size 2^( 5) =       0.000429189417
  error estimate for blocks of size 2^( 6) =       0.000432896518
  error estimate for blocks of size 2^( 7) =       0.000433802556

      target function =                  N/A
              le_mean =     -17.217099710729
             les_mean =     296.748033224579
             stat err =       0.000430293551
             autocorr =       1.158974668367
              std dev =       0.565252983325
             le_variance =       0.319510935157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143370029
                                         uncertainty =       0.003300406237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319143370029
                                         uncertainty =       0.003300406237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399694217
  error estimate for blocks of size 2^( 2) =       0.000409596211
  error estimate for blocks of size 2^( 3) =       0.000418159685
  error estimate for blocks of size 2^( 4) =       0.000425285713
  error estimate for blocks of size 2^( 5) =       0.000429189417
  error estimate for blocks of size 2^( 6) =       0.000432896517
  error estimate for blocks of size 2^( 7) =       0.000433802555

      target function =                  N/A
              le_mean =     -17.217099710732
             les_mean =     296.748033223616
             stat err =       0.000430293551
             autocorr =       1.158974669635
              std dev =       0.565252982369
             le_variance =       0.319510934078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217099710733        initial  <--
     3.9062e+05     3.9062e+06             3.6159e-09       -17.217099710725
     1.5625e+06     1.5625e+07             9.0398e-10       -17.217099710729
     6.2500e+06     6.2500e+07             2.2599e-10       -17.217099710732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1539
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4896e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1667
    reference variance = 0.208239
====================================================
  Execution time = 2.0003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308813920697
                                         uncertainty =       0.002583669792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308813920697
                                         uncertainty =       0.002583669792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392920854
  error estimate for blocks of size 2^( 2) =       0.000402291007
  error estimate for blocks of size 2^( 3) =       0.000411703370
  error estimate for blocks of size 2^( 4) =       0.000418348821
  error estimate for blocks of size 2^( 5) =       0.000422395145
  error estimate for blocks of size 2^( 6) =       0.000424691596
  error estimate for blocks of size 2^( 7) =       0.000425300156

      target function =                  N/A
              le_mean =     -17.216562149141
             les_mean =     296.718785675381
             stat err =       0.000422683930
             autocorr =       1.157234346642
              std dev =       0.555674000217
             le_variance =       0.308773594517


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656214914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562149141       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562149144       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562149145       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562149146       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562149147       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562148783       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562153429       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562150352       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562154692       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 3.855818e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562149141       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562149142       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562149142       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562149143       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562149143       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562158531       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562142899       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562148147       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562147852       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 9.639544e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216562149141       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216562149142       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216562149142       residual = 5.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216562149142       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216562148181       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216562143119       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216562163065       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216562136510       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216562170258       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 2.409887e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5558e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.18087
====================================================
  Execution time = 2.1522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1181e-01
  Total weights = 2.0000e+06
  Execution time = 1.8057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858363908
                                         uncertainty =       0.002764150443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858363908
                                         uncertainty =       0.002764150443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394846235
  error estimate for blocks of size 2^( 2) =       0.000404968116
  error estimate for blocks of size 2^( 3) =       0.000413956800
  error estimate for blocks of size 2^( 4) =       0.000420606084
  error estimate for blocks of size 2^( 5) =       0.000425006451
  error estimate for blocks of size 2^( 6) =       0.000426071341
  error estimate for blocks of size 2^( 7) =       0.000426194511

      target function =                  N/A
              le_mean =     -17.217049144084
             les_mean =     296.738588172835
             stat err =       0.000424469597
             autocorr =       1.155678874107
              std dev =       0.558396900895
             le_variance =       0.311807098929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858364183
                                         uncertainty =       0.002764150447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858364183
                                         uncertainty =       0.002764150447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394846235
  error estimate for blocks of size 2^( 2) =       0.000404968116
  error estimate for blocks of size 2^( 3) =       0.000413956801
  error estimate for blocks of size 2^( 4) =       0.000420606084
  error estimate for blocks of size 2^( 5) =       0.000425006451
  error estimate for blocks of size 2^( 6) =       0.000426071342
  error estimate for blocks of size 2^( 7) =       0.000426194511

      target function =                  N/A
              le_mean =     -17.217049144086
             les_mean =     296.738588173182
             stat err =       0.000424469597
             autocorr =       1.155678873784
              std dev =       0.558396901140
             le_variance =       0.311807099203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858364045
                                         uncertainty =       0.002764150445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858364045
                                         uncertainty =       0.002764150445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394846235
  error estimate for blocks of size 2^( 2) =       0.000404968116
  error estimate for blocks of size 2^( 3) =       0.000413956800
  error estimate for blocks of size 2^( 4) =       0.000420606084
  error estimate for blocks of size 2^( 5) =       0.000425006451
  error estimate for blocks of size 2^( 6) =       0.000426071341
  error estimate for blocks of size 2^( 7) =       0.000426194511

      target function =                  N/A
              le_mean =     -17.217049144085
             les_mean =     296.738588173008
             stat err =       0.000424469597
             autocorr =       1.155678873935
              std dev =       0.558396901017
             le_variance =       0.311807099066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858363925
                                         uncertainty =       0.002764150443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311858363925
                                         uncertainty =       0.002764150443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394846235
  error estimate for blocks of size 2^( 2) =       0.000404968116
  error estimate for blocks of size 2^( 3) =       0.000413956800
  error estimate for blocks of size 2^( 4) =       0.000420606084
  error estimate for blocks of size 2^( 5) =       0.000425006451
  error estimate for blocks of size 2^( 6) =       0.000426071341
  error estimate for blocks of size 2^( 7) =       0.000426194511

      target function =                  N/A
              le_mean =     -17.217049144084
             les_mean =     296.738588172856
             stat err =       0.000424469597
             autocorr =       1.155678874087
              std dev =       0.558396900910
             le_variance =       0.311807098946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217049144084        initial
     3.9062e+06     3.9062e+07             3.8558e-10       -17.217049144086  <--
     1.5625e+07     1.5625e+08             9.6395e-11       -17.217049144085
     6.2500e+07     6.2500e+08             2.4099e-11       -17.217049144084

*****************************************************************************
Applying the update for shift_i =   3.9062e+06     and shift_s =   3.9062e+07
*****************************************************************************

  Execution time = 3.0629e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6193e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1483
    reference variance = 0.362111
====================================================
  Execution time = 2.2466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5459e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022911465
                                         uncertainty =       0.004413652481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022911465
                                         uncertainty =       0.004413652481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400016413
  error estimate for blocks of size 2^( 2) =       0.000409932294
  error estimate for blocks of size 2^( 3) =       0.000418935677
  error estimate for blocks of size 2^( 4) =       0.000425384446
  error estimate for blocks of size 2^( 5) =       0.000429678712
  error estimate for blocks of size 2^( 6) =       0.000429616791
  error estimate for blocks of size 2^( 7) =       0.000430599310

      target function =                  N/A
              le_mean =     -17.217061179903
             les_mean =     296.747221773100
             stat err =       0.000428819815
             autocorr =       1.149195903018
              std dev =       0.565708635773
             le_variance =       0.320026260588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721706117990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061179903       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061179918       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061179924       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061180222       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061179754       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061180289       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061180410       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061179817       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217061179908       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.570479e-09

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061179903       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061179907       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061179908       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061176970       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061183241       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061178161       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061180292       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061179079       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217061181243       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 3.926198e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217061179903       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217061179904       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217061179904       residual = 5.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217061179584       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217061193467       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217061169596       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217061187271       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217061173201       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217061190130       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 9.815488e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8019e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2673
    reference variance = 0.678787
====================================================
  Execution time = 2.0452e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2033e-01
  Total weights = 2.0000e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342304
                                         uncertainty =       0.004907166012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342304
                                         uncertainty =       0.004907166012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400208297
  error estimate for blocks of size 2^( 2) =       0.000410299293
  error estimate for blocks of size 2^( 3) =       0.000418821800
  error estimate for blocks of size 2^( 4) =       0.000425458183
  error estimate for blocks of size 2^( 5) =       0.000429878384
  error estimate for blocks of size 2^( 6) =       0.000431818937
  error estimate for blocks of size 2^( 7) =       0.000433426277

      target function =                  N/A
              le_mean =     -17.217094079085
             les_mean =     296.748661730390
             stat err =       0.000430145445
             autocorr =       1.155203458337
              std dev =       0.565980001858
             le_variance =       0.320333362503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410343318
                                         uncertainty =       0.004907166021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410343318
                                         uncertainty =       0.004907166021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400208298
  error estimate for blocks of size 2^( 2) =       0.000410299294
  error estimate for blocks of size 2^( 3) =       0.000418821801
  error estimate for blocks of size 2^( 4) =       0.000425458183
  error estimate for blocks of size 2^( 5) =       0.000429878385
  error estimate for blocks of size 2^( 6) =       0.000431818938
  error estimate for blocks of size 2^( 7) =       0.000433426278

      target function =                  N/A
              le_mean =     -17.217094079095
             les_mean =     296.748661731774
             stat err =       0.000430145446
             autocorr =       1.155203457142
              std dev =       0.565980002754
             le_variance =       0.320333363518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342811
                                         uncertainty =       0.004907166017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342811
                                         uncertainty =       0.004907166017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400208298
  error estimate for blocks of size 2^( 2) =       0.000410299294
  error estimate for blocks of size 2^( 3) =       0.000418821800
  error estimate for blocks of size 2^( 4) =       0.000425458183
  error estimate for blocks of size 2^( 5) =       0.000429878384
  error estimate for blocks of size 2^( 6) =       0.000431818937
  error estimate for blocks of size 2^( 7) =       0.000433426277

      target function =                  N/A
              le_mean =     -17.217094079090
             les_mean =     296.748661731082
             stat err =       0.000430145446
             autocorr =       1.155203457741
              std dev =       0.565980002306
             le_variance =       0.320333363010

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342367
                                         uncertainty =       0.004907166013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320410342367
                                         uncertainty =       0.004907166013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400208297
  error estimate for blocks of size 2^( 2) =       0.000410299293
  error estimate for blocks of size 2^( 3) =       0.000418821800
  error estimate for blocks of size 2^( 4) =       0.000425458183
  error estimate for blocks of size 2^( 5) =       0.000429878384
  error estimate for blocks of size 2^( 6) =       0.000431818937
  error estimate for blocks of size 2^( 7) =       0.000433426277

      target function =                  N/A
              le_mean =     -17.217094079085
             les_mean =     296.748661730476
             stat err =       0.000430145445
             autocorr =       1.155203458250
              std dev =       0.565980001914
             le_variance =       0.320333362566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217094079085        initial
     9.7656e+05     9.7656e+06             1.5705e-09       -17.217094079095  <--
     3.9062e+06     3.9062e+07             3.9262e-10       -17.217094079090
     1.5625e+07     1.5625e+08             9.8155e-11       -17.217094079085

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9675e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.342882
====================================================
  Execution time = 2.0847e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2146e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321407406028
                                         uncertainty =       0.005130514116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321407406028
                                         uncertainty =       0.005130514116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400912078
  error estimate for blocks of size 2^( 2) =       0.000410773533
  error estimate for blocks of size 2^( 3) =       0.000419950907
  error estimate for blocks of size 2^( 4) =       0.000426877508
  error estimate for blocks of size 2^( 5) =       0.000430851512
  error estimate for blocks of size 2^( 6) =       0.000434151477
  error estimate for blocks of size 2^( 7) =       0.000435042173

      target function =                  N/A
              le_mean =     -17.216757913364
             les_mean =     296.738213875770
             stat err =       0.000431730667
             autocorr =       1.159651562827
              std dev =       0.566975298510
             le_variance =       0.321460989121


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675791336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757913364       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757913412       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757913423       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757913452       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216757913341       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757913335       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216757913235       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216757913475       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216757913437       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 5.999038e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757913364       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757913376       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757913379       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757913352       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216757913466       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757912627       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216757914352       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216757913146       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216757912827       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 1.499760e-09

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757913364       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757913367       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757913368       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757913368       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216757915034       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757910557       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216757906650       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216757915343       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216757906609       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 3.749406e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1224
    reference variance = 0.303848
====================================================
  Execution time = 2.0028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1149e-01
  Total weights = 2.0000e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530026018
                                         uncertainty =       0.002472084903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530026018
                                         uncertainty =       0.002472084903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643818
  error estimate for blocks of size 2^( 2) =       0.000404339707
  error estimate for blocks of size 2^( 3) =       0.000413401887
  error estimate for blocks of size 2^( 4) =       0.000419854455
  error estimate for blocks of size 2^( 5) =       0.000424046584
  error estimate for blocks of size 2^( 6) =       0.000427081158
  error estimate for blocks of size 2^( 7) =       0.000429706855

      target function =                  N/A
              le_mean =     -17.216214359483
             les_mean =     296.709524201368
             stat err =       0.000425172263
             autocorr =       1.160698015967
              std dev =       0.558110639071
             le_variance =       0.311487485444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530030633
                                         uncertainty =       0.002472084958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530030633
                                         uncertainty =       0.002472084958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643820
  error estimate for blocks of size 2^( 2) =       0.000404339709
  error estimate for blocks of size 2^( 3) =       0.000413401889
  error estimate for blocks of size 2^( 4) =       0.000419854458
  error estimate for blocks of size 2^( 5) =       0.000424046586
  error estimate for blocks of size 2^( 6) =       0.000427081160
  error estimate for blocks of size 2^( 7) =       0.000429706857

      target function =                  N/A
              le_mean =     -17.216214359454
             les_mean =     296.709524204989
             stat err =       0.000425172265
             autocorr =       1.160698010354
              std dev =       0.558110643204
             le_variance =       0.311487490058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530028326
                                         uncertainty =       0.002472084931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530028326
                                         uncertainty =       0.002472084931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643819
  error estimate for blocks of size 2^( 2) =       0.000404339708
  error estimate for blocks of size 2^( 3) =       0.000413401888
  error estimate for blocks of size 2^( 4) =       0.000419854457
  error estimate for blocks of size 2^( 5) =       0.000424046585
  error estimate for blocks of size 2^( 6) =       0.000427081159
  error estimate for blocks of size 2^( 7) =       0.000429706856

      target function =                  N/A
              le_mean =     -17.216214359469
             les_mean =     296.709524203178
             stat err =       0.000425172264
             autocorr =       1.160698013150
              std dev =       0.558110641138
             le_variance =       0.311487487751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530026306
                                         uncertainty =       0.002472084906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311530026306
                                         uncertainty =       0.002472084906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394643818
  error estimate for blocks of size 2^( 2) =       0.000404339707
  error estimate for blocks of size 2^( 3) =       0.000413401887
  error estimate for blocks of size 2^( 4) =       0.000419854456
  error estimate for blocks of size 2^( 5) =       0.000424046584
  error estimate for blocks of size 2^( 6) =       0.000427081158
  error estimate for blocks of size 2^( 7) =       0.000429706855

      target function =                  N/A
              le_mean =     -17.216214359481
             les_mean =     296.709524201594
             stat err =       0.000425172263
             autocorr =       1.160698015611
              std dev =       0.558110639329
             le_variance =       0.311487485733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216214359483        initial  <--
     2.4414e+05     2.4414e+06             5.9990e-09       -17.216214359454
     9.7656e+05     9.7656e+06             1.4998e-09       -17.216214359469
     3.9062e+06     3.9062e+07             3.7494e-10       -17.216214359481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2840
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5723e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.26448
====================================================
  Execution time = 2.0260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1127e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311232066764
                                         uncertainty =       0.002527843234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311232066764
                                         uncertainty =       0.002527843234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394507065
  error estimate for blocks of size 2^( 2) =       0.000405088915
  error estimate for blocks of size 2^( 3) =       0.000414415058
  error estimate for blocks of size 2^( 4) =       0.000421129902
  error estimate for blocks of size 2^( 5) =       0.000424940895
  error estimate for blocks of size 2^( 6) =       0.000427421770
  error estimate for blocks of size 2^( 7) =       0.000429325649

      target function =                  N/A
              le_mean =     -17.216512534553
             les_mean =     296.719575345683
             stat err =       0.000425704554
             autocorr =       1.164412935054
              std dev =       0.557917241993
             le_variance =       0.311271648914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651253455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512534553       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512534555       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216512534557       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216512534518       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216512536337       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216512533441       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216512534059       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216512535188       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216512534512       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 6.020584e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512534553       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512534553       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216512534554       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216512534663       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216512539399       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216512535945       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216512535254       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216512538821       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216512528525       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 1.505144e-10

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216512534553       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216512534553       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216512534553       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216512535620       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216512551122       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216512562636       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216512528345       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216512561865       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216512514616       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 3.762834e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5788e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2009
    reference variance = 0.276919
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2490e-01
  Total weights = 2.0000e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802468
                                         uncertainty =       0.006139727653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802468
                                         uncertainty =       0.006139727653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403048169
  error estimate for blocks of size 2^( 2) =       0.000413002045
  error estimate for blocks of size 2^( 3) =       0.000422020837
  error estimate for blocks of size 2^( 4) =       0.000428284279
  error estimate for blocks of size 2^( 5) =       0.000432709709
  error estimate for blocks of size 2^( 6) =       0.000434919507
  error estimate for blocks of size 2^( 7) =       0.000435814253

      target function =                  N/A
              le_mean =     -17.216337761759
             les_mean =     296.727181418121
             stat err =       0.000432931937
             autocorr =       1.153786207671
              std dev =       0.569996187358
             le_variance =       0.324895653602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802902
                                         uncertainty =       0.006139727664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802902
                                         uncertainty =       0.006139727664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403048170
  error estimate for blocks of size 2^( 2) =       0.000413002045
  error estimate for blocks of size 2^( 3) =       0.000422020837
  error estimate for blocks of size 2^( 4) =       0.000428284279
  error estimate for blocks of size 2^( 5) =       0.000432709709
  error estimate for blocks of size 2^( 6) =       0.000434919507
  error estimate for blocks of size 2^( 7) =       0.000435814253

      target function =                  N/A
              le_mean =     -17.216337761757
             les_mean =     296.727181418488
             stat err =       0.000432931937
             autocorr =       1.153786207147
              std dev =       0.569996187738
             le_variance =       0.324895654036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802685
                                         uncertainty =       0.006139727659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802685
                                         uncertainty =       0.006139727659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403048169
  error estimate for blocks of size 2^( 2) =       0.000413002045
  error estimate for blocks of size 2^( 3) =       0.000422020837
  error estimate for blocks of size 2^( 4) =       0.000428284279
  error estimate for blocks of size 2^( 5) =       0.000432709709
  error estimate for blocks of size 2^( 6) =       0.000434919507
  error estimate for blocks of size 2^( 7) =       0.000435814253

      target function =                  N/A
              le_mean =     -17.216337761758
             les_mean =     296.727181418304
             stat err =       0.000432931937
             autocorr =       1.153786207405
              std dev =       0.569996187548
             le_variance =       0.324895653819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802495
                                         uncertainty =       0.006139727654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324960802495
                                         uncertainty =       0.006139727654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403048169
  error estimate for blocks of size 2^( 2) =       0.000413002045
  error estimate for blocks of size 2^( 3) =       0.000422020837
  error estimate for blocks of size 2^( 4) =       0.000428284279
  error estimate for blocks of size 2^( 5) =       0.000432709709
  error estimate for blocks of size 2^( 6) =       0.000434919507
  error estimate for blocks of size 2^( 7) =       0.000435814253

      target function =                  N/A
              le_mean =     -17.216337761759
             les_mean =     296.727181418144
             stat err =       0.000432931937
             autocorr =       1.153786207636
              std dev =       0.569996187381
             le_variance =       0.324895653629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216337761759        initial  <--
     2.4414e+06     2.4414e+07             6.0206e-10       -17.216337761757
     9.7656e+06     9.7656e+07             1.5051e-10       -17.216337761758
     3.9062e+07     3.9062e+08             3.7628e-11       -17.216337761759

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3249
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.141964
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318074231218
                                         uncertainty =       0.005059494335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318074231218
                                         uncertainty =       0.005059494335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398763286
  error estimate for blocks of size 2^( 2) =       0.000408223612
  error estimate for blocks of size 2^( 3) =       0.000417552127
  error estimate for blocks of size 2^( 4) =       0.000424699219
  error estimate for blocks of size 2^( 5) =       0.000428151355
  error estimate for blocks of size 2^( 6) =       0.000429427416
  error estimate for blocks of size 2^( 7) =       0.000430829024

      target function =                  N/A
              le_mean =     -17.216535298660
             les_mean =     296.727111846888
             stat err =       0.000428276754
             autocorr =       1.153502851717
              std dev =       0.563936446681
             le_variance =       0.318024315895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653529866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535298660       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535298660       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535298661       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535298953       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535299539       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535294340       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535305412       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535284872       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216535295638       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.154200e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535298660       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535298660       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535298660       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535298660       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535298660       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535331652       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535339111       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535297936       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216535388039       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.538530e-11

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216535298660       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216535298660       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216535298660       residual = 5.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216535298660       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216535298660       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216535306279       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216535336925       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216535294863       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216534951835       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 3.846334e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5984e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.22844
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1705e-01
  Total weights = 2.0000e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983678
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983678
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154083
  error estimate for blocks of size 2^( 2) =       0.000408289942
  error estimate for blocks of size 2^( 3) =       0.000416675957
  error estimate for blocks of size 2^( 4) =       0.000422738338
  error estimate for blocks of size 2^( 5) =       0.000428088693
  error estimate for blocks of size 2^( 6) =       0.000431551582
  error estimate for blocks of size 2^( 7) =       0.000432214607

      target function =                  N/A
              le_mean =     -17.217036533022
             les_mean =     296.743400168553
             stat err =       0.000428648305
             autocorr =       1.159043869428
              std dev =       0.563074904120
             le_variance =       0.317053347650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983718
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983718
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154083
  error estimate for blocks of size 2^( 2) =       0.000408289942
  error estimate for blocks of size 2^( 3) =       0.000416675957
  error estimate for blocks of size 2^( 4) =       0.000422738338
  error estimate for blocks of size 2^( 5) =       0.000428088693
  error estimate for blocks of size 2^( 6) =       0.000431551582
  error estimate for blocks of size 2^( 7) =       0.000432214607

      target function =                  N/A
              le_mean =     -17.217036533022
             les_mean =     296.743400168593
             stat err =       0.000428648305
             autocorr =       1.159043869374
              std dev =       0.563074904155
             le_variance =       0.317053347689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983698
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983698
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154083
  error estimate for blocks of size 2^( 2) =       0.000408289942
  error estimate for blocks of size 2^( 3) =       0.000416675957
  error estimate for blocks of size 2^( 4) =       0.000422738338
  error estimate for blocks of size 2^( 5) =       0.000428088693
  error estimate for blocks of size 2^( 6) =       0.000431551582
  error estimate for blocks of size 2^( 7) =       0.000432214607

      target function =                  N/A
              le_mean =     -17.217036533022
             les_mean =     296.743400168573
             stat err =       0.000428648305
             autocorr =       1.159043869392
              std dev =       0.563074904137
             le_variance =       0.317053347669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983681
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317055983681
                                         uncertainty =       0.004375733248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154083
  error estimate for blocks of size 2^( 2) =       0.000408289942
  error estimate for blocks of size 2^( 3) =       0.000416675957
  error estimate for blocks of size 2^( 4) =       0.000422738338
  error estimate for blocks of size 2^( 5) =       0.000428088693
  error estimate for blocks of size 2^( 6) =       0.000431551582
  error estimate for blocks of size 2^( 7) =       0.000432214607

      target function =                  N/A
              le_mean =     -17.217036533022
             les_mean =     296.743400168556
             stat err =       0.000428648305
             autocorr =       1.159043869423
              std dev =       0.563074904122
             le_variance =       0.317053347652


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217036533022        initial
     2.4414e+07     2.4414e+08             6.1542e-11       -17.217036533022
     9.7656e+07     9.7656e+08             1.5385e-11       -17.217036533022  <--
     3.9062e+08     3.9062e+09             3.8463e-12       -17.217036533022

*****************************************************************************
Applying the update for shift_i =   9.7656e+07     and shift_s =   9.7656e+08
*****************************************************************************

  Execution time = 2.9504e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.666796
====================================================
  Execution time = 2.0631e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1845e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317985899034
                                         uncertainty =       0.004740242809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317985899034
                                         uncertainty =       0.004740242809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399031136
  error estimate for blocks of size 2^( 2) =       0.000408992742
  error estimate for blocks of size 2^( 3) =       0.000417489006
  error estimate for blocks of size 2^( 4) =       0.000424246000
  error estimate for blocks of size 2^( 5) =       0.000428218999
  error estimate for blocks of size 2^( 6) =       0.000430018411
  error estimate for blocks of size 2^( 7) =       0.000430369414

      target function =                  N/A
              le_mean =     -17.216169783501
             les_mean =     296.714953549933
             stat err =       0.000428213206
             autocorr =       1.151612962449
              std dev =       0.564315244201
             le_variance =       0.318451694837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616978350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169783501       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169783501       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216169783501       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216169770675       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216169788365       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216169783502       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216169777820       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216169778011       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216169801619       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 6.494472e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169783501       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169783501       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216169783501       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216169807630       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216169809569       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216169748199       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216169741324       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216169831557       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216169733278       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 1.623631e-11

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216169783501       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216169783501       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216169783501       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216169783501       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216169848034       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216169680684       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216169885679       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216169990201       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216169940111       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+08 is 4.059029e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181727 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6198e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2533
    reference variance = 0.211217
====================================================
  Execution time = 1.9543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1245e-01
  Total weights = 2.0000e+06
  Execution time = 1.8090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514395
                                         uncertainty =       0.005372416760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514395
                                         uncertainty =       0.005372416760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395251859
  error estimate for blocks of size 2^( 2) =       0.000405298763
  error estimate for blocks of size 2^( 3) =       0.000414184813
  error estimate for blocks of size 2^( 4) =       0.000421055830
  error estimate for blocks of size 2^( 5) =       0.000425255080
  error estimate for blocks of size 2^( 6) =       0.000427323036
  error estimate for blocks of size 2^( 7) =       0.000429144547

      target function =                  N/A
              le_mean =     -17.216912471856
             les_mean =     296.734522972104
             stat err =       0.000425694623
             autocorr =       1.159974617175
              std dev =       0.558970540170
             le_variance =       0.312448064778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514438
                                         uncertainty =       0.005372416762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514438
                                         uncertainty =       0.005372416762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395251859
  error estimate for blocks of size 2^( 2) =       0.000405298763
  error estimate for blocks of size 2^( 3) =       0.000414184813
  error estimate for blocks of size 2^( 4) =       0.000421055830
  error estimate for blocks of size 2^( 5) =       0.000425255080
  error estimate for blocks of size 2^( 6) =       0.000427323036
  error estimate for blocks of size 2^( 7) =       0.000429144547

      target function =                  N/A
              le_mean =     -17.216912471856
             les_mean =     296.734522972143
             stat err =       0.000425694623
             autocorr =       1.159974617129
              std dev =       0.558970540208
             le_variance =       0.312448064820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514417
                                         uncertainty =       0.005372416761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514417
                                         uncertainty =       0.005372416761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395251859
  error estimate for blocks of size 2^( 2) =       0.000405298763
  error estimate for blocks of size 2^( 3) =       0.000414184813
  error estimate for blocks of size 2^( 4) =       0.000421055830
  error estimate for blocks of size 2^( 5) =       0.000425255080
  error estimate for blocks of size 2^( 6) =       0.000427323036
  error estimate for blocks of size 2^( 7) =       0.000429144547

      target function =                  N/A
              le_mean =     -17.216912471856
             les_mean =     296.734522972124
             stat err =       0.000425694623
             autocorr =       1.159974617142
              std dev =       0.558970540189
             le_variance =       0.312448064799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514398
                                         uncertainty =       0.005372416761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312368514398
                                         uncertainty =       0.005372416761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395251859
  error estimate for blocks of size 2^( 2) =       0.000405298763
  error estimate for blocks of size 2^( 3) =       0.000414184813
  error estimate for blocks of size 2^( 4) =       0.000421055830
  error estimate for blocks of size 2^( 5) =       0.000425255080
  error estimate for blocks of size 2^( 6) =       0.000427323036
  error estimate for blocks of size 2^( 7) =       0.000429144547

      target function =                  N/A
              le_mean =     -17.216912471856
             les_mean =     296.734522972107
             stat err =       0.000425694623
             autocorr =       1.159974617162
              std dev =       0.558970540172
             le_variance =       0.312448064781


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216912471856        initial  <--
     2.4414e+07     2.4414e+08             6.4945e-11       -17.216912471856
     9.7656e+07     9.7656e+08             1.6236e-11       -17.216912471856
     3.9062e+08     3.9062e+09             4.0590e-12       -17.216912471856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8639
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8070e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.305024
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5473e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308669150282
                                         uncertainty =       0.002756999897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308669150282
                                         uncertainty =       0.002756999897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392899586
  error estimate for blocks of size 2^( 2) =       0.000402805397
  error estimate for blocks of size 2^( 3) =       0.000412242739
  error estimate for blocks of size 2^( 4) =       0.000419186070
  error estimate for blocks of size 2^( 5) =       0.000423794888
  error estimate for blocks of size 2^( 6) =       0.000426779620
  error estimate for blocks of size 2^( 7) =       0.000427640738

      target function =                  N/A
              le_mean =     -17.216307108123
             les_mean =     296.709970456861
             stat err =       0.000424350329
             autocorr =       1.166503221957
              std dev =       0.555643923773
             le_variance =       0.308740170026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630710812e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307108123       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307108123       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307108123       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307157120       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307108123       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216307054902       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216306959010       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216307280939       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307332132       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 6.048873e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307108123       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307108123       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307108123       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216307121014       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216307104509       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216306845790       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216306682469       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216305831606       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216306984367       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 1.512325e-12

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216307108123       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216307108123       residual = 9.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216307108123       residual = 5.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216308587033       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309227778       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216304748126       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216305016888       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216304203473       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216307246121       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+09 is 3.780836e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184760 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5807e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2776
    reference variance = 0.37648
====================================================
  Execution time = 2.1465e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1226e-01
  Total weights = 2.0000e+06
  Execution time = 1.8113e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665388
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665388
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395130024
  error estimate for blocks of size 2^( 2) =       0.000405060583
  error estimate for blocks of size 2^( 3) =       0.000414317271
  error estimate for blocks of size 2^( 4) =       0.000421170459
  error estimate for blocks of size 2^( 5) =       0.000425011812
  error estimate for blocks of size 2^( 6) =       0.000426871084
  error estimate for blocks of size 2^( 7) =       0.000428528254

      target function =                  N/A
              le_mean =     -17.216415510742
             les_mean =     296.717218354222
             stat err =       0.000425395402
             autocorr =       1.159058941400
              std dev =       0.558798238918
             le_variance =       0.312255471818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665392
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665392
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395130024
  error estimate for blocks of size 2^( 2) =       0.000405060583
  error estimate for blocks of size 2^( 3) =       0.000414317271
  error estimate for blocks of size 2^( 4) =       0.000421170459
  error estimate for blocks of size 2^( 5) =       0.000425011812
  error estimate for blocks of size 2^( 6) =       0.000426871084
  error estimate for blocks of size 2^( 7) =       0.000428528254

      target function =                  N/A
              le_mean =     -17.216415510742
             les_mean =     296.717218354226
             stat err =       0.000425395402
             autocorr =       1.159058941400
              std dev =       0.558798238922
             le_variance =       0.312255471822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665390
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665390
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395130024
  error estimate for blocks of size 2^( 2) =       0.000405060583
  error estimate for blocks of size 2^( 3) =       0.000414317271
  error estimate for blocks of size 2^( 4) =       0.000421170459
  error estimate for blocks of size 2^( 5) =       0.000425011812
  error estimate for blocks of size 2^( 6) =       0.000426871084
  error estimate for blocks of size 2^( 7) =       0.000428528254

      target function =                  N/A
              le_mean =     -17.216415510742
             les_mean =     296.717218354224
             stat err =       0.000425395402
             autocorr =       1.159058941396
              std dev =       0.558798238920
             le_variance =       0.312255471820

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665388
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312229665388
                                         uncertainty =       0.002623152692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395130024
  error estimate for blocks of size 2^( 2) =       0.000405060583
  error estimate for blocks of size 2^( 3) =       0.000414317271
  error estimate for blocks of size 2^( 4) =       0.000421170459
  error estimate for blocks of size 2^( 5) =       0.000425011812
  error estimate for blocks of size 2^( 6) =       0.000426871084
  error estimate for blocks of size 2^( 7) =       0.000428528254

      target function =                  N/A
              le_mean =     -17.216415510742
             les_mean =     296.717218354223
             stat err =       0.000425395402
             autocorr =       1.159058941397
              std dev =       0.558798238918
             le_variance =       0.312255471818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216415510742        initial  <--
     2.4414e+08     2.4414e+09             6.0489e-12       -17.216415510742
     9.7656e+08     9.7656e+09             1.5123e-12       -17.216415510742
     3.9062e+09     3.9062e+10             3.7808e-13       -17.216415510742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5978
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6411e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2515
    reference variance = 0.170406
====================================================
  Execution time = 1.9894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0936e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309324339603
                                         uncertainty =       0.002743132378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309324339603
                                         uncertainty =       0.002743132378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393296043
  error estimate for blocks of size 2^( 2) =       0.000403340909
  error estimate for blocks of size 2^( 3) =       0.000412203359
  error estimate for blocks of size 2^( 4) =       0.000418895537
  error estimate for blocks of size 2^( 5) =       0.000421833339
  error estimate for blocks of size 2^( 6) =       0.000424390628
  error estimate for blocks of size 2^( 7) =       0.000427021550

      target function =                  N/A
              le_mean =     -17.216688893266
             les_mean =     296.723739847346
             stat err =       0.000423035263
             autocorr =       1.156948394995
              std dev =       0.556204597725
             le_variance =       0.309363554530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668889327e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688893266       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688893266       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216688893266       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216688904961       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216687570992       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216688757546       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216687725484       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216688998412       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216690500986       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 5.993639e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688893266       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688893266       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216688893266       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216688893266       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694716688       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216692005390       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216689870350       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216695550953       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216691419131       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 1.494782e-13

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688893266       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688893266       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216688893266       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216695930480       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216638535838       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216690917891       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216706157018       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506372035       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216652816474       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216508722200       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216961187716       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217003386875       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216434944809       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217607068358       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.218256227221       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216510625784       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215846052369       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.214623882608       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214348008269       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.210025662596       residual = 6.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.212412236478       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215242330676       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.218833104529       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.214805592395       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.219743729386       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.222957171947       residual = 6.37e-03           smallest_sin_value = 9.99e-01
davidson iteration   26:   krylov dim =  27   energy =     -17.216100519607       residual = 4.84e-04           smallest_sin_value = 9.98e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 3.572871e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.197310 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5651e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.320219
====================================================
  Execution time = 1.9626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1108e-01
  Total weights = 2.0000e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394383885
  error estimate for blocks of size 2^( 2) =       0.000404465980
  error estimate for blocks of size 2^( 3) =       0.000413827274
  error estimate for blocks of size 2^( 4) =       0.000419885499
  error estimate for blocks of size 2^( 5) =       0.000424160085
  error estimate for blocks of size 2^( 6) =       0.000425678954
  error estimate for blocks of size 2^( 7) =       0.000425648069

      target function =                  N/A
              le_mean =     -17.216186683973
             les_mean =     296.708161079163
             stat err =       0.000423843152
             autocorr =       1.154973499422
              std dev =       0.557743038757
             le_variance =       0.311077297282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394383885
  error estimate for blocks of size 2^( 2) =       0.000404465980
  error estimate for blocks of size 2^( 3) =       0.000413827274
  error estimate for blocks of size 2^( 4) =       0.000419885499
  error estimate for blocks of size 2^( 5) =       0.000424160085
  error estimate for blocks of size 2^( 6) =       0.000425678954
  error estimate for blocks of size 2^( 7) =       0.000425648069

      target function =                  N/A
              le_mean =     -17.216186683973
             les_mean =     296.708161079164
             stat err =       0.000423843152
             autocorr =       1.154973499419
              std dev =       0.557743038757
             le_variance =       0.311077297282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394383885
  error estimate for blocks of size 2^( 2) =       0.000404465980
  error estimate for blocks of size 2^( 3) =       0.000413827274
  error estimate for blocks of size 2^( 4) =       0.000419885499
  error estimate for blocks of size 2^( 5) =       0.000424160085
  error estimate for blocks of size 2^( 6) =       0.000425678954
  error estimate for blocks of size 2^( 7) =       0.000425648069

      target function =                  N/A
              le_mean =     -17.216186683973
             les_mean =     296.708161079164
             stat err =       0.000423843152
             autocorr =       1.154973499412
              std dev =       0.557743038757
             le_variance =       0.311077297282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311117317467
                                         uncertainty =       0.002661215617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394383885
  error estimate for blocks of size 2^( 2) =       0.000404465980
  error estimate for blocks of size 2^( 3) =       0.000413827274
  error estimate for blocks of size 2^( 4) =       0.000419885499
  error estimate for blocks of size 2^( 5) =       0.000424160085
  error estimate for blocks of size 2^( 6) =       0.000425678954
  error estimate for blocks of size 2^( 7) =       0.000425648069

      target function =                  N/A
              le_mean =     -17.216186683973
             les_mean =     296.708161079163
             stat err =       0.000423843152
             autocorr =       1.154973499419
              std dev =       0.557743038757
             le_variance =       0.311077297282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216186683973        initial  <--
     2.4414e+09     2.4414e+10             5.9936e-13       -17.216186683973
     9.7656e+09     9.7656e+10             1.4948e-13       -17.216186683973
     3.9062e+10     3.9062e+11             3.5729e-14       -17.216186683973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0376
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4695e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.220514
====================================================
  Execution time = 2.0042e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1646e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316350361329
                                         uncertainty =       0.005175692560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316350361329
                                         uncertainty =       0.005175692560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397781952
  error estimate for blocks of size 2^( 2) =       0.000407624524
  error estimate for blocks of size 2^( 3) =       0.000416593833
  error estimate for blocks of size 2^( 4) =       0.000422617509
  error estimate for blocks of size 2^( 5) =       0.000427013535
  error estimate for blocks of size 2^( 6) =       0.000427765900
  error estimate for blocks of size 2^( 7) =       0.000429559693

      target function =                  N/A
              le_mean =     -17.217041184351
             les_mean =     296.742967947495
             stat err =       0.000426739159
             autocorr =       1.150892728644
              std dev =       0.562548630853
             le_variance =       0.316460962075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704118435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041184351       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041184351       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041184351       residual = 4.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217041672295       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217041184351       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217041185064       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217044575092       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217054184237       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216867152740       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217062128111       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216951221698       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217027222492       residual = 4.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216808212408       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217447045535       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217305780879       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217102312783       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216193655625       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216381427129       residual = 7.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217023205859       residual = 7.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.218368347245       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217597034753       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215730207787       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215463203481       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213979105949       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.212373382573       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.211638713673       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.211860824523       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.194010008037       residual = 8.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.224006411400       residual = 9.41e-03           smallest_sin_value = 9.98e-01
davidson iteration   29:   krylov dim =  30   energy =     -17.213975542241       residual = 1.58e-03           smallest_sin_value = 9.90e-01
davidson iteration   30 stopping due to small subspace S singular value of 8.49e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 5.995446e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041184351       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041184351       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041184351       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217041184351       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217047896863       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217050758394       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217017209871       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217000253660       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217006756715       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217002540855       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217289932097       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216338679448       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216503823260       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216109894089       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.218047969352       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218243186873       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.212986463588       residual = 2.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.203145520116       residual = 2.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217944297892       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.186640536537       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.232511785904       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.191182763641       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.215036804154       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.218371830312       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.278818866752       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.230234351104       residual = 2.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.397180788761       residual = 5.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.156074088108       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.193933066554       residual = 7.89e-02           smallest_sin_value = 9.96e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 1.576644e-14

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217041184351       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217041184351       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217041184351       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217136347702       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217101216449       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217233181562       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216967605522       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218370683656       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.219220423356       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216204210228       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218118575324       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215318476829       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219888913553       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.221290927479       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.225901072267       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.235159468758       residual = 5.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.227925244246       residual = 1.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.203533332602       residual = 2.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.246863961276       residual = 1.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.242703276686       residual = 1.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.232378811023       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.239092090675       residual = 9.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.155579496545       residual = 6.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.125838798341       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.228263992852       residual = 2.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.923758785463       residual = 1.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.103932028833       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.189048392056       residual = 1.79e-01           smallest_sin_value = 9.95e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.14e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 2.801289e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230636 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5653e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2661
    reference variance = 0.260342
====================================================
  Execution time = 1.9410e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1285e-01
  Total weights = 2.0000e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395506576
  error estimate for blocks of size 2^( 2) =       0.000405352685
  error estimate for blocks of size 2^( 3) =       0.000414524937
  error estimate for blocks of size 2^( 4) =       0.000420934190
  error estimate for blocks of size 2^( 5) =       0.000424676697
  error estimate for blocks of size 2^( 6) =       0.000426412366
  error estimate for blocks of size 2^( 7) =       0.000429199358

      target function =                  N/A
              le_mean =     -17.216156729109
             les_mean =     296.708903268237
             stat err =       0.000425305653
             autocorr =       1.156364877075
              std dev =       0.559330763868
             le_variance =       0.312850903409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395506576
  error estimate for blocks of size 2^( 2) =       0.000405352685
  error estimate for blocks of size 2^( 3) =       0.000414524937
  error estimate for blocks of size 2^( 4) =       0.000420934190
  error estimate for blocks of size 2^( 5) =       0.000424676697
  error estimate for blocks of size 2^( 6) =       0.000426412366
  error estimate for blocks of size 2^( 7) =       0.000429199358

      target function =                  N/A
              le_mean =     -17.216156729109
             les_mean =     296.708903268237
             stat err =       0.000425305653
             autocorr =       1.156364877080
              std dev =       0.559330763868
             le_variance =       0.312850903409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395506576
  error estimate for blocks of size 2^( 2) =       0.000405352685
  error estimate for blocks of size 2^( 3) =       0.000414524937
  error estimate for blocks of size 2^( 4) =       0.000420934190
  error estimate for blocks of size 2^( 5) =       0.000424676697
  error estimate for blocks of size 2^( 6) =       0.000426412366
  error estimate for blocks of size 2^( 7) =       0.000429199358

      target function =                  N/A
              le_mean =     -17.216156729109
             les_mean =     296.708903268237
             stat err =       0.000425305653
             autocorr =       1.156364877069
              std dev =       0.559330763868
             le_variance =       0.312850903409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312844913070
                                         uncertainty =       0.004638010168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395506576
  error estimate for blocks of size 2^( 2) =       0.000405352685
  error estimate for blocks of size 2^( 3) =       0.000414524937
  error estimate for blocks of size 2^( 4) =       0.000420934190
  error estimate for blocks of size 2^( 5) =       0.000424676697
  error estimate for blocks of size 2^( 6) =       0.000426412366
  error estimate for blocks of size 2^( 7) =       0.000429199358

      target function =                  N/A
              le_mean =     -17.216156729109
             les_mean =     296.708903268237
             stat err =       0.000425305653
             autocorr =       1.156364877081
              std dev =       0.559330763868
             le_variance =       0.312850903409


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216156729109        initial  <--
     2.4414e+10     2.4414e+11             5.9954e-14       -17.216156729109
     9.7656e+10     9.7656e+11             1.5766e-14       -17.216156729109
     3.9062e+11     3.9062e+12             2.8013e-15       -17.216156729109

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6136
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4274e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1851
    reference variance = 0.196429
====================================================
  Execution time = 1.9989e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0962e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309744547469
                                         uncertainty =       0.002823284319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309744547469
                                         uncertainty =       0.002823284319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393461031
  error estimate for blocks of size 2^( 2) =       0.000403378613
  error estimate for blocks of size 2^( 3) =       0.000412399848
  error estimate for blocks of size 2^( 4) =       0.000419167079
  error estimate for blocks of size 2^( 5) =       0.000422751671
  error estimate for blocks of size 2^( 6) =       0.000425615570
  error estimate for blocks of size 2^( 7) =       0.000426276509

      target function =                  N/A
              le_mean =     -17.217012605706
             les_mean =     296.735146076258
             stat err =       0.000423452707
             autocorr =       1.158260845529
              std dev =       0.556437926495
             le_variance =       0.309623166042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701260571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012605706       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012605706       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012605706       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217138663265       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216852420497       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215719565223       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217513765779       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217030152217       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216608600390       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216898363783       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216810114274       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215529853743       residual = 3.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219489168730       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216787203663       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216335532587       residual = 6.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.219542102129       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.210850070953       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.223331161791       residual = 7.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.198776954371       residual = 5.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200253516838       residual = 4.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219902583980       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.206942509448       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.192625334444       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.188298154382       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.210441243316       residual = 5.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.147562900716       residual = 7.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.283653054990       residual = 6.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.168321041445       residual = 3.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.209036834516       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.002465875330       residual = 7.17e+00           smallest_sin_value = 9.99e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 5.754966e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012605706       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012605706       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012605706       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217012567817       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217014425526       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216972926772       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217247331188       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216862544225       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214453276703       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215586401605       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215584496865       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.209020187291       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.205737146556       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.239287712477       residual = 7.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217609951573       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.143491545914       residual = 7.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.178083225825       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.318791257379       residual = 1.49e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.294389709189       residual = 8.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.282453972029       residual = 6.38e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.227529701081       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.355901606227       residual = 2.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.877155425087       residual = 1.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.727712863556       residual = 4.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.719627258387       residual = 3.87e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.797877098759       residual = 2.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.890308204564       residual = 1.63e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.160623900617       residual = 5.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.982259397306       residual = 8.32e+00           smallest_sin_value = 9.99e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 1.157678e-15

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217012605706       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012605706       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012605706       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217012605706       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216545392866       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210186027291       residual = 5.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216254421333       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215477637308       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.226001374394       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.203568774271       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.201635690960       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.171366569142       residual = 3.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.159836545692       residual = 5.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.278261356144       residual = 6.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.197052297738       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.190100610016       residual = 1.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.209595313533       residual = 4.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.456353649672       residual = 8.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.654476751940       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.944370418679       residual = 1.15e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.883001378511       residual = 1.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.068891082035       residual = 3.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.844833560274       residual = 2.13e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.461403379320       residual = 9.62e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.611459767821       residual = 2.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.299406112309       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -15.675633200536       residual = 3.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -15.537604144995       residual = 4.38e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.775567417448       residual = 7.44e+01           smallest_sin_value = 9.98e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.63e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 2.198260e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5536e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2707
    reference variance = 0.258859
====================================================
  Execution time = 1.9674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1417e-01
  Total weights = 2.0000e+06
  Execution time = 1.8149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396341551
  error estimate for blocks of size 2^( 2) =       0.000406097604
  error estimate for blocks of size 2^( 3) =       0.000415308012
  error estimate for blocks of size 2^( 4) =       0.000422051783
  error estimate for blocks of size 2^( 5) =       0.000426448935
  error estimate for blocks of size 2^( 6) =       0.000429159387
  error estimate for blocks of size 2^( 7) =       0.000429140450

      target function =                  N/A
              le_mean =     -17.215928371660
             les_mean =     296.702362790988
             stat err =       0.000426700139
             autocorr =       1.159061177652
              std dev =       0.560511596624
             le_variance =       0.314173249950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396341551
  error estimate for blocks of size 2^( 2) =       0.000406097604
  error estimate for blocks of size 2^( 3) =       0.000415308012
  error estimate for blocks of size 2^( 4) =       0.000422051783
  error estimate for blocks of size 2^( 5) =       0.000426448935
  error estimate for blocks of size 2^( 6) =       0.000429159387
  error estimate for blocks of size 2^( 7) =       0.000429140450

      target function =                  N/A
              le_mean =     -17.215928371660
             les_mean =     296.702362790988
             stat err =       0.000426700139
             autocorr =       1.159061177645
              std dev =       0.560511596624
             le_variance =       0.314173249950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396341551
  error estimate for blocks of size 2^( 2) =       0.000406097604
  error estimate for blocks of size 2^( 3) =       0.000415308012
  error estimate for blocks of size 2^( 4) =       0.000422051783
  error estimate for blocks of size 2^( 5) =       0.000426448935
  error estimate for blocks of size 2^( 6) =       0.000429159387
  error estimate for blocks of size 2^( 7) =       0.000429140450

      target function =                  N/A
              le_mean =     -17.215928371660
             les_mean =     296.702362790988
             stat err =       0.000426700139
             autocorr =       1.159061177648
              std dev =       0.560511596624
             le_variance =       0.314173249950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314262554501
                                         uncertainty =       0.002980997376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396341551
  error estimate for blocks of size 2^( 2) =       0.000406097604
  error estimate for blocks of size 2^( 3) =       0.000415308012
  error estimate for blocks of size 2^( 4) =       0.000422051783
  error estimate for blocks of size 2^( 5) =       0.000426448935
  error estimate for blocks of size 2^( 6) =       0.000429159387
  error estimate for blocks of size 2^( 7) =       0.000429140450

      target function =                  N/A
              le_mean =     -17.215928371660
             les_mean =     296.702362790988
             stat err =       0.000426700139
             autocorr =       1.159061177651
              std dev =       0.560511596624
             le_variance =       0.314173249950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215928371660        initial  <--
     2.4414e+11     2.4414e+12             5.7550e-15       -17.215928371660
     9.7656e+11     9.7656e+12             1.1577e-15       -17.215928371660
     3.9062e+12     3.9062e+13             2.1983e-16       -17.215928371660

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8398
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4382e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.22745
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313961602050
                                         uncertainty =       0.003800556099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313961602050
                                         uncertainty =       0.003800556099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396175232
  error estimate for blocks of size 2^( 2) =       0.000405742452
  error estimate for blocks of size 2^( 3) =       0.000414984711
  error estimate for blocks of size 2^( 4) =       0.000421977214
  error estimate for blocks of size 2^( 5) =       0.000425825300
  error estimate for blocks of size 2^( 6) =       0.000429212180
  error estimate for blocks of size 2^( 7) =       0.000429757279

      target function =                  N/A
              le_mean =     -17.216727769924
             les_mean =     296.729624574986
             stat err =       0.000426692993
             autocorr =       1.159995706314
              std dev =       0.560276385605
             le_variance =       0.313909628267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672776992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727769924       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727769924       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216727769924       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216655597226       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216727769924       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217158282206       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217483497289       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215293942611       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.204604835981       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214104217891       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.224586173329       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.212826620913       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.221758288142       residual = 6.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.371375822855       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.198204672282       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.370376330389       residual = 3.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.300319751327       residual = 1.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.434802941400       residual = 7.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.241563890442       residual = 8.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.348588899952       residual = 2.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.963566231467       residual = 1.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.273930036811       residual = 6.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.481176408025       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.971161586827       residual = 1.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.178961632488       residual = 1.50e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.441114273083       residual = 8.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.643113225954       residual = 2.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.132167576492       residual = 1.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.082984281454       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.705426542647       residual = 4.28e+01           smallest_sin_value = 9.99e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.51e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 5.004653e-16

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727769924       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727769924       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.9062e+13, overlap shift 3.9062e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216727769924       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216727769924       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216727769924       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.155145722103       residual = 5.91e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.993804316565       residual = 8.74e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.171187531142       residual = 2.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.999752948287       residual = 8.06e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.149848913988       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.572571437510       residual = 1.88e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.410933499388       residual = 5.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -18.073497480774       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.425914454416       residual = 9.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.157121281308       residual = 8.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -18.138643752222       residual = 1.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -18.252463603237       residual = 1.73e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.100886827940       residual = 1.18e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -18.067736853398       residual = 1.13e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.823099334293       residual = 6.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.023252730482       residual = 2.14e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -14.611222170744       residual = 1.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -12.945001756324       residual = 2.79e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.596972161349       residual = 3.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -15.767863209113       residual = 3.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.052320258235       residual = 2.07e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -19.140922249719       residual = 6.71e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -10.893027157460       residual = 6.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -14.012641485528       residual = 1.51e+03           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -15.047132620079       residual = 8.35e+02           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+13 is 1.425058e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5778e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2587
    reference variance = 0.221837
====================================================
  Execution time = 1.9524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1905e-01
  Total weights = 2.0000e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399407199
  error estimate for blocks of size 2^( 2) =       0.000409339147
  error estimate for blocks of size 2^( 3) =       0.000418532266
  error estimate for blocks of size 2^( 4) =       0.000424874613
  error estimate for blocks of size 2^( 5) =       0.000429227819
  error estimate for blocks of size 2^( 6) =       0.000431269461
  error estimate for blocks of size 2^( 7) =       0.000431504265

      target function =                  N/A
              le_mean =     -17.217623198934
             les_mean =     296.765600681530
             stat err =       0.000429219040
             autocorr =       1.154851601542
              std dev =       0.564847077162
             le_variance =       0.319052220578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399407199
  error estimate for blocks of size 2^( 2) =       0.000409339147
  error estimate for blocks of size 2^( 3) =       0.000418532266
  error estimate for blocks of size 2^( 4) =       0.000424874613
  error estimate for blocks of size 2^( 5) =       0.000429227819
  error estimate for blocks of size 2^( 6) =       0.000431269461
  error estimate for blocks of size 2^( 7) =       0.000431504265

      target function =                  N/A
              le_mean =     -17.217623198934
             les_mean =     296.765600681530
             stat err =       0.000429219040
             autocorr =       1.154851601542
              std dev =       0.564847077162
             le_variance =       0.319052220578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399407199
  error estimate for blocks of size 2^( 2) =       0.000409339147
  error estimate for blocks of size 2^( 3) =       0.000418532266
  error estimate for blocks of size 2^( 4) =       0.000424874613
  error estimate for blocks of size 2^( 5) =       0.000429227819
  error estimate for blocks of size 2^( 6) =       0.000431269461
  error estimate for blocks of size 2^( 7) =       0.000431504265

      target function =                  N/A
              le_mean =     -17.217623198934
             les_mean =     296.765600681530
             stat err =       0.000429219040
             autocorr =       1.154851601542
              std dev =       0.564847077162
             le_variance =       0.319052220578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319076876754
                                         uncertainty =       0.005977443176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399407199
  error estimate for blocks of size 2^( 2) =       0.000409339147
  error estimate for blocks of size 2^( 3) =       0.000418532266
  error estimate for blocks of size 2^( 4) =       0.000424874613
  error estimate for blocks of size 2^( 5) =       0.000429227819
  error estimate for blocks of size 2^( 6) =       0.000431269461
  error estimate for blocks of size 2^( 7) =       0.000431504265

      target function =                  N/A
              le_mean =     -17.217623198934
             les_mean =     296.765600681530
             stat err =       0.000429219040
             autocorr =       1.154851601542
              std dev =       0.564847077162
             le_variance =       0.319052220578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217623198934        initial  <--
     2.4414e+12     2.4414e+13             5.0047e-16       -17.217623198934
     9.7656e+12     9.7656e+13             0.0000e+00       -17.217623198934
     3.9062e+13     3.9062e+14             1.4251e-17       -17.217623198934

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6947
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2216
    reference variance = 0.135876
====================================================
  Execution time = 2.0316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319690871600
                                         uncertainty =       0.005324535393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319690871600
                                         uncertainty =       0.005324535393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399814618
  error estimate for blocks of size 2^( 2) =       0.000409645036
  error estimate for blocks of size 2^( 3) =       0.000418483611
  error estimate for blocks of size 2^( 4) =       0.000425716722
  error estimate for blocks of size 2^( 5) =       0.000429229754
  error estimate for blocks of size 2^( 6) =       0.000431798358
  error estimate for blocks of size 2^( 7) =       0.000433710830

      target function =                  N/A
              le_mean =     -17.216782859754
             les_mean =     296.737315337008
             stat err =       0.000430113916
             autocorr =       1.157309854837
              std dev =       0.565423254675
             le_variance =       0.319703456928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678285975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782859754       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782859754       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216782859754       residual = 7.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211673430624       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.223018539947       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.152832176141       residual = 8.00e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.091114745882       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.203139448185       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.194956534622       residual = 8.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.221189924811       residual = 3.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.186607735578       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.386300794398       residual = 4.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.820416953483       residual = 5.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.469693706824       residual = 8.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.824516354433       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.403486816676       residual = 5.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -19.357688136237       residual = 7.23e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -15.473180035743       residual = 4.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -21.561443003298       residual = 2.95e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.646219266810       residual = 4.94e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -14.854722843864       residual = 8.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -19.574742576572       residual = 8.82e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -24.124443569284       residual = 7.60e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.033596048804       residual = 2.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.009649718173       residual = 1.25e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -21.797246159005       residual = 3.34e+03           smallest_sin_value = 9.96e-01
davidson iteration   26 stopping due to too large eigenvalue change
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 1.835199e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782859754       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782859754       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216782859754       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216782859754       residual = 3.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.953548053038       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.025956261726       residual = 6.14e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.133535717656       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.931322504188       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.243608427315       residual = 6.35e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.742631642883       residual = 3.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -18.109796692936       residual = 1.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.449501935667       residual = 2.34e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.104279525905       residual = 3.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -19.123350134561       residual = 5.78e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.742211343521       residual = 8.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -14.397566349605       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -15.405194152599       residual = 4.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -18.078510170300       residual = 1.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   18 stopping due to too large eigenvalue change
davidson solver did not converge after         18 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 4.587998e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+14, overlap shift 3.9062e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782859754       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782859754       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216782859754       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.684908370072       residual = 4.53e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.977299157837       residual = 9.93e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.921877238015       residual = 9.03e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -18.348025350362       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -14.741317625809       residual = 1.05e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -19.354343551654       residual = 7.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.282340565634       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.239258912236       residual = 3.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.213439550536       residual = 1.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+14 is 1.147000e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6523e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2846
    reference variance = 0.492382
====================================================
  Execution time = 1.9539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1294e-01
  Total weights = 2.0000e+06
  Execution time = 1.8162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395565236
  error estimate for blocks of size 2^( 2) =       0.000405464598
  error estimate for blocks of size 2^( 3) =       0.000414582749
  error estimate for blocks of size 2^( 4) =       0.000420842929
  error estimate for blocks of size 2^( 5) =       0.000425594397
  error estimate for blocks of size 2^( 6) =       0.000429188065
  error estimate for blocks of size 2^( 7) =       0.000430627248

      target function =                  N/A
              le_mean =     -17.216669259060
             les_mean =     296.726643930572
             stat err =       0.000426563160
             autocorr =       1.162868098702
              std dev =       0.559413720958
             le_variance =       0.312943711196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395565236
  error estimate for blocks of size 2^( 2) =       0.000405464598
  error estimate for blocks of size 2^( 3) =       0.000414582749
  error estimate for blocks of size 2^( 4) =       0.000420842929
  error estimate for blocks of size 2^( 5) =       0.000425594397
  error estimate for blocks of size 2^( 6) =       0.000429188065
  error estimate for blocks of size 2^( 7) =       0.000430627248

      target function =                  N/A
              le_mean =     -17.216669259060
             les_mean =     296.726643930572
             stat err =       0.000426563160
             autocorr =       1.162868098699
              std dev =       0.559413720958
             le_variance =       0.312943711196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395565236
  error estimate for blocks of size 2^( 2) =       0.000405464598
  error estimate for blocks of size 2^( 3) =       0.000414582749
  error estimate for blocks of size 2^( 4) =       0.000420842929
  error estimate for blocks of size 2^( 5) =       0.000425594397
  error estimate for blocks of size 2^( 6) =       0.000429188065
  error estimate for blocks of size 2^( 7) =       0.000430627248

      target function =                  N/A
              le_mean =     -17.216669259060
             les_mean =     296.726643930572
             stat err =       0.000426563160
             autocorr =       1.162868098702
              std dev =       0.559413720958
             le_variance =       0.312943711196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312906393879
                                         uncertainty =       0.003058716361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395565236
  error estimate for blocks of size 2^( 2) =       0.000405464598
  error estimate for blocks of size 2^( 3) =       0.000414582749
  error estimate for blocks of size 2^( 4) =       0.000420842929
  error estimate for blocks of size 2^( 5) =       0.000425594397
  error estimate for blocks of size 2^( 6) =       0.000429188065
  error estimate for blocks of size 2^( 7) =       0.000430627248

      target function =                  N/A
              le_mean =     -17.216669259060
             les_mean =     296.726643930572
             stat err =       0.000426563160
             autocorr =       1.162868098702
              std dev =       0.559413720958
             le_variance =       0.312943711196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216669259060        initial  <--
     2.4414e+13     2.4414e+14             1.8352e-17       -17.216669259060
     9.7656e+13     9.7656e+14             4.5880e-18       -17.216669259060
     3.9062e+14     3.9062e+15             1.1470e-18       -17.216669259060

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7226
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.194
    reference variance = 0.212174
====================================================
  Execution time = 2.1855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1834e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318472557537
                                         uncertainty =       0.005399880553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318472557537
                                         uncertainty =       0.005399880553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398961337
  error estimate for blocks of size 2^( 2) =       0.000408753823
  error estimate for blocks of size 2^( 3) =       0.000417801744
  error estimate for blocks of size 2^( 4) =       0.000423729173
  error estimate for blocks of size 2^( 5) =       0.000427277435
  error estimate for blocks of size 2^( 6) =       0.000429346402
  error estimate for blocks of size 2^( 7) =       0.000430342212

      target function =                  N/A
              le_mean =     -17.215775611173
             les_mean =     296.701270032243
             stat err =       0.000427673806
             autocorr =       1.149115494849
              std dev =       0.564216533938
             le_variance =       0.318340297169


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577561117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+15, overlap shift 3.9062e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215775611173       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.302444 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7407e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2705
    reference variance = 0.489184
====================================================
  Execution time = 1.9588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2894e-01
  Total weights = 2.0000e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405547472
  error estimate for blocks of size 2^( 2) =       0.000414932537
  error estimate for blocks of size 2^( 3) =       0.000424069275
  error estimate for blocks of size 2^( 4) =       0.000430910223
  error estimate for blocks of size 2^( 5) =       0.000435902322
  error estimate for blocks of size 2^( 6) =       0.000437380385
  error estimate for blocks of size 2^( 7) =       0.000437195338

      target function =                  N/A
              le_mean =     -17.216496166135
             les_mean =     296.736677578295
             stat err =       0.000435347067
             autocorr =       1.152359133724
              std dev =       0.573530735190
             le_variance =       0.328937504207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405547472
  error estimate for blocks of size 2^( 2) =       0.000414932537
  error estimate for blocks of size 2^( 3) =       0.000424069275
  error estimate for blocks of size 2^( 4) =       0.000430910223
  error estimate for blocks of size 2^( 5) =       0.000435902322
  error estimate for blocks of size 2^( 6) =       0.000437380385
  error estimate for blocks of size 2^( 7) =       0.000437195338

      target function =                  N/A
              le_mean =     -17.216496166135
             les_mean =     296.736677578295
             stat err =       0.000435347067
             autocorr =       1.152359133724
              std dev =       0.573530735190
             le_variance =       0.328937504207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405547472
  error estimate for blocks of size 2^( 2) =       0.000414932537
  error estimate for blocks of size 2^( 3) =       0.000424069275
  error estimate for blocks of size 2^( 4) =       0.000430910223
  error estimate for blocks of size 2^( 5) =       0.000435902322
  error estimate for blocks of size 2^( 6) =       0.000437380385
  error estimate for blocks of size 2^( 7) =       0.000437195338

      target function =                  N/A
              le_mean =     -17.216496166135
             les_mean =     296.736677578295
             stat err =       0.000435347067
             autocorr =       1.152359133724
              std dev =       0.573530735190
             le_variance =       0.328937504207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328923319919
                                         uncertainty =       0.015703549175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405547472
  error estimate for blocks of size 2^( 2) =       0.000414932537
  error estimate for blocks of size 2^( 3) =       0.000424069275
  error estimate for blocks of size 2^( 4) =       0.000430910223
  error estimate for blocks of size 2^( 5) =       0.000435902322
  error estimate for blocks of size 2^( 6) =       0.000437380385
  error estimate for blocks of size 2^( 7) =       0.000437195338

      target function =                  N/A
              le_mean =     -17.216496166135
             les_mean =     296.736677578295
             stat err =       0.000435347067
             autocorr =       1.152359133724
              std dev =       0.573530735190
             le_variance =       0.328937504207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216496166135        initial  <--
     2.4414e+14     2.4414e+15             0.0000e+00       -17.216496166135
     9.7656e+14     9.7656e+15             0.0000e+00       -17.216496166135
     3.9062e+15     3.9062e+16             0.0000e+00       -17.216496166135

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7490
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1412
    reference variance = 0.133248
====================================================
  Execution time = 1.9874e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1704e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5109e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317035834988
                                         uncertainty =       0.004119457775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317035834988
                                         uncertainty =       0.004119457775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398145811
  error estimate for blocks of size 2^( 2) =       0.000408007691
  error estimate for blocks of size 2^( 3) =       0.000417230590
  error estimate for blocks of size 2^( 4) =       0.000423657748
  error estimate for blocks of size 2^( 5) =       0.000427213606
  error estimate for blocks of size 2^( 6) =       0.000430427365
  error estimate for blocks of size 2^( 7) =       0.000430486144

      target function =                  N/A
              le_mean =     -17.216762874401
             les_mean =     296.733963888101
             stat err =       0.000427946216
             autocorr =       1.155298154696
              std dev =       0.563063205382
             le_variance =       0.317040173255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676287440e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+16, overlap shift 3.9062e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216762874401       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303492 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5390e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.323971
====================================================
  Execution time = 1.9474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1420e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396360752
  error estimate for blocks of size 2^( 2) =       0.000406099408
  error estimate for blocks of size 2^( 3) =       0.000415229377
  error estimate for blocks of size 2^( 4) =       0.000421751959
  error estimate for blocks of size 2^( 5) =       0.000425335655
  error estimate for blocks of size 2^( 6) =       0.000426293254
  error estimate for blocks of size 2^( 7) =       0.000428105683

      target function =                  N/A
              le_mean =     -17.217168117814
             les_mean =     296.745081531165
             stat err =       0.000425371638
             autocorr =       1.151743503957
              std dev =       0.560538750833
             le_variance =       0.314203691186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396360752
  error estimate for blocks of size 2^( 2) =       0.000406099408
  error estimate for blocks of size 2^( 3) =       0.000415229377
  error estimate for blocks of size 2^( 4) =       0.000421751959
  error estimate for blocks of size 2^( 5) =       0.000425335655
  error estimate for blocks of size 2^( 6) =       0.000426293254
  error estimate for blocks of size 2^( 7) =       0.000428105683

      target function =                  N/A
              le_mean =     -17.217168117814
             les_mean =     296.745081531165
             stat err =       0.000425371638
             autocorr =       1.151743503957
              std dev =       0.560538750833
             le_variance =       0.314203691186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396360752
  error estimate for blocks of size 2^( 2) =       0.000406099408
  error estimate for blocks of size 2^( 3) =       0.000415229377
  error estimate for blocks of size 2^( 4) =       0.000421751959
  error estimate for blocks of size 2^( 5) =       0.000425335655
  error estimate for blocks of size 2^( 6) =       0.000426293254
  error estimate for blocks of size 2^( 7) =       0.000428105683

      target function =                  N/A
              le_mean =     -17.217168117814
             les_mean =     296.745081531165
             stat err =       0.000425371638
             autocorr =       1.151743503957
              std dev =       0.560538750833
             le_variance =       0.314203691186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314112984673
                                         uncertainty =       0.003788483355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396360752
  error estimate for blocks of size 2^( 2) =       0.000406099408
  error estimate for blocks of size 2^( 3) =       0.000415229377
  error estimate for blocks of size 2^( 4) =       0.000421751959
  error estimate for blocks of size 2^( 5) =       0.000425335655
  error estimate for blocks of size 2^( 6) =       0.000426293254
  error estimate for blocks of size 2^( 7) =       0.000428105683

      target function =                  N/A
              le_mean =     -17.217168117814
             les_mean =     296.745081531165
             stat err =       0.000425371638
             autocorr =       1.151743503957
              std dev =       0.560538750833
             le_variance =       0.314203691186


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217168117814        initial  <--
     2.4414e+15     2.4414e+16             0.0000e+00       -17.217168117814
     9.7656e+15     9.7656e+16             0.0000e+00       -17.217168117814
     3.9062e+16     3.9062e+17             0.0000e+00       -17.217168117814

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6387
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.243886
====================================================
  Execution time = 2.0107e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310073399840
                                         uncertainty =       0.002608696905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310073399840
                                         uncertainty =       0.002608696905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393721984
  error estimate for blocks of size 2^( 2) =       0.000403935208
  error estimate for blocks of size 2^( 3) =       0.000412918972
  error estimate for blocks of size 2^( 4) =       0.000419047733
  error estimate for blocks of size 2^( 5) =       0.000423421014
  error estimate for blocks of size 2^( 6) =       0.000424766844
  error estimate for blocks of size 2^( 7) =       0.000426012871

      target function =                  N/A
              le_mean =     -17.215896496236
             les_mean =     296.697126015118
             stat err =       0.000423312116
             autocorr =       1.155958034357
              std dev =       0.556806969278
             le_variance =       0.310034001037


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721589649624e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+17, overlap shift 3.9062e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215896496236       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5654e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1027
    reference variance = 0.370651
====================================================
  Execution time = 1.9508e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1079e-01
  Total weights = 2.0000e+06
  Execution time = 1.8122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394199681
  error estimate for blocks of size 2^( 2) =       0.000404044754
  error estimate for blocks of size 2^( 3) =       0.000412576801
  error estimate for blocks of size 2^( 4) =       0.000419390629
  error estimate for blocks of size 2^( 5) =       0.000423403066
  error estimate for blocks of size 2^( 6) =       0.000425064839
  error estimate for blocks of size 2^( 7) =       0.000426500056

      target function =                  N/A
              le_mean =     -17.216070836966
             les_mean =     296.703881684537
             stat err =       0.000423589648
             autocorr =       1.154670681600
              std dev =       0.557482534716
             le_variance =       0.310786776513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394199681
  error estimate for blocks of size 2^( 2) =       0.000404044754
  error estimate for blocks of size 2^( 3) =       0.000412576801
  error estimate for blocks of size 2^( 4) =       0.000419390629
  error estimate for blocks of size 2^( 5) =       0.000423403066
  error estimate for blocks of size 2^( 6) =       0.000425064839
  error estimate for blocks of size 2^( 7) =       0.000426500056

      target function =                  N/A
              le_mean =     -17.216070836966
             les_mean =     296.703881684537
             stat err =       0.000423589648
             autocorr =       1.154670681600
              std dev =       0.557482534716
             le_variance =       0.310786776513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394199681
  error estimate for blocks of size 2^( 2) =       0.000404044754
  error estimate for blocks of size 2^( 3) =       0.000412576801
  error estimate for blocks of size 2^( 4) =       0.000419390629
  error estimate for blocks of size 2^( 5) =       0.000423403066
  error estimate for blocks of size 2^( 6) =       0.000425064839
  error estimate for blocks of size 2^( 7) =       0.000426500056

      target function =                  N/A
              le_mean =     -17.216070836966
             les_mean =     296.703881684537
             stat err =       0.000423589648
             autocorr =       1.154670681600
              std dev =       0.557482534716
             le_variance =       0.310786776513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310735446514
                                         uncertainty =       0.003030210526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394199681
  error estimate for blocks of size 2^( 2) =       0.000404044754
  error estimate for blocks of size 2^( 3) =       0.000412576801
  error estimate for blocks of size 2^( 4) =       0.000419390629
  error estimate for blocks of size 2^( 5) =       0.000423403066
  error estimate for blocks of size 2^( 6) =       0.000425064839
  error estimate for blocks of size 2^( 7) =       0.000426500056

      target function =                  N/A
              le_mean =     -17.216070836966
             les_mean =     296.703881684537
             stat err =       0.000423589648
             autocorr =       1.154670681600
              std dev =       0.557482534716
             le_variance =       0.310786776513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216070836966        initial  <--
     2.4414e+16     2.4414e+17             0.0000e+00       -17.216070836966
     9.7656e+16     9.7656e+17             0.0000e+00       -17.216070836966
     3.9062e+17     3.9062e+18             0.0000e+00       -17.216070836966

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6710
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.253083
====================================================
  Execution time = 1.9918e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310861164532
                                         uncertainty =       0.002780525505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310861164532
                                         uncertainty =       0.002780525505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394204695
  error estimate for blocks of size 2^( 2) =       0.000404417504
  error estimate for blocks of size 2^( 3) =       0.000413146658
  error estimate for blocks of size 2^( 4) =       0.000419875534
  error estimate for blocks of size 2^( 5) =       0.000424355048
  error estimate for blocks of size 2^( 6) =       0.000426986914
  error estimate for blocks of size 2^( 7) =       0.000427835003

      target function =                  N/A
              le_mean =     -17.216747561518
             les_mean =     296.727191124560
             stat err =       0.000424763125
             autocorr =       1.161047610840
              std dev =       0.557489625837
             le_variance =       0.310794682916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674756152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+18, overlap shift 3.9062e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216747561518       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.305598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5522e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.190552
====================================================
  Execution time = 1.9355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1104e-01
  Total weights = 2.0000e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394360207
  error estimate for blocks of size 2^( 2) =       0.000403964156
  error estimate for blocks of size 2^( 3) =       0.000412864486
  error estimate for blocks of size 2^( 4) =       0.000419463865
  error estimate for blocks of size 2^( 5) =       0.000423684169
  error estimate for blocks of size 2^( 6) =       0.000425291746
  error estimate for blocks of size 2^( 7) =       0.000424992030

      target function =                  N/A
              le_mean =     -17.216462356236
             les_mean =     296.717615854274
             stat err =       0.000423357952
             autocorr =       1.152469051591
              std dev =       0.557709553547
             le_variance =       0.311039946118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394360207
  error estimate for blocks of size 2^( 2) =       0.000403964156
  error estimate for blocks of size 2^( 3) =       0.000412864486
  error estimate for blocks of size 2^( 4) =       0.000419463865
  error estimate for blocks of size 2^( 5) =       0.000423684169
  error estimate for blocks of size 2^( 6) =       0.000425291746
  error estimate for blocks of size 2^( 7) =       0.000424992030

      target function =                  N/A
              le_mean =     -17.216462356236
             les_mean =     296.717615854274
             stat err =       0.000423357952
             autocorr =       1.152469051591
              std dev =       0.557709553547
             le_variance =       0.311039946118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394360207
  error estimate for blocks of size 2^( 2) =       0.000403964156
  error estimate for blocks of size 2^( 3) =       0.000412864486
  error estimate for blocks of size 2^( 4) =       0.000419463865
  error estimate for blocks of size 2^( 5) =       0.000423684169
  error estimate for blocks of size 2^( 6) =       0.000425291746
  error estimate for blocks of size 2^( 7) =       0.000424992030

      target function =                  N/A
              le_mean =     -17.216462356236
             les_mean =     296.717615854274
             stat err =       0.000423357952
             autocorr =       1.152469051591
              std dev =       0.557709553547
             le_variance =       0.311039946118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311025775202
                                         uncertainty =       0.003685727515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394360207
  error estimate for blocks of size 2^( 2) =       0.000403964156
  error estimate for blocks of size 2^( 3) =       0.000412864486
  error estimate for blocks of size 2^( 4) =       0.000419463865
  error estimate for blocks of size 2^( 5) =       0.000423684169
  error estimate for blocks of size 2^( 6) =       0.000425291746
  error estimate for blocks of size 2^( 7) =       0.000424992030

      target function =                  N/A
              le_mean =     -17.216462356236
             les_mean =     296.717615854274
             stat err =       0.000423357952
             autocorr =       1.152469051591
              std dev =       0.557709553547
             le_variance =       0.311039946118


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216462356236        initial  <--
     2.4414e+17     2.4414e+18             0.0000e+00       -17.216462356236
     9.7656e+17     9.7656e+18             0.0000e+00       -17.216462356236
     3.9062e+18     3.9062e+19             0.0000e+00       -17.216462356236

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.5234
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1724
    reference variance = 0.172465
====================================================
  Execution time = 2.0458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312271650999
                                         uncertainty =       0.005140770466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312271650999
                                         uncertainty =       0.005140770466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395124794
  error estimate for blocks of size 2^( 2) =       0.000405030139
  error estimate for blocks of size 2^( 3) =       0.000414311665
  error estimate for blocks of size 2^( 4) =       0.000421483940
  error estimate for blocks of size 2^( 5) =       0.000425436590
  error estimate for blocks of size 2^( 6) =       0.000428191525
  error estimate for blocks of size 2^( 7) =       0.000429092327

      target function =                  N/A
              le_mean =     -17.216413934041
             les_mean =     296.717155798262
             stat err =       0.000426051095
             autocorr =       1.162665556210
              std dev =       0.558790842924
             le_variance =       0.312247206136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641393404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+19, overlap shift 3.9062e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216413934041       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5990e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2295
    reference variance = 0.225059
====================================================
  Execution time = 1.9680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2004e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400024540
  error estimate for blocks of size 2^( 2) =       0.000409946836
  error estimate for blocks of size 2^( 3) =       0.000418609984
  error estimate for blocks of size 2^( 4) =       0.000424804790
  error estimate for blocks of size 2^( 5) =       0.000428607476
  error estimate for blocks of size 2^( 6) =       0.000430077382
  error estimate for blocks of size 2^( 7) =       0.000431749042

      target function =                  N/A
              le_mean =     -17.216429592449
             les_mean =     296.725487017567
             stat err =       0.000428809672
             autocorr =       1.149094844621
              std dev =       0.565720130308
             le_variance =       0.320039265836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400024540
  error estimate for blocks of size 2^( 2) =       0.000409946836
  error estimate for blocks of size 2^( 3) =       0.000418609984
  error estimate for blocks of size 2^( 4) =       0.000424804790
  error estimate for blocks of size 2^( 5) =       0.000428607476
  error estimate for blocks of size 2^( 6) =       0.000430077382
  error estimate for blocks of size 2^( 7) =       0.000431749042

      target function =                  N/A
              le_mean =     -17.216429592449
             les_mean =     296.725487017567
             stat err =       0.000428809672
             autocorr =       1.149094844621
              std dev =       0.565720130308
             le_variance =       0.320039265836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400024540
  error estimate for blocks of size 2^( 2) =       0.000409946836
  error estimate for blocks of size 2^( 3) =       0.000418609984
  error estimate for blocks of size 2^( 4) =       0.000424804790
  error estimate for blocks of size 2^( 5) =       0.000428607476
  error estimate for blocks of size 2^( 6) =       0.000430077382
  error estimate for blocks of size 2^( 7) =       0.000431749042

      target function =                  N/A
              le_mean =     -17.216429592449
             les_mean =     296.725487017567
             stat err =       0.000428809672
             autocorr =       1.149094844621
              std dev =       0.565720130308
             le_variance =       0.320039265836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320022737569
                                         uncertainty =       0.004626773138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400024540
  error estimate for blocks of size 2^( 2) =       0.000409946836
  error estimate for blocks of size 2^( 3) =       0.000418609984
  error estimate for blocks of size 2^( 4) =       0.000424804790
  error estimate for blocks of size 2^( 5) =       0.000428607476
  error estimate for blocks of size 2^( 6) =       0.000430077382
  error estimate for blocks of size 2^( 7) =       0.000431749042

      target function =                  N/A
              le_mean =     -17.216429592449
             les_mean =     296.725487017567
             stat err =       0.000428809672
             autocorr =       1.149094844621
              std dev =       0.565720130308
             le_variance =       0.320039265836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216429592449        initial  <--
     2.4414e+18     2.4414e+19             0.0000e+00       -17.216429592449
     9.7656e+18     9.7656e+19             0.0000e+00       -17.216429592449
     3.9062e+19     3.9062e+20             0.0000e+00       -17.216429592449

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.8064
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7802e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.313627
====================================================
  Execution time = 2.0174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1460e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314636588356
                                         uncertainty =       0.002746300192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314636588356
                                         uncertainty =       0.002746300192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396612423
  error estimate for blocks of size 2^( 2) =       0.000406619262
  error estimate for blocks of size 2^( 3) =       0.000415466389
  error estimate for blocks of size 2^( 4) =       0.000422176423
  error estimate for blocks of size 2^( 5) =       0.000426693102
  error estimate for blocks of size 2^( 6) =       0.000429297008
  error estimate for blocks of size 2^( 7) =       0.000428056703

      target function =                  N/A
              le_mean =     -17.216721496986
             les_mean =     296.730101775420
             stat err =       0.000426555809
             autocorr =       1.156695630661
              std dev =       0.560894667407
             le_variance =       0.314602827925


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672149699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721496986       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 2.318812e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721496986       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 5.797031e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+20, overlap shift 3.9062e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216721496986       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216721496986       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+20 is 1.449258e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5682e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.235832
====================================================
  Execution time = 2.1869e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1132e-01
  Total weights = 2.0000e+06
  Execution time = 1.8147e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394539660
  error estimate for blocks of size 2^( 2) =       0.000404133494
  error estimate for blocks of size 2^( 3) =       0.000412707179
  error estimate for blocks of size 2^( 4) =       0.000419854348
  error estimate for blocks of size 2^( 5) =       0.000422603026
  error estimate for blocks of size 2^( 6) =       0.000424986657
  error estimate for blocks of size 2^( 7) =       0.000426460970

      target function =                  N/A
              le_mean =     -17.216789823430
             les_mean =     296.729174755386
             stat err =       0.000423476250
             autocorr =       1.152064476024
              std dev =       0.557963338303
             le_variance =       0.311323086890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394539660
  error estimate for blocks of size 2^( 2) =       0.000404133494
  error estimate for blocks of size 2^( 3) =       0.000412707179
  error estimate for blocks of size 2^( 4) =       0.000419854348
  error estimate for blocks of size 2^( 5) =       0.000422603026
  error estimate for blocks of size 2^( 6) =       0.000424986657
  error estimate for blocks of size 2^( 7) =       0.000426460970

      target function =                  N/A
              le_mean =     -17.216789823430
             les_mean =     296.729174755386
             stat err =       0.000423476250
             autocorr =       1.152064476024
              std dev =       0.557963338303
             le_variance =       0.311323086890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394539660
  error estimate for blocks of size 2^( 2) =       0.000404133494
  error estimate for blocks of size 2^( 3) =       0.000412707179
  error estimate for blocks of size 2^( 4) =       0.000419854348
  error estimate for blocks of size 2^( 5) =       0.000422603026
  error estimate for blocks of size 2^( 6) =       0.000424986657
  error estimate for blocks of size 2^( 7) =       0.000426460970

      target function =                  N/A
              le_mean =     -17.216789823430
             les_mean =     296.729174755386
             stat err =       0.000423476250
             autocorr =       1.152064476024
              std dev =       0.557963338303
             le_variance =       0.311323086890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311389209219
                                         uncertainty =       0.002339019992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394539660
  error estimate for blocks of size 2^( 2) =       0.000404133494
  error estimate for blocks of size 2^( 3) =       0.000412707179
  error estimate for blocks of size 2^( 4) =       0.000419854348
  error estimate for blocks of size 2^( 5) =       0.000422603026
  error estimate for blocks of size 2^( 6) =       0.000424986657
  error estimate for blocks of size 2^( 7) =       0.000426460970

      target function =                  N/A
              le_mean =     -17.216789823430
             les_mean =     296.729174755386
             stat err =       0.000423476250
             autocorr =       1.152064476024
              std dev =       0.557963338303
             le_variance =       0.311323086890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216789823430        initial  <--
     2.4414e+19     2.4414e+20             2.3188e-23       -17.216789823430
     9.7656e+19     9.7656e+20             5.7970e-24       -17.216789823430
     3.9062e+20     3.9062e+21             1.4493e-24       -17.216789823430

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0267
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2473
    reference variance = 0.158162
====================================================
  Execution time = 1.9967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2066e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320683789839
                                         uncertainty =       0.008601720666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320683789839
                                         uncertainty =       0.008601720666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400410156
  error estimate for blocks of size 2^( 2) =       0.000410187979
  error estimate for blocks of size 2^( 3) =       0.000419088384
  error estimate for blocks of size 2^( 4) =       0.000426085992
  error estimate for blocks of size 2^( 5) =       0.000430281992
  error estimate for blocks of size 2^( 6) =       0.000432612333
  error estimate for blocks of size 2^( 7) =       0.000432971646

      target function =                  N/A
              le_mean =     -17.216830999847
             les_mean =     296.739926102967
             stat err =       0.000430487991
             autocorr =       1.155877772132
              std dev =       0.566265473070
             le_variance =       0.320656585991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683099985e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+21, overlap shift 3.9062e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216830999847       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5590e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1805
    reference variance = 0.211154
====================================================
  Execution time = 1.9897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1614e-01
  Total weights = 2.0000e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397577446
  error estimate for blocks of size 2^( 2) =       0.000407843554
  error estimate for blocks of size 2^( 3) =       0.000416350433
  error estimate for blocks of size 2^( 4) =       0.000423163649
  error estimate for blocks of size 2^( 5) =       0.000427303120
  error estimate for blocks of size 2^( 6) =       0.000429126220
  error estimate for blocks of size 2^( 7) =       0.000431322396

      target function =                  N/A
              le_mean =     -17.216775232802
             les_mean =     296.733484910543
             stat err =       0.000427728846
             autocorr =       1.157426977181
              std dev =       0.562259416794
             le_variance =       0.316135651774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397577446
  error estimate for blocks of size 2^( 2) =       0.000407843554
  error estimate for blocks of size 2^( 3) =       0.000416350433
  error estimate for blocks of size 2^( 4) =       0.000423163649
  error estimate for blocks of size 2^( 5) =       0.000427303120
  error estimate for blocks of size 2^( 6) =       0.000429126220
  error estimate for blocks of size 2^( 7) =       0.000431322396

      target function =                  N/A
              le_mean =     -17.216775232802
             les_mean =     296.733484910543
             stat err =       0.000427728846
             autocorr =       1.157426977181
              std dev =       0.562259416794
             le_variance =       0.316135651774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397577446
  error estimate for blocks of size 2^( 2) =       0.000407843554
  error estimate for blocks of size 2^( 3) =       0.000416350433
  error estimate for blocks of size 2^( 4) =       0.000423163649
  error estimate for blocks of size 2^( 5) =       0.000427303120
  error estimate for blocks of size 2^( 6) =       0.000429126220
  error estimate for blocks of size 2^( 7) =       0.000431322396

      target function =                  N/A
              le_mean =     -17.216775232802
             les_mean =     296.733484910543
             stat err =       0.000427728846
             autocorr =       1.157426977181
              std dev =       0.562259416794
             le_variance =       0.316135651774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316198514446
                                         uncertainty =       0.006471732215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397577446
  error estimate for blocks of size 2^( 2) =       0.000407843554
  error estimate for blocks of size 2^( 3) =       0.000416350433
  error estimate for blocks of size 2^( 4) =       0.000423163649
  error estimate for blocks of size 2^( 5) =       0.000427303120
  error estimate for blocks of size 2^( 6) =       0.000429126220
  error estimate for blocks of size 2^( 7) =       0.000431322396

      target function =                  N/A
              le_mean =     -17.216775232802
             les_mean =     296.733484910543
             stat err =       0.000427728846
             autocorr =       1.157426977181
              std dev =       0.562259416794
             le_variance =       0.316135651774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216775232802        initial  <--
     2.4414e+20     2.4414e+21             0.0000e+00       -17.216775232802
     9.7656e+20     9.7656e+21             0.0000e+00       -17.216775232802
     3.9062e+21     3.9062e+22             0.0000e+00       -17.216775232802

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0928
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2058
    reference variance = 0.234283
====================================================
  Execution time = 1.9813e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.3613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323046238581
                                         uncertainty =       0.004755053686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323046238581
                                         uncertainty =       0.004755053686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401913180
  error estimate for blocks of size 2^( 2) =       0.000411793875
  error estimate for blocks of size 2^( 3) =       0.000420704826
  error estimate for blocks of size 2^( 4) =       0.000427292105
  error estimate for blocks of size 2^( 5) =       0.000432211172
  error estimate for blocks of size 2^( 6) =       0.000435350597
  error estimate for blocks of size 2^( 7) =       0.000436232744

      target function =                  N/A
              le_mean =     -17.216274293314
             les_mean =     296.723168790372
             stat err =       0.000432771655
             autocorr =       1.159452918468
              std dev =       0.568391070719
             le_variance =       0.323068409273


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721627429331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+22, overlap shift 3.9062e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216274293314       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310059 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5179e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2496
    reference variance = 0.17493
====================================================
  Execution time = 1.9579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1393e-01
  Total weights = 2.0000e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396187752
  error estimate for blocks of size 2^( 2) =       0.000405950052
  error estimate for blocks of size 2^( 3) =       0.000414823178
  error estimate for blocks of size 2^( 4) =       0.000420270916
  error estimate for blocks of size 2^( 5) =       0.000423522844
  error estimate for blocks of size 2^( 6) =       0.000424493143
  error estimate for blocks of size 2^( 7) =       0.000425030858

      target function =                  N/A
              le_mean =     -17.216266989155
             les_mean =     296.713778354429
             stat err =       0.000423329440
             autocorr =       1.141707501135
              std dev =       0.560294091994
             le_variance =       0.313929469524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396187752
  error estimate for blocks of size 2^( 2) =       0.000405950052
  error estimate for blocks of size 2^( 3) =       0.000414823178
  error estimate for blocks of size 2^( 4) =       0.000420270916
  error estimate for blocks of size 2^( 5) =       0.000423522844
  error estimate for blocks of size 2^( 6) =       0.000424493143
  error estimate for blocks of size 2^( 7) =       0.000425030858

      target function =                  N/A
              le_mean =     -17.216266989155
             les_mean =     296.713778354429
             stat err =       0.000423329440
             autocorr =       1.141707501135
              std dev =       0.560294091994
             le_variance =       0.313929469524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396187752
  error estimate for blocks of size 2^( 2) =       0.000405950052
  error estimate for blocks of size 2^( 3) =       0.000414823178
  error estimate for blocks of size 2^( 4) =       0.000420270916
  error estimate for blocks of size 2^( 5) =       0.000423522844
  error estimate for blocks of size 2^( 6) =       0.000424493143
  error estimate for blocks of size 2^( 7) =       0.000425030858

      target function =                  N/A
              le_mean =     -17.216266989155
             les_mean =     296.713778354429
             stat err =       0.000423329440
             autocorr =       1.141707501135
              std dev =       0.560294091994
             le_variance =       0.313929469524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314047738214
                                         uncertainty =       0.005304807171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396187752
  error estimate for blocks of size 2^( 2) =       0.000405950052
  error estimate for blocks of size 2^( 3) =       0.000414823178
  error estimate for blocks of size 2^( 4) =       0.000420270916
  error estimate for blocks of size 2^( 5) =       0.000423522844
  error estimate for blocks of size 2^( 6) =       0.000424493143
  error estimate for blocks of size 2^( 7) =       0.000425030858

      target function =                  N/A
              le_mean =     -17.216266989155
             les_mean =     296.713778354429
             stat err =       0.000423329440
             autocorr =       1.141707501135
              std dev =       0.560294091994
             le_variance =       0.313929469524


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216266989155        initial  <--
     2.4414e+21     2.4414e+22             0.0000e+00       -17.216266989155
     9.7656e+21     9.7656e+22             0.0000e+00       -17.216266989155
     3.9062e+22     3.9062e+23             0.0000e+00       -17.216266989155

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7426
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.363719
====================================================
  Execution time = 1.9801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1573e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315841346334
                                         uncertainty =       0.003640851206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315841346334
                                         uncertainty =       0.003640851206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397321017
  error estimate for blocks of size 2^( 2) =       0.000407279023
  error estimate for blocks of size 2^( 3) =       0.000416390928
  error estimate for blocks of size 2^( 4) =       0.000422556419
  error estimate for blocks of size 2^( 5) =       0.000425864995
  error estimate for blocks of size 2^( 6) =       0.000428087240
  error estimate for blocks of size 2^( 7) =       0.000428734262

      target function =                  N/A
              le_mean =     -17.216028904385
             les_mean =     296.707379060114
             stat err =       0.000426310729
             autocorr =       1.151249482612
              std dev =       0.561896771083
             le_variance =       0.315727981354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721602890439e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+23, overlap shift 3.9062e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216028904385       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5294e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.251048
====================================================
  Execution time = 1.9409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1669e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397926682
  error estimate for blocks of size 2^( 2) =       0.000407623416
  error estimate for blocks of size 2^( 3) =       0.000416856427
  error estimate for blocks of size 2^( 4) =       0.000423104895
  error estimate for blocks of size 2^( 5) =       0.000428123345
  error estimate for blocks of size 2^( 6) =       0.000431154661
  error estimate for blocks of size 2^( 7) =       0.000434667728

      target function =                  N/A
              le_mean =     -17.215518091079
             les_mean =     296.690754274930
             stat err =       0.000429262657
             autocorr =       1.163697487499
              std dev =       0.562753310984
             le_variance =       0.316691289023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397926682
  error estimate for blocks of size 2^( 2) =       0.000407623416
  error estimate for blocks of size 2^( 3) =       0.000416856427
  error estimate for blocks of size 2^( 4) =       0.000423104895
  error estimate for blocks of size 2^( 5) =       0.000428123345
  error estimate for blocks of size 2^( 6) =       0.000431154661
  error estimate for blocks of size 2^( 7) =       0.000434667728

      target function =                  N/A
              le_mean =     -17.215518091079
             les_mean =     296.690754274930
             stat err =       0.000429262657
             autocorr =       1.163697487499
              std dev =       0.562753310984
             le_variance =       0.316691289023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397926682
  error estimate for blocks of size 2^( 2) =       0.000407623416
  error estimate for blocks of size 2^( 3) =       0.000416856427
  error estimate for blocks of size 2^( 4) =       0.000423104895
  error estimate for blocks of size 2^( 5) =       0.000428123345
  error estimate for blocks of size 2^( 6) =       0.000431154661
  error estimate for blocks of size 2^( 7) =       0.000434667728

      target function =                  N/A
              le_mean =     -17.215518091079
             les_mean =     296.690754274930
             stat err =       0.000429262657
             autocorr =       1.163697487499
              std dev =       0.562753310984
             le_variance =       0.316691289023

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773508730
                                         uncertainty =       0.003510403816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397926682
  error estimate for blocks of size 2^( 2) =       0.000407623416
  error estimate for blocks of size 2^( 3) =       0.000416856427
  error estimate for blocks of size 2^( 4) =       0.000423104895
  error estimate for blocks of size 2^( 5) =       0.000428123345
  error estimate for blocks of size 2^( 6) =       0.000431154661
  error estimate for blocks of size 2^( 7) =       0.000434667728

      target function =                  N/A
              le_mean =     -17.215518091079
             les_mean =     296.690754274930
             stat err =       0.000429262657
             autocorr =       1.163697487499
              std dev =       0.562753310984
             le_variance =       0.316691289023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215518091079        initial  <--
     2.4414e+22     2.4414e+23             0.0000e+00       -17.215518091079
     9.7656e+22     9.7656e+23             0.0000e+00       -17.215518091079
     3.9062e+23     3.9062e+24             0.0000e+00       -17.215518091079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6017
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.3902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.448732
====================================================
  Execution time = 1.9619e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1903e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318948310593
                                         uncertainty =       0.004050444588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318948310593
                                         uncertainty =       0.004050444588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399393073
  error estimate for blocks of size 2^( 2) =       0.000409263128
  error estimate for blocks of size 2^( 3) =       0.000418765389
  error estimate for blocks of size 2^( 4) =       0.000425222068
  error estimate for blocks of size 2^( 5) =       0.000429330407
  error estimate for blocks of size 2^( 6) =       0.000432386970
  error estimate for blocks of size 2^( 7) =       0.000432555442

      target function =                  N/A
              le_mean =     -17.217316830579
             les_mean =     296.755028338081
             stat err =       0.000429873722
             autocorr =       1.158459188775
              std dev =       0.564827100149
             le_variance =       0.319029653062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731683058e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+24, overlap shift 3.9062e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217316830579       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+24 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.312122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5167e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.183265
====================================================
  Execution time = 1.9681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1786e-01
  Total weights = 2.0000e+06
  Execution time = 1.8203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398661660
  error estimate for blocks of size 2^( 2) =       0.000408583354
  error estimate for blocks of size 2^( 3) =       0.000417641088
  error estimate for blocks of size 2^( 4) =       0.000423451745
  error estimate for blocks of size 2^( 5) =       0.000427962720
  error estimate for blocks of size 2^( 6) =       0.000429556374
  error estimate for blocks of size 2^( 7) =       0.000431403484

      target function =                  N/A
              le_mean =     -17.217283723395
             les_mean =     296.752720891131
             stat err =       0.000428093581
             autocorr =       1.153104030244
              std dev =       0.563792726252
             le_variance =       0.317862238174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398661660
  error estimate for blocks of size 2^( 2) =       0.000408583354
  error estimate for blocks of size 2^( 3) =       0.000417641088
  error estimate for blocks of size 2^( 4) =       0.000423451745
  error estimate for blocks of size 2^( 5) =       0.000427962720
  error estimate for blocks of size 2^( 6) =       0.000429556374
  error estimate for blocks of size 2^( 7) =       0.000431403484

      target function =                  N/A
              le_mean =     -17.217283723395
             les_mean =     296.752720891131
             stat err =       0.000428093581
             autocorr =       1.153104030244
              std dev =       0.563792726252
             le_variance =       0.317862238174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398661660
  error estimate for blocks of size 2^( 2) =       0.000408583354
  error estimate for blocks of size 2^( 3) =       0.000417641088
  error estimate for blocks of size 2^( 4) =       0.000423451745
  error estimate for blocks of size 2^( 5) =       0.000427962720
  error estimate for blocks of size 2^( 6) =       0.000429556374
  error estimate for blocks of size 2^( 7) =       0.000431403484

      target function =                  N/A
              le_mean =     -17.217283723395
             les_mean =     296.752720891131
             stat err =       0.000428093581
             autocorr =       1.153104030244
              std dev =       0.563792726252
             le_variance =       0.317862238174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317813913675
                                         uncertainty =       0.006586861172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398661660
  error estimate for blocks of size 2^( 2) =       0.000408583354
  error estimate for blocks of size 2^( 3) =       0.000417641088
  error estimate for blocks of size 2^( 4) =       0.000423451745
  error estimate for blocks of size 2^( 5) =       0.000427962720
  error estimate for blocks of size 2^( 6) =       0.000429556374
  error estimate for blocks of size 2^( 7) =       0.000431403484

      target function =                  N/A
              le_mean =     -17.217283723395
             les_mean =     296.752720891131
             stat err =       0.000428093581
             autocorr =       1.153104030244
              std dev =       0.563792726252
             le_variance =       0.317862238174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217283723395        initial  <--
     2.4414e+23     2.4414e+24             0.0000e+00       -17.217283723395
     9.7656e+23     9.7656e+24             0.0000e+00       -17.217283723395
     3.9062e+24     3.9062e+25             0.0000e+00       -17.217283723395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8718
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2339
    reference variance = 0.242852
====================================================
  Execution time = 2.2307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0834e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5427e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308433074231
                                         uncertainty =       0.002379235394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308433074231
                                         uncertainty =       0.002379235394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392647376
  error estimate for blocks of size 2^( 2) =       0.000402853632
  error estimate for blocks of size 2^( 3) =       0.000411850377
  error estimate for blocks of size 2^( 4) =       0.000418410380
  error estimate for blocks of size 2^( 5) =       0.000421964848
  error estimate for blocks of size 2^( 6) =       0.000422668276
  error estimate for blocks of size 2^( 7) =       0.000422632846

      target function =                  N/A
              le_mean =     -17.216646335780
             les_mean =     296.721254820657
             stat err =       0.000421419087
             autocorr =       1.151921822018
              std dev =       0.555287244153
             le_variance =       0.308343923519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664633578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+25, overlap shift 3.9062e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216646335780       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313175 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7855e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.22311
====================================================
  Execution time = 1.9741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2956e-01
  Total weights = 2.0000e+06
  Execution time = 1.8185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405929121
  error estimate for blocks of size 2^( 2) =       0.000415932537
  error estimate for blocks of size 2^( 3) =       0.000424992573
  error estimate for blocks of size 2^( 4) =       0.000431235442
  error estimate for blocks of size 2^( 5) =       0.000435351564
  error estimate for blocks of size 2^( 6) =       0.000437796469
  error estimate for blocks of size 2^( 7) =       0.000439311022

      target function =                  N/A
              le_mean =     -17.216187476343
             les_mean =     296.726667959070
             stat err =       0.000435923624
             autocorr =       1.153241847830
              std dev =       0.574070468905
             le_variance =       0.329556903268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405929121
  error estimate for blocks of size 2^( 2) =       0.000415932537
  error estimate for blocks of size 2^( 3) =       0.000424992573
  error estimate for blocks of size 2^( 4) =       0.000431235442
  error estimate for blocks of size 2^( 5) =       0.000435351564
  error estimate for blocks of size 2^( 6) =       0.000437796469
  error estimate for blocks of size 2^( 7) =       0.000439311022

      target function =                  N/A
              le_mean =     -17.216187476343
             les_mean =     296.726667959070
             stat err =       0.000435923624
             autocorr =       1.153241847830
              std dev =       0.574070468905
             le_variance =       0.329556903268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405929121
  error estimate for blocks of size 2^( 2) =       0.000415932537
  error estimate for blocks of size 2^( 3) =       0.000424992573
  error estimate for blocks of size 2^( 4) =       0.000431235442
  error estimate for blocks of size 2^( 5) =       0.000435351564
  error estimate for blocks of size 2^( 6) =       0.000437796469
  error estimate for blocks of size 2^( 7) =       0.000439311022

      target function =                  N/A
              le_mean =     -17.216187476343
             les_mean =     296.726667959070
             stat err =       0.000435923624
             autocorr =       1.153241847830
              std dev =       0.574070468905
             le_variance =       0.329556903268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329660207481
                                         uncertainty =       0.013771773950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405929121
  error estimate for blocks of size 2^( 2) =       0.000415932537
  error estimate for blocks of size 2^( 3) =       0.000424992573
  error estimate for blocks of size 2^( 4) =       0.000431235442
  error estimate for blocks of size 2^( 5) =       0.000435351564
  error estimate for blocks of size 2^( 6) =       0.000437796469
  error estimate for blocks of size 2^( 7) =       0.000439311022

      target function =                  N/A
              le_mean =     -17.216187476343
             les_mean =     296.726667959070
             stat err =       0.000435923624
             autocorr =       1.153241847830
              std dev =       0.574070468905
             le_variance =       0.329556903268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216187476343        initial  <--
     2.4414e+24     2.4414e+25             0.0000e+00       -17.216187476343
     9.7656e+24     9.7656e+25             0.0000e+00       -17.216187476343
     3.9062e+25     3.9062e+26             0.0000e+00       -17.216187476343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9180
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.200232
====================================================
  Execution time = 2.2397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2166e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321631336432
                                         uncertainty =       0.005150012180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321631336432
                                         uncertainty =       0.005150012180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401033481
  error estimate for blocks of size 2^( 2) =       0.000410645718
  error estimate for blocks of size 2^( 3) =       0.000419564993
  error estimate for blocks of size 2^( 4) =       0.000426168527
  error estimate for blocks of size 2^( 5) =       0.000430569632
  error estimate for blocks of size 2^( 6) =       0.000431624230
  error estimate for blocks of size 2^( 7) =       0.000431961086

      target function =                  N/A
              le_mean =     -17.216514017291
             les_mean =     296.730010453292
             stat err =       0.000430080869
             autocorr =       1.150108950665
              std dev =       0.567146988492
             le_variance =       0.321655706555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651401729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+26, overlap shift 3.9062e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216514017291       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7958e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.3219
    reference variance = 0.575637
====================================================
  Execution time = 1.9568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1415e-01
  Total weights = 2.0000e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396325707
  error estimate for blocks of size 2^( 2) =       0.000405675362
  error estimate for blocks of size 2^( 3) =       0.000414012098
  error estimate for blocks of size 2^( 4) =       0.000420840843
  error estimate for blocks of size 2^( 5) =       0.000425222816
  error estimate for blocks of size 2^( 6) =       0.000426486505
  error estimate for blocks of size 2^( 7) =       0.000426672247

      target function =                  N/A
              le_mean =     -17.216469564788
             les_mean =     296.720972250024
             stat err =       0.000424805603
             autocorr =       1.148883483362
              std dev =       0.560489189737
             le_variance =       0.314148131812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396325707
  error estimate for blocks of size 2^( 2) =       0.000405675362
  error estimate for blocks of size 2^( 3) =       0.000414012098
  error estimate for blocks of size 2^( 4) =       0.000420840843
  error estimate for blocks of size 2^( 5) =       0.000425222816
  error estimate for blocks of size 2^( 6) =       0.000426486505
  error estimate for blocks of size 2^( 7) =       0.000426672247

      target function =                  N/A
              le_mean =     -17.216469564788
             les_mean =     296.720972250024
             stat err =       0.000424805603
             autocorr =       1.148883483362
              std dev =       0.560489189737
             le_variance =       0.314148131812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396325707
  error estimate for blocks of size 2^( 2) =       0.000405675362
  error estimate for blocks of size 2^( 3) =       0.000414012098
  error estimate for blocks of size 2^( 4) =       0.000420840843
  error estimate for blocks of size 2^( 5) =       0.000425222816
  error estimate for blocks of size 2^( 6) =       0.000426486505
  error estimate for blocks of size 2^( 7) =       0.000426672247

      target function =                  N/A
              le_mean =     -17.216469564788
             les_mean =     296.720972250024
             stat err =       0.000424805603
             autocorr =       1.148883483362
              std dev =       0.560489189737
             le_variance =       0.314148131812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313891818770
                                         uncertainty =       0.004541674517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396325707
  error estimate for blocks of size 2^( 2) =       0.000405675362
  error estimate for blocks of size 2^( 3) =       0.000414012098
  error estimate for blocks of size 2^( 4) =       0.000420840843
  error estimate for blocks of size 2^( 5) =       0.000425222816
  error estimate for blocks of size 2^( 6) =       0.000426486505
  error estimate for blocks of size 2^( 7) =       0.000426672247

      target function =                  N/A
              le_mean =     -17.216469564788
             les_mean =     296.720972250024
             stat err =       0.000424805603
             autocorr =       1.148883483362
              std dev =       0.560489189737
             le_variance =       0.314148131812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216469564788        initial  <--
     2.4414e+25     2.4414e+26             0.0000e+00       -17.216469564788
     9.7656e+25     9.7656e+26             0.0000e+00       -17.216469564788
     3.9062e+26     3.9062e+27             0.0000e+00       -17.216469564788

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7419
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6711e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.140884
====================================================
  Execution time = 2.0032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315738811692
                                         uncertainty =       0.002687704664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315738811692
                                         uncertainty =       0.002687704664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397268976
  error estimate for blocks of size 2^( 2) =       0.000407044256
  error estimate for blocks of size 2^( 3) =       0.000415875747
  error estimate for blocks of size 2^( 4) =       0.000422252659
  error estimate for blocks of size 2^( 5) =       0.000427077193
  error estimate for blocks of size 2^( 6) =       0.000428289150
  error estimate for blocks of size 2^( 7) =       0.000428726928

      target function =                  N/A
              le_mean =     -17.216773233154
             les_mean =     296.732925682633
             stat err =       0.000426586482
             autocorr =       1.153041337026
              std dev =       0.561823173783
             le_variance =       0.315645278599


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677323315e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+27, overlap shift 3.9062e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773233154       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315297 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5555e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.291479
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1343e-01
  Total weights = 2.0000e+06
  Execution time = 1.8303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395871878
  error estimate for blocks of size 2^( 2) =       0.000406139537
  error estimate for blocks of size 2^( 3) =       0.000415199737
  error estimate for blocks of size 2^( 4) =       0.000421566550
  error estimate for blocks of size 2^( 5) =       0.000425476593
  error estimate for blocks of size 2^( 6) =       0.000427922777
  error estimate for blocks of size 2^( 7) =       0.000426958950

      target function =                  N/A
              le_mean =     -17.216036497343
             les_mean =     296.705341608620
             stat err =       0.000425481218
             autocorr =       1.155184848932
              std dev =       0.559847378751
             le_variance =       0.313429087495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395871878
  error estimate for blocks of size 2^( 2) =       0.000406139537
  error estimate for blocks of size 2^( 3) =       0.000415199737
  error estimate for blocks of size 2^( 4) =       0.000421566550
  error estimate for blocks of size 2^( 5) =       0.000425476593
  error estimate for blocks of size 2^( 6) =       0.000427922777
  error estimate for blocks of size 2^( 7) =       0.000426958950

      target function =                  N/A
              le_mean =     -17.216036497343
             les_mean =     296.705341608620
             stat err =       0.000425481218
             autocorr =       1.155184848932
              std dev =       0.559847378751
             le_variance =       0.313429087495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395871878
  error estimate for blocks of size 2^( 2) =       0.000406139537
  error estimate for blocks of size 2^( 3) =       0.000415199737
  error estimate for blocks of size 2^( 4) =       0.000421566550
  error estimate for blocks of size 2^( 5) =       0.000425476593
  error estimate for blocks of size 2^( 6) =       0.000427922777
  error estimate for blocks of size 2^( 7) =       0.000426958950

      target function =                  N/A
              le_mean =     -17.216036497343
             les_mean =     296.705341608620
             stat err =       0.000425481218
             autocorr =       1.155184848932
              std dev =       0.559847378751
             le_variance =       0.313429087495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313485206055
                                         uncertainty =       0.003662231012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395871878
  error estimate for blocks of size 2^( 2) =       0.000406139537
  error estimate for blocks of size 2^( 3) =       0.000415199737
  error estimate for blocks of size 2^( 4) =       0.000421566550
  error estimate for blocks of size 2^( 5) =       0.000425476593
  error estimate for blocks of size 2^( 6) =       0.000427922777
  error estimate for blocks of size 2^( 7) =       0.000426958950

      target function =                  N/A
              le_mean =     -17.216036497343
             les_mean =     296.705341608620
             stat err =       0.000425481218
             autocorr =       1.155184848932
              std dev =       0.559847378751
             le_variance =       0.313429087495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216036497343        initial  <--
     2.4414e+26     2.4414e+27             0.0000e+00       -17.216036497343
     9.7656e+26     9.7656e+27             0.0000e+00       -17.216036497343
     3.9062e+27     3.9062e+28             0.0000e+00       -17.216036497343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0619
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4654e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.252057
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1087e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310948550820
                                         uncertainty =       0.002807000834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310948550820
                                         uncertainty =       0.002807000834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394252729
  error estimate for blocks of size 2^( 2) =       0.000404227025
  error estimate for blocks of size 2^( 3) =       0.000413297150
  error estimate for blocks of size 2^( 4) =       0.000420370633
  error estimate for blocks of size 2^( 5) =       0.000424145152
  error estimate for blocks of size 2^( 6) =       0.000426134096
  error estimate for blocks of size 2^( 7) =       0.000426982507

      target function =                  N/A
              le_mean =     -17.216877442178
             les_mean =     296.731739132692
             stat err =       0.000424408097
             autocorr =       1.158825129838
              std dev =       0.557557556814
             le_variance =       0.310870429160


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687744218e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877442178       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877442178       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877442203       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 2.217722e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877442178       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877442178       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877442086       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 5.544304e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+28, overlap shift 3.9062e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877442178       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877442178       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877442319       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+28 is 1.386076e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.316606 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5673e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2618
    reference variance = 0.241918
====================================================
  Execution time = 1.9658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8197e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393252623
  error estimate for blocks of size 2^( 2) =       0.000403199584
  error estimate for blocks of size 2^( 3) =       0.000412060175
  error estimate for blocks of size 2^( 4) =       0.000418845294
  error estimate for blocks of size 2^( 5) =       0.000422599363
  error estimate for blocks of size 2^( 6) =       0.000424027372
  error estimate for blocks of size 2^( 7) =       0.000424684559

      target function =                  N/A
              le_mean =     -17.216456846836
             les_mean =     296.715681455719
             stat err =       0.000422539147
             autocorr =       1.154491250466
              std dev =       0.556143193247
             le_variance =       0.309295251394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393252623
  error estimate for blocks of size 2^( 2) =       0.000403199584
  error estimate for blocks of size 2^( 3) =       0.000412060175
  error estimate for blocks of size 2^( 4) =       0.000418845294
  error estimate for blocks of size 2^( 5) =       0.000422599363
  error estimate for blocks of size 2^( 6) =       0.000424027372
  error estimate for blocks of size 2^( 7) =       0.000424684559

      target function =                  N/A
              le_mean =     -17.216456846836
             les_mean =     296.715681455719
             stat err =       0.000422539147
             autocorr =       1.154491250466
              std dev =       0.556143193247
             le_variance =       0.309295251394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393252623
  error estimate for blocks of size 2^( 2) =       0.000403199584
  error estimate for blocks of size 2^( 3) =       0.000412060175
  error estimate for blocks of size 2^( 4) =       0.000418845294
  error estimate for blocks of size 2^( 5) =       0.000422599363
  error estimate for blocks of size 2^( 6) =       0.000424027372
  error estimate for blocks of size 2^( 7) =       0.000424684559

      target function =                  N/A
              le_mean =     -17.216456846836
             les_mean =     296.715681455719
             stat err =       0.000422539147
             autocorr =       1.154491250466
              std dev =       0.556143193247
             le_variance =       0.309295251394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309354271848
                                         uncertainty =       0.003272149668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393252623
  error estimate for blocks of size 2^( 2) =       0.000403199584
  error estimate for blocks of size 2^( 3) =       0.000412060175
  error estimate for blocks of size 2^( 4) =       0.000418845294
  error estimate for blocks of size 2^( 5) =       0.000422599363
  error estimate for blocks of size 2^( 6) =       0.000424027372
  error estimate for blocks of size 2^( 7) =       0.000424684559

      target function =                  N/A
              le_mean =     -17.216456846836
             les_mean =     296.715681455719
             stat err =       0.000422539147
             autocorr =       1.154491250466
              std dev =       0.556143193247
             le_variance =       0.309295251394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216456846836        initial  <--
     2.4414e+27     2.4414e+28             2.2177e-31       -17.216456846836
     9.7656e+27     9.7656e+28             5.5443e-32       -17.216456846836
     3.9062e+28     3.9062e+29             1.3861e-32       -17.216456846836

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8487
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4528e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2328
    reference variance = 0.348918
====================================================
  Execution time = 2.0022e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1360e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313666431337
                                         uncertainty =       0.006154070426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313666431337
                                         uncertainty =       0.006154070426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395980555
  error estimate for blocks of size 2^( 2) =       0.000405827087
  error estimate for blocks of size 2^( 3) =       0.000414709080
  error estimate for blocks of size 2^( 4) =       0.000420718827
  error estimate for blocks of size 2^( 5) =       0.000424510754
  error estimate for blocks of size 2^( 6) =       0.000425149543
  error estimate for blocks of size 2^( 7) =       0.000428972518

      target function =                  N/A
              le_mean =     -17.216246826451
             les_mean =     296.712755832692
             stat err =       0.000424837911
             autocorr =       1.151062242941
              std dev =       0.560001071600
             le_variance =       0.313601200193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721624682645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+28, overlap shift 2.4414e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216246826451       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216246826451       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216246826574       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+28 is 1.691930e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+28, overlap shift 9.7656e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216246826451       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216246826451       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216246826574       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+28 is 4.229824e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+29, overlap shift 3.9062e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216246826451       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216246826451       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216246826574       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+29 is 1.057456e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5565e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2167
    reference variance = 0.208694
====================================================
  Execution time = 2.0049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2686e-01
  Total weights = 2.0000e+06
  Execution time = 1.8184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404262972
  error estimate for blocks of size 2^( 2) =       0.000413923452
  error estimate for blocks of size 2^( 3) =       0.000422532304
  error estimate for blocks of size 2^( 4) =       0.000428803601
  error estimate for blocks of size 2^( 5) =       0.000432741008
  error estimate for blocks of size 2^( 6) =       0.000435530213
  error estimate for blocks of size 2^( 7) =       0.000434829962

      target function =                  N/A
              le_mean =     -17.215524974666
             les_mean =     296.701157091486
             stat err =       0.000432976196
             autocorr =       1.147096915021
              std dev =       0.571714178201
             le_variance =       0.326857101556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404262972
  error estimate for blocks of size 2^( 2) =       0.000413923452
  error estimate for blocks of size 2^( 3) =       0.000422532304
  error estimate for blocks of size 2^( 4) =       0.000428803601
  error estimate for blocks of size 2^( 5) =       0.000432741008
  error estimate for blocks of size 2^( 6) =       0.000435530213
  error estimate for blocks of size 2^( 7) =       0.000434829962

      target function =                  N/A
              le_mean =     -17.215524974666
             les_mean =     296.701157091486
             stat err =       0.000432976196
             autocorr =       1.147096915021
              std dev =       0.571714178201
             le_variance =       0.326857101556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404262972
  error estimate for blocks of size 2^( 2) =       0.000413923452
  error estimate for blocks of size 2^( 3) =       0.000422532304
  error estimate for blocks of size 2^( 4) =       0.000428803601
  error estimate for blocks of size 2^( 5) =       0.000432741008
  error estimate for blocks of size 2^( 6) =       0.000435530213
  error estimate for blocks of size 2^( 7) =       0.000434829962

      target function =                  N/A
              le_mean =     -17.215524974666
             les_mean =     296.701157091486
             stat err =       0.000432976196
             autocorr =       1.147096915021
              std dev =       0.571714178201
             le_variance =       0.326857101556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326897444709
                                         uncertainty =       0.010201943359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404262972
  error estimate for blocks of size 2^( 2) =       0.000413923452
  error estimate for blocks of size 2^( 3) =       0.000422532304
  error estimate for blocks of size 2^( 4) =       0.000428803601
  error estimate for blocks of size 2^( 5) =       0.000432741008
  error estimate for blocks of size 2^( 6) =       0.000435530213
  error estimate for blocks of size 2^( 7) =       0.000434829962

      target function =                  N/A
              le_mean =     -17.215524974666
             les_mean =     296.701157091486
             stat err =       0.000432976196
             autocorr =       1.147096915021
              std dev =       0.571714178201
             le_variance =       0.326857101556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215524974666        initial  <--
     2.4414e+28     2.4414e+29             1.6919e-32       -17.215524974666
     9.7656e+28     9.7656e+29             4.2298e-33       -17.215524974666
     3.9062e+29     3.9062e+30             1.0575e-33       -17.215524974666

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2267
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.0829
    reference variance = 0.475572
====================================================
  Execution time = 1.9993e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1398e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313998536782
                                         uncertainty =       0.002898506633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313998536782
                                         uncertainty =       0.002898506633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396222366
  error estimate for blocks of size 2^( 2) =       0.000405720498
  error estimate for blocks of size 2^( 3) =       0.000414423351
  error estimate for blocks of size 2^( 4) =       0.000421416138
  error estimate for blocks of size 2^( 5) =       0.000425803594
  error estimate for blocks of size 2^( 6) =       0.000428548549
  error estimate for blocks of size 2^( 7) =       0.000430546497

      target function =                  N/A
              le_mean =     -17.215844728758
             les_mean =     296.699293894663
             stat err =       0.000426578695
             autocorr =       1.159098509604
              std dev =       0.560343044004
             le_variance =       0.313984326964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721584472876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+29, overlap shift 2.4414e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+29, overlap shift 9.7656e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.9062e+30, overlap shift 3.9062e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215844728758       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.318904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5507e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2536
    reference variance = 0.437397
====================================================
  Execution time = 2.1552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2711e-01
  Total weights = 2.0000e+06
  Execution time = 1.8253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404418301
  error estimate for blocks of size 2^( 2) =       0.000414229628
  error estimate for blocks of size 2^( 3) =       0.000423206547
  error estimate for blocks of size 2^( 4) =       0.000429694510
  error estimate for blocks of size 2^( 5) =       0.000433787456
  error estimate for blocks of size 2^( 6) =       0.000436266426
  error estimate for blocks of size 2^( 7) =       0.000436729270

      target function =                  N/A
              le_mean =     -17.215630244352
             les_mean =     296.705032870392
             stat err =       0.000434119415
             autocorr =       1.152276803469
              std dev =       0.571933845565
             le_variance =       0.327108323702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404418301
  error estimate for blocks of size 2^( 2) =       0.000414229628
  error estimate for blocks of size 2^( 3) =       0.000423206547
  error estimate for blocks of size 2^( 4) =       0.000429694510
  error estimate for blocks of size 2^( 5) =       0.000433787456
  error estimate for blocks of size 2^( 6) =       0.000436266426
  error estimate for blocks of size 2^( 7) =       0.000436729270

      target function =                  N/A
              le_mean =     -17.215630244352
             les_mean =     296.705032870392
             stat err =       0.000434119415
             autocorr =       1.152276803469
              std dev =       0.571933845565
             le_variance =       0.327108323702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404418301
  error estimate for blocks of size 2^( 2) =       0.000414229628
  error estimate for blocks of size 2^( 3) =       0.000423206547
  error estimate for blocks of size 2^( 4) =       0.000429694510
  error estimate for blocks of size 2^( 5) =       0.000433787456
  error estimate for blocks of size 2^( 6) =       0.000436266426
  error estimate for blocks of size 2^( 7) =       0.000436729270

      target function =                  N/A
              le_mean =     -17.215630244352
             les_mean =     296.705032870392
             stat err =       0.000434119415
             autocorr =       1.152276803469
              std dev =       0.571933845565
             le_variance =       0.327108323702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327215287691
                                         uncertainty =       0.007330358437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404418301
  error estimate for blocks of size 2^( 2) =       0.000414229628
  error estimate for blocks of size 2^( 3) =       0.000423206547
  error estimate for blocks of size 2^( 4) =       0.000429694510
  error estimate for blocks of size 2^( 5) =       0.000433787456
  error estimate for blocks of size 2^( 6) =       0.000436266426
  error estimate for blocks of size 2^( 7) =       0.000436729270

      target function =                  N/A
              le_mean =     -17.215630244352
             les_mean =     296.705032870392
             stat err =       0.000434119415
             autocorr =       1.152276803469
              std dev =       0.571933845565
             le_variance =       0.327108323702


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215630244352        initial  <--
     2.4414e+29     2.4414e+30             0.0000e+00       -17.215630244352
     9.7656e+29     9.7656e+30             0.0000e+00       -17.215630244352
     3.9062e+30     3.9062e+31             0.0000e+00       -17.215630244352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7587
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.098000e-01 1 1  ON 0
 uu_1                 4.810422e-02 1 1  ON 1
 uu_2                -4.517452e-02 1 1  ON 2
 uu_3                -9.942900e-02 1 1  ON 3
 uu_4                -1.325366e-01 1 1  ON 4
 uu_5                -1.385152e-01 1 1  ON 5
 uu_6                -1.150449e-01 1 1  ON 6
 uu_7                -4.257158e-02 1 1  ON 7
 uu_8                 9.777373e-02 1 1  ON 8
 uu_9                 1.225505e-01 1 1  ON 9
 ud_0                 3.463231e-01 1 1  ON 10
 ud_1                 9.089905e-02 1 1  ON 11
 ud_2                -1.344790e-02 1 1  ON 12
 ud_3                -7.172925e-02 1 1  ON 13
 ud_4                -1.199510e-01 1 1  ON 14
 ud_5                -1.535074e-01 1 1  ON 15
 ud_6                -1.556998e-01 1 1  ON 16
 ud_7                -1.107672e-01 1 1  ON 17
 ud_8                 1.407801e-03 1 1  ON 18
 ud_9                 9.244352e-02 1 1  ON 19
 eO_0                -7.561679e-01 1 1  ON 20
 eO_1                -4.427567e-01 1 1  ON 21
 eO_2                -4.536668e-02 1 1  ON 22
 eO_3                 2.044045e-01 1 1  ON 23
 eO_4                 2.979160e-01 1 1  ON 24
 eO_5                 3.141659e-01 1 1  ON 25
 eO_6                 2.539434e-01 1 1  ON 26
 eO_7                 1.158792e-01 1 1  ON 27
 eO_8                 2.853293e-02 1 1  ON 28
 eO_9                 1.861835e-02 1 1  ON 29
eH1_0                -1.815315e-01 1 1  ON 30
eH1_1                -1.033513e-01 1 1  ON 31
eH1_2                -6.278690e-02 1 1  ON 32
eH1_3                -2.665635e-02 1 1  ON 33
eH1_4                 1.894694e-02 1 1  ON 34
eH1_5                 3.447160e-02 1 1  ON 35
eH1_6                 7.840214e-02 1 1  ON 36
eH1_7                 1.093415e-01 1 1  ON 37
eH1_8                 9.261207e-02 1 1  ON 38
eH1_9                 2.499365e-02 1 1  ON 39
eH2_0                -1.833813e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.407604e-02 1 1  ON 42
eH2_3                -2.758511e-02 1 1  ON 43
eH2_4                 1.792720e-02 1 1  ON 44
eH2_5                 3.386828e-02 1 1  ON 45
eH2_6                 7.883749e-02 1 1  ON 46
eH2_7                 1.133602e-01 1 1  ON 47
eH2_8                 9.618838e-02 1 1  ON 48
eH2_9                 2.707314e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6272e+01 secs
  Total Execution time = 2.2172e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
