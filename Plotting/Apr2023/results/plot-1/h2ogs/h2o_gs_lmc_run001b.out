Rank =    0  Free Memory = 85311 MB
Rank =    1  Free Memory = 85311 MB
Rank =    2  Free Memory = 85311 MB
Rank =    3  Free Memory = 85311 MB
Rank =    4  Free Memory = 85311 MB
Rank =    5  Free Memory = 85311 MB
Rank =    6  Free Memory = 85311 MB
Rank =    7  Free Memory = 85311 MB
Rank =    8  Free Memory = 85311 MB
Rank =    9  Free Memory = 85311 MB
Rank =   10  Free Memory = 85311 MB
Rank =   11  Free Memory = 85311 MB
Rank =   12  Free Memory = 85311 MB
Rank =   13  Free Memory = 85310 MB
Rank =   14  Free Memory = 85310 MB
Rank =   15  Free Memory = 85294 MB
Rank =   16  Free Memory = 85294 MB
Rank =   17  Free Memory = 85294 MB
Rank =   18  Free Memory = 85294 MB
Rank =   19  Free Memory = 85294 MB
Rank =   20  Free Memory = 85294 MB
Rank =   21  Free Memory = 85294 MB
Rank =   22  Free Memory = 85294 MB
Rank =   23  Free Memory = 85294 MB
Rank =   24  Free Memory = 85294 MB
Rank =   25  Free Memory = 85294 MB
Rank =   26  Free Memory = 85294 MB
Rank =   27  Free Memory = 85294 MB
Rank =   28  Free Memory = 85294 MB
Rank =   29  Free Memory = 85294 MB
Rank =   30  Free Memory = 85294 MB
Rank =   31  Free Memory = 85294 MB
Rank =   32  Free Memory = 84749 MB
Rank =   33  Free Memory = 84749 MB
Rank =   34  Free Memory = 84749 MB
Rank =   35  Free Memory = 84749 MB
Rank =   36  Free Memory = 84749 MB
Rank =   37  Free Memory = 84749 MB
Rank =   38  Free Memory = 84749 MB
Rank =   39  Free Memory = 84749 MB
Rank =   40  Free Memory = 84749 MB
Rank =   41  Free Memory = 84749 MB
Rank =   42  Free Memory = 84749 MB
Rank =   43  Free Memory = 84749 MB
Rank =   44  Free Memory = 84749 MB
Rank =   45  Free Memory = 84749 MB
Rank =   46  Free Memory = 84749 MB
Rank =   47  Free Memory = 84749 MB
Rank =   48  Free Memory = 84749 MB
Rank =   49  Free Memory = 84749 MB
Rank =   50  Free Memory = 84749 MB
Rank =   51  Free Memory = 84749 MB
Rank =   52  Free Memory = 84749 MB
Rank =   53  Free Memory = 84749 MB
Rank =   54  Free Memory = 84749 MB
Rank =   55  Free Memory = 84749 MB
Rank =   56  Free Memory = 84749 MB
Rank =   57  Free Memory = 84749 MB
Rank =   58  Free Memory = 84749 MB
Rank =   59  Free Memory = 84749 MB
Rank =   60  Free Memory = 84749 MB
Rank =   61  Free Memory = 84749 MB
Rank =   62  Free Memory = 84749 MB
Rank =   63  Free Memory = 84749 MB
Rank =   64  Free Memory = 84403 MB
Rank =   65  Free Memory = 84403 MB
Rank =   66  Free Memory = 84403 MB
Rank =   67  Free Memory = 84403 MB
Rank =   68  Free Memory = 84403 MB
Rank =   69  Free Memory = 84403 MB
Rank =   70  Free Memory = 84403 MB
Rank =   71  Free Memory = 84403 MB
Rank =   72  Free Memory = 84403 MB
Rank =   73  Free Memory = 84403 MB
Rank =   74  Free Memory = 84403 MB
Rank =   75  Free Memory = 84403 MB
Rank =   76  Free Memory = 84403 MB
Rank =   77  Free Memory = 84403 MB
Rank =   78  Free Memory = 84403 MB
Rank =   79  Free Memory = 84403 MB
Rank =   80  Free Memory = 84403 MB
Rank =   81  Free Memory = 84403 MB
Rank =   82  Free Memory = 84403 MB
Rank =   83  Free Memory = 84403 MB
Rank =   84  Free Memory = 84403 MB
Rank =   85  Free Memory = 84403 MB
Rank =   86  Free Memory = 84403 MB
Rank =   87  Free Memory = 84403 MB
Rank =   88  Free Memory = 84403 MB
Rank =   89  Free Memory = 84403 MB
Rank =   90  Free Memory = 84403 MB
Rank =   91  Free Memory = 84403 MB
Rank =   92  Free Memory = 84403 MB
Rank =   93  Free Memory = 84403 MB
Rank =   94  Free Memory = 84403 MB
Rank =   95  Free Memory = 84403 MB
Rank =   96  Free Memory = 90119 MB
Rank =   97  Free Memory = 90119 MB
Rank =   98  Free Memory = 90119 MB
Rank =   99  Free Memory = 90119 MB
Rank =  100  Free Memory = 90119 MB
Rank =  101  Free Memory = 90119 MB
Rank =  102  Free Memory = 90119 MB
Rank =  103  Free Memory = 90119 MB
Rank =  104  Free Memory = 90119 MB
Rank =  105  Free Memory = 90119 MB
Rank =  106  Free Memory = 90119 MB
Rank =  107  Free Memory = 90119 MB
Rank =  108  Free Memory = 90119 MB
Rank =  109  Free Memory = 90119 MB
Rank =  110  Free Memory = 90119 MB
Rank =  111  Free Memory = 90119 MB
Rank =  112  Free Memory = 90119 MB
Rank =  113  Free Memory = 90119 MB
Rank =  114  Free Memory = 90119 MB
Rank =  115  Free Memory = 90119 MB
Rank =  116  Free Memory = 90119 MB
Rank =  117  Free Memory = 90119 MB
Rank =  118  Free Memory = 90119 MB
Rank =  119  Free Memory = 90119 MB
Rank =  120  Free Memory = 90119 MB
Rank =  121  Free Memory = 90119 MB
Rank =  122  Free Memory = 90119 MB
Rank =  123  Free Memory = 90119 MB
Rank =  124  Free Memory = 90119 MB
Rank =  125  Free Memory = 90119 MB
Rank =  126  Free Memory = 90119 MB
Rank =  127  Free Memory = 90119 MB
  Input file(s): opt_h2o_gs_lmc_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmc_run001b.xml

  Project = H2O
  date    = 2023-03-02 15:53:19 PST
  host    = n0119.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 751

  Range of prime numbers to use as seeds over processors and threads = 5717-6841


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.036790e-01    1         1  ON     0
     uu_1                 4.369969e-02    1         1  ON     1
     uu_2                -4.751547e-02    1         1  ON     2
     uu_3                -9.904430e-02    1         1  ON     3
     uu_4                -1.294213e-01    1         1  ON     4
     uu_5                -1.342274e-01    1         1  ON     5
     uu_6                -1.118891e-01    1         1  ON     6
     uu_7                -3.803704e-02    1         1  ON     7
     uu_8                 1.008672e-01    1         1  ON     8
     uu_9                 1.201846e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.471060e-01    1         1  ON     0
     ud_1                 8.998273e-02    1         1  ON     1
     ud_2                -1.727333e-02    1         1  ON     2
     ud_3                -7.538141e-02    1         1  ON     3
     ud_4                -1.203878e-01    1         1  ON     4
     ud_5                -1.507891e-01    1         1  ON     5
     ud_6                -1.541543e-01    1         1  ON     6
     ud_7                -1.094148e-01    1         1  ON     7
     ud_8                 5.948648e-03    1         1  ON     8
     ud_9                 9.251987e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.402239e-01    1         1  ON     0
     eO_1                -4.286477e-01    1         1  ON     1
     eO_2                -3.455078e-02    1         1  ON     2
     eO_3                 2.024897e-01    1         1  ON     3
     eO_4                 2.802436e-01    1         1  ON     4
     eO_5                 3.038405e-01    1         1  ON     5
     eO_6                 2.493761e-01    1         1  ON     6
     eO_7                 1.108761e-01    1         1  ON     7
     eO_8                 2.771120e-02    1         1  ON     8
     eO_9                 1.834432e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.814828e-01    1         1  ON     0
     eH1_1                -1.020709e-01    1         1  ON     1
     eH1_2                -6.230105e-02    1         1  ON     2
     eH1_3                -2.601347e-02    1         1  ON     3
     eH1_4                 1.958757e-02    1         1  ON     4
     eH1_5                 3.568236e-02    1         1  ON     5
     eH1_6                 7.685541e-02    1         1  ON     6
     eH1_7                 1.104950e-01    1         1  ON     7
     eH1_8                 9.001442e-02    1         1  ON     8
     eH1_9                 2.406840e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.826246e-01    1         1  ON     0
     eH2_1                -1.035998e-01    1         1  ON     1
     eH2_2                -6.368915e-02    1         1  ON     2
     eH2_3                -2.766839e-02    1         1  ON     3
     eH2_4                 1.867338e-02    1         1  ON     4
     eH2_5                 3.506256e-02    1         1  ON     5
     eH2_6                 7.835843e-02    1         1  ON     6
     eH2_7                 1.139680e-01    1         1  ON     7
     eH2_8                 9.324152e-02    1         1  ON     8
     eH2_9                 2.614968e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.710690e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4843e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 119
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2028
    reference variance = 0.440567
====================================================
  Execution time = 2.2026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1892e-01
  Total weights = 1.956521825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298971314567
                                         uncertainty =       0.001927034406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298971314567
                                         uncertainty =       0.001927034406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386622766
  error estimate for blocks of size 2^( 2) =       0.000396822100
  error estimate for blocks of size 2^( 3) =       0.000406036782
  error estimate for blocks of size 2^( 4) =       0.000412576048
  error estimate for blocks of size 2^( 5) =       0.000416646386
  error estimate for blocks of size 2^( 6) =       0.000419055526
  error estimate for blocks of size 2^( 7) =       0.000421001952

      target function =                  N/A
              le_mean =     -17.216777857434
             les_mean =     296.736359861073
             stat err =       0.000417319978
             autocorr =       1.165100809039
              std dev =       0.546767159407
             le_variance =       0.298954326606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721677785743e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777857484       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216791391427       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216794243529       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216790880000       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216804035995       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803364362       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216804419353       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216804953025       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216805313548       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216805639770       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216804845042       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216804695730       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216804828717       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216804934275       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e-01 is 3.974154e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777857484       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783219949       residual = 8.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216784583385       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216783216892       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216786818304       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216787538539       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216787345276       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216787448914       residual = 8.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216787514972       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216787501411       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216787397204       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+00 is 1.114704e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777857484       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216779427702       residual = 9.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216779860489       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216779597774       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216780549867       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216780688363       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216780601390       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216780625687       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216780636915       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216780627172       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+00 is 2.874704e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8330e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0   2.039440e-01                 1 1 ON  0
uu_1   4.386615e-02                 1 1 ON  1
uu_2   -4.746074e-02                1 1 ON  2
uu_3   -9.914059e-02                1 1 ON  3
uu_4   -1.295426e-01                1 1 ON  4
uu_5   -1.343670e-01                1 1 ON  5
uu_6   -1.119456e-01                1 1 ON  6
uu_7   -3.817224e-02                1 1 ON  7
uu_8   1.007792e-01                 1 1 ON  8
uu_9   1.202439e-01                 1 1 ON  9
ud_0   3.474170e-01                 1 1 ON  10
ud_1   9.014529e-02                 1 1 ON  11
ud_2   -1.723482e-02                1 1 ON  12
ud_3   -7.547735e-02                1 1 ON  13
ud_4   -1.206109e-01                1 1 ON  14
ud_5   -1.508976e-01                1 1 ON  15
ud_6   -1.541280e-01                1 1 ON  16
ud_7   -1.095161e-01                1 1 ON  17
ud_8   5.835188e-03                 1 1 ON  18
ud_9   9.254180e-02                 1 1 ON  19
eO_0   -7.413386e-01                1 1 ON  20
eO_1   -4.293173e-01                1 1 ON  21
eO_2   -3.457282e-02                1 1 ON  22
eO_3   2.032464e-01                 1 1 ON  23
eO_4   2.810581e-01                 1 1 ON  24
eO_5   3.038759e-01                 1 1 ON  25
eO_6   2.494240e-01                 1 1 ON  26
eO_7   1.109839e-01                 1 1 ON  27
eO_8   2.773244e-02                 1 1 ON  28
eO_9   1.835739e-02                 1 1 ON  29
eH1_0  -1.815798e-01                1 1 ON  30
eH1_1  -1.020669e-01                1 1 ON  31
eH1_2  -6.233011e-02                1 1 ON  32
eH1_3  -2.603079e-02                1 1 ON  33
eH1_4  1.964356e-02                 1 1 ON  34
eH1_5  3.572916e-02                 1 1 ON  35
eH1_6  7.682498e-02                 1 1 ON  36
eH1_7  1.104673e-01                 1 1 ON  37
eH1_8  9.008584e-02                 1 1 ON  38
eH1_9  2.408292e-02                 1 1 ON  39
eH2_0  -1.826822e-01                1 1 ON  40
eH2_1  -1.035468e-01                1 1 ON  41
eH2_2  -6.366381e-02                1 1 ON  42
eH2_3  -2.766255e-02                1 1 ON  43
eH2_4  1.863364e-02                 1 1 ON  44
eH2_5  3.508414e-02                 1 1 ON  45
eH2_6  7.830362e-02                 1 1 ON  46
eH2_7  1.139141e-01                 1 1 ON  47
eH2_8  9.330312e-02                 1 1 ON  48
eH2_9  2.617521e-02                 1 1 ON  49
ci_001 -4.137506e-02                3 1 ON  50
ci_002 -3.005795e-02                3 1 ON  51
ci_003 -2.523131e-02                3 1 ON  52
ci_004 2.147845e-02                 3 1 ON  53
ci_005 2.168453e-02                 3 1 ON  54
ci_006 -1.880984e-02                3 1 ON  55
ci_007 -1.928428e-02                3 1 ON  56
ci_008 -1.794151e-02                3 1 ON  57
ci_009 -1.771169e-02                3 1 ON  58
ci_010 -1.792282e-02                3 1 ON  59
ci_011 -1.642054e-02                3 1 ON  60
ci_012 -1.642726e-02                3 1 ON  61
ci_013 -1.909951e-02                3 1 ON  62
ci_014 1.382166e-02                 3 1 ON  63
ci_015 1.389944e-02                 3 1 ON  64
ci_016 1.630559e-02                 3 1 ON  65
ci_017 1.661642e-02                 3 1 ON  66
ci_018 1.248708e-02                 3 1 ON  67
ci_019 1.308850e-02                 3 1 ON  68
ci_020 1.329225e-02                 3 1 ON  69
ci_021 1.353497e-02                 3 1 ON  70
ci_022 1.166100e-02                 3 1 ON  71
ci_023 1.129580e-02                 3 1 ON  72
ci_024 1.235758e-02                 3 1 ON  73
ci_025 1.222653e-02                 3 1 ON  74
ci_026 1.107771e-02                 3 1 ON  75
ci_027 1.138167e-02                 3 1 ON  76
ci_028 -1.445352e-02                3 1 ON  77
ci_029 -1.480081e-02                3 1 ON  78
ci_030 -1.101173e-02                3 1 ON  79
ci_031 -1.174609e-02                3 1 ON  80
ci_032 -1.348119e-02                3 1 ON  81
ci_033 1.091539e-02                 3 1 ON  82
ci_034 1.057428e-02                 3 1 ON  83
ci_035 -4.876226e-03                3 1 ON  84
ci_036 -1.072423e-02                3 1 ON  85
ci_037 -1.018856e-02                3 1 ON  86
ci_038 1.548793e-03                 3 1 ON  87
ci_039 1.948780e-03                 3 1 ON  88
ci_040 -4.129383e-03                3 1 ON  89
ci_041 9.993140e-03                 3 1 ON  90
ci_042 9.667208e-03                 3 1 ON  91
ci_043 -3.457118e-03                3 1 ON  92
ci_044 -1.536479e-02                3 1 ON  93
ci_045 -1.582231e-03                3 1 ON  94
ci_046 5.262535e-03                 3 1 ON  95
ci_047 5.649291e-03                 3 1 ON  96
ci_048 -1.137266e-02                3 1 ON  97
ci_049 -1.181422e-02                3 1 ON  98
ci_050 7.559613e-03                 3 1 ON  99
ci_051 7.839013e-03                 3 1 ON  100
ci_052 -6.899945e-03                3 1 ON  101
ci_053 -6.811247e-03                3 1 ON  102
ci_054 -2.909981e-03                3 1 ON  103
ci_055 -2.945648e-03                3 1 ON  104
ci_056 4.613196e-03                 3 1 ON  105
ci_057 4.557027e-03                 3 1 ON  106
ci_058 -6.796549e-03                3 1 ON  107
ci_059 -6.833839e-03                3 1 ON  108
ci_060 8.441737e-03                 3 1 ON  109
ci_061 8.176392e-03                 3 1 ON  110
ci_062 -3.207018e-03                3 1 ON  111
ci_063 -3.152124e-03                3 1 ON  112
ci_064 -3.128821e-03                3 1 ON  113
ci_065 -4.152845e-03                3 1 ON  114
ci_066 5.997400e-03                 3 1 ON  115
ci_067 5.387379e-03                 3 1 ON  116
ci_068 -5.028231e-03                3 1 ON  117
ci_069 -4.897141e-03                3 1 ON  118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.264
    reference variance = 0.408391
====================================================
  Execution time = 2.0487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1476e-01
  Total weights = 1.9567e+06
  Execution time = 1.8337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299248441097
                                         uncertainty =       0.002006153159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299248441097
                                         uncertainty =       0.002006153159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386802847
  error estimate for blocks of size 2^( 2) =       0.000396891968
  error estimate for blocks of size 2^( 3) =       0.000405944335
  error estimate for blocks of size 2^( 4) =       0.000412980500
  error estimate for blocks of size 2^( 5) =       0.000417630628
  error estimate for blocks of size 2^( 6) =       0.000419128294
  error estimate for blocks of size 2^( 7) =       0.000421298174

      target function =                  N/A
              le_mean =     -17.216758569972
             les_mean =     296.732645282355
             stat err =       0.000417759399
             autocorr =       1.166468821590
              std dev =       0.547021832418
             le_variance =       0.299232885142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299495140677
                                         uncertainty =       0.001996886387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299495140677
                                         uncertainty =       0.001996886387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961839
  error estimate for blocks of size 2^( 2) =       0.000397044904
  error estimate for blocks of size 2^( 3) =       0.000406096364
  error estimate for blocks of size 2^( 4) =       0.000413119912
  error estimate for blocks of size 2^( 5) =       0.000417798772
  error estimate for blocks of size 2^( 6) =       0.000419311886
  error estimate for blocks of size 2^( 7) =       0.000421507573

      target function =                  N/A
              le_mean =     -17.216754264397
             les_mean =     296.752352126940
             stat err =       0.000417934536
             autocorr =       1.166487914565
              std dev =       0.547246681255
             le_variance =       0.299478930144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299296992152
                                         uncertainty =       0.001997942571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299296992152
                                         uncertainty =       0.001997942571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386833845
  error estimate for blocks of size 2^( 2) =       0.000396925024
  error estimate for blocks of size 2^( 3) =       0.000405983500
  error estimate for blocks of size 2^( 4) =       0.000413015501
  error estimate for blocks of size 2^( 5) =       0.000417687071
  error estimate for blocks of size 2^( 6) =       0.000419192132
  error estimate for blocks of size 2^( 7) =       0.000421376655

      target function =                  N/A
              le_mean =     -17.216750693029
             les_mean =     296.734866207049
             stat err =       0.000417817840
             autocorr =       1.166608214422
              std dev =       0.547065669776
             le_variance =       0.299280847047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299241690737
                                         uncertainty =       0.002004773953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299241690737
                                         uncertainty =       0.002004773953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386798427
  error estimate for blocks of size 2^( 2) =       0.000396888176
  error estimate for blocks of size 2^( 3) =       0.000405941723
  error estimate for blocks of size 2^( 4) =       0.000412977723
  error estimate for blocks of size 2^( 5) =       0.000417630778
  error estimate for blocks of size 2^( 6) =       0.000419129160
  error estimate for blocks of size 2^( 7) =       0.000421300945

      target function =                  N/A
              le_mean =     -17.216755990213
             les_mean =     296.731467435042
             stat err =       0.000417759652
             autocorr =       1.166496893317
              std dev =       0.547015581277
             le_variance =       0.299226046160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216758569972        initial  <--
     2.5000e-01     2.5000e+00             3.9742e-03       -17.216754264397
     1.0000e+00     1.0000e+01             1.1147e-03       -17.216750693029
     4.0000e+00     4.0000e+01             2.8747e-04       -17.216755990213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7447
  </log>
  <optVariables href="H2O.s000.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1839
    reference variance = 0.273694
====================================================
  Execution time = 2.1198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1115e-01
  Total weights = 1.956750018e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298141259924
                                         uncertainty =       0.001726336884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298141259924
                                         uncertainty =       0.001726336884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386087753
  error estimate for blocks of size 2^( 2) =       0.000396462885
  error estimate for blocks of size 2^( 3) =       0.000405895458
  error estimate for blocks of size 2^( 4) =       0.000412413073
  error estimate for blocks of size 2^( 5) =       0.000416311052
  error estimate for blocks of size 2^( 6) =       0.000418721889
  error estimate for blocks of size 2^( 7) =       0.000418053120

      target function =                  N/A
              le_mean =     -17.216795763310
             les_mean =     296.729210799221
             stat err =       0.000416374784
             autocorr =       1.163045720438
              std dev =       0.546010537149
             le_variance =       0.298127506677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679576331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795763345       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795454693       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795506812       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795756229       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216796915726       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216796968439       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216796717871       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216796707653       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216796616670       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216796617885       residual = 9.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+00 is 4.321601e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795763345       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795679992       residual = 3.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795693601       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795746537       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216796040315       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216796062368       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216796004975       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216795998345       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216795974217       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216795973701       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+01 is 1.094054e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216795763345       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216795742080       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216795745522       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216795758020       residual = 6.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216795831803       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216795838028       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216795823899       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216795822158       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216795816001       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216795815739       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+01 is 2.743750e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.184112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7341e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.037069e-01 1 1  ON 0
  uu_1                 4.371083e-02 1 1  ON 1
  uu_2                -4.750894e-02 1 1  ON 2
  uu_3                -9.905717e-02 1 1  ON 3
  uu_4                -1.294327e-01 1 1  ON 4
  uu_5                -1.342408e-01 1 1  ON 5
  uu_6                -1.118970e-01 1 1  ON 6
  uu_7                -3.804643e-02 1 1  ON 7
  uu_8                 1.008626e-01 1 1  ON 8
  uu_9                 1.201903e-01 1 1  ON 9
  ud_0                 3.471263e-01 1 1  ON 10
  ud_1                 9.000603e-02 1 1  ON 11
  ud_2                -1.726995e-02 1 1  ON 12
  ud_3                -7.538960e-02 1 1  ON 13
  ud_4                -1.204105e-01 1 1  ON 14
  ud_5                -1.508052e-01 1 1  ON 15
  ud_6                -1.541492e-01 1 1  ON 16
  ud_7                -1.094191e-01 1 1  ON 17
  ud_8                 5.937496e-03 1 1  ON 18
  ud_9                 9.252085e-02 1 1  ON 19
  eO_0                -7.403333e-01 1 1  ON 20
  eO_1                -4.287148e-01 1 1  ON 21
  eO_2                -3.455568e-02 1 1  ON 22
  eO_3                 2.025680e-01 1 1  ON 23
  eO_4                 2.803190e-01 1 1  ON 24
  eO_5                 3.038441e-01 1 1  ON 25
  eO_6                 2.493836e-01 1 1  ON 26
  eO_7                 1.108890e-01 1 1  ON 27
  eO_8                 2.771293e-02 1 1  ON 28
  eO_9                 1.834514e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020747e-01 1 1  ON 31
 eH1_2                -6.229962e-02 1 1  ON 32
 eH1_3                -2.601936e-02 1 1  ON 33
 eH1_4                 1.958594e-02 1 1  ON 34
 eH1_5                 3.568547e-02 1 1  ON 35
 eH1_6                 7.685660e-02 1 1  ON 36
 eH1_7                 1.104911e-01 1 1  ON 37
 eH1_8                 9.002030e-02 1 1  ON 38
 eH1_9                 2.407060e-02 1 1  ON 39
 eH2_0                -1.826461e-01 1 1  ON 40
 eH2_1                -1.035981e-01 1 1  ON 41
 eH2_2                -6.368815e-02 1 1  ON 42
 eH2_3                -2.767187e-02 1 1  ON 43
 eH2_4                 1.868053e-02 1 1  ON 44
 eH2_5                 3.506891e-02 1 1  ON 45
 eH2_6                 7.835945e-02 1 1  ON 46
 eH2_7                 1.139660e-01 1 1  ON 47
 eH2_8                 9.324842e-02 1 1  ON 48
 eH2_9                 2.615157e-02 1 1  ON 49
ci_001                -4.168209e-02 3 1  ON 50
ci_002                -3.011543e-02 3 1  ON 51
ci_003                -2.528451e-02 3 1  ON 52
ci_004                 2.145747e-02 3 1  ON 53
ci_005                 2.161807e-02 3 1  ON 54
ci_006                -1.879500e-02 3 1  ON 55
ci_007                -1.931141e-02 3 1  ON 56
ci_008                -1.806532e-02 3 1  ON 57
ci_009                -1.765109e-02 3 1  ON 58
ci_010                -1.789686e-02 3 1  ON 59
ci_011                -1.637950e-02 3 1  ON 60
ci_012                -1.646891e-02 3 1  ON 61
ci_013                -1.900165e-02 3 1  ON 62
ci_014                 1.375828e-02 3 1  ON 63
ci_015                 1.398022e-02 3 1  ON 64
ci_016                 1.633818e-02 3 1  ON 65
ci_017                 1.652994e-02 3 1  ON 66
ci_018                 1.261400e-02 3 1  ON 67
ci_019                 1.291214e-02 3 1  ON 68
ci_020                 1.326363e-02 3 1  ON 69
ci_021                 1.358824e-02 3 1  ON 70
ci_022                 1.175715e-02 3 1  ON 71
ci_023                 1.150944e-02 3 1  ON 72
ci_024                 1.250028e-02 3 1  ON 73
ci_025                 1.221512e-02 3 1  ON 74
ci_026                 1.113717e-02 3 1  ON 75
ci_027                 1.150004e-02 3 1  ON 76
ci_028                -1.444597e-02 3 1  ON 77
ci_029                -1.476745e-02 3 1  ON 78
ci_030                -1.102368e-02 3 1  ON 79
ci_031                -1.178580e-02 3 1  ON 80
ci_032                -1.333532e-02 3 1  ON 81
ci_033                 1.087598e-02 3 1  ON 82
ci_034                 1.077510e-02 3 1  ON 83
ci_035                -4.980361e-03 3 1  ON 84
ci_036                -1.088280e-02 3 1  ON 85
ci_037                -1.030256e-02 3 1  ON 86
ci_038                 1.623003e-03 3 1  ON 87
ci_039                 1.982267e-03 3 1  ON 88
ci_040                -4.104478e-03 3 1  ON 89
ci_041                 1.001377e-02 3 1  ON 90
ci_042                 9.728315e-03 3 1  ON 91
ci_043                -3.590306e-03 3 1  ON 92
ci_044                -1.540622e-02 3 1  ON 93
ci_045                -1.676321e-03 3 1  ON 94
ci_046                 5.229803e-03 3 1  ON 95
ci_047                 5.902996e-03 3 1  ON 96
ci_048                -1.129721e-02 3 1  ON 97
ci_049                -1.192047e-02 3 1  ON 98
ci_050                 7.701092e-03 3 1  ON 99
ci_051                 7.755358e-03 3 1  ON 100
ci_052                -7.014130e-03 3 1  ON 101
ci_053                -6.757092e-03 3 1  ON 102
ci_054                -2.943277e-03 3 1  ON 103
ci_055                -3.094614e-03 3 1  ON 104
ci_056                 4.770324e-03 3 1  ON 105
ci_057                 4.624977e-03 3 1  ON 106
ci_058                -6.921236e-03 3 1  ON 107
ci_059                -6.799699e-03 3 1  ON 108
ci_060                 8.401316e-03 3 1  ON 109
ci_061                 8.238764e-03 3 1  ON 110
ci_062                -3.043322e-03 3 1  ON 111
ci_063                -2.997880e-03 3 1  ON 112
ci_064                -3.003779e-03 3 1  ON 113
ci_065                -4.126987e-03 3 1  ON 114
ci_066                 6.034072e-03 3 1  ON 115
ci_067                 5.235867e-03 3 1  ON 116
ci_068                -5.360208e-03 3 1  ON 117
ci_069                -5.094890e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2449
    reference variance = 0.220286
====================================================
  Execution time = 2.0632e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1710e-01
  Total weights = 1.9568e+06
  Execution time = 1.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302245105076
                                         uncertainty =       0.003447133044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302245105076
                                         uncertainty =       0.003447133044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388753177
  error estimate for blocks of size 2^( 2) =       0.000399209536
  error estimate for blocks of size 2^( 3) =       0.000408429231
  error estimate for blocks of size 2^( 4) =       0.000414509060
  error estimate for blocks of size 2^( 5) =       0.000418572859
  error estimate for blocks of size 2^( 6) =       0.000420650726
  error estimate for blocks of size 2^( 7) =       0.000421963079

      target function =                  N/A
              le_mean =     -17.215943286974
             les_mean =     296.705835019810
             stat err =       0.000418923931
             autocorr =       1.161241207550
              std dev =       0.549780014666
             le_variance =       0.302258064526

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240527229
                                         uncertainty =       0.003481474052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302240527229
                                         uncertainty =       0.003481474052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388750093
  error estimate for blocks of size 2^( 2) =       0.000399205824
  error estimate for blocks of size 2^( 3) =       0.000408423615
  error estimate for blocks of size 2^( 4) =       0.000414504211
  error estimate for blocks of size 2^( 5) =       0.000418571603
  error estimate for blocks of size 2^( 6) =       0.000420640964
  error estimate for blocks of size 2^( 7) =       0.000421967912

      target function =                  N/A
              le_mean =     -17.215942492647
             les_mean =     296.814174901248
             stat err =       0.000418921173
             autocorr =       1.161244336589
              std dev =       0.549775653950
             le_variance =       0.302253269676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302235482596
                                         uncertainty =       0.003465770510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302235482596
                                         uncertainty =       0.003465770510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388746913
  error estimate for blocks of size 2^( 2) =       0.000399203261
  error estimate for blocks of size 2^( 3) =       0.000408421963
  error estimate for blocks of size 2^( 4) =       0.000414501242
  error estimate for blocks of size 2^( 5) =       0.000418565971
  error estimate for blocks of size 2^( 6) =       0.000420642252
  error estimate for blocks of size 2^( 7) =       0.000421961753

      target function =                  N/A
              le_mean =     -17.215941989036
             les_mean =     296.705811773860
             stat err =       0.000418917805
             autocorr =       1.161244660754
              std dev =       0.549771157387
             le_variance =       0.302248325495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302243497197
                                         uncertainty =       0.003449486057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302243497197
                                         uncertainty =       0.003449486057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388752133
  error estimate for blocks of size 2^( 2) =       0.000399208497
  error estimate for blocks of size 2^( 3) =       0.000408428095
  error estimate for blocks of size 2^( 4) =       0.000414507849
  error estimate for blocks of size 2^( 5) =       0.000418571774
  error estimate for blocks of size 2^( 6) =       0.000420649453
  error estimate for blocks of size 2^( 7) =       0.000421962689

      target function =                  N/A
              le_mean =     -17.215943101683
             les_mean =     296.705795298073
             stat err =       0.000418922941
             autocorr =       1.161241953794
              std dev =       0.549778538757
             le_variance =       0.302256441678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215943286974        initial  <--
     2.5000e+00     2.5000e+01             4.3216e-04       -17.215942492647
     1.0000e+01     1.0000e+02             1.0941e-04       -17.215941989036
     4.0000e+01     4.0000e+02             2.7437e-05       -17.215943101683

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8556
  </log>
  <optVariables href="H2O.s001.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2692
    reference variance = 0.42921
====================================================
  Execution time = 2.0778e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1208e-01
  Total weights = 1.956459527e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298682903303
                                         uncertainty =       0.002191109087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298682903303
                                         uncertainty =       0.002191109087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386532066
  error estimate for blocks of size 2^( 2) =       0.000396744909
  error estimate for blocks of size 2^( 3) =       0.000405131324
  error estimate for blocks of size 2^( 4) =       0.000412272510
  error estimate for blocks of size 2^( 5) =       0.000416900942
  error estimate for blocks of size 2^( 6) =       0.000417366386
  error estimate for blocks of size 2^( 7) =       0.000418357273

      target function =                  N/A
              le_mean =     -17.216329021147
             les_mean =     296.714069622880
             stat err =       0.000416224278
             autocorr =       1.159534730040
              std dev =       0.546638889615
             le_variance =       0.298814075639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632902115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216329021174       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216329186314       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216329225410       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216329250037       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216329307814       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216329308700       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216329298661       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216329306114       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216329299972       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216329295545       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+01 is 4.249059e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216329021174       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216329062770       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216329072723       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216329078806       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216329094032       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216329092464       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216329090944       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216329092826       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216329091308       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216329090189       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+02 is 1.062495e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216329021174       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216329031593       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216329034092       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216329035608       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216329039391       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216329039139       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216329038635       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216329039114       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216329038736       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216329038455       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+02 is 2.656370e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6841e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.036823e-01 1 1  ON 0
  uu_1                 4.370165e-02 1 1  ON 1
  uu_2                -4.751506e-02 1 1  ON 2
  uu_3                -9.904537e-02 1 1  ON 3
  uu_4                -1.294230e-01 1 1  ON 4
  uu_5                -1.342285e-01 1 1  ON 5
  uu_6                -1.118901e-01 1 1  ON 6
  uu_7                -3.803824e-02 1 1  ON 7
  uu_8                 1.008665e-01 1 1  ON 8
  uu_9                 1.201851e-01 1 1  ON 9
  ud_0                 3.471110e-01 1 1  ON 10
  ud_1                 8.998378e-02 1 1  ON 11
  ud_2                -1.727340e-02 1 1  ON 12
  ud_3                -7.538245e-02 1 1  ON 13
  ud_4                -1.203905e-01 1 1  ON 14
  ud_5                -1.507905e-01 1 1  ON 15
  ud_6                -1.541544e-01 1 1  ON 16
  ud_7                -1.094149e-01 1 1  ON 17
  ud_8                 5.947530e-03 1 1  ON 18
  ud_9                 9.251976e-02 1 1  ON 19
  eO_0                -7.402346e-01 1 1  ON 20
  eO_1                -4.286550e-01 1 1  ON 21
  eO_2                -3.455124e-02 1 1  ON 22
  eO_3                 2.024971e-01 1 1  ON 23
  eO_4                 2.802518e-01 1 1  ON 24
  eO_5                 3.038412e-01 1 1  ON 25
  eO_6                 2.493768e-01 1 1  ON 26
  eO_7                 1.108774e-01 1 1  ON 27
  eO_8                 2.771134e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814832e-01 1 1  ON 30
 eH1_1                -1.020710e-01 1 1  ON 31
 eH1_2                -6.230093e-02 1 1  ON 32
 eH1_3                -2.601346e-02 1 1  ON 33
 eH1_4                 1.958733e-02 1 1  ON 34
 eH1_5                 3.568271e-02 1 1  ON 35
 eH1_6                 7.685528e-02 1 1  ON 36
 eH1_7                 1.104945e-01 1 1  ON 37
 eH1_8                 9.001503e-02 1 1  ON 38
 eH1_9                 2.406859e-02 1 1  ON 39
 eH2_0                -1.826250e-01 1 1  ON 40
 eH2_1                -1.036012e-01 1 1  ON 41
 eH2_2                -6.368846e-02 1 1  ON 42
 eH2_3                -2.766845e-02 1 1  ON 43
 eH2_4                 1.867317e-02 1 1  ON 44
 eH2_5                 3.506282e-02 1 1  ON 45
 eH2_6                 7.835861e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324221e-02 1 1  ON 48
 eH2_9                 2.614986e-02 1 1  ON 49
ci_001                -4.170441e-02 3 1  ON 50
ci_002                -3.012177e-02 3 1  ON 51
ci_003                -2.528594e-02 3 1  ON 52
ci_004                 2.147723e-02 3 1  ON 53
ci_005                 2.161886e-02 3 1  ON 54
ci_006                -1.878858e-02 3 1  ON 55
ci_007                -1.932061e-02 3 1  ON 56
ci_008                -1.805202e-02 3 1  ON 57
ci_009                -1.762867e-02 3 1  ON 58
ci_010                -1.791218e-02 3 1  ON 59
ci_011                -1.637357e-02 3 1  ON 60
ci_012                -1.648228e-02 3 1  ON 61
ci_013                -1.899874e-02 3 1  ON 62
ci_014                 1.376930e-02 3 1  ON 63
ci_015                 1.399608e-02 3 1  ON 64
ci_016                 1.631875e-02 3 1  ON 65
ci_017                 1.654614e-02 3 1  ON 66
ci_018                 1.257159e-02 3 1  ON 67
ci_019                 1.289847e-02 3 1  ON 68
ci_020                 1.326465e-02 3 1  ON 69
ci_021                 1.359726e-02 3 1  ON 70
ci_022                 1.177102e-02 3 1  ON 71
ci_023                 1.151041e-02 3 1  ON 72
ci_024                 1.252685e-02 3 1  ON 73
ci_025                 1.222881e-02 3 1  ON 74
ci_026                 1.110479e-02 3 1  ON 75
ci_027                 1.152205e-02 3 1  ON 76
ci_028                -1.444647e-02 3 1  ON 77
ci_029                -1.476265e-02 3 1  ON 78
ci_030                -1.102974e-02 3 1  ON 79
ci_031                -1.177062e-02 3 1  ON 80
ci_032                -1.332824e-02 3 1  ON 81
ci_033                 1.088195e-02 3 1  ON 82
ci_034                 1.077856e-02 3 1  ON 83
ci_035                -4.994974e-03 3 1  ON 84
ci_036                -1.089431e-02 3 1  ON 85
ci_037                -1.029746e-02 3 1  ON 86
ci_038                 1.621589e-03 3 1  ON 87
ci_039                 1.981642e-03 3 1  ON 88
ci_040                -4.112905e-03 3 1  ON 89
ci_041                 1.002091e-02 3 1  ON 90
ci_042                 9.732621e-03 3 1  ON 91
ci_043                -3.584831e-03 3 1  ON 92
ci_044                -1.543153e-02 3 1  ON 93
ci_045                -1.672172e-03 3 1  ON 94
ci_046                 5.225349e-03 3 1  ON 95
ci_047                 5.917317e-03 3 1  ON 96
ci_048                -1.129156e-02 3 1  ON 97
ci_049                -1.192649e-02 3 1  ON 98
ci_050                 7.728228e-03 3 1  ON 99
ci_051                 7.750276e-03 3 1  ON 100
ci_052                -7.010484e-03 3 1  ON 101
ci_053                -6.825164e-03 3 1  ON 102
ci_054                -2.932380e-03 3 1  ON 103
ci_055                -3.080580e-03 3 1  ON 104
ci_056                 4.766482e-03 3 1  ON 105
ci_057                 4.621367e-03 3 1  ON 106
ci_058                -6.912532e-03 3 1  ON 107
ci_059                -6.879776e-03 3 1  ON 108
ci_060                 8.397559e-03 3 1  ON 109
ci_061                 8.234238e-03 3 1  ON 110
ci_062                -3.043597e-03 3 1  ON 111
ci_063                -3.004178e-03 3 1  ON 112
ci_064                -2.989302e-03 3 1  ON 113
ci_065                -4.121189e-03 3 1  ON 114
ci_066                 6.043587e-03 3 1  ON 115
ci_067                 5.243648e-03 3 1  ON 116
ci_068                -5.350875e-03 3 1  ON 117
ci_069                -5.111995e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1507
    reference variance = 0.208636
====================================================
  Execution time = 2.0816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1807e-01
  Total weights = 1.9565e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299600938775
                                         uncertainty =       0.002061253618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299600938775
                                         uncertainty =       0.002061253618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387040862
  error estimate for blocks of size 2^( 2) =       0.000396870761
  error estimate for blocks of size 2^( 3) =       0.000405994056
  error estimate for blocks of size 2^( 4) =       0.000412788599
  error estimate for blocks of size 2^( 5) =       0.000417051540
  error estimate for blocks of size 2^( 6) =       0.000419812797
  error estimate for blocks of size 2^( 7) =       0.000422503354

      target function =                  N/A
              le_mean =     -17.216262419177
             les_mean =     296.717754665745
             stat err =       0.000418039073
             autocorr =       1.166595008244
              std dev =       0.547358436869
             le_variance =       0.299601258412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299614849056
                                         uncertainty =       0.002062525923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299614849056
                                         uncertainty =       0.002062525923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387049882
  error estimate for blocks of size 2^( 2) =       0.000396879428
  error estimate for blocks of size 2^( 3) =       0.000406002216
  error estimate for blocks of size 2^( 4) =       0.000412796634
  error estimate for blocks of size 2^( 5) =       0.000417059448
  error estimate for blocks of size 2^( 6) =       0.000419820228
  error estimate for blocks of size 2^( 7) =       0.000422510598

      target function =                  N/A
              le_mean =     -17.216262345480
             les_mean =     296.717793499743
             stat err =       0.000418046727
             autocorr =       1.166583356445
              std dev =       0.547371192944
             le_variance =       0.299615222865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299607941018
                                         uncertainty =       0.002061891310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299607941018
                                         uncertainty =       0.002061891310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387045403
  error estimate for blocks of size 2^( 2) =       0.000396875124
  error estimate for blocks of size 2^( 3) =       0.000405998164
  error estimate for blocks of size 2^( 4) =       0.000412792644
  error estimate for blocks of size 2^( 5) =       0.000417055523
  error estimate for blocks of size 2^( 6) =       0.000419816540
  error estimate for blocks of size 2^( 7) =       0.000422507000

      target function =                  N/A
              le_mean =     -17.216262380021
             les_mean =     296.717773729966
             stat err =       0.000418042927
             autocorr =       1.166589147852
              std dev =       0.547364858076
             le_variance =       0.299608287856

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299601814057
                                         uncertainty =       0.002061333113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299601814057
                                         uncertainty =       0.002061333113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387041430
  error estimate for blocks of size 2^( 2) =       0.000396871306
  error estimate for blocks of size 2^( 3) =       0.000405994570
  error estimate for blocks of size 2^( 4) =       0.000412789105
  error estimate for blocks of size 2^( 5) =       0.000417052038
  error estimate for blocks of size 2^( 6) =       0.000419813265
  error estimate for blocks of size 2^( 7) =       0.000422503809

      target function =                  N/A
              le_mean =     -17.216262414084
             les_mean =     296.717756997771
             stat err =       0.000418039554
             autocorr =       1.166594275556
              std dev =       0.547359239529
             le_variance =       0.299602137098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216262419177        initial  <--
     2.5000e+01     2.5000e+02             4.2491e-05       -17.216262345480
     1.0000e+02     1.0000e+03             1.0625e-05       -17.216262380021
     4.0000e+02     4.0000e+03             2.6564e-06       -17.216262414084

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0133
  </log>
  <optVariables href="H2O.s002.opt.xml">
  uu_0                 2.036790e-01 1 1  ON 0
  uu_1                 4.369969e-02 1 1  ON 1
  uu_2                -4.751547e-02 1 1  ON 2
  uu_3                -9.904430e-02 1 1  ON 3
  uu_4                -1.294213e-01 1 1  ON 4
  uu_5                -1.342274e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803704e-02 1 1  ON 7
  uu_8                 1.008672e-01 1 1  ON 8
  uu_9                 1.201846e-01 1 1  ON 9
  ud_0                 3.471060e-01 1 1  ON 10
  ud_1                 8.998273e-02 1 1  ON 11
  ud_2                -1.727333e-02 1 1  ON 12
  ud_3                -7.538141e-02 1 1  ON 13
  ud_4                -1.203878e-01 1 1  ON 14
  ud_5                -1.507891e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094148e-01 1 1  ON 17
  ud_8                 5.948648e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402239e-01 1 1  ON 20
  eO_1                -4.286477e-01 1 1  ON 21
  eO_2                -3.455078e-02 1 1  ON 22
  eO_3                 2.024897e-01 1 1  ON 23
  eO_4                 2.802436e-01 1 1  ON 24
  eO_5                 3.038405e-01 1 1  ON 25
  eO_6                 2.493761e-01 1 1  ON 26
  eO_7                 1.108761e-01 1 1  ON 27
  eO_8                 2.771120e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020709e-01 1 1  ON 31
 eH1_2                -6.230105e-02 1 1  ON 32
 eH1_3                -2.601347e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568236e-02 1 1  ON 35
 eH1_6                 7.685541e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001442e-02 1 1  ON 38
 eH1_9                 2.406840e-02 1 1  ON 39
 eH2_0                -1.826246e-01 1 1  ON 40
 eH2_1                -1.035998e-01 1 1  ON 41
 eH2_2                -6.368915e-02 1 1  ON 42
 eH2_3                -2.766839e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506256e-02 1 1  ON 45
 eH2_6                 7.835843e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324152e-02 1 1  ON 48
 eH2_9                 2.614968e-02 1 1  ON 49
ci_001                -4.170791e-02 3 1  ON 50
ci_002                -3.012093e-02 3 1  ON 51
ci_003                -2.528693e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161932e-02 3 1  ON 54
ci_006                -1.879093e-02 3 1  ON 55
ci_007                -1.932207e-02 3 1  ON 56
ci_008                -1.805352e-02 3 1  ON 57
ci_009                -1.762733e-02 3 1  ON 58
ci_010                -1.791539e-02 3 1  ON 59
ci_011                -1.637486e-02 3 1  ON 60
ci_012                -1.648170e-02 3 1  ON 61
ci_013                -1.899988e-02 3 1  ON 62
ci_014                 1.376913e-02 3 1  ON 63
ci_015                 1.399701e-02 3 1  ON 64
ci_016                 1.631803e-02 3 1  ON 65
ci_017                 1.654850e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289820e-02 3 1  ON 68
ci_020                 1.326289e-02 3 1  ON 69
ci_021                 1.359756e-02 3 1  ON 70
ci_022                 1.177261e-02 3 1  ON 71
ci_023                 1.151017e-02 3 1  ON 72
ci_024                 1.252642e-02 3 1  ON 73
ci_025                 1.222848e-02 3 1  ON 74
ci_026                 1.110274e-02 3 1  ON 75
ci_027                 1.152212e-02 3 1  ON 76
ci_028                -1.444788e-02 3 1  ON 77
ci_029                -1.476206e-02 3 1  ON 78
ci_030                -1.102883e-02 3 1  ON 79
ci_031                -1.177358e-02 3 1  ON 80
ci_032                -1.332777e-02 3 1  ON 81
ci_033                 1.088319e-02 3 1  ON 82
ci_034                 1.077972e-02 3 1  ON 83
ci_035                -4.996160e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029946e-02 3 1  ON 86
ci_038                 1.621988e-03 3 1  ON 87
ci_039                 1.981011e-03 3 1  ON 88
ci_040                -4.114896e-03 3 1  ON 89
ci_041                 1.002120e-02 3 1  ON 90
ci_042                 9.730941e-03 3 1  ON 91
ci_043                -3.586444e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672836e-03 3 1  ON 94
ci_046                 5.223554e-03 3 1  ON 95
ci_047                 5.916087e-03 3 1  ON 96
ci_048                -1.129100e-02 3 1  ON 97
ci_049                -1.192695e-02 3 1  ON 98
ci_050                 7.727268e-03 3 1  ON 99
ci_051                 7.751174e-03 3 1  ON 100
ci_052                -7.011579e-03 3 1  ON 101
ci_053                -6.824953e-03 3 1  ON 102
ci_054                -2.931357e-03 3 1  ON 103
ci_055                -3.081434e-03 3 1  ON 104
ci_056                 4.765902e-03 3 1  ON 105
ci_057                 4.624369e-03 3 1  ON 106
ci_058                -6.913217e-03 3 1  ON 107
ci_059                -6.879899e-03 3 1  ON 108
ci_060                 8.399824e-03 3 1  ON 109
ci_061                 8.234216e-03 3 1  ON 110
ci_062                -3.045358e-03 3 1  ON 111
ci_063                -3.004232e-03 3 1  ON 112
ci_064                -2.988322e-03 3 1  ON 113
ci_065                -4.121896e-03 3 1  ON 114
ci_066                 6.044677e-03 3 1  ON 115
ci_067                 5.241260e-03 3 1  ON 116
ci_068                -5.351278e-03 3 1  ON 117
ci_069                -5.112359e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6862e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2696
    reference variance = 0.194932
====================================================
  Execution time = 2.0882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2059e-01
  Total weights = 1.956472854e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0990e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299692073083
                                         uncertainty =       0.003087538803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299692073083
                                         uncertainty =       0.003087538803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387035567
  error estimate for blocks of size 2^( 2) =       0.000396702160
  error estimate for blocks of size 2^( 3) =       0.000405937934
  error estimate for blocks of size 2^( 4) =       0.000412276380
  error estimate for blocks of size 2^( 5) =       0.000416927021
  error estimate for blocks of size 2^( 6) =       0.000420035029
  error estimate for blocks of size 2^( 7) =       0.000422629771

      target function =                  N/A
              le_mean =     -17.216579307211
             les_mean =     296.731191787662
             stat err =       0.000417967050
             autocorr =       1.166224980463
              std dev =       0.547350947338
             le_variance =       0.299593059552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657930721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579307233       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579347689       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579340132       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579335026       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216579348140       residual = 6.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216579350807       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216579351380       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216579351648       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216579351568       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216579351382       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+02 is 4.502406e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579307233       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579317355       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579315465       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579314188       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216579317468       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216579318133       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216579318278       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216579318345       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216579318325       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216579318278       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+03 is 1.125777e-06

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216579307233       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216579309764       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216579309291       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216579308972       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216579309792       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216579309960       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216579309994       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216579309991       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216579310009       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216579309989       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 4.0000e+03 is 2.814553e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6989e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.036792e-01 1 1  ON 0
  uu_1                 4.369984e-02 1 1  ON 1
  uu_2                -4.751543e-02 1 1  ON 2
  uu_3                -9.904432e-02 1 1  ON 3
  uu_4                -1.294214e-01 1 1  ON 4
  uu_5                -1.342276e-01 1 1  ON 5
  uu_6                -1.118891e-01 1 1  ON 6
  uu_7                -3.803712e-02 1 1  ON 7
  uu_8                 1.008671e-01 1 1  ON 8
  uu_9                 1.201847e-01 1 1  ON 9
  ud_0                 3.471062e-01 1 1  ON 10
  ud_1                 8.998292e-02 1 1  ON 11
  ud_2                -1.727328e-02 1 1  ON 12
  ud_3                -7.538153e-02 1 1  ON 13
  ud_4                -1.203881e-01 1 1  ON 14
  ud_5                -1.507892e-01 1 1  ON 15
  ud_6                -1.541543e-01 1 1  ON 16
  ud_7                -1.094149e-01 1 1  ON 17
  ud_8                 5.948535e-03 1 1  ON 18
  ud_9                 9.251987e-02 1 1  ON 19
  eO_0                -7.402251e-01 1 1  ON 20
  eO_1                -4.286483e-01 1 1  ON 21
  eO_2                -3.455082e-02 1 1  ON 22
  eO_3                 2.024906e-01 1 1  ON 23
  eO_4                 2.802444e-01 1 1  ON 24
  eO_5                 3.038406e-01 1 1  ON 25
  eO_6                 2.493762e-01 1 1  ON 26
  eO_7                 1.108762e-01 1 1  ON 27
  eO_8                 2.771122e-02 1 1  ON 28
  eO_9                 1.834432e-02 1 1  ON 29
 eH1_0                -1.814828e-01 1 1  ON 30
 eH1_1                -1.020710e-01 1 1  ON 31
 eH1_2                -6.230101e-02 1 1  ON 32
 eH1_3                -2.601348e-02 1 1  ON 33
 eH1_4                 1.958757e-02 1 1  ON 34
 eH1_5                 3.568242e-02 1 1  ON 35
 eH1_6                 7.685542e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001448e-02 1 1  ON 38
 eH1_9                 2.406842e-02 1 1  ON 39
 eH2_0                -1.826248e-01 1 1  ON 40
 eH2_1                -1.035999e-01 1 1  ON 41
 eH2_2                -6.368916e-02 1 1  ON 42
 eH2_3                -2.766829e-02 1 1  ON 43
 eH2_4                 1.867339e-02 1 1  ON 44
 eH2_5                 3.506259e-02 1 1  ON 45
 eH2_6                 7.835842e-02 1 1  ON 46
 eH2_7                 1.139680e-01 1 1  ON 47
 eH2_8                 9.324160e-02 1 1  ON 48
 eH2_9                 2.614970e-02 1 1  ON 49
ci_001                -4.170828e-02 3 1  ON 50
ci_002                -3.012098e-02 3 1  ON 51
ci_003                -2.528673e-02 3 1  ON 52
ci_004                 2.147692e-02 3 1  ON 53
ci_005                 2.161898e-02 3 1  ON 54
ci_006                -1.879095e-02 3 1  ON 55
ci_007                -1.932230e-02 3 1  ON 56
ci_008                -1.805344e-02 3 1  ON 57
ci_009                -1.762723e-02 3 1  ON 58
ci_010                -1.791528e-02 3 1  ON 59
ci_011                -1.637464e-02 3 1  ON 60
ci_012                -1.648150e-02 3 1  ON 61
ci_013                -1.899999e-02 3 1  ON 62
ci_014                 1.376935e-02 3 1  ON 63
ci_015                 1.399694e-02 3 1  ON 64
ci_016                 1.631815e-02 3 1  ON 65
ci_017                 1.654856e-02 3 1  ON 66
ci_018                 1.257071e-02 3 1  ON 67
ci_019                 1.289797e-02 3 1  ON 68
ci_020                 1.326256e-02 3 1  ON 69
ci_021                 1.359748e-02 3 1  ON 70
ci_022                 1.177260e-02 3 1  ON 71
ci_023                 1.151004e-02 3 1  ON 72
ci_024                 1.252621e-02 3 1  ON 73
ci_025                 1.222822e-02 3 1  ON 74
ci_026                 1.110282e-02 3 1  ON 75
ci_027                 1.152167e-02 3 1  ON 76
ci_028                -1.444772e-02 3 1  ON 77
ci_029                -1.476212e-02 3 1  ON 78
ci_030                -1.102904e-02 3 1  ON 79
ci_031                -1.177311e-02 3 1  ON 80
ci_032                -1.332782e-02 3 1  ON 81
ci_033                 1.088308e-02 3 1  ON 82
ci_034                 1.077965e-02 3 1  ON 83
ci_035                -4.996183e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029932e-02 3 1  ON 86
ci_038                 1.622134e-03 3 1  ON 87
ci_039                 1.980979e-03 3 1  ON 88
ci_040                -4.114602e-03 3 1  ON 89
ci_041                 1.002111e-02 3 1  ON 90
ci_042                 9.730900e-03 3 1  ON 91
ci_043                -3.586014e-03 3 1  ON 92
ci_044                -1.543144e-02 3 1  ON 93
ci_045                -1.672955e-03 3 1  ON 94
ci_046                 5.223620e-03 3 1  ON 95
ci_047                 5.916117e-03 3 1  ON 96
ci_048                -1.129089e-02 3 1  ON 97
ci_049                -1.192674e-02 3 1  ON 98
ci_050                 7.727283e-03 3 1  ON 99
ci_051                 7.750954e-03 3 1  ON 100
ci_052                -7.011364e-03 3 1  ON 101
ci_053                -6.824382e-03 3 1  ON 102
ci_054                -2.931349e-03 3 1  ON 103
ci_055                -3.081349e-03 3 1  ON 104
ci_056                 4.766017e-03 3 1  ON 105
ci_057                 4.624393e-03 3 1  ON 106
ci_058                -6.913033e-03 3 1  ON 107
ci_059                -6.879783e-03 3 1  ON 108
ci_060                 8.399706e-03 3 1  ON 109
ci_061                 8.234310e-03 3 1  ON 110
ci_062                -3.045539e-03 3 1  ON 111
ci_063                -3.004181e-03 3 1  ON 112
ci_064                -2.988318e-03 3 1  ON 113
ci_065                -4.122232e-03 3 1  ON 114
ci_066                 6.044599e-03 3 1  ON 115
ci_067                 5.241570e-03 3 1  ON 116
ci_068                -5.351134e-03 3 1  ON 117
ci_069                -5.112335e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2144
    reference variance = 0.234444
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1232e-01
  Total weights = 1.9565e+06
  Execution time = 1.8371e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298918560565
                                         uncertainty =       0.002040850452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298918560565
                                         uncertainty =       0.002040850452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386564938
  error estimate for blocks of size 2^( 2) =       0.000396796648
  error estimate for blocks of size 2^( 3) =       0.000405808831
  error estimate for blocks of size 2^( 4) =       0.000412452351
  error estimate for blocks of size 2^( 5) =       0.000417650990
  error estimate for blocks of size 2^( 6) =       0.000419892787
  error estimate for blocks of size 2^( 7) =       0.000421320763

      target function =                  N/A
              le_mean =     -17.216764043063
             les_mean =     296.729284965273
             stat err =       0.000417829223
             autocorr =       1.168295491388
              std dev =       0.546685378288
             le_variance =       0.298864902834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917124864
                                         uncertainty =       0.002040867622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917124864
                                         uncertainty =       0.002040867622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386564012
  error estimate for blocks of size 2^( 2) =       0.000396795764
  error estimate for blocks of size 2^( 3) =       0.000405807968
  error estimate for blocks of size 2^( 4) =       0.000412451532
  error estimate for blocks of size 2^( 5) =       0.000417650182
  error estimate for blocks of size 2^( 6) =       0.000419891902
  error estimate for blocks of size 2^( 7) =       0.000421319863

      target function =                  N/A
              le_mean =     -17.216764052676
             les_mean =     296.729283458012
             stat err =       0.000417828370
             autocorr =       1.168296323456
              std dev =       0.546684067856
             le_variance =       0.298863470047

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917841461
                                         uncertainty =       0.002040859031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298917841461
                                         uncertainty =       0.002040859031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386564474
  error estimate for blocks of size 2^( 2) =       0.000396796205
  error estimate for blocks of size 2^( 3) =       0.000405808399
  error estimate for blocks of size 2^( 4) =       0.000412451941
  error estimate for blocks of size 2^( 5) =       0.000417650586
  error estimate for blocks of size 2^( 6) =       0.000419892344
  error estimate for blocks of size 2^( 7) =       0.000421320312

      target function =                  N/A
              le_mean =     -17.216764047844
             les_mean =     296.729284202433
             stat err =       0.000417828795
             autocorr =       1.168295908185
              std dev =       0.546684721927
             le_variance =       0.298864185189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298918470618
                                         uncertainty =       0.002040851524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298918470618
                                         uncertainty =       0.002040851524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386564880
  error estimate for blocks of size 2^( 2) =       0.000396796593
  error estimate for blocks of size 2^( 3) =       0.000405808777
  error estimate for blocks of size 2^( 4) =       0.000412452299
  error estimate for blocks of size 2^( 5) =       0.000417650939
  error estimate for blocks of size 2^( 6) =       0.000419892731
  error estimate for blocks of size 2^( 7) =       0.000421320707

      target function =                  N/A
              le_mean =     -17.216764043658
             les_mean =     296.729284869005
             stat err =       0.000417829169
             autocorr =       1.168295543523
              std dev =       0.546685296190
             le_variance =       0.298864813070


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216764043063        initial
     2.5000e+02     2.5000e+03             4.5024e-06       -17.216764052676  <--
     1.0000e+03     1.0000e+04             1.1258e-06       -17.216764047844
     4.0000e+03     4.0000e+04             2.8146e-07       -17.216764043658

*****************************************************************************
Applying the update for shift_i =   2.5000e+02     and shift_s =   2.5000e+03
*****************************************************************************

  Execution time = 3.0075e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948197e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402284e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614974e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654876e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088275e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996253e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622571e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113720e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730775e-03 3 1  ON 91
ci_043                -3.584725e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673311e-03 3 1  ON 94
ci_046                 5.223818e-03 3 1  ON 95
ci_047                 5.916207e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750295e-03 3 1  ON 100
ci_052                -7.010717e-03 3 1  ON 101
ci_053                -6.822673e-03 3 1  ON 102
ci_054                -2.931323e-03 3 1  ON 103
ci_055                -3.081096e-03 3 1  ON 104
ci_056                 4.766361e-03 3 1  ON 105
ci_057                 4.624463e-03 3 1  ON 106
ci_058                -6.912481e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399354e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123238e-03 3 1  ON 114
ci_066                 6.044366e-03 3 1  ON 115
ci_067                 5.242498e-03 3 1  ON 116
ci_068                -5.350703e-03 3 1  ON 117
ci_069                -5.112264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2999
    reference variance = 0.82488
====================================================
  Execution time = 2.3361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1936e-01
  Total weights = 1.956515499e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299978990455
                                         uncertainty =       0.002621599458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299978990455
                                         uncertainty =       0.002621599458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387306815
  error estimate for blocks of size 2^( 2) =       0.000397072287
  error estimate for blocks of size 2^( 3) =       0.000406245713
  error estimate for blocks of size 2^( 4) =       0.000412878217
  error estimate for blocks of size 2^( 5) =       0.000417231185
  error estimate for blocks of size 2^( 6) =       0.000419084766
  error estimate for blocks of size 2^( 7) =       0.000419011007

      target function =                  N/A
              le_mean =     -17.215953218601
             les_mean =     296.708407485224
             stat err =       0.000417051294
             autocorr =       1.159494431924
              std dev =       0.547734550846
             le_variance =       0.300013138191


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595321860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953218642       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953225948       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215953222966       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215953220795       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215953220796       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215953266309       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215953267053       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215953268181       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215953267832       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215953267354       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+01 is 1.627488e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953218642       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953220474       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215953219712       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215953219110       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215953219079       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215953230503       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215953230694       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215953230975       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215953230887       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215953230769       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+02 is 4.068993e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953218642       residual = 2.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953219100       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215953218909       residual = 8.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215953218754       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215953218745       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215953221603       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215953221653       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215953221723       residual = 8.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215953221699       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215953221673       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+03 is 1.017265e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9479e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.036809e-01 1 1  ON 0
  uu_1                 4.370097e-02 1 1  ON 1
  uu_2                -4.751528e-02 1 1  ON 2
  uu_3                -9.904474e-02 1 1  ON 3
  uu_4                -1.294222e-01 1 1  ON 4
  uu_5                -1.342285e-01 1 1  ON 5
  uu_6                -1.118895e-01 1 1  ON 6
  uu_7                -3.803783e-02 1 1  ON 7
  uu_8                 1.008665e-01 1 1  ON 8
  uu_9                 1.201850e-01 1 1  ON 9
  ud_0                 3.471084e-01 1 1  ON 10
  ud_1                 8.998420e-02 1 1  ON 11
  ud_2                -1.727282e-02 1 1  ON 12
  ud_3                -7.538263e-02 1 1  ON 13
  ud_4                -1.203897e-01 1 1  ON 14
  ud_5                -1.507904e-01 1 1  ON 15
  ud_6                -1.541538e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.947796e-03 1 1  ON 18
  ud_9                 9.251992e-02 1 1  ON 19
  eO_0                -7.402325e-01 1 1  ON 20
  eO_1                -4.286534e-01 1 1  ON 21
  eO_2                -3.455123e-02 1 1  ON 22
  eO_3                 2.024964e-01 1 1  ON 23
  eO_4                 2.802496e-01 1 1  ON 24
  eO_5                 3.038410e-01 1 1  ON 25
  eO_6                 2.493767e-01 1 1  ON 26
  eO_7                 1.108770e-01 1 1  ON 27
  eO_8                 2.771133e-02 1 1  ON 28
  eO_9                 1.834437e-02 1 1  ON 29
 eH1_0                -1.814834e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230064e-02 1 1  ON 32
 eH1_3                -2.601357e-02 1 1  ON 33
 eH1_4                 1.958776e-02 1 1  ON 34
 eH1_5                 3.568253e-02 1 1  ON 35
 eH1_6                 7.685543e-02 1 1  ON 36
 eH1_7                 1.104948e-01 1 1  ON 37
 eH1_8                 9.001492e-02 1 1  ON 38
 eH1_9                 2.406855e-02 1 1  ON 39
 eH2_0                -1.826256e-01 1 1  ON 40
 eH2_1                -1.036001e-01 1 1  ON 41
 eH2_2                -6.368922e-02 1 1  ON 42
 eH2_3                -2.766817e-02 1 1  ON 43
 eH2_4                 1.867342e-02 1 1  ON 44
 eH2_5                 3.506289e-02 1 1  ON 45
 eH2_6                 7.835855e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324206e-02 1 1  ON 48
 eH2_9                 2.614982e-02 1 1  ON 49
ci_001                -4.170820e-02 3 1  ON 50
ci_002                -3.012091e-02 3 1  ON 51
ci_003                -2.528486e-02 3 1  ON 52
ci_004                 2.147662e-02 3 1  ON 53
ci_005                 2.161732e-02 3 1  ON 54
ci_006                -1.879099e-02 3 1  ON 55
ci_007                -1.932280e-02 3 1  ON 56
ci_008                -1.805312e-02 3 1  ON 57
ci_009                -1.762730e-02 3 1  ON 58
ci_010                -1.791427e-02 3 1  ON 59
ci_011                -1.637479e-02 3 1  ON 60
ci_012                -1.648144e-02 3 1  ON 61
ci_013                -1.900142e-02 3 1  ON 62
ci_014                 1.376974e-02 3 1  ON 63
ci_015                 1.399640e-02 3 1  ON 64
ci_016                 1.631985e-02 3 1  ON 65
ci_017                 1.654950e-02 3 1  ON 66
ci_018                 1.257027e-02 3 1  ON 67
ci_019                 1.289803e-02 3 1  ON 68
ci_020                 1.326163e-02 3 1  ON 69
ci_021                 1.359567e-02 3 1  ON 70
ci_022                 1.177370e-02 3 1  ON 71
ci_023                 1.150995e-02 3 1  ON 72
ci_024                 1.252485e-02 3 1  ON 73
ci_025                 1.222781e-02 3 1  ON 74
ci_026                 1.110249e-02 3 1  ON 75
ci_027                 1.152132e-02 3 1  ON 76
ci_028                -1.444633e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.103061e-02 3 1  ON 79
ci_031                -1.177117e-02 3 1  ON 80
ci_032                -1.332881e-02 3 1  ON 81
ci_033                 1.088137e-02 3 1  ON 82
ci_034                 1.077888e-02 3 1  ON 83
ci_035                -4.995722e-03 3 1  ON 84
ci_036                -1.089469e-02 3 1  ON 85
ci_037                -1.029933e-02 3 1  ON 86
ci_038                 1.622936e-03 3 1  ON 87
ci_039                 1.980308e-03 3 1  ON 88
ci_040                -4.112628e-03 3 1  ON 89
ci_041                 1.002072e-02 3 1  ON 90
ci_042                 9.731283e-03 3 1  ON 91
ci_043                -3.583911e-03 3 1  ON 92
ci_044                -1.543165e-02 3 1  ON 93
ci_045                -1.673862e-03 3 1  ON 94
ci_046                 5.224425e-03 3 1  ON 95
ci_047                 5.915853e-03 3 1  ON 96
ci_048                -1.129027e-02 3 1  ON 97
ci_049                -1.192601e-02 3 1  ON 98
ci_050                 7.726623e-03 3 1  ON 99
ci_051                 7.750251e-03 3 1  ON 100
ci_052                -7.011051e-03 3 1  ON 101
ci_053                -6.822355e-03 3 1  ON 102
ci_054                -2.932162e-03 3 1  ON 103
ci_055                -3.081327e-03 3 1  ON 104
ci_056                 4.766307e-03 3 1  ON 105
ci_057                 4.624744e-03 3 1  ON 106
ci_058                -6.912331e-03 3 1  ON 107
ci_059                -6.879106e-03 3 1  ON 108
ci_060                 8.399002e-03 3 1  ON 109
ci_061                 8.234840e-03 3 1  ON 110
ci_062                -3.046460e-03 3 1  ON 111
ci_063                -3.004081e-03 3 1  ON 112
ci_064                -2.988664e-03 3 1  ON 113
ci_065                -4.123125e-03 3 1  ON 114
ci_066                 6.045640e-03 3 1  ON 115
ci_067                 5.243221e-03 3 1  ON 116
ci_068                -5.350570e-03 3 1  ON 117
ci_069                -5.110812e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2378
    reference variance = 0.305359
====================================================
  Execution time = 2.0961e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0961e-01
  Total weights = 1.9570e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294991377291
                                         uncertainty =       0.001730331132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294991377291
                                         uncertainty =       0.001730331132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384127744
  error estimate for blocks of size 2^( 2) =       0.000394419168
  error estimate for blocks of size 2^( 3) =       0.000403718680
  error estimate for blocks of size 2^( 4) =       0.000410536604
  error estimate for blocks of size 2^( 5) =       0.000414635182
  error estimate for blocks of size 2^( 6) =       0.000415401364
  error estimate for blocks of size 2^( 7) =       0.000416807277

      target function =                  N/A
              le_mean =     -17.215269565731
             les_mean =     296.675094318927
             stat err =       0.000414345107
             autocorr =       1.163517925021
              std dev =       0.543238664979
             le_variance =       0.295108247129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294994149028
                                         uncertainty =       0.001730314444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294994149028
                                         uncertainty =       0.001730314444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384129563
  error estimate for blocks of size 2^( 2) =       0.000394420867
  error estimate for blocks of size 2^( 3) =       0.000403720322
  error estimate for blocks of size 2^( 4) =       0.000410538257
  error estimate for blocks of size 2^( 5) =       0.000414636975
  error estimate for blocks of size 2^( 6) =       0.000415403392
  error estimate for blocks of size 2^( 7) =       0.000416809014

      target function =                  N/A
              le_mean =     -17.215269551903
             les_mean =     296.675185543423
             stat err =       0.000414346909
             autocorr =       1.163517028285
              std dev =       0.543241237348
             le_variance =       0.295111041955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294992762376
                                         uncertainty =       0.001730322694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294992762376
                                         uncertainty =       0.001730322694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384128653
  error estimate for blocks of size 2^( 2) =       0.000394420017
  error estimate for blocks of size 2^( 3) =       0.000403719501
  error estimate for blocks of size 2^( 4) =       0.000410537430
  error estimate for blocks of size 2^( 5) =       0.000414636080
  error estimate for blocks of size 2^( 6) =       0.000415402380
  error estimate for blocks of size 2^( 7) =       0.000416808147

      target function =                  N/A
              le_mean =     -17.215269558220
             les_mean =     296.675137522921
             stat err =       0.000414346009
             autocorr =       1.163517485404
              std dev =       0.543239950490
             le_variance =       0.295109643808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294991550204
                                         uncertainty =       0.001730330070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294991550204
                                         uncertainty =       0.001730330070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384127857
  error estimate for blocks of size 2^( 2) =       0.000394419274
  error estimate for blocks of size 2^( 3) =       0.000403718783
  error estimate for blocks of size 2^( 4) =       0.000410536707
  error estimate for blocks of size 2^( 5) =       0.000414635294
  error estimate for blocks of size 2^( 6) =       0.000415401491
  error estimate for blocks of size 2^( 7) =       0.000416807386

      target function =                  N/A
              le_mean =     -17.215269564732
             les_mean =     296.675099453191
             stat err =       0.000414345220
             autocorr =       1.163517870832
              std dev =       0.543238825465
             le_variance =       0.295108421492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215269565731        initial  <--
     6.2500e+01     6.2500e+02             1.6275e-05       -17.215269551903
     2.5000e+02     2.5000e+03             4.0690e-06       -17.215269558220
     1.0000e+03     1.0000e+04             1.0173e-06       -17.215269564732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2012
  </log>
  <optVariables href="H2O.s004.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948197e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402284e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614974e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654876e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088275e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996253e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622571e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113720e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730775e-03 3 1  ON 91
ci_043                -3.584725e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673311e-03 3 1  ON 94
ci_046                 5.223818e-03 3 1  ON 95
ci_047                 5.916207e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750295e-03 3 1  ON 100
ci_052                -7.010717e-03 3 1  ON 101
ci_053                -6.822673e-03 3 1  ON 102
ci_054                -2.931323e-03 3 1  ON 103
ci_055                -3.081096e-03 3 1  ON 104
ci_056                 4.766361e-03 3 1  ON 105
ci_057                 4.624463e-03 3 1  ON 106
ci_058                -6.912481e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399354e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123238e-03 3 1  ON 114
ci_066                 6.044366e-03 3 1  ON 115
ci_067                 5.242498e-03 3 1  ON 116
ci_068                -5.350703e-03 3 1  ON 117
ci_069                -5.112264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3692
    reference variance = 0.582401
====================================================
  Execution time = 2.0716e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1847e-01
  Total weights = 1.956545297e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298865640807
                                         uncertainty =       0.001909346072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298865640807
                                         uncertainty =       0.001909346072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386641166
  error estimate for blocks of size 2^( 2) =       0.000396990013
  error estimate for blocks of size 2^( 3) =       0.000405760211
  error estimate for blocks of size 2^( 4) =       0.000411595965
  error estimate for blocks of size 2^( 5) =       0.000414728671
  error estimate for blocks of size 2^( 6) =       0.000417566229
  error estimate for blocks of size 2^( 7) =       0.000417754056

      target function =                  N/A
              le_mean =     -17.216549471549
             les_mean =     296.728041012516
             stat err =       0.000415411230
             autocorr =       1.154357376194
              std dev =       0.546793180928
             le_variance =       0.298982782709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654947155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549471596       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549477523       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216549478764       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216549479827       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216549483519       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216549483137       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216549483541       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216549483030       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216549483191       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216549483242       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+02 is 1.786232e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549471596       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549473078       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216549473389       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216549473654       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216549474581       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216549474483       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216549474588       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216549474458       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216549474499       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216549474522       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+03 is 4.465940e-07

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216549471596       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216549471967       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216549472045       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216549472112       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216549472339       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216549472322       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216549472341       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216549472313       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216549472330       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216549472370       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+04 is 1.116507e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.200280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6881e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904439e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998353e-02 1 1  ON 11
  ud_2                -1.727307e-02 1 1  ON 12
  ud_3                -7.538194e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948152e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402289e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455092e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802469e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230089e-02 1 1  ON 32
 eH1_3                -2.601351e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568265e-02 1 1  ON 35
 eH1_6                 7.685545e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001469e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368920e-02 1 1  ON 42
 eH2_3                -2.766798e-02 1 1  ON 43
 eH2_4                 1.867339e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324185e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170936e-02 3 1  ON 50
ci_002                -3.012109e-02 3 1  ON 51
ci_003                -2.528614e-02 3 1  ON 52
ci_004                 2.147679e-02 3 1  ON 53
ci_005                 2.161796e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932293e-02 3 1  ON 56
ci_008                -1.805317e-02 3 1  ON 57
ci_009                -1.762703e-02 3 1  ON 58
ci_010                -1.791490e-02 3 1  ON 59
ci_011                -1.637398e-02 3 1  ON 60
ci_012                -1.648091e-02 3 1  ON 61
ci_013                -1.900033e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399663e-02 3 1  ON 64
ci_016                 1.631862e-02 3 1  ON 65
ci_017                 1.654879e-02 3 1  ON 66
ci_018                 1.257073e-02 3 1  ON 67
ci_019                 1.289729e-02 3 1  ON 68
ci_020                 1.326161e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177250e-02 3 1  ON 71
ci_023                 1.150967e-02 3 1  ON 72
ci_024                 1.252553e-02 3 1  ON 73
ci_025                 1.222725e-02 3 1  ON 74
ci_026                 1.110299e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444728e-02 3 1  ON 77
ci_029                -1.476224e-02 3 1  ON 78
ci_030                -1.102961e-02 3 1  ON 79
ci_031                -1.177159e-02 3 1  ON 80
ci_032                -1.332800e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077944e-02 3 1  ON 83
ci_035                -4.996132e-03 3 1  ON 84
ci_036                -1.089544e-02 3 1  ON 85
ci_037                -1.029883e-02 3 1  ON 86
ci_038                 1.622638e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113742e-03 3 1  ON 89
ci_041                 1.002076e-02 3 1  ON 90
ci_042                 9.730795e-03 3 1  ON 91
ci_043                -3.584686e-03 3 1  ON 92
ci_044                -1.543137e-02 3 1  ON 93
ci_045                -1.673404e-03 3 1  ON 94
ci_046                 5.223879e-03 3 1  ON 95
ci_047                 5.916214e-03 3 1  ON 96
ci_048                -1.129056e-02 3 1  ON 97
ci_049                -1.192608e-02 3 1  ON 98
ci_050                 7.727316e-03 3 1  ON 99
ci_051                 7.750236e-03 3 1  ON 100
ci_052                -7.010704e-03 3 1  ON 101
ci_053                -6.822642e-03 3 1  ON 102
ci_054                -2.931325e-03 3 1  ON 103
ci_055                -3.081119e-03 3 1  ON 104
ci_056                 4.766299e-03 3 1  ON 105
ci_057                 4.624420e-03 3 1  ON 106
ci_058                -6.912518e-03 3 1  ON 107
ci_059                -6.879377e-03 3 1  ON 108
ci_060                 8.399268e-03 3 1  ON 109
ci_061                 8.234599e-03 3 1  ON 110
ci_062                -3.046118e-03 3 1  ON 111
ci_063                -3.004117e-03 3 1  ON 112
ci_064                -2.988304e-03 3 1  ON 113
ci_065                -4.123185e-03 3 1  ON 114
ci_066                 6.044321e-03 3 1  ON 115
ci_067                 5.242541e-03 3 1  ON 116
ci_068                -5.350642e-03 3 1  ON 117
ci_069                -5.112207e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1631
    reference variance = 0.373207
====================================================
  Execution time = 2.0879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1689e-01
  Total weights = 1.9567e+06
  Execution time = 1.8435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975186802
                                         uncertainty =       0.004253460515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975186802
                                         uncertainty =       0.004253460515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387268650
  error estimate for blocks of size 2^( 2) =       0.000397576993
  error estimate for blocks of size 2^( 3) =       0.000406357305
  error estimate for blocks of size 2^( 4) =       0.000412907771
  error estimate for blocks of size 2^( 5) =       0.000416206966
  error estimate for blocks of size 2^( 6) =       0.000417956503
  error estimate for blocks of size 2^( 7) =       0.000419955701

      target function =                  N/A
              le_mean =     -17.216550856499
             les_mean =     296.726515359571
             stat err =       0.000416756735
             autocorr =       1.158085359569
              std dev =       0.547680577356
             le_variance =       0.299954014813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299974990292
                                         uncertainty =       0.004253483094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299974990292
                                         uncertainty =       0.004253483094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387268521
  error estimate for blocks of size 2^( 2) =       0.000397576875
  error estimate for blocks of size 2^( 3) =       0.000406357188
  error estimate for blocks of size 2^( 4) =       0.000412907676
  error estimate for blocks of size 2^( 5) =       0.000416206881
  error estimate for blocks of size 2^( 6) =       0.000417956380
  error estimate for blocks of size 2^( 7) =       0.000419955586

      target function =                  N/A
              le_mean =     -17.216550849629
             les_mean =     296.726513721120
             stat err =       0.000416756630
             autocorr =       1.158085547691
              std dev =       0.547680394882
             le_variance =       0.299953814938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975088450
                                         uncertainty =       0.004253471805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975088450
                                         uncertainty =       0.004253471805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387268586
  error estimate for blocks of size 2^( 2) =       0.000397576934
  error estimate for blocks of size 2^( 3) =       0.000406357246
  error estimate for blocks of size 2^( 4) =       0.000412907724
  error estimate for blocks of size 2^( 5) =       0.000416206923
  error estimate for blocks of size 2^( 6) =       0.000417956442
  error estimate for blocks of size 2^( 7) =       0.000419955643

      target function =                  N/A
              le_mean =     -17.216550853057
             les_mean =     296.726514477509
             stat err =       0.000416756683
             autocorr =       1.158085453738
              std dev =       0.547680486030
             le_variance =       0.299953914779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975174503
                                         uncertainty =       0.004253461926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299975174503
                                         uncertainty =       0.004253461926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387268642
  error estimate for blocks of size 2^( 2) =       0.000397576985
  error estimate for blocks of size 2^( 3) =       0.000406357298
  error estimate for blocks of size 2^( 4) =       0.000412907765
  error estimate for blocks of size 2^( 5) =       0.000416206961
  error estimate for blocks of size 2^( 6) =       0.000417956496
  error estimate for blocks of size 2^( 7) =       0.000419955693

      target function =                  N/A
              le_mean =     -17.216550856068
             les_mean =     296.726515241936
             stat err =       0.000416756729
             autocorr =       1.158085371341
              std dev =       0.547680565936
             le_variance =       0.299954002304


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216550856499        initial  <--
     6.2500e+02     6.2500e+03             1.7862e-06       -17.216550849629
     2.5000e+03     2.5000e+04             4.4659e-07       -17.216550853057
     1.0000e+04     1.0000e+05             1.1165e-07       -17.216550856068

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1679
  </log>
  <optVariables href="H2O.s005.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948197e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402284e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614974e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654876e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088275e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996253e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622571e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113720e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730775e-03 3 1  ON 91
ci_043                -3.584725e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673311e-03 3 1  ON 94
ci_046                 5.223818e-03 3 1  ON 95
ci_047                 5.916207e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750295e-03 3 1  ON 100
ci_052                -7.010717e-03 3 1  ON 101
ci_053                -6.822673e-03 3 1  ON 102
ci_054                -2.931323e-03 3 1  ON 103
ci_055                -3.081096e-03 3 1  ON 104
ci_056                 4.766361e-03 3 1  ON 105
ci_057                 4.624463e-03 3 1  ON 106
ci_058                -6.912481e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399354e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123238e-03 3 1  ON 114
ci_066                 6.044366e-03 3 1  ON 115
ci_067                 5.242498e-03 3 1  ON 116
ci_068                -5.350703e-03 3 1  ON 117
ci_069                -5.112264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7093e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7239e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.215
    reference variance = 0.398147
====================================================
  Execution time = 2.1049e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1069e-01
  Total weights = 1.956532664e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298714487759
                                         uncertainty =       0.001981276862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298714487759
                                         uncertainty =       0.001981276862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386480879
  error estimate for blocks of size 2^( 2) =       0.000396534547
  error estimate for blocks of size 2^( 3) =       0.000405375827
  error estimate for blocks of size 2^( 4) =       0.000411719662
  error estimate for blocks of size 2^( 5) =       0.000414971013
  error estimate for blocks of size 2^( 6) =       0.000416264775
  error estimate for blocks of size 2^( 7) =       0.000417607932

      target function =                  N/A
              le_mean =     -17.216052721325
             les_mean =     296.703157065307
             stat err =       0.000415140845
             autocorr =       1.153811614124
              std dev =       0.546566500560
             le_variance =       0.298734939534


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721605272132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052721341       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052722126       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052722199       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052722475       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052722505       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052722705       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052722603       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052722581       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216052722596       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216052722629       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+03 is 1.730837e-07

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052721341       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052721537       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052721556       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052721621       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052721639       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052721658       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052721652       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052721628       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216052721771       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216052721658       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+04 is 4.327110e-08

solving harmonic davidson linear method for identity shift 1.0000e+05, overlap shift 1.0000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216052721341       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216052721390       residual = 8.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216052721395       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052721412       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216052721181       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216052721430       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216052721432       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216052721404       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216052721026       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216052721414       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+05 is 1.081779e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7145e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538191e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948192e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402285e-01 1 1  ON 20
  eO_1                -4.286504e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024931e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867339e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170940e-02 3 1  ON 50
ci_002                -3.012112e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147692e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654877e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326157e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252556e-02 3 1  ON 73
ci_025                 1.222742e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444724e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332799e-02 3 1  ON 81
ci_033                 1.088274e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996247e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622577e-03 3 1  ON 87
ci_039                 1.980878e-03 3 1  ON 88
ci_040                -4.113721e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730770e-03 3 1  ON 91
ci_043                -3.584721e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673314e-03 3 1  ON 94
ci_046                 5.223825e-03 3 1  ON 95
ci_047                 5.916202e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727328e-03 3 1  ON 99
ci_051                 7.750289e-03 3 1  ON 100
ci_052                -7.010710e-03 3 1  ON 101
ci_053                -6.822667e-03 3 1  ON 102
ci_054                -2.931318e-03 3 1  ON 103
ci_055                -3.081102e-03 3 1  ON 104
ci_056                 4.766364e-03 3 1  ON 105
ci_057                 4.624467e-03 3 1  ON 106
ci_058                -6.912473e-03 3 1  ON 107
ci_059                -6.879424e-03 3 1  ON 108
ci_060                 8.399351e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046078e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988306e-03 3 1  ON 113
ci_065                -4.123236e-03 3 1  ON 114
ci_066                 6.044364e-03 3 1  ON 115
ci_067                 5.242519e-03 3 1  ON 116
ci_068                -5.350697e-03 3 1  ON 117
ci_069                -5.112270e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.247521
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1578e-01
  Total weights = 1.9565e+06
  Execution time = 1.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605594631
                                         uncertainty =       0.002423212223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605594631
                                         uncertainty =       0.002423212223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689719
  error estimate for blocks of size 2^( 2) =       0.000397534745
  error estimate for blocks of size 2^( 3) =       0.000406842663
  error estimate for blocks of size 2^( 4) =       0.000414335487
  error estimate for blocks of size 2^( 5) =       0.000418791157
  error estimate for blocks of size 2^( 6) =       0.000421343793
  error estimate for blocks of size 2^( 7) =       0.000420222529

      target function =                  N/A
              le_mean =     -17.216607040247
             les_mean =     296.727335177903
             stat err =       0.000418673242
             autocorr =       1.166223642220
              std dev =       0.548276058772
             le_variance =       0.300606636623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605586175
                                         uncertainty =       0.002423213506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605586175
                                         uncertainty =       0.002423213506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689714
  error estimate for blocks of size 2^( 2) =       0.000397534741
  error estimate for blocks of size 2^( 3) =       0.000406842658
  error estimate for blocks of size 2^( 4) =       0.000414335485
  error estimate for blocks of size 2^( 5) =       0.000418791154
  error estimate for blocks of size 2^( 6) =       0.000421343790
  error estimate for blocks of size 2^( 7) =       0.000420222531

      target function =                  N/A
              le_mean =     -17.216607039870
             les_mean =     296.727335174639
             stat err =       0.000418673240
             autocorr =       1.166223665794
              std dev =       0.548276051163
             le_variance =       0.300606628279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605590403
                                         uncertainty =       0.002423212865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605590403
                                         uncertainty =       0.002423212865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689716
  error estimate for blocks of size 2^( 2) =       0.000397534743
  error estimate for blocks of size 2^( 3) =       0.000406842660
  error estimate for blocks of size 2^( 4) =       0.000414335486
  error estimate for blocks of size 2^( 5) =       0.000418791156
  error estimate for blocks of size 2^( 6) =       0.000421343791
  error estimate for blocks of size 2^( 7) =       0.000420222530

      target function =                  N/A
              le_mean =     -17.216607040058
             les_mean =     296.727335176231
             stat err =       0.000418673241
             autocorr =       1.166223654023
              std dev =       0.548276054968
             le_variance =       0.300606632451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605594103
                                         uncertainty =       0.002423212303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300605594103
                                         uncertainty =       0.002423212303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689719
  error estimate for blocks of size 2^( 2) =       0.000397534745
  error estimate for blocks of size 2^( 3) =       0.000406842662
  error estimate for blocks of size 2^( 4) =       0.000414335487
  error estimate for blocks of size 2^( 5) =       0.000418791157
  error estimate for blocks of size 2^( 6) =       0.000421343792
  error estimate for blocks of size 2^( 7) =       0.000420222530

      target function =                  N/A
              le_mean =     -17.216607040223
             les_mean =     296.727335177689
             stat err =       0.000418673242
             autocorr =       1.166223643706
              std dev =       0.548276058297
             le_variance =       0.300606636101


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216607040247        initial  <--
     6.2500e+03     6.2500e+04             1.7308e-07       -17.216607039870
     2.5000e+04     2.5000e+05             4.3271e-08       -17.216607040058
     1.0000e+05     1.0000e+06             1.0818e-08       -17.216607040223

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8387
  </log>
  <optVariables href="H2O.s006.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948197e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402284e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614974e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654876e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088275e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996253e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622571e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113720e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730775e-03 3 1  ON 91
ci_043                -3.584725e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673311e-03 3 1  ON 94
ci_046                 5.223818e-03 3 1  ON 95
ci_047                 5.916207e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750295e-03 3 1  ON 100
ci_052                -7.010717e-03 3 1  ON 101
ci_053                -6.822673e-03 3 1  ON 102
ci_054                -2.931323e-03 3 1  ON 103
ci_055                -3.081096e-03 3 1  ON 104
ci_056                 4.766361e-03 3 1  ON 105
ci_057                 4.624463e-03 3 1  ON 106
ci_058                -6.912481e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399354e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123238e-03 3 1  ON 114
ci_066                 6.044366e-03 3 1  ON 115
ci_067                 5.242498e-03 3 1  ON 116
ci_068                -5.350703e-03 3 1  ON 117
ci_069                -5.112264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7239e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.168211
====================================================
  Execution time = 2.1232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1597e-01
  Total weights = 1.956789501e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299843831835
                                         uncertainty =       0.002154535246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299843831835
                                         uncertainty =       0.002154535246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387181129
  error estimate for blocks of size 2^( 2) =       0.000397275440
  error estimate for blocks of size 2^( 3) =       0.000406668597
  error estimate for blocks of size 2^( 4) =       0.000413420866
  error estimate for blocks of size 2^( 5) =       0.000418159293
  error estimate for blocks of size 2^( 6) =       0.000420750333
  error estimate for blocks of size 2^( 7) =       0.000421474071

      target function =                  N/A
              le_mean =     -17.216219776660
             les_mean =     296.714195914514
             stat err =       0.000418451141
             autocorr =       1.168049232031
              std dev =       0.547556804304
             le_variance =       0.299818453940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621977666e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216219776659       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216219776749       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216219776766       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216219776766       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216219776731       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216219776797       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216219776787       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216219776788       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216219776652       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216219776761       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+04 is 1.687700e-08

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216219776659       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216219776681       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216219776686       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216219776686       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216219777750       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216219776462       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216219776775       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216219776740       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216219777666       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216219776433       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+05 is 4.219251e-09

solving harmonic davidson linear method for identity shift 1.0000e+06, overlap shift 1.0000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216219776659       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216219776664       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216219776666       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216219776666       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216219777457       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216219776668       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216219777316       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216219776658       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216219776513       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216219780032       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.0000e+06 is 1.054813e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.208386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7347e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948197e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402284e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614974e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654876e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359726e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476230e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088274e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996252e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622572e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113720e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730774e-03 3 1  ON 91
ci_043                -3.584723e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673314e-03 3 1  ON 94
ci_046                 5.223819e-03 3 1  ON 95
ci_047                 5.916206e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750294e-03 3 1  ON 100
ci_052                -7.010717e-03 3 1  ON 101
ci_053                -6.822674e-03 3 1  ON 102
ci_054                -2.931324e-03 3 1  ON 103
ci_055                -3.081097e-03 3 1  ON 104
ci_056                 4.766361e-03 3 1  ON 105
ci_057                 4.624462e-03 3 1  ON 106
ci_058                -6.912481e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399352e-03 3 1  ON 109
ci_061                 8.234591e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004031e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123237e-03 3 1  ON 114
ci_066                 6.044365e-03 3 1  ON 115
ci_067                 5.242498e-03 3 1  ON 116
ci_068                -5.350702e-03 3 1  ON 117
ci_069                -5.112263e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2211
    reference variance = 0.162948
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0903e-01
  Total weights = 1.9564e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558542114
                                         uncertainty =       0.002170837760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558542114
                                         uncertainty =       0.002170837760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385057424
  error estimate for blocks of size 2^( 2) =       0.000394969403
  error estimate for blocks of size 2^( 3) =       0.000404437249
  error estimate for blocks of size 2^( 4) =       0.000411354071
  error estimate for blocks of size 2^( 5) =       0.000415356583
  error estimate for blocks of size 2^( 6) =       0.000415948777
  error estimate for blocks of size 2^( 7) =       0.000415447364

      target function =                  N/A
              le_mean =     -17.216627910977
             les_mean =     296.721302229192
             stat err =       0.000414526699
             autocorr =       1.158921484918
              std dev =       0.544553430897
             le_variance =       0.296538439101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558545820
                                         uncertainty =       0.002170837842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558545820
                                         uncertainty =       0.002170837842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385057426
  error estimate for blocks of size 2^( 2) =       0.000394969406
  error estimate for blocks of size 2^( 3) =       0.000404437252
  error estimate for blocks of size 2^( 4) =       0.000411354074
  error estimate for blocks of size 2^( 5) =       0.000415356586
  error estimate for blocks of size 2^( 6) =       0.000415948779
  error estimate for blocks of size 2^( 7) =       0.000415447365

      target function =                  N/A
              le_mean =     -17.216627911008
             les_mean =     296.721302216710
             stat err =       0.000414526701
             autocorr =       1.158921483032
              std dev =       0.544553434321
             le_variance =       0.296538442830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558543967
                                         uncertainty =       0.002170837801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558543967
                                         uncertainty =       0.002170837801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385057425
  error estimate for blocks of size 2^( 2) =       0.000394969405
  error estimate for blocks of size 2^( 3) =       0.000404437250
  error estimate for blocks of size 2^( 4) =       0.000411354073
  error estimate for blocks of size 2^( 5) =       0.000415356585
  error estimate for blocks of size 2^( 6) =       0.000415948778
  error estimate for blocks of size 2^( 7) =       0.000415447365

      target function =                  N/A
              le_mean =     -17.216627910992
             les_mean =     296.721302222942
             stat err =       0.000414526700
             autocorr =       1.158921483970
              std dev =       0.544553432609
             le_variance =       0.296538440966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558542346
                                         uncertainty =       0.002170837765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296558542346
                                         uncertainty =       0.002170837765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385057424
  error estimate for blocks of size 2^( 2) =       0.000394969404
  error estimate for blocks of size 2^( 3) =       0.000404437249
  error estimate for blocks of size 2^( 4) =       0.000411354072
  error estimate for blocks of size 2^( 5) =       0.000415356583
  error estimate for blocks of size 2^( 6) =       0.000415948777
  error estimate for blocks of size 2^( 7) =       0.000415447364

      target function =                  N/A
              le_mean =     -17.216627910979
             les_mean =     296.721302228409
             stat err =       0.000414526699
             autocorr =       1.158921484797
              std dev =       0.544553431110
             le_variance =       0.296538439334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216627910977        initial
     6.2500e+04     6.2500e+05             1.6877e-08       -17.216627911008  <--
     2.5000e+05     2.5000e+06             4.2193e-09       -17.216627910992
     1.0000e+06     1.0000e+07             1.0548e-09       -17.216627910979

*****************************************************************************
Applying the update for shift_i =   6.2500e+04     and shift_s =   6.2500e+05
*****************************************************************************

  Execution time = 2.9777e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803734e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538190e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948195e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402285e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024930e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685544e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170941e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147693e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791493e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377001e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654877e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359726e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476230e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088274e-02 3 1  ON 82
ci_034                 1.077943e-02 3 1  ON 83
ci_035                -4.996249e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622573e-03 3 1  ON 87
ci_039                 1.980881e-03 3 1  ON 88
ci_040                -4.113719e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730772e-03 3 1  ON 91
ci_043                -3.584716e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673322e-03 3 1  ON 94
ci_046                 5.223824e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192611e-02 3 1  ON 98
ci_050                 7.727331e-03 3 1  ON 99
ci_051                 7.750291e-03 3 1  ON 100
ci_052                -7.010718e-03 3 1  ON 101
ci_053                -6.822675e-03 3 1  ON 102
ci_054                -2.931328e-03 3 1  ON 103
ci_055                -3.081098e-03 3 1  ON 104
ci_056                 4.766360e-03 3 1  ON 105
ci_057                 4.624459e-03 3 1  ON 106
ci_058                -6.912482e-03 3 1  ON 107
ci_059                -6.879435e-03 3 1  ON 108
ci_060                 8.399349e-03 3 1  ON 109
ci_061                 8.234590e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004033e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123234e-03 3 1  ON 114
ci_066                 6.044364e-03 3 1  ON 115
ci_067                 5.242500e-03 3 1  ON 116
ci_068                -5.350698e-03 3 1  ON 117
ci_069                -5.112262e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7239e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.270495
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1970e-01
  Total weights = 1.956708561e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302605202477
                                         uncertainty =       0.003117051178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302605202477
                                         uncertainty =       0.003117051178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388960357
  error estimate for blocks of size 2^( 2) =       0.000398983918
  error estimate for blocks of size 2^( 3) =       0.000408536867
  error estimate for blocks of size 2^( 4) =       0.000415065459
  error estimate for blocks of size 2^( 5) =       0.000418802318
  error estimate for blocks of size 2^( 6) =       0.000420746450
  error estimate for blocks of size 2^( 7) =       0.000423009860

      target function =                  N/A
              le_mean =     -17.216858427478
             les_mean =     296.739912301824
             stat err =       0.000419406022
             autocorr =       1.162675827989
              std dev =       0.550073011680
             le_variance =       0.302580318178


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685842748e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216858427522       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216858427697       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216858427729       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216858427793       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216858427813       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216858427869       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216858427875       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216858427847       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216858427900       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216858427830       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+04 is 7.285094e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216858427522       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216858427566       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216858427574       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216858427588       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216858427601       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216858427386       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216858427631       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216858427655       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216858427658       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216858427519       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+04 is 1.821277e-08

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216858427522       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216858427533       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216858427535       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216858427539       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216858427646       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216858427822       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216858427125       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216858427543       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216858427262       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216858428015       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.5000e+05 is 4.553194e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6912e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370031e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904435e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803735e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998348e-02 1 1  ON 11
  ud_2                -1.727311e-02 1 1  ON 12
  ud_3                -7.538191e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948193e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402285e-01 1 1  ON 20
  eO_1                -4.286503e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024931e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230088e-02 1 1  ON 32
 eH1_3                -2.601350e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685545e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001466e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766800e-02 1 1  ON 43
 eH2_4                 1.867340e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324182e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170940e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147692e-02 3 1  ON 53
ci_005                 2.161795e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637399e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654877e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177257e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252557e-02 3 1  ON 73
ci_025                 1.222742e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444725e-02 3 1  ON 77
ci_029                -1.476230e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088274e-02 3 1  ON 82
ci_034                 1.077942e-02 3 1  ON 83
ci_035                -4.996248e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029890e-02 3 1  ON 86
ci_038                 1.622573e-03 3 1  ON 87
ci_039                 1.980880e-03 3 1  ON 88
ci_040                -4.113718e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730771e-03 3 1  ON 91
ci_043                -3.584714e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673323e-03 3 1  ON 94
ci_046                 5.223826e-03 3 1  ON 95
ci_047                 5.916201e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192611e-02 3 1  ON 98
ci_050                 7.727328e-03 3 1  ON 99
ci_051                 7.750290e-03 3 1  ON 100
ci_052                -7.010713e-03 3 1  ON 101
ci_053                -6.822674e-03 3 1  ON 102
ci_054                -2.931329e-03 3 1  ON 103
ci_055                -3.081101e-03 3 1  ON 104
ci_056                 4.766356e-03 3 1  ON 105
ci_057                 4.624463e-03 3 1  ON 106
ci_058                -6.912482e-03 3 1  ON 107
ci_059                -6.879433e-03 3 1  ON 108
ci_060                 8.399349e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046079e-03 3 1  ON 111
ci_063                -3.004035e-03 3 1  ON 112
ci_064                -2.988305e-03 3 1  ON 113
ci_065                -4.123231e-03 3 1  ON 114
ci_066                 6.044358e-03 3 1  ON 115
ci_067                 5.242502e-03 3 1  ON 116
ci_068                -5.350693e-03 3 1  ON 117
ci_069                -5.112264e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3358
    reference variance = 0.518418
====================================================
  Execution time = 2.0561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1013e-01
  Total weights = 1.9565e+06
  Execution time = 1.8304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880966956
                                         uncertainty =       0.002205836189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880966956
                                         uncertainty =       0.002205836189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884472
  error estimate for blocks of size 2^( 2) =       0.000395879958
  error estimate for blocks of size 2^( 3) =       0.000404899802
  error estimate for blocks of size 2^( 4) =       0.000411581240
  error estimate for blocks of size 2^( 5) =       0.000416274688
  error estimate for blocks of size 2^( 6) =       0.000417914000
  error estimate for blocks of size 2^( 7) =       0.000416900590

      target function =                  N/A
              le_mean =     -17.215728216482
             les_mean =     296.691424075952
             stat err =       0.000415667629
             autocorr =       1.160320070518
              std dev =       0.545723053169
             le_variance =       0.297813650760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880962367
                                         uncertainty =       0.002205835744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880962367
                                         uncertainty =       0.002205835744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884469
  error estimate for blocks of size 2^( 2) =       0.000395879955
  error estimate for blocks of size 2^( 3) =       0.000404899799
  error estimate for blocks of size 2^( 4) =       0.000411581237
  error estimate for blocks of size 2^( 5) =       0.000416274685
  error estimate for blocks of size 2^( 6) =       0.000417913997
  error estimate for blocks of size 2^( 7) =       0.000416900588

      target function =                  N/A
              le_mean =     -17.215728216541
             les_mean =     296.691424063104
             stat err =       0.000415667627
             autocorr =       1.160320074076
              std dev =       0.545723048970
             le_variance =       0.297813646177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880964661
                                         uncertainty =       0.002205835967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880964661
                                         uncertainty =       0.002205835967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884470
  error estimate for blocks of size 2^( 2) =       0.000395879956
  error estimate for blocks of size 2^( 3) =       0.000404899801
  error estimate for blocks of size 2^( 4) =       0.000411581238
  error estimate for blocks of size 2^( 5) =       0.000416274687
  error estimate for blocks of size 2^( 6) =       0.000417913998
  error estimate for blocks of size 2^( 7) =       0.000416900589

      target function =                  N/A
              le_mean =     -17.215728216511
             les_mean =     296.691424069505
             stat err =       0.000415667628
             autocorr =       1.160320072305
              std dev =       0.545723051070
             le_variance =       0.297813648469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880966669
                                         uncertainty =       0.002205836161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297880966669
                                         uncertainty =       0.002205836161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385884471
  error estimate for blocks of size 2^( 2) =       0.000395879958
  error estimate for blocks of size 2^( 3) =       0.000404899802
  error estimate for blocks of size 2^( 4) =       0.000411581240
  error estimate for blocks of size 2^( 5) =       0.000416274688
  error estimate for blocks of size 2^( 6) =       0.000417913999
  error estimate for blocks of size 2^( 7) =       0.000416900590

      target function =                  N/A
              le_mean =     -17.215728216486
             les_mean =     296.691424075144
             stat err =       0.000415667629
             autocorr =       1.160320070749
              std dev =       0.545723052907
             le_variance =       0.297813650474


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215728216482        initial
     1.5625e+04     1.5625e+05             7.2851e-08       -17.215728216541  <--
     6.2500e+04     6.2500e+05             1.8213e-08       -17.215728216511
     2.5000e+05     2.5000e+06             4.5532e-09       -17.215728216486

*****************************************************************************
Applying the update for shift_i =   1.5625e+04     and shift_s =   1.5625e+05
*****************************************************************************

  Execution time = 2.9785e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370032e-02 1 1  ON 1
  uu_2                -4.751529e-02 1 1  ON 2
  uu_3                -9.904436e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803735e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998349e-02 1 1  ON 11
  ud_2                -1.727310e-02 1 1  ON 12
  ud_3                -7.538191e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948185e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402285e-01 1 1  ON 20
  eO_1                -4.286504e-01 1 1  ON 21
  eO_2                -3.455093e-02 1 1  ON 22
  eO_3                 2.024931e-01 1 1  ON 23
  eO_4                 2.802466e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230087e-02 1 1  ON 32
 eH1_3                -2.601351e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685545e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001467e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766799e-02 1 1  ON 43
 eH2_4                 1.867339e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324183e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170938e-02 3 1  ON 50
ci_002                -3.012113e-02 3 1  ON 51
ci_003                -2.528615e-02 3 1  ON 52
ci_004                 2.147691e-02 3 1  ON 53
ci_005                 2.161794e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932298e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762695e-02 3 1  ON 58
ci_010                -1.791492e-02 3 1  ON 59
ci_011                -1.637398e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900032e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631849e-02 3 1  ON 65
ci_017                 1.654877e-02 3 1  ON 66
ci_018                 1.257064e-02 3 1  ON 67
ci_019                 1.289727e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177256e-02 3 1  ON 71
ci_023                 1.150965e-02 3 1  ON 72
ci_024                 1.252556e-02 3 1  ON 73
ci_025                 1.222742e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152033e-02 3 1  ON 76
ci_028                -1.444723e-02 3 1  ON 77
ci_029                -1.476229e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332798e-02 3 1  ON 81
ci_033                 1.088273e-02 3 1  ON 82
ci_034                 1.077942e-02 3 1  ON 83
ci_035                -4.996246e-03 3 1  ON 84
ci_036                -1.089545e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622572e-03 3 1  ON 87
ci_039                 1.980876e-03 3 1  ON 88
ci_040                -4.113717e-03 3 1  ON 89
ci_041                 1.002083e-02 3 1  ON 90
ci_042                 9.730770e-03 3 1  ON 91
ci_043                -3.584707e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673326e-03 3 1  ON 94
ci_046                 5.223831e-03 3 1  ON 95
ci_047                 5.916193e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192612e-02 3 1  ON 98
ci_050                 7.727322e-03 3 1  ON 99
ci_051                 7.750285e-03 3 1  ON 100
ci_052                -7.010699e-03 3 1  ON 101
ci_053                -6.822669e-03 3 1  ON 102
ci_054                -2.931332e-03 3 1  ON 103
ci_055                -3.081108e-03 3 1  ON 104
ci_056                 4.766344e-03 3 1  ON 105
ci_057                 4.624473e-03 3 1  ON 106
ci_058                -6.912484e-03 3 1  ON 107
ci_059                -6.879426e-03 3 1  ON 108
ci_060                 8.399352e-03 3 1  ON 109
ci_061                 8.234610e-03 3 1  ON 110
ci_062                -3.046081e-03 3 1  ON 111
ci_063                -3.004042e-03 3 1  ON 112
ci_064                -2.988306e-03 3 1  ON 113
ci_065                -4.123222e-03 3 1  ON 114
ci_066                 6.044341e-03 3 1  ON 115
ci_067                 5.242505e-03 3 1  ON 116
ci_068                -5.350680e-03 3 1  ON 117
ci_069                -5.112272e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7242e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2764
    reference variance = 0.175346
====================================================
  Execution time = 2.1076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1372e-01
  Total weights = 1.956566900e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.7876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298834507437
                                         uncertainty =       0.002052907356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298834507437
                                         uncertainty =       0.002052907356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386533091
  error estimate for blocks of size 2^( 2) =       0.000396042239
  error estimate for blocks of size 2^( 3) =       0.000404866697
  error estimate for blocks of size 2^( 4) =       0.000412390321
  error estimate for blocks of size 2^( 5) =       0.000417665198
  error estimate for blocks of size 2^( 6) =       0.000421315783
  error estimate for blocks of size 2^( 7) =       0.000423837277

      target function =                  N/A
              le_mean =     -17.215811444170
             les_mean =     296.697884048137
             stat err =       0.000418802145
             autocorr =       1.173936036004
              std dev =       0.546640340077
             le_variance =       0.298815661400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721581144417e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215811444203       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215811444865       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215811444954       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215811444677       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215811444977       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215811445289       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215811445339       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215811445494       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215811445485       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215811445482       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+03 is 2.507904e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215811444203       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215811444368       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215811444391       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215811444321       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215811444396       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215811444477       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215811444494       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215811444519       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215811444512       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215811444527       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+04 is 6.269779e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215811444203       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215811444244       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215811444250       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215811444234       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215811444251       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215811444303       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215811444291       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215811444301       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215811444263       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215811444297       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.2500e+04 is 1.567446e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9071e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.036798e-01 1 1  ON 0
  uu_1                 4.370034e-02 1 1  ON 1
  uu_2                -4.751528e-02 1 1  ON 2
  uu_3                -9.904436e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803737e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471069e-01 1 1  ON 10
  ud_1                 8.998349e-02 1 1  ON 11
  ud_2                -1.727310e-02 1 1  ON 12
  ud_3                -7.538192e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541541e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948175e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402286e-01 1 1  ON 20
  eO_1                -4.286504e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024931e-01 1 1  ON 23
  eO_4                 2.802467e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108765e-01 1 1  ON 27
  eO_8                 2.771127e-02 1 1  ON 28
  eO_9                 1.834435e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230087e-02 1 1  ON 32
 eH1_3                -2.601351e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568260e-02 1 1  ON 35
 eH1_6                 7.685545e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001467e-02 1 1  ON 38
 eH1_9                 2.406848e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766799e-02 1 1  ON 43
 eH2_4                 1.867339e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324183e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170938e-02 3 1  ON 50
ci_002                -3.012114e-02 3 1  ON 51
ci_003                -2.528616e-02 3 1  ON 52
ci_004                 2.147690e-02 3 1  ON 53
ci_005                 2.161794e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932298e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762696e-02 3 1  ON 58
ci_010                -1.791490e-02 3 1  ON 59
ci_011                -1.637398e-02 3 1  ON 60
ci_012                -1.648092e-02 3 1  ON 61
ci_013                -1.900033e-02 3 1  ON 62
ci_014                 1.377003e-02 3 1  ON 63
ci_015                 1.399674e-02 3 1  ON 64
ci_016                 1.631850e-02 3 1  ON 65
ci_017                 1.654878e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289726e-02 3 1  ON 68
ci_020                 1.326156e-02 3 1  ON 69
ci_021                 1.359725e-02 3 1  ON 70
ci_022                 1.177255e-02 3 1  ON 71
ci_023                 1.150964e-02 3 1  ON 72
ci_024                 1.252556e-02 3 1  ON 73
ci_025                 1.222742e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152034e-02 3 1  ON 76
ci_028                -1.444724e-02 3 1  ON 77
ci_029                -1.476228e-02 3 1  ON 78
ci_030                -1.102967e-02 3 1  ON 79
ci_031                -1.177169e-02 3 1  ON 80
ci_032                -1.332797e-02 3 1  ON 81
ci_033                 1.088272e-02 3 1  ON 82
ci_034                 1.077942e-02 3 1  ON 83
ci_035                -4.996239e-03 3 1  ON 84
ci_036                -1.089546e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622573e-03 3 1  ON 87
ci_039                 1.980871e-03 3 1  ON 88
ci_040                -4.113708e-03 3 1  ON 89
ci_041                 1.002084e-02 3 1  ON 90
ci_042                 9.730777e-03 3 1  ON 91
ci_043                -3.584701e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673329e-03 3 1  ON 94
ci_046                 5.223837e-03 3 1  ON 95
ci_047                 5.916196e-03 3 1  ON 96
ci_048                -1.129057e-02 3 1  ON 97
ci_049                -1.192613e-02 3 1  ON 98
ci_050                 7.727329e-03 3 1  ON 99
ci_051                 7.750273e-03 3 1  ON 100
ci_052                -7.010688e-03 3 1  ON 101
ci_053                -6.822675e-03 3 1  ON 102
ci_054                -2.931340e-03 3 1  ON 103
ci_055                -3.081103e-03 3 1  ON 104
ci_056                 4.766337e-03 3 1  ON 105
ci_057                 4.624474e-03 3 1  ON 106
ci_058                -6.912468e-03 3 1  ON 107
ci_059                -6.879409e-03 3 1  ON 108
ci_060                 8.399343e-03 3 1  ON 109
ci_061                 8.234606e-03 3 1  ON 110
ci_062                -3.046096e-03 3 1  ON 111
ci_063                -3.004043e-03 3 1  ON 112
ci_064                -2.988300e-03 3 1  ON 113
ci_065                -4.123241e-03 3 1  ON 114
ci_066                 6.044315e-03 3 1  ON 115
ci_067                 5.242507e-03 3 1  ON 116
ci_068                -5.350667e-03 3 1  ON 117
ci_069                -5.112280e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0649
    reference variance = 1.79533
====================================================
  Execution time = 2.1550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1119e-01
  Total weights = 1.9563e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875861489
                                         uncertainty =       0.001875835354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875861489
                                         uncertainty =       0.001875835354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385360568
  error estimate for blocks of size 2^( 2) =       0.000395356624
  error estimate for blocks of size 2^( 3) =       0.000404467920
  error estimate for blocks of size 2^( 4) =       0.000412074175
  error estimate for blocks of size 2^( 5) =       0.000416773708
  error estimate for blocks of size 2^( 6) =       0.000418740709
  error estimate for blocks of size 2^( 7) =       0.000420968476

      target function =                  N/A
              le_mean =     -17.216586258846
             les_mean =     296.722029711805
             stat err =       0.000417139267
             autocorr =       1.171730139476
              std dev =       0.544982141346
             le_variance =       0.297005534386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875879847
                                         uncertainty =       0.001875834989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875879847
                                         uncertainty =       0.001875834989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385360580
  error estimate for blocks of size 2^( 2) =       0.000395356635
  error estimate for blocks of size 2^( 3) =       0.000404467929
  error estimate for blocks of size 2^( 4) =       0.000412074184
  error estimate for blocks of size 2^( 5) =       0.000416773720
  error estimate for blocks of size 2^( 6) =       0.000418740722
  error estimate for blocks of size 2^( 7) =       0.000420968489

      target function =                  N/A
              le_mean =     -17.216586259295
             les_mean =     296.722029771726
             stat err =       0.000417139279
             autocorr =       1.171730133740
              std dev =       0.544982158185
             le_variance =       0.297005552740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875870669
                                         uncertainty =       0.001875835172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875870669
                                         uncertainty =       0.001875835172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385360574
  error estimate for blocks of size 2^( 2) =       0.000395356629
  error estimate for blocks of size 2^( 3) =       0.000404467925
  error estimate for blocks of size 2^( 4) =       0.000412074180
  error estimate for blocks of size 2^( 5) =       0.000416773714
  error estimate for blocks of size 2^( 6) =       0.000418740716
  error estimate for blocks of size 2^( 7) =       0.000420968483

      target function =                  N/A
              le_mean =     -17.216586259071
             les_mean =     296.722029741732
             stat err =       0.000417139273
             autocorr =       1.171730136605
              std dev =       0.544982149766
             le_variance =       0.297005543563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875862637
                                         uncertainty =       0.001875835332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296875862637
                                         uncertainty =       0.001875835332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385360569
  error estimate for blocks of size 2^( 2) =       0.000395356625
  error estimate for blocks of size 2^( 3) =       0.000404467921
  error estimate for blocks of size 2^( 4) =       0.000412074176
  error estimate for blocks of size 2^( 5) =       0.000416773708
  error estimate for blocks of size 2^( 6) =       0.000418740710
  error estimate for blocks of size 2^( 7) =       0.000420968477

      target function =                  N/A
              le_mean =     -17.216586258874
             les_mean =     296.722029715542
             stat err =       0.000417139268
             autocorr =       1.171730139118
              std dev =       0.544982142398
             le_variance =       0.297005535533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216586258846        initial
     3.9062e+03     3.9062e+04             2.5079e-07       -17.216586259295  <--
     1.5625e+04     1.5625e+05             6.2698e-08       -17.216586259071
     6.2500e+04     6.2500e+05             1.5674e-08       -17.216586258874

*****************************************************************************
Applying the update for shift_i =   3.9062e+03     and shift_s =   3.9062e+04
*****************************************************************************

  Execution time = 3.0742e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370038e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177254e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.149
    reference variance = 0.213015
====================================================
  Execution time = 2.0919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1174e-01
  Total weights = 1.956504309e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628342113
                                         uncertainty =       0.001791613096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299628342113
                                         uncertainty =       0.001791613096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387058763
  error estimate for blocks of size 2^( 2) =       0.000397245447
  error estimate for blocks of size 2^( 3) =       0.000406358761
  error estimate for blocks of size 2^( 4) =       0.000413468397
  error estimate for blocks of size 2^( 5) =       0.000417578270
  error estimate for blocks of size 2^( 6) =       0.000421315464
  error estimate for blocks of size 2^( 7) =       0.000422539925

      target function =                  N/A
              le_mean =     -17.216580034327
             les_mean =     296.722363631916
             stat err =       0.000418725514
             autocorr =       1.170321116243
              std dev =       0.547383751730
             le_variance =       0.299628971658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658003433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216580034377       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216580040563       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216580040231       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216580038443       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216580041368       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216580041545       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216580042046       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216580042231       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216580042289       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216580042230       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+02 is 1.163551e-06

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216580034377       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216580035924       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216580035840       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216580035390       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216580036125       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216580036169       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216580036294       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216580036338       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216580036361       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216580036339       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+03 is 2.908979e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216580034377       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216580034763       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216580034743       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216580034631       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216580034814       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216580034827       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216580034855       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216580034860       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216580034819       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216580034861       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+04 is 7.272512e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7081e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370046e-02 1 1  ON 1
  uu_2                -4.751524e-02 1 1  ON 2
  uu_3                -9.904439e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342282e-01 1 1  ON 5
  uu_6                -1.118893e-01 1 1  ON 6
  uu_7                -3.803744e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998353e-02 1 1  ON 11
  ud_2                -1.727307e-02 1 1  ON 12
  ud_3                -7.538198e-02 1 1  ON 13
  ud_4                -1.203891e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948106e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402291e-01 1 1  ON 20
  eO_1                -4.286507e-01 1 1  ON 21
  eO_2                -3.455096e-02 1 1  ON 22
  eO_3                 2.024935e-01 1 1  ON 23
  eO_4                 2.802470e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230085e-02 1 1  ON 32
 eH1_3                -2.601356e-02 1 1  ON 33
 eH1_4                 1.958759e-02 1 1  ON 34
 eH1_5                 3.568263e-02 1 1  ON 35
 eH1_6                 7.685545e-02 1 1  ON 36
 eH1_7                 1.104949e-01 1 1  ON 37
 eH1_8                 9.001469e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867335e-02 1 1  ON 44
 eH2_5                 3.506274e-02 1 1  ON 45
 eH2_6                 7.835839e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324186e-02 1 1  ON 48
 eH2_9                 2.614976e-02 1 1  ON 49
ci_001                -4.170928e-02 3 1  ON 50
ci_002                -3.012114e-02 3 1  ON 51
ci_003                -2.528622e-02 3 1  ON 52
ci_004                 2.147684e-02 3 1  ON 53
ci_005                 2.161794e-02 3 1  ON 54
ci_006                -1.879100e-02 3 1  ON 55
ci_007                -1.932300e-02 3 1  ON 56
ci_008                -1.805325e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791484e-02 3 1  ON 59
ci_011                -1.637402e-02 3 1  ON 60
ci_012                -1.648095e-02 3 1  ON 61
ci_013                -1.900040e-02 3 1  ON 62
ci_014                 1.377002e-02 3 1  ON 63
ci_015                 1.399671e-02 3 1  ON 64
ci_016                 1.631851e-02 3 1  ON 65
ci_017                 1.654878e-02 3 1  ON 66
ci_018                 1.257063e-02 3 1  ON 67
ci_019                 1.289725e-02 3 1  ON 68
ci_020                 1.326158e-02 3 1  ON 69
ci_021                 1.359721e-02 3 1  ON 70
ci_022                 1.177255e-02 3 1  ON 71
ci_023                 1.150963e-02 3 1  ON 72
ci_024                 1.252551e-02 3 1  ON 73
ci_025                 1.222744e-02 3 1  ON 74
ci_026                 1.110307e-02 3 1  ON 75
ci_027                 1.152036e-02 3 1  ON 76
ci_028                -1.444730e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102964e-02 3 1  ON 79
ci_031                -1.177167e-02 3 1  ON 80
ci_032                -1.332803e-02 3 1  ON 81
ci_033                 1.088268e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996189e-03 3 1  ON 84
ci_036                -1.089545e-02 3 1  ON 85
ci_037                -1.029893e-02 3 1  ON 86
ci_038                 1.622581e-03 3 1  ON 87
ci_039                 1.980785e-03 3 1  ON 88
ci_040                -4.113671e-03 3 1  ON 89
ci_041                 1.002082e-02 3 1  ON 90
ci_042                 9.730803e-03 3 1  ON 91
ci_043                -3.584619e-03 3 1  ON 92
ci_044                -1.543138e-02 3 1  ON 93
ci_045                -1.673380e-03 3 1  ON 94
ci_046                 5.223892e-03 3 1  ON 95
ci_047                 5.916159e-03 3 1  ON 96
ci_048                -1.129061e-02 3 1  ON 97
ci_049                -1.192614e-02 3 1  ON 98
ci_050                 7.727373e-03 3 1  ON 99
ci_051                 7.750276e-03 3 1  ON 100
ci_052                -7.010569e-03 3 1  ON 101
ci_053                -6.822683e-03 3 1  ON 102
ci_054                -2.931346e-03 3 1  ON 103
ci_055                -3.081081e-03 3 1  ON 104
ci_056                 4.766341e-03 3 1  ON 105
ci_057                 4.624474e-03 3 1  ON 106
ci_058                -6.912369e-03 3 1  ON 107
ci_059                -6.879333e-03 3 1  ON 108
ci_060                 8.399307e-03 3 1  ON 109
ci_061                 8.234600e-03 3 1  ON 110
ci_062                -3.046125e-03 3 1  ON 111
ci_063                -3.004060e-03 3 1  ON 112
ci_064                -2.988382e-03 3 1  ON 113
ci_065                -4.123209e-03 3 1  ON 114
ci_066                 6.044217e-03 3 1  ON 115
ci_067                 5.242537e-03 3 1  ON 116
ci_068                -5.350622e-03 3 1  ON 117
ci_069                -5.112270e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1478
    reference variance = 0.532402
====================================================
  Execution time = 2.0968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1739e-01
  Total weights = 1.9566e+06
  Execution time = 1.8296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777753773
                                         uncertainty =       0.002067822582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777753773
                                         uncertainty =       0.002067822582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495563
  error estimate for blocks of size 2^( 2) =       0.000398568395
  error estimate for blocks of size 2^( 3) =       0.000407510284
  error estimate for blocks of size 2^( 4) =       0.000413785168
  error estimate for blocks of size 2^( 5) =       0.000417908177
  error estimate for blocks of size 2^( 6) =       0.000418891019
  error estimate for blocks of size 2^( 7) =       0.000422928471

      target function =                  N/A
              le_mean =     -17.216126051008
             les_mean =     296.712387273148
             stat err =       0.000418378209
             autocorr =       1.159754288574
              std dev =       0.549415693650
             le_variance =       0.301857604429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777890804
                                         uncertainty =       0.002067827051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777890804
                                         uncertainty =       0.002067827051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495652
  error estimate for blocks of size 2^( 2) =       0.000398568478
  error estimate for blocks of size 2^( 3) =       0.000407510367
  error estimate for blocks of size 2^( 4) =       0.000413785258
  error estimate for blocks of size 2^( 5) =       0.000417908302
  error estimate for blocks of size 2^( 6) =       0.000418891168
  error estimate for blocks of size 2^( 7) =       0.000422928621

      target function =                  N/A
              le_mean =     -17.216126045839
             les_mean =     296.712389241764
             stat err =       0.000418378337
             autocorr =       1.159754467187
              std dev =       0.549415819807
             le_variance =       0.301857743054

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777822253
                                         uncertainty =       0.002067824816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777822253
                                         uncertainty =       0.002067824816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495607
  error estimate for blocks of size 2^( 2) =       0.000398568436
  error estimate for blocks of size 2^( 3) =       0.000407510325
  error estimate for blocks of size 2^( 4) =       0.000413785213
  error estimate for blocks of size 2^( 5) =       0.000417908240
  error estimate for blocks of size 2^( 6) =       0.000418891093
  error estimate for blocks of size 2^( 7) =       0.000422928546

      target function =                  N/A
              le_mean =     -17.216126048420
             les_mean =     296.712388254989
             stat err =       0.000418378273
             autocorr =       1.159754377903
              std dev =       0.549415756696
             le_variance =       0.301857673706

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777762329
                                         uncertainty =       0.002067822861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301777762329
                                         uncertainty =       0.002067822861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388495568
  error estimate for blocks of size 2^( 2) =       0.000398568400
  error estimate for blocks of size 2^( 3) =       0.000407510289
  error estimate for blocks of size 2^( 4) =       0.000413785174
  error estimate for blocks of size 2^( 5) =       0.000417908185
  error estimate for blocks of size 2^( 6) =       0.000418891028
  error estimate for blocks of size 2^( 7) =       0.000422928481

      target function =                  N/A
              le_mean =     -17.216126050684
             les_mean =     296.712387395588
             stat err =       0.000418378217
             autocorr =       1.159754299743
              std dev =       0.549415701527
             le_variance =       0.301857613085


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216126051008        initial  <--
     9.7656e+02     9.7656e+03             1.1636e-06       -17.216126045839
     3.9062e+03     3.9062e+04             2.9090e-07       -17.216126048420
     1.5625e+04     1.5625e+05             7.2725e-08       -17.216126050684

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1967
  </log>
  <optVariables href="H2O.s010.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370038e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177254e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7285e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.233894
====================================================
  Execution time = 2.0796e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1033e-01
  Total weights = 1.956901433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296666910412
                                         uncertainty =       0.002014680814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296666910412
                                         uncertainty =       0.002014680814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385183747
  error estimate for blocks of size 2^( 2) =       0.000395457068
  error estimate for blocks of size 2^( 3) =       0.000404553881
  error estimate for blocks of size 2^( 4) =       0.000411399096
  error estimate for blocks of size 2^( 5) =       0.000414896835
  error estimate for blocks of size 2^( 6) =       0.000417255546
  error estimate for blocks of size 2^( 7) =       0.000418658600

      target function =                  N/A
              le_mean =     -17.216310636116
             les_mean =     296.711680774258
             stat err =       0.000415552519
             autocorr =       1.163900708389
              std dev =       0.544732078853
             le_variance =       0.296733037731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631063612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216310636126       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216310636570       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216310636549       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216310636503       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216310636578       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216310636705       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216310636729       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216310636748       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216310636739       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216310636741       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+03 is 1.039578e-07

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216310636126       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216310636237       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216310636232       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216310636225       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216310636238       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216310636265       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216310636304       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216310636328       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216310636354       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216310636341       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+04 is 2.598948e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216310636126       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216310636154       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216310636153       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216310636150       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216310636348       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216310636292       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216310636209       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216310636188       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216310636395       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216310635552       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+05 is 6.497372e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6889e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803741e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948142e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368917e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170934e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648091e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654881e-02 3 1  ON 66
ci_018                 1.257066e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252554e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110309e-02 3 1  ON 75
ci_027                 1.152037e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476226e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996213e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622577e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113683e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730798e-03 3 1  ON 91
ci_043                -3.584679e-03 3 1  ON 92
ci_044                -1.543143e-02 3 1  ON 93
ci_045                -1.673340e-03 3 1  ON 94
ci_046                 5.223854e-03 3 1  ON 95
ci_047                 5.916202e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727349e-03 3 1  ON 99
ci_051                 7.750235e-03 3 1  ON 100
ci_052                -7.010653e-03 3 1  ON 101
ci_053                -6.822686e-03 3 1  ON 102
ci_054                -2.931366e-03 3 1  ON 103
ci_055                -3.081087e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624484e-03 3 1  ON 106
ci_058                -6.912422e-03 3 1  ON 107
ci_059                -6.879356e-03 3 1  ON 108
ci_060                 8.399313e-03 3 1  ON 109
ci_061                 8.234600e-03 3 1  ON 110
ci_062                -3.046137e-03 3 1  ON 111
ci_063                -3.004050e-03 3 1  ON 112
ci_064                -2.988282e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044229e-03 3 1  ON 115
ci_067                 5.242516e-03 3 1  ON 116
ci_068                -5.350627e-03 3 1  ON 117
ci_069                -5.112311e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.288254
====================================================
  Execution time = 2.0607e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0942e-01
  Total weights = 1.9565e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307912050
                                         uncertainty =       0.001864641038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307912050
                                         uncertainty =       0.001864641038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384883579
  error estimate for blocks of size 2^( 2) =       0.000394820946
  error estimate for blocks of size 2^( 3) =       0.000404185211
  error estimate for blocks of size 2^( 4) =       0.000411083944
  error estimate for blocks of size 2^( 5) =       0.000414860047
  error estimate for blocks of size 2^( 6) =       0.000416309187
  error estimate for blocks of size 2^( 7) =       0.000417079555

      target function =                  N/A
              le_mean =     -17.217120134424
             les_mean =     296.738640900685
             stat err =       0.000414833183
             autocorr =       1.161684547456
              std dev =       0.544307577849
             le_variance =       0.296270739303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307935924
                                         uncertainty =       0.001864641427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307935924
                                         uncertainty =       0.001864641427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384883595
  error estimate for blocks of size 2^( 2) =       0.000394820961
  error estimate for blocks of size 2^( 3) =       0.000404185226
  error estimate for blocks of size 2^( 4) =       0.000411083959
  error estimate for blocks of size 2^( 5) =       0.000414860061
  error estimate for blocks of size 2^( 6) =       0.000416309200
  error estimate for blocks of size 2^( 7) =       0.000417079568

      target function =                  N/A
              le_mean =     -17.217120134305
             les_mean =     296.738640885216
             stat err =       0.000414833197
             autocorr =       1.161684530704
              std dev =       0.544307599805
             le_variance =       0.296270763206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307923987
                                         uncertainty =       0.001864641232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307923987
                                         uncertainty =       0.001864641232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384883587
  error estimate for blocks of size 2^( 2) =       0.000394820953
  error estimate for blocks of size 2^( 3) =       0.000404185218
  error estimate for blocks of size 2^( 4) =       0.000411083952
  error estimate for blocks of size 2^( 5) =       0.000414860054
  error estimate for blocks of size 2^( 6) =       0.000416309193
  error estimate for blocks of size 2^( 7) =       0.000417079561

      target function =                  N/A
              le_mean =     -17.217120134365
             les_mean =     296.738640892930
             stat err =       0.000414833190
             autocorr =       1.161684539076
              std dev =       0.544307588827
             le_variance =       0.296270751255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307913542
                                         uncertainty =       0.001864641062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296307913542
                                         uncertainty =       0.001864641062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384883580
  error estimate for blocks of size 2^( 2) =       0.000394820947
  error estimate for blocks of size 2^( 3) =       0.000404185212
  error estimate for blocks of size 2^( 4) =       0.000411083945
  error estimate for blocks of size 2^( 5) =       0.000414860048
  error estimate for blocks of size 2^( 6) =       0.000416309187
  error estimate for blocks of size 2^( 7) =       0.000417079555

      target function =                  N/A
              le_mean =     -17.217120134417
             les_mean =     296.738640899713
             stat err =       0.000414833184
             autocorr =       1.161684546408
              std dev =       0.544307579221
             le_variance =       0.296270740797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217120134424        initial  <--
     9.7656e+03     9.7656e+04             1.0396e-07       -17.217120134305
     3.9062e+04     3.9062e+05             2.5989e-08       -17.217120134365
     1.5625e+05     1.5625e+06             6.4974e-09       -17.217120134417

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8252
  </log>
  <optVariables href="H2O.s011.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370038e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177254e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1884
    reference variance = 0.341492
====================================================
  Execution time = 2.0947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1760e-01
  Total weights = 1.956534801e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300757855403
                                         uncertainty =       0.002159833360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300757855403
                                         uncertainty =       0.002159833360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387826254
  error estimate for blocks of size 2^( 2) =       0.000398099872
  error estimate for blocks of size 2^( 3) =       0.000407230608
  error estimate for blocks of size 2^( 4) =       0.000413969268
  error estimate for blocks of size 2^( 5) =       0.000418594641
  error estimate for blocks of size 2^( 6) =       0.000420581259
  error estimate for blocks of size 2^( 7) =       0.000424730104

      target function =                  N/A
              le_mean =     -17.215976883375
             les_mean =     296.707459586932
             stat err =       0.000419468818
             autocorr =       1.169835921701
              std dev =       0.548469148623
             le_variance =       0.300818406991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597688337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215976883402       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215976883414       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215976883394       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215976883410       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215976883407       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215976883455       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215976883412       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215976883397       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215976883322       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215976883411       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+04 is 1.170891e-08

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215976883402       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215976883405       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215976883400       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215976883399       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215976883411       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215976883180       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215976883330       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215976883737       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215976883649       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215976884053       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+05 is 2.927229e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215976883402       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215976883403       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215976883402       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215976883402       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215976881849       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215976883358       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215976883389       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215976882386       residual = 6.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215976883979       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215976886632       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+06 is 7.318073e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241367 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6975e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332795e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750239e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242512e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1437
    reference variance = 0.149322
====================================================
  Execution time = 2.0821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.9566e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660748155
                                         uncertainty =       0.002317205546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660748155
                                         uncertainty =       0.002317205546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385794933
  error estimate for blocks of size 2^( 2) =       0.000396028322
  error estimate for blocks of size 2^( 3) =       0.000404926668
  error estimate for blocks of size 2^( 4) =       0.000411819289
  error estimate for blocks of size 2^( 5) =       0.000416143885
  error estimate for blocks of size 2^( 6) =       0.000418425541
  error estimate for blocks of size 2^( 7) =       0.000420914572

      target function =                  N/A
              le_mean =     -17.216518379162
             les_mean =     296.722025727623
             stat err =       0.000416825822
             autocorr =       1.167336840038
              std dev =       0.545596426235
             le_variance =       0.297675460321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660747043
                                         uncertainty =       0.002317205481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660747043
                                         uncertainty =       0.002317205481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385794932
  error estimate for blocks of size 2^( 2) =       0.000396028321
  error estimate for blocks of size 2^( 3) =       0.000404926668
  error estimate for blocks of size 2^( 4) =       0.000411819288
  error estimate for blocks of size 2^( 5) =       0.000416143884
  error estimate for blocks of size 2^( 6) =       0.000418425541
  error estimate for blocks of size 2^( 7) =       0.000420914572

      target function =                  N/A
              le_mean =     -17.216518379121
             les_mean =     296.722025717119
             stat err =       0.000416825821
             autocorr =       1.167336840717
              std dev =       0.545596425223
             le_variance =       0.297675459217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660747599
                                         uncertainty =       0.002317205513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660747599
                                         uncertainty =       0.002317205513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385794932
  error estimate for blocks of size 2^( 2) =       0.000396028322
  error estimate for blocks of size 2^( 3) =       0.000404926668
  error estimate for blocks of size 2^( 4) =       0.000411819288
  error estimate for blocks of size 2^( 5) =       0.000416143884
  error estimate for blocks of size 2^( 6) =       0.000418425541
  error estimate for blocks of size 2^( 7) =       0.000420914572

      target function =                  N/A
              le_mean =     -17.216518379142
             les_mean =     296.722025722370
             stat err =       0.000416825821
             autocorr =       1.167336840393
              std dev =       0.545596425729
             le_variance =       0.297675459769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660748086
                                         uncertainty =       0.002317205542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297660748086
                                         uncertainty =       0.002317205542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385794933
  error estimate for blocks of size 2^( 2) =       0.000396028322
  error estimate for blocks of size 2^( 3) =       0.000404926668
  error estimate for blocks of size 2^( 4) =       0.000411819289
  error estimate for blocks of size 2^( 5) =       0.000416143885
  error estimate for blocks of size 2^( 6) =       0.000418425541
  error estimate for blocks of size 2^( 7) =       0.000420914572

      target function =                  N/A
              le_mean =     -17.216518379160
             les_mean =     296.722025726966
             stat err =       0.000416825822
             autocorr =       1.167336840090
              std dev =       0.545596426172
             le_variance =       0.297675460252


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216518379162        initial  <--
     9.7656e+04     9.7656e+05             1.1709e-08       -17.216518379121
     3.9062e+05     3.9062e+06             2.9272e-09       -17.216518379142
     1.5625e+06     1.5625e+07             7.3181e-10       -17.216518379160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0228
  </log>
  <optVariables href="H2O.s012.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370038e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177254e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916203e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2668
    reference variance = 0.531036
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0720e-01
  Total weights = 1.956713686e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295033447629
                                         uncertainty =       0.001794949979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295033447629
                                         uncertainty =       0.001794949979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384075401
  error estimate for blocks of size 2^( 2) =       0.000394031191
  error estimate for blocks of size 2^( 3) =       0.000403302938
  error estimate for blocks of size 2^( 4) =       0.000409938854
  error estimate for blocks of size 2^( 5) =       0.000414328695
  error estimate for blocks of size 2^( 6) =       0.000416151625
  error estimate for blocks of size 2^( 7) =       0.000418711987

      target function =                  N/A
              le_mean =     -17.216520779872
             les_mean =     296.715787583819
             stat err =       0.000414782790
             autocorr =       1.166295157461
              std dev =       0.543164640794
             le_variance =       0.295027827009


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652077987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520779916       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520779916       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520779914       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520779913       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520779916       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520779881       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520779985       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520780106       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520781170       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520778488       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+05 is 1.143441e-09

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520779916       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520779916       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520779916       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520781013       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520780920       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520766850       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520774659       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520789078       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520780250       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520784022       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+06 is 2.858602e-10

solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520779916       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520779916       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520779916       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520779296       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520778177       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520772075       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520788904       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216520785002       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216520783324       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216520777934       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5625e+07 is 7.146496e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6787e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370038e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822692e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234595e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.654203
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1146e-01
  Total weights = 1.9566e+06
  Execution time = 1.8211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521416
                                         uncertainty =       0.001763765475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521416
                                         uncertainty =       0.001763765475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395741
  error estimate for blocks of size 2^( 2) =       0.000396353839
  error estimate for blocks of size 2^( 3) =       0.000405272735
  error estimate for blocks of size 2^( 4) =       0.000412322756
  error estimate for blocks of size 2^( 5) =       0.000417958219
  error estimate for blocks of size 2^( 6) =       0.000420539646
  error estimate for blocks of size 2^( 7) =       0.000422232528

      target function =                  N/A
              le_mean =     -17.216173587876
             les_mean =     296.708093268868
             stat err =       0.000418263287
             autocorr =       1.171749647134
              std dev =       0.546446097177
             le_variance =       0.298603337120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521444
                                         uncertainty =       0.001763765479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521444
                                         uncertainty =       0.001763765479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395741
  error estimate for blocks of size 2^( 2) =       0.000396353839
  error estimate for blocks of size 2^( 3) =       0.000405272735
  error estimate for blocks of size 2^( 4) =       0.000412322756
  error estimate for blocks of size 2^( 5) =       0.000417958219
  error estimate for blocks of size 2^( 6) =       0.000420539646
  error estimate for blocks of size 2^( 7) =       0.000422232528

      target function =                  N/A
              le_mean =     -17.216173587880
             les_mean =     296.708093268814
             stat err =       0.000418263287
             autocorr =       1.171749647109
              std dev =       0.546446097203
             le_variance =       0.298603337149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521430
                                         uncertainty =       0.001763765477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521430
                                         uncertainty =       0.001763765477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395741
  error estimate for blocks of size 2^( 2) =       0.000396353839
  error estimate for blocks of size 2^( 3) =       0.000405272735
  error estimate for blocks of size 2^( 4) =       0.000412322756
  error estimate for blocks of size 2^( 5) =       0.000417958219
  error estimate for blocks of size 2^( 6) =       0.000420539646
  error estimate for blocks of size 2^( 7) =       0.000422232528

      target function =                  N/A
              le_mean =     -17.216173587878
             les_mean =     296.708093268841
             stat err =       0.000418263287
             autocorr =       1.171749647119
              std dev =       0.546446097190
             le_variance =       0.298603337134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521417
                                         uncertainty =       0.001763765476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298655521417
                                         uncertainty =       0.001763765476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386395741
  error estimate for blocks of size 2^( 2) =       0.000396353839
  error estimate for blocks of size 2^( 3) =       0.000405272735
  error estimate for blocks of size 2^( 4) =       0.000412322756
  error estimate for blocks of size 2^( 5) =       0.000417958219
  error estimate for blocks of size 2^( 6) =       0.000420539646
  error estimate for blocks of size 2^( 7) =       0.000422232528

      target function =                  N/A
              le_mean =     -17.216173587876
             les_mean =     296.708093268865
             stat err =       0.000418263287
             autocorr =       1.171749647132
              std dev =       0.546446097179
             le_variance =       0.298603337122


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216173587876        initial
     9.7656e+05     9.7656e+06             1.1434e-09       -17.216173587880  <--
     3.9062e+06     3.9062e+07             2.8586e-10       -17.216173587878
     1.5625e+07     1.5625e+08             7.1465e-11       -17.216173587876

*****************************************************************************
Applying the update for shift_i =   9.7656e+05     and shift_s =   9.7656e+06
*****************************************************************************

  Execution time = 2.9760e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6554e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.296864
====================================================
  Execution time = 2.0872e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1571e-01
  Total weights = 1.956248748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301655632310
                                         uncertainty =       0.002319836793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301655632310
                                         uncertainty =       0.002319836793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388366227
  error estimate for blocks of size 2^( 2) =       0.000398383614
  error estimate for blocks of size 2^( 3) =       0.000407847615
  error estimate for blocks of size 2^( 4) =       0.000415678727
  error estimate for blocks of size 2^( 5) =       0.000420099269
  error estimate for blocks of size 2^( 6) =       0.000421312337
  error estimate for blocks of size 2^( 7) =       0.000420747778

      target function =                  N/A
              le_mean =     -17.216568219938
             les_mean =     296.725928750232
             stat err =       0.000419459528
             autocorr =       1.166533499731
              std dev =       0.549232785722
             le_variance =       0.301656652912


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656821994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568219981       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216568219980       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216568219977       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216568219938       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216568219952       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216568220044       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216568219896       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216568219992       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216568220223       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216568219166       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+05 is 4.661767e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568219981       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216568219981       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216568219980       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216568219981       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216568217516       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216568220335       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216568220331       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216568219275       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216568224353       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216568213567       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+05 is 1.165442e-09

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216568219981       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216568219981       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216568219981       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216568220433       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216568219993       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216568219867       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216568219436       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216568218116       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216568219411       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216568221431       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+06 is 2.913605e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.249347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6920e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996216e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350629e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.267523
====================================================
  Execution time = 2.2476e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1424e-01
  Total weights = 1.9564e+06
  Execution time = 1.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951662
                                         uncertainty =       0.002173876897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951662
                                         uncertainty =       0.002173876897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387595861
  error estimate for blocks of size 2^( 2) =       0.000397864714
  error estimate for blocks of size 2^( 3) =       0.000406576690
  error estimate for blocks of size 2^( 4) =       0.000413068729
  error estimate for blocks of size 2^( 5) =       0.000417107615
  error estimate for blocks of size 2^( 6) =       0.000419164095
  error estimate for blocks of size 2^( 7) =       0.000421955497

      target function =                  N/A
              le_mean =     -17.217034854790
             les_mean =     296.740533217291
             stat err =       0.000417823984
             autocorr =       1.162059784094
              std dev =       0.548143322823
             le_variance =       0.300461102355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951978
                                         uncertainty =       0.002173876888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951978
                                         uncertainty =       0.002173876888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387595861
  error estimate for blocks of size 2^( 2) =       0.000397864714
  error estimate for blocks of size 2^( 3) =       0.000406576691
  error estimate for blocks of size 2^( 4) =       0.000413068730
  error estimate for blocks of size 2^( 5) =       0.000417107616
  error estimate for blocks of size 2^( 6) =       0.000419164095
  error estimate for blocks of size 2^( 7) =       0.000421955498

      target function =                  N/A
              le_mean =     -17.217034854772
             les_mean =     296.740533216511
             stat err =       0.000417823985
             autocorr =       1.162059783987
              std dev =       0.548143323114
             le_variance =       0.300461102674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951820
                                         uncertainty =       0.002173876892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951820
                                         uncertainty =       0.002173876892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387595861
  error estimate for blocks of size 2^( 2) =       0.000397864714
  error estimate for blocks of size 2^( 3) =       0.000406576690
  error estimate for blocks of size 2^( 4) =       0.000413068730
  error estimate for blocks of size 2^( 5) =       0.000417107615
  error estimate for blocks of size 2^( 6) =       0.000419164095
  error estimate for blocks of size 2^( 7) =       0.000421955497

      target function =                  N/A
              le_mean =     -17.217034854781
             les_mean =     296.740533216901
             stat err =       0.000417823984
             autocorr =       1.162059784048
              std dev =       0.548143322969
             le_variance =       0.300461102515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951681
                                         uncertainty =       0.002173876897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300390951681
                                         uncertainty =       0.002173876897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387595861
  error estimate for blocks of size 2^( 2) =       0.000397864714
  error estimate for blocks of size 2^( 3) =       0.000406576690
  error estimate for blocks of size 2^( 4) =       0.000413068729
  error estimate for blocks of size 2^( 5) =       0.000417107615
  error estimate for blocks of size 2^( 6) =       0.000419164095
  error estimate for blocks of size 2^( 7) =       0.000421955497

      target function =                  N/A
              le_mean =     -17.217034854789
             les_mean =     296.740533217243
             stat err =       0.000417823984
             autocorr =       1.162059784091
              std dev =       0.548143322841
             le_variance =       0.300461102375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217034854790        initial  <--
     2.4414e+05     2.4414e+06             4.6618e-09       -17.217034854772
     9.7656e+05     9.7656e+06             1.1654e-09       -17.217034854781
     3.9062e+06     3.9062e+07             2.9136e-10       -17.217034854789

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6446
  </log>
  <optVariables href="H2O.s014.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8571e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2222
    reference variance = 0.36338
====================================================
  Execution time = 2.1026e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.956699791e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299269669407
                                         uncertainty =       0.002054076663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299269669407
                                         uncertainty =       0.002054076663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386778016
  error estimate for blocks of size 2^( 2) =       0.000396743333
  error estimate for blocks of size 2^( 3) =       0.000405611694
  error estimate for blocks of size 2^( 4) =       0.000411699761
  error estimate for blocks of size 2^( 5) =       0.000416038071
  error estimate for blocks of size 2^( 6) =       0.000418324933
  error estimate for blocks of size 2^( 7) =       0.000420799924

      target function =                  N/A
              le_mean =     -17.215971650380
             les_mean =     296.703201107046
             stat err =       0.000416715672
             autocorr =       1.160796542953
              std dev =       0.546986715675
             le_variance =       0.299194467125


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597165038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215971650405       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215971650405       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215971650405       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215971649564       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215971650394       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215971650389       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215971651265       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215971650261       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215971648836       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215971651795       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+06 is 4.422856e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215971650405       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215971650405       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215971650405       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215971652693       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215971659691       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215971649913       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215971643412       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215971648784       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215971650967       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215971649891       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+06 is 1.105712e-10

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215971650405       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215971650405       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215971650405       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215971650405       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215971668248       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215971649708       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215971690006       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215971655354       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215971628860       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215971674892       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+07 is 2.764277e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.253253 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7145e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.211915
====================================================
  Execution time = 2.0804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1550e-01
  Total weights = 1.9568e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461767
                                         uncertainty =       0.002132978921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461767
                                         uncertainty =       0.002132978921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385930818
  error estimate for blocks of size 2^( 2) =       0.000395784935
  error estimate for blocks of size 2^( 3) =       0.000405042376
  error estimate for blocks of size 2^( 4) =       0.000411317311
  error estimate for blocks of size 2^( 5) =       0.000415253203
  error estimate for blocks of size 2^( 6) =       0.000417797832
  error estimate for blocks of size 2^( 7) =       0.000418968806

      target function =                  N/A
              le_mean =     -17.216616595342
             les_mean =     296.727389723099
             stat err =       0.000415834288
             autocorr =       1.160971808379
              std dev =       0.545788596858
             le_variance =       0.297885192460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461684
                                         uncertainty =       0.002132978912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461684
                                         uncertainty =       0.002132978912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385930818
  error estimate for blocks of size 2^( 2) =       0.000395784935
  error estimate for blocks of size 2^( 3) =       0.000405042376
  error estimate for blocks of size 2^( 4) =       0.000411317311
  error estimate for blocks of size 2^( 5) =       0.000415253203
  error estimate for blocks of size 2^( 6) =       0.000417797832
  error estimate for blocks of size 2^( 7) =       0.000418968806

      target function =                  N/A
              le_mean =     -17.216616595339
             les_mean =     296.727389722251
             stat err =       0.000415834288
             autocorr =       1.160971808516
              std dev =       0.545788596782
             le_variance =       0.297885192377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461726
                                         uncertainty =       0.002132978916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461726
                                         uncertainty =       0.002132978916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385930818
  error estimate for blocks of size 2^( 2) =       0.000395784935
  error estimate for blocks of size 2^( 3) =       0.000405042376
  error estimate for blocks of size 2^( 4) =       0.000411317311
  error estimate for blocks of size 2^( 5) =       0.000415253203
  error estimate for blocks of size 2^( 6) =       0.000417797832
  error estimate for blocks of size 2^( 7) =       0.000418968806

      target function =                  N/A
              le_mean =     -17.216616595341
             les_mean =     296.727389722675
             stat err =       0.000415834288
             autocorr =       1.160971808450
              std dev =       0.545788596820
             le_variance =       0.297885192419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461762
                                         uncertainty =       0.002132978920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297963461762
                                         uncertainty =       0.002132978920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385930818
  error estimate for blocks of size 2^( 2) =       0.000395784935
  error estimate for blocks of size 2^( 3) =       0.000405042376
  error estimate for blocks of size 2^( 4) =       0.000411317311
  error estimate for blocks of size 2^( 5) =       0.000415253203
  error estimate for blocks of size 2^( 6) =       0.000417797832
  error estimate for blocks of size 2^( 7) =       0.000418968806

      target function =                  N/A
              le_mean =     -17.216616595342
             les_mean =     296.727389723046
             stat err =       0.000415834288
             autocorr =       1.160971808386
              std dev =       0.545788596853
             le_variance =       0.297885192455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216616595342        initial  <--
     2.4414e+06     2.4414e+07             4.4229e-10       -17.216616595339
     9.7656e+06     9.7656e+07             1.1057e-10       -17.216616595341
     3.9062e+07     3.9062e+08             2.7643e-11       -17.216616595342

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9858
  </log>
  <optVariables href="H2O.s015.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1463
    reference variance = 0.42166
====================================================
  Execution time = 2.0770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1386e-01
  Total weights = 1.956490184e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299550396199
                                         uncertainty =       0.002949852994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299550396199
                                         uncertainty =       0.002949852994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386967051
  error estimate for blocks of size 2^( 2) =       0.000396596379
  error estimate for blocks of size 2^( 3) =       0.000405274060
  error estimate for blocks of size 2^( 4) =       0.000411821492
  error estimate for blocks of size 2^( 5) =       0.000416933736
  error estimate for blocks of size 2^( 6) =       0.000418924968
  error estimate for blocks of size 2^( 7) =       0.000421370439

      target function =                  N/A
              le_mean =     -17.216138470049
             les_mean =     296.709285406831
             stat err =       0.000417262659
             autocorr =       1.162709085297
              std dev =       0.547254051884
             le_variance =       0.299486997304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613847005e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216138470100       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216138470101       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216138470101       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216138486705       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216138469657       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216138459081       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216138481456       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216138459180       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216138480635       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216138468698       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+07 is 4.201954e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216138470100       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216138470101       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216138470101       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216138470101       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216138470101       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216138470101       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216138470109       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216138400368       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216138489419       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216138541355       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+07 is 1.050495e-11

solving harmonic davidson linear method for identity shift 3.9062e+08, overlap shift 3.9062e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216138470100       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216138470100       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216138470100       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216138600069       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216142056341       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216138582522       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216138547301       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216138459982       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216138307983       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216137325701       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+08 is 2.627323e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6817e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1618
    reference variance = 0.179102
====================================================
  Execution time = 2.0483e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0896e-01
  Total weights = 1.9567e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127518
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127518
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384410526
  error estimate for blocks of size 2^( 2) =       0.000394254793
  error estimate for blocks of size 2^( 3) =       0.000403142549
  error estimate for blocks of size 2^( 4) =       0.000409538073
  error estimate for blocks of size 2^( 5) =       0.000413554612
  error estimate for blocks of size 2^( 6) =       0.000414053550
  error estimate for blocks of size 2^( 7) =       0.000412640437

      target function =                  N/A
              le_mean =     -17.216417818866
             les_mean =     296.714006947541
             stat err =       0.000412446668
             autocorr =       1.151184826623
              std dev =       0.543638579314
             le_variance =       0.295542904918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127515
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127515
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384410526
  error estimate for blocks of size 2^( 2) =       0.000394254793
  error estimate for blocks of size 2^( 3) =       0.000403142549
  error estimate for blocks of size 2^( 4) =       0.000409538073
  error estimate for blocks of size 2^( 5) =       0.000413554612
  error estimate for blocks of size 2^( 6) =       0.000414053550
  error estimate for blocks of size 2^( 7) =       0.000412640437

      target function =                  N/A
              le_mean =     -17.216417818866
             les_mean =     296.714006947533
             stat err =       0.000412446668
             autocorr =       1.151184826628
              std dev =       0.543638579311
             le_variance =       0.295542904916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127516
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127516
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384410526
  error estimate for blocks of size 2^( 2) =       0.000394254793
  error estimate for blocks of size 2^( 3) =       0.000403142549
  error estimate for blocks of size 2^( 4) =       0.000409538073
  error estimate for blocks of size 2^( 5) =       0.000413554612
  error estimate for blocks of size 2^( 6) =       0.000414053550
  error estimate for blocks of size 2^( 7) =       0.000412640437

      target function =                  N/A
              le_mean =     -17.216417818866
             les_mean =     296.714006947537
             stat err =       0.000412446668
             autocorr =       1.151184826621
              std dev =       0.543638579313
             le_variance =       0.295542904917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127517
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295623127517
                                         uncertainty =       0.001722190374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384410526
  error estimate for blocks of size 2^( 2) =       0.000394254793
  error estimate for blocks of size 2^( 3) =       0.000403142549
  error estimate for blocks of size 2^( 4) =       0.000409538073
  error estimate for blocks of size 2^( 5) =       0.000413554612
  error estimate for blocks of size 2^( 6) =       0.000414053550
  error estimate for blocks of size 2^( 7) =       0.000412640437

      target function =                  N/A
              le_mean =     -17.216417818866
             les_mean =     296.714006947540
             stat err =       0.000412446668
             autocorr =       1.151184826625
              std dev =       0.543638579314
             le_variance =       0.295542904918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216417818866        initial  <--
     2.4414e+07     2.4414e+08             4.2020e-11       -17.216417818866
     9.7656e+07     9.7656e+08             1.0505e-11       -17.216417818866
     3.9062e+08     3.9062e+09             2.6273e-12       -17.216417818866

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6557
  </log>
  <optVariables href="H2O.s016.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1812
    reference variance = 0.301384
====================================================
  Execution time = 2.0930e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1185e-01
  Total weights = 1.956296760e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295569792430
                                         uncertainty =       0.001808253322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295569792430
                                         uncertainty =       0.001808253322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384578349
  error estimate for blocks of size 2^( 2) =       0.000395015349
  error estimate for blocks of size 2^( 3) =       0.000404190921
  error estimate for blocks of size 2^( 4) =       0.000411350014
  error estimate for blocks of size 2^( 5) =       0.000415234813
  error estimate for blocks of size 2^( 6) =       0.000417132763
  error estimate for blocks of size 2^( 7) =       0.000417191485

      target function =                  N/A
              le_mean =     -17.216733073921
             les_mean =     296.727751589628
             stat err =       0.000415227269
             autocorr =       1.165741000264
              std dev =       0.543875917188
             le_variance =       0.295801013297


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673307392e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733073937       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733073937       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733073937       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733211301       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733157837       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733058909       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733286760       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216733045825       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216732981604       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216733228027       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+08 is 4.293636e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733073937       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733073937       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733073937       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733073937       residual = 8.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733081786       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733756833       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733032235       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216732503495       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216733883242       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216732553426       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+08 is 1.073294e-12

solving harmonic davidson linear method for identity shift 3.9062e+09, overlap shift 3.9062e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733073937       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733073937       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733073937       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733073937       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733707852       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733130045       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733744151       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216732897320       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216735185936       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216730745688       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.9062e+09 is 2.682671e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.261077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6990e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2557
    reference variance = 0.36238
====================================================
  Execution time = 2.0679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1180e-01
  Total weights = 1.9568e+06
  Execution time = 1.8458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386093307
  error estimate for blocks of size 2^( 2) =       0.000396117743
  error estimate for blocks of size 2^( 3) =       0.000405339237
  error estimate for blocks of size 2^( 4) =       0.000411968274
  error estimate for blocks of size 2^( 5) =       0.000416369992
  error estimate for blocks of size 2^( 6) =       0.000420136474
  error estimate for blocks of size 2^( 7) =       0.000422024507

      target function =                  N/A
              le_mean =     -17.216771289867
             les_mean =     296.729016472202
             stat err =       0.000417624812
             autocorr =       1.170005869123
              std dev =       0.546018390407
             le_variance =       0.298136082663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386093307
  error estimate for blocks of size 2^( 2) =       0.000396117743
  error estimate for blocks of size 2^( 3) =       0.000405339237
  error estimate for blocks of size 2^( 4) =       0.000411968274
  error estimate for blocks of size 2^( 5) =       0.000416369992
  error estimate for blocks of size 2^( 6) =       0.000420136474
  error estimate for blocks of size 2^( 7) =       0.000422024507

      target function =                  N/A
              le_mean =     -17.216771289867
             les_mean =     296.729016472201
             stat err =       0.000417624812
             autocorr =       1.170005869121
              std dev =       0.546018390407
             le_variance =       0.298136082662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386093307
  error estimate for blocks of size 2^( 2) =       0.000396117743
  error estimate for blocks of size 2^( 3) =       0.000405339237
  error estimate for blocks of size 2^( 4) =       0.000411968274
  error estimate for blocks of size 2^( 5) =       0.000416369992
  error estimate for blocks of size 2^( 6) =       0.000420136474
  error estimate for blocks of size 2^( 7) =       0.000422024507

      target function =                  N/A
              le_mean =     -17.216771289867
             les_mean =     296.729016472202
             stat err =       0.000417624812
             autocorr =       1.170005869128
              std dev =       0.546018390407
             le_variance =       0.298136082663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298140375624
                                         uncertainty =       0.001931404188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386093307
  error estimate for blocks of size 2^( 2) =       0.000396117743
  error estimate for blocks of size 2^( 3) =       0.000405339237
  error estimate for blocks of size 2^( 4) =       0.000411968274
  error estimate for blocks of size 2^( 5) =       0.000416369992
  error estimate for blocks of size 2^( 6) =       0.000420136474
  error estimate for blocks of size 2^( 7) =       0.000422024507

      target function =                  N/A
              le_mean =     -17.216771289867
             les_mean =     296.729016472202
             stat err =       0.000417624812
             autocorr =       1.170005869119
              std dev =       0.546018390407
             le_variance =       0.298136082663


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216771289867        initial
     2.4414e+08     2.4414e+09             4.2936e-12       -17.216771289867  <--
     9.7656e+08     9.7656e+09             1.0733e-12       -17.216771289867
     3.9062e+09     3.9062e+10             2.6827e-13       -17.216771289867

*****************************************************************************
Applying the update for shift_i =   2.4414e+08     and shift_s =   2.4414e+09
*****************************************************************************

  Execution time = 2.9947e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2291
    reference variance = 0.287031
====================================================
  Execution time = 2.1078e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5327e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1552e-01
  Total weights = 1.956440708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169420805
                                         uncertainty =       0.002193818443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299169420805
                                         uncertainty =       0.002193818443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386732918
  error estimate for blocks of size 2^( 2) =       0.000397218163
  error estimate for blocks of size 2^( 3) =       0.000405954767
  error estimate for blocks of size 2^( 4) =       0.000412312663
  error estimate for blocks of size 2^( 5) =       0.000415784052
  error estimate for blocks of size 2^( 6) =       0.000415713674
  error estimate for blocks of size 2^( 7) =       0.000416611341

      target function =                  N/A
              le_mean =     -17.215820161681
             les_mean =     296.699980121054
             stat err =       0.000415105433
             autocorr =       1.152111610059
              std dev =       0.546922938285
             le_variance =       0.299124700423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721582016168e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820161715       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820161715       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820161715       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820161715       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820135686       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820417551       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215820007075       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215820198922       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215820113863       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215820199881       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+07 is 1.806756e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820161715       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820161715       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820161715       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820147131       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215820208404       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215820175074       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215820166007       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215820196169       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215820075286       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215820257877       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+08 is 4.516928e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215820161715       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215820161715       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215820161715       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215820161715       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215817514220       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215818446934       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215822356468       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215823751079       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215804119379       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215817110953       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.7656e+08 is 1.129263e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264976 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7278e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2874
    reference variance = 0.30379
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1387e-01
  Total weights = 1.9566e+06
  Execution time = 1.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365295
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365295
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387657423
  error estimate for blocks of size 2^( 2) =       0.000397914336
  error estimate for blocks of size 2^( 3) =       0.000406870095
  error estimate for blocks of size 2^( 4) =       0.000413940907
  error estimate for blocks of size 2^( 5) =       0.000417696714
  error estimate for blocks of size 2^( 6) =       0.000419429194
  error estimate for blocks of size 2^( 7) =       0.000420670681

      target function =                  N/A
              le_mean =     -17.216128038304
             les_mean =     296.708939454154
             stat err =       0.000417934374
             autocorr =       1.162304650712
              std dev =       0.548230385340
             le_variance =       0.300556555410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365297
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365297
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387657423
  error estimate for blocks of size 2^( 2) =       0.000397914336
  error estimate for blocks of size 2^( 3) =       0.000406870095
  error estimate for blocks of size 2^( 4) =       0.000413940907
  error estimate for blocks of size 2^( 5) =       0.000417696714
  error estimate for blocks of size 2^( 6) =       0.000419429194
  error estimate for blocks of size 2^( 7) =       0.000420670682

      target function =                  N/A
              le_mean =     -17.216128038304
             les_mean =     296.708939454159
             stat err =       0.000417934374
             autocorr =       1.162304650713
              std dev =       0.548230385342
             le_variance =       0.300556555412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365296
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365296
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387657423
  error estimate for blocks of size 2^( 2) =       0.000397914336
  error estimate for blocks of size 2^( 3) =       0.000406870095
  error estimate for blocks of size 2^( 4) =       0.000413940907
  error estimate for blocks of size 2^( 5) =       0.000417696714
  error estimate for blocks of size 2^( 6) =       0.000419429194
  error estimate for blocks of size 2^( 7) =       0.000420670682

      target function =                  N/A
              le_mean =     -17.216128038304
             les_mean =     296.708939454156
             stat err =       0.000417934374
             autocorr =       1.162304650719
              std dev =       0.548230385341
             le_variance =       0.300556555411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365295
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300594365295
                                         uncertainty =       0.002306980693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387657423
  error estimate for blocks of size 2^( 2) =       0.000397914336
  error estimate for blocks of size 2^( 3) =       0.000406870095
  error estimate for blocks of size 2^( 4) =       0.000413940907
  error estimate for blocks of size 2^( 5) =       0.000417696714
  error estimate for blocks of size 2^( 6) =       0.000419429194
  error estimate for blocks of size 2^( 7) =       0.000420670682

      target function =                  N/A
              le_mean =     -17.216128038304
             les_mean =     296.708939454154
             stat err =       0.000417934374
             autocorr =       1.162304650712
              std dev =       0.548230385340
             le_variance =       0.300556555410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216128038304        initial
     6.1035e+07     6.1035e+08             1.8068e-11       -17.216128038304  <--
     2.4414e+08     2.4414e+09             4.5169e-12       -17.216128038304
     9.7656e+08     9.7656e+09             1.1293e-12       -17.216128038304

*****************************************************************************
Applying the update for shift_i =   6.1035e+07     and shift_s =   6.1035e+08
*****************************************************************************

  Execution time = 2.9765e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7050e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2415
    reference variance = 0.204919
====================================================
  Execution time = 2.0859e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1678e-01
  Total weights = 1.956457805e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301875805396
                                         uncertainty =       0.002188533168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301875805396
                                         uncertainty =       0.002188533168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388497424
  error estimate for blocks of size 2^( 2) =       0.000398512498
  error estimate for blocks of size 2^( 3) =       0.000407251541
  error estimate for blocks of size 2^( 4) =       0.000414283917
  error estimate for blocks of size 2^( 5) =       0.000419591587
  error estimate for blocks of size 2^( 6) =       0.000422769178
  error estimate for blocks of size 2^( 7) =       0.000423678950

      target function =                  N/A
              le_mean =     -17.216429845349
             les_mean =     296.722232620024
             stat err =       0.000420080908
             autocorr =       1.169202139321
              std dev =       0.549418325739
             le_variance =       0.301860496657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642984535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429845390       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429845390       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429845390       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429845390       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429824489       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429845396       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429834827       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216429845654       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216429847899       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216429837091       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+07 is 7.396103e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429845390       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429845390       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429845390       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429845390       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429843774       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429820314       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429901542       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216429856847       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216429884375       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216429893349       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+07 is 1.849017e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216429845390       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216429845390       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216429845390       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216429845390       residual = 8.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216429957555       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216429792774       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216429560969       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216429816037       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216429563615       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216430044398       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 2.4414e+08 is 4.622694e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7082e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2726
    reference variance = 0.210696
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0691e-01
  Total weights = 1.9567e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638338
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638338
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384552699
  error estimate for blocks of size 2^( 2) =       0.000394592428
  error estimate for blocks of size 2^( 3) =       0.000403066571
  error estimate for blocks of size 2^( 4) =       0.000409694619
  error estimate for blocks of size 2^( 5) =       0.000413929074
  error estimate for blocks of size 2^( 6) =       0.000415971674
  error estimate for blocks of size 2^( 7) =       0.000417885660

      target function =                  N/A
              le_mean =     -17.217296072467
             les_mean =     296.742195556907
             stat err =       0.000414370257
             autocorr =       1.161088760719
              std dev =       0.543839642231
             le_variance =       0.295761556462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638337
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638337
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384552699
  error estimate for blocks of size 2^( 2) =       0.000394592428
  error estimate for blocks of size 2^( 3) =       0.000403066571
  error estimate for blocks of size 2^( 4) =       0.000409694619
  error estimate for blocks of size 2^( 5) =       0.000413929074
  error estimate for blocks of size 2^( 6) =       0.000415971674
  error estimate for blocks of size 2^( 7) =       0.000417885660

      target function =                  N/A
              le_mean =     -17.217296072468
             les_mean =     296.742195556905
             stat err =       0.000414370257
             autocorr =       1.161088760721
              std dev =       0.543839642230
             le_variance =       0.295761556461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638337
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638337
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384552699
  error estimate for blocks of size 2^( 2) =       0.000394592428
  error estimate for blocks of size 2^( 3) =       0.000403066571
  error estimate for blocks of size 2^( 4) =       0.000409694619
  error estimate for blocks of size 2^( 5) =       0.000413929074
  error estimate for blocks of size 2^( 6) =       0.000415971674
  error estimate for blocks of size 2^( 7) =       0.000417885660

      target function =                  N/A
              le_mean =     -17.217296072467
             les_mean =     296.742195556906
             stat err =       0.000414370257
             autocorr =       1.161088760716
              std dev =       0.543839642230
             le_variance =       0.295761556461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638338
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295712638338
                                         uncertainty =       0.001693760044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384552699
  error estimate for blocks of size 2^( 2) =       0.000394592428
  error estimate for blocks of size 2^( 3) =       0.000403066571
  error estimate for blocks of size 2^( 4) =       0.000409694619
  error estimate for blocks of size 2^( 5) =       0.000413929074
  error estimate for blocks of size 2^( 6) =       0.000415971674
  error estimate for blocks of size 2^( 7) =       0.000417885660

      target function =                  N/A
              le_mean =     -17.217296072467
             les_mean =     296.742195556907
             stat err =       0.000414370257
             autocorr =       1.161088760715
              std dev =       0.543839642231
             le_variance =       0.295761556462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217296072467        initial
     1.5259e+07     1.5259e+08             7.3961e-11       -17.217296072468  <--
     6.1035e+07     6.1035e+08             1.8490e-11       -17.217296072467
     2.4414e+08     2.4414e+09             4.6227e-12       -17.217296072467

*****************************************************************************
Applying the update for shift_i =   1.5259e+07     and shift_s =   1.5259e+08
*****************************************************************************

  Execution time = 3.3667e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1499
    reference variance = 0.29796
====================================================
  Execution time = 2.0857e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1138e-01
  Total weights = 1.956177676e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295299237556
                                         uncertainty =       0.001877771184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295299237556
                                         uncertainty =       0.001877771184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384233999
  error estimate for blocks of size 2^( 2) =       0.000394492573
  error estimate for blocks of size 2^( 3) =       0.000404328502
  error estimate for blocks of size 2^( 4) =       0.000410904666
  error estimate for blocks of size 2^( 5) =       0.000415462374
  error estimate for blocks of size 2^( 6) =       0.000417730624
  error estimate for blocks of size 2^( 7) =       0.000420169451

      target function =                  N/A
              le_mean =     -17.215585147887
             les_mean =     296.687755337992
             stat err =       0.000416066779
             autocorr =       1.172558447481
              std dev =       0.543388932402
             le_variance =       0.295271531857


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721558514789e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215585147890       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215585147892       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215585147892       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215585147820       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215585147894       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215585147757       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215585147672       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215585148661       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215585144779       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215585145023       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215585150214       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+06 is 3.238695e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215585147890       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215585147891       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215585147891       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215585147853       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215585147891       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215585147891       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215585152599       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215585148883       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215585142571       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215585138997       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215585160499       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+07 is 8.096732e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215585147890       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215585147890       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215585147890       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215585147890       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215585147890       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215585150803       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215585163942       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215585174339       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215585077326       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215585135615       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215585037593       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+07 is 2.024230e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6993e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.198824
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0558e-01
  Total weights = 1.9568e+06
  Execution time = 1.8114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477424
                                         uncertainty =       0.001479818554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477424
                                         uncertainty =       0.001479818554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382848404
  error estimate for blocks of size 2^( 2) =       0.000393149387
  error estimate for blocks of size 2^( 3) =       0.000402472631
  error estimate for blocks of size 2^( 4) =       0.000409416380
  error estimate for blocks of size 2^( 5) =       0.000413496617
  error estimate for blocks of size 2^( 6) =       0.000415550479
  error estimate for blocks of size 2^( 7) =       0.000417112300

      target function =                  N/A
              le_mean =     -17.216443384096
             les_mean =     296.711501880171
             stat err =       0.000413893944
             autocorr =       1.168757639689
              std dev =       0.541429404927
             le_variance =       0.293145800520

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477375
                                         uncertainty =       0.001479818552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477375
                                         uncertainty =       0.001479818552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382848404
  error estimate for blocks of size 2^( 2) =       0.000393149387
  error estimate for blocks of size 2^( 3) =       0.000402472631
  error estimate for blocks of size 2^( 4) =       0.000409416380
  error estimate for blocks of size 2^( 5) =       0.000413496617
  error estimate for blocks of size 2^( 6) =       0.000415550479
  error estimate for blocks of size 2^( 7) =       0.000417112300

      target function =                  N/A
              le_mean =     -17.216443384096
             les_mean =     296.711501880222
             stat err =       0.000413893944
             autocorr =       1.168757639772
              std dev =       0.541429404882
             le_variance =       0.293145800471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477400
                                         uncertainty =       0.001479818553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477400
                                         uncertainty =       0.001479818553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382848404
  error estimate for blocks of size 2^( 2) =       0.000393149387
  error estimate for blocks of size 2^( 3) =       0.000402472631
  error estimate for blocks of size 2^( 4) =       0.000409416380
  error estimate for blocks of size 2^( 5) =       0.000413496617
  error estimate for blocks of size 2^( 6) =       0.000415550479
  error estimate for blocks of size 2^( 7) =       0.000417112300

      target function =                  N/A
              le_mean =     -17.216443384096
             les_mean =     296.711501880196
             stat err =       0.000413893944
             autocorr =       1.168757639736
              std dev =       0.541429404905
             le_variance =       0.293145800495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477421
                                         uncertainty =       0.001479818554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293181477421
                                         uncertainty =       0.001479818554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382848404
  error estimate for blocks of size 2^( 2) =       0.000393149387
  error estimate for blocks of size 2^( 3) =       0.000402472631
  error estimate for blocks of size 2^( 4) =       0.000409416380
  error estimate for blocks of size 2^( 5) =       0.000413496617
  error estimate for blocks of size 2^( 6) =       0.000415550479
  error estimate for blocks of size 2^( 7) =       0.000417112300

      target function =                  N/A
              le_mean =     -17.216443384096
             les_mean =     296.711501880174
             stat err =       0.000413893944
             autocorr =       1.168757639694
              std dev =       0.541429404924
             le_variance =       0.293145800516


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216443384096        initial  <--
     3.8147e+06     3.8147e+07             3.2387e-10       -17.216443384096
     1.5259e+07     1.5259e+08             8.0967e-11       -17.216443384096
     6.1035e+07     6.1035e+08             2.0242e-11       -17.216443384096

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4583
  </log>
  <optVariables href="H2O.s020.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.187002
====================================================
  Execution time = 2.0842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1188e-01
  Total weights = 1.956626614e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298085082042
                                         uncertainty =       0.001969680552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298085082042
                                         uncertainty =       0.001969680552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386093730
  error estimate for blocks of size 2^( 2) =       0.000395993505
  error estimate for blocks of size 2^( 3) =       0.000405275440
  error estimate for blocks of size 2^( 4) =       0.000411599803
  error estimate for blocks of size 2^( 5) =       0.000415641927
  error estimate for blocks of size 2^( 6) =       0.000417662751
  error estimate for blocks of size 2^( 7) =       0.000417841396

      target function =                  N/A
              le_mean =     -17.215772479171
             les_mean =     296.694699534128
             stat err =       0.000415686469
             autocorr =       1.159167719501
              std dev =       0.546018989336
             le_variance =       0.298136736716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721577247917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215772479211       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215772479211       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215772479211       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215772456538       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215772492490       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215772503238       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215772471498       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215772436296       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215772491449       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215772419757       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+07 is 2.862921e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215772479211       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215772479211       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215772479211       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215772479211       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215772481619       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215772469913       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215772484553       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215772260300       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215772389121       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215772354179       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+08 is 7.157587e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215772479211       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215772479211       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215772479211       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215772479211       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215772720500       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215772929183       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215772480859       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215772287080       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215772342210       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215772417211       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+08 is 1.789344e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277346 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6891e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2562
    reference variance = 0.189498
====================================================
  Execution time = 2.0376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1388e-01
  Total weights = 1.9564e+06
  Execution time = 1.8171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387827006
  error estimate for blocks of size 2^( 2) =       0.000397841707
  error estimate for blocks of size 2^( 3) =       0.000407039483
  error estimate for blocks of size 2^( 4) =       0.000413544117
  error estimate for blocks of size 2^( 5) =       0.000417905644
  error estimate for blocks of size 2^( 6) =       0.000419054468
  error estimate for blocks of size 2^( 7) =       0.000421397884

      target function =                  N/A
              le_mean =     -17.217137585221
             les_mean =     296.743709637656
             stat err =       0.000417975528
             autocorr =       1.161517123750
              std dev =       0.548470211233
             le_variance =       0.300819572610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387827006
  error estimate for blocks of size 2^( 2) =       0.000397841707
  error estimate for blocks of size 2^( 3) =       0.000407039483
  error estimate for blocks of size 2^( 4) =       0.000413544117
  error estimate for blocks of size 2^( 5) =       0.000417905644
  error estimate for blocks of size 2^( 6) =       0.000419054468
  error estimate for blocks of size 2^( 7) =       0.000421397884

      target function =                  N/A
              le_mean =     -17.217137585221
             les_mean =     296.743709637649
             stat err =       0.000417975528
             autocorr =       1.161517123745
              std dev =       0.548470211233
             le_variance =       0.300819572610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387827006
  error estimate for blocks of size 2^( 2) =       0.000397841707
  error estimate for blocks of size 2^( 3) =       0.000407039483
  error estimate for blocks of size 2^( 4) =       0.000413544117
  error estimate for blocks of size 2^( 5) =       0.000417905644
  error estimate for blocks of size 2^( 6) =       0.000419054468
  error estimate for blocks of size 2^( 7) =       0.000421397884

      target function =                  N/A
              le_mean =     -17.217137585221
             les_mean =     296.743709637653
             stat err =       0.000417975528
             autocorr =       1.161517123746
              std dev =       0.548470211233
             le_variance =       0.300819572610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300838346745
                                         uncertainty =       0.002509109198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387827006
  error estimate for blocks of size 2^( 2) =       0.000397841707
  error estimate for blocks of size 2^( 3) =       0.000407039483
  error estimate for blocks of size 2^( 4) =       0.000413544117
  error estimate for blocks of size 2^( 5) =       0.000417905644
  error estimate for blocks of size 2^( 6) =       0.000419054468
  error estimate for blocks of size 2^( 7) =       0.000421397884

      target function =                  N/A
              le_mean =     -17.217137585221
             les_mean =     296.743709637656
             stat err =       0.000417975528
             autocorr =       1.161517123749
              std dev =       0.548470211233
             le_variance =       0.300819572610


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217137585221        initial  <--
     3.8147e+07     3.8147e+08             2.8629e-11       -17.217137585221
     1.5259e+08     1.5259e+09             7.1576e-12       -17.217137585221
     6.1035e+08     6.1035e+09             1.7893e-12       -17.217137585221

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5807
  </log>
  <optVariables href="H2O.s021.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1683
    reference variance = 0.246565
====================================================
  Execution time = 2.0541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1287e-01
  Total weights = 1.956349189e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299900962334
                                         uncertainty =       0.002143200420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299900962334
                                         uncertainty =       0.002143200420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387191604
  error estimate for blocks of size 2^( 2) =       0.000397281932
  error estimate for blocks of size 2^( 3) =       0.000406297879
  error estimate for blocks of size 2^( 4) =       0.000412863177
  error estimate for blocks of size 2^( 5) =       0.000416524692
  error estimate for blocks of size 2^( 6) =       0.000419459543
  error estimate for blocks of size 2^( 7) =       0.000419942632

      target function =                  N/A
              le_mean =     -17.216551596962
             les_mean =     296.722516447894
             stat err =       0.000417197511
             autocorr =       1.160998221739
              std dev =       0.547571617660
             le_variance =       0.299834676467


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655159696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551596999       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551596999       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551596999       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216551596999       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216551409998       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216551594467       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216551710843       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216551436743       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216551274047       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216551816385       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+08 is 2.994388e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551596999       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551596999       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551596999       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216551462978       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216550305099       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216553298531       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216551072398       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216552072957       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216550178979       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216552118947       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+09 is 7.484746e-13

solving harmonic davidson linear method for identity shift 6.1035e+09, overlap shift 6.1035e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216551596999       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216551596999       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216551596999       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216552089513       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216549471589       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554019886       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216552325438       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216552251523       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216546370412       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216548554287       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+09 is 1.871204e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281270 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6701e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.153695
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1308e-01
  Total weights = 1.9565e+06
  Execution time = 1.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665433
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665433
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387087562
  error estimate for blocks of size 2^( 2) =       0.000397085373
  error estimate for blocks of size 2^( 3) =       0.000406057018
  error estimate for blocks of size 2^( 4) =       0.000412946342
  error estimate for blocks of size 2^( 5) =       0.000416829040
  error estimate for blocks of size 2^( 6) =       0.000418142861
  error estimate for blocks of size 2^( 7) =       0.000419758996

      target function =                  N/A
              le_mean =     -17.216678089082
             les_mean =     296.727088438940
             stat err =       0.000416919310
             autocorr =       1.160073713065
              std dev =       0.547424480535
             le_variance =       0.299673561889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665434
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665434
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387087562
  error estimate for blocks of size 2^( 2) =       0.000397085373
  error estimate for blocks of size 2^( 3) =       0.000406057018
  error estimate for blocks of size 2^( 4) =       0.000412946342
  error estimate for blocks of size 2^( 5) =       0.000416829040
  error estimate for blocks of size 2^( 6) =       0.000418142861
  error estimate for blocks of size 2^( 7) =       0.000419758996

      target function =                  N/A
              le_mean =     -17.216678089082
             les_mean =     296.727088438941
             stat err =       0.000416919310
             autocorr =       1.160073713063
              std dev =       0.547424480535
             le_variance =       0.299673561889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665434
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665434
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387087562
  error estimate for blocks of size 2^( 2) =       0.000397085373
  error estimate for blocks of size 2^( 3) =       0.000406057018
  error estimate for blocks of size 2^( 4) =       0.000412946342
  error estimate for blocks of size 2^( 5) =       0.000416829040
  error estimate for blocks of size 2^( 6) =       0.000418142861
  error estimate for blocks of size 2^( 7) =       0.000419758996

      target function =                  N/A
              le_mean =     -17.216678089082
             les_mean =     296.727088438940
             stat err =       0.000416919310
             autocorr =       1.160073713063
              std dev =       0.547424480535
             le_variance =       0.299673561889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665433
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299708665433
                                         uncertainty =       0.001956835864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387087562
  error estimate for blocks of size 2^( 2) =       0.000397085373
  error estimate for blocks of size 2^( 3) =       0.000406057018
  error estimate for blocks of size 2^( 4) =       0.000412946342
  error estimate for blocks of size 2^( 5) =       0.000416829040
  error estimate for blocks of size 2^( 6) =       0.000418142861
  error estimate for blocks of size 2^( 7) =       0.000419758996

      target function =                  N/A
              le_mean =     -17.216678089082
             les_mean =     296.727088438940
             stat err =       0.000416919310
             autocorr =       1.160073713065
              std dev =       0.547424480535
             le_variance =       0.299673561889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216678089082        initial  <--
     3.8147e+08     3.8147e+09             2.9944e-12       -17.216678089082
     1.5259e+09     1.5259e+10             7.4847e-13       -17.216678089082
     6.1035e+09     6.1035e+10             1.8712e-13       -17.216678089082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6493
  </log>
  <optVariables href="H2O.s022.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.197
    reference variance = 0.153125
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1507e-01
  Total weights = 1.956520261e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300775112617
                                         uncertainty =       0.001918710152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300775112617
                                         uncertainty =       0.001918710152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387749340
  error estimate for blocks of size 2^( 2) =       0.000397853741
  error estimate for blocks of size 2^( 3) =       0.000406659472
  error estimate for blocks of size 2^( 4) =       0.000413189210
  error estimate for blocks of size 2^( 5) =       0.000416936922
  error estimate for blocks of size 2^( 6) =       0.000419186522
  error estimate for blocks of size 2^( 7) =       0.000421307523

      target function =                  N/A
              le_mean =     -17.215687095213
             les_mean =     296.694947835981
             stat err =       0.000417655044
             autocorr =       1.160201247392
              std dev =       0.548360374876
             le_variance =       0.300699100734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721568709521e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687095232       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687095232       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687095232       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215687095232       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215687095232       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215687182305       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215686731705       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215686478371       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215690559306       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215690161762       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+09 is 2.761605e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687095232       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687095232       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687095232       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215687095232       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215657669808       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215605592928       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215691087085       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215735634771       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215730511660       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215734010618       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215592400331       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215725738711       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215692402167       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215545869247       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215701751591       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215731883295       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215695974103       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215707395310       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215822042925       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215808052614       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215473519982       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215559703301       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216644708008       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215334889841       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215445903264       residual = 9.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216015972282       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.215896898680       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217308799314       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.215657774914       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.215194214879       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.216198170715       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.217279802829       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.214681422004       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.214738987847       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.213943947879       residual = 4.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.214592836219       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.214299782791       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.215523154183       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.211239646614       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.223021268680       residual = 8.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.218098613788       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.212715604354       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.228717801026       residual = 2.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.214351892611       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.214031389154       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.214397875022       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.213008991871       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.224238730290       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.224339304880       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.218625710776       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.216382156907       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.213690783808       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.206778313438       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.206619034460       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.219274396492       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.220542000902       residual = 4.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.221551473246       residual = 7.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.214311087699       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.212850708238       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.206798237357       residual = 1.20e-02           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.208611071854       residual = 7.79e-03           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.216109172166       residual = 1.04e-03           smallest_sin_value = 9.98e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.204109318494       residual = 2.13e-02           smallest_sin_value = 9.96e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.212224049188       residual = 2.83e-03           smallest_sin_value = 9.95e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+10 is 7.037769e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215687095232       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215687095232       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215687095232       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215696964298       residual = 6.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215683202239       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215693823085       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215706930020       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215701415405       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215747538547       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215664281294       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215883406031       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216136660395       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216324856805       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216222927151       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214874768405       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216723732849       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215574540934       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216229476302       residual = 4.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215703900778       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214529849909       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215581329415       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213522233280       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.219180735825       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215930219510       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.217129220514       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.212783574578       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.218879376759       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215138223135       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.214848444242       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.212835720159       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.216443480192       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.214062762131       residual = 4.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.218347812215       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.220637448712       residual = 3.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.213356409009       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.224229100945       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.218587919877       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.224413334168       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.221488992783       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.206716229688       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.218390514666       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.213631037625       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.210319430337       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.211764020154       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.220045838755       residual = 4.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.226641564471       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.206570743943       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.215529094983       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.206516777855       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.221484301182       residual = 5.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.263368072251       residual = 3.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.190053369904       residual = 1.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.301089824660       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.271088739592       residual = 4.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.165000503683       residual = 4.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.180758249453       residual = 1.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.100547437280       residual = 2.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.328497034094       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.233162372528       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.211952122323       residual = 7.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -17.262553940415       residual = 3.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -17.216265894660       residual = 2.44e-03           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.234331370107       residual = 8.09e-02           smallest_sin_value = 9.93e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.249067300762       residual = 1.84e-01           smallest_sin_value = 9.93e-01
davidson iteration   64:   krylov dim =  65   energy =     -17.218835437330       residual = 7.07e-03           smallest_sin_value = 9.92e-01
davidson iteration   65 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         65 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+10 is 1.690781e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.511789 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7103e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.398348
====================================================
  Execution time = 2.0528e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1236e-01
  Total weights = 1.9563e+06
  Execution time = 1.8116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387102207
  error estimate for blocks of size 2^( 2) =       0.000396931107
  error estimate for blocks of size 2^( 3) =       0.000405825030
  error estimate for blocks of size 2^( 4) =       0.000412018644
  error estimate for blocks of size 2^( 5) =       0.000416032910
  error estimate for blocks of size 2^( 6) =       0.000417287490
  error estimate for blocks of size 2^( 7) =       0.000417711189

      target function =                  N/A
              le_mean =     -17.216119783194
             les_mean =     296.707141364851
             stat err =       0.000415762558
             autocorr =       1.153558060934
              std dev =       0.547445190711
             le_variance =       0.299696236833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387102207
  error estimate for blocks of size 2^( 2) =       0.000396931107
  error estimate for blocks of size 2^( 3) =       0.000405825030
  error estimate for blocks of size 2^( 4) =       0.000412018644
  error estimate for blocks of size 2^( 5) =       0.000416032910
  error estimate for blocks of size 2^( 6) =       0.000417287490
  error estimate for blocks of size 2^( 7) =       0.000417711189

      target function =                  N/A
              le_mean =     -17.216119783194
             les_mean =     296.707141364850
             stat err =       0.000415762558
             autocorr =       1.153558060944
              std dev =       0.547445190711
             le_variance =       0.299696236833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387102207
  error estimate for blocks of size 2^( 2) =       0.000396931107
  error estimate for blocks of size 2^( 3) =       0.000405825030
  error estimate for blocks of size 2^( 4) =       0.000412018644
  error estimate for blocks of size 2^( 5) =       0.000416032910
  error estimate for blocks of size 2^( 6) =       0.000417287490
  error estimate for blocks of size 2^( 7) =       0.000417711189

      target function =                  N/A
              le_mean =     -17.216119783194
             les_mean =     296.707141364850
             stat err =       0.000415762558
             autocorr =       1.153558060931
              std dev =       0.547445190711
             le_variance =       0.299696236833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299701653124
                                         uncertainty =       0.002368461036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387102207
  error estimate for blocks of size 2^( 2) =       0.000396931107
  error estimate for blocks of size 2^( 3) =       0.000405825030
  error estimate for blocks of size 2^( 4) =       0.000412018644
  error estimate for blocks of size 2^( 5) =       0.000416032910
  error estimate for blocks of size 2^( 6) =       0.000417287490
  error estimate for blocks of size 2^( 7) =       0.000417711189

      target function =                  N/A
              le_mean =     -17.216119783194
             les_mean =     296.707141364850
             stat err =       0.000415762558
             autocorr =       1.153558060934
              std dev =       0.547445190711
             le_variance =       0.299696236833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216119783194        initial
     3.8147e+09     3.8147e+10             2.7616e-13       -17.216119783194
     1.5259e+10     1.5259e+11             7.0378e-14       -17.216119783194  <--
     6.1035e+10     6.1035e+11             1.6908e-14       -17.216119783194

*****************************************************************************
Applying the update for shift_i =   1.5259e+10     and shift_s =   1.5259e+11
*****************************************************************************

  Execution time = 2.9686e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.3236
    reference variance = 0.595279
====================================================
  Execution time = 2.0439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1004e-01
  Total weights = 1.956325662e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297306700820
                                         uncertainty =       0.002051467502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297306700820
                                         uncertainty =       0.002051467502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385576097
  error estimate for blocks of size 2^( 2) =       0.000395392218
  error estimate for blocks of size 2^( 3) =       0.000404629528
  error estimate for blocks of size 2^( 4) =       0.000411740105
  error estimate for blocks of size 2^( 5) =       0.000416974155
  error estimate for blocks of size 2^( 6) =       0.000418764890
  error estimate for blocks of size 2^( 7) =       0.000419763047

      target function =                  N/A
              le_mean =     -17.216414921958
             les_mean =     296.714981872324
             stat err =       0.000416810549
             autocorr =       1.168576635420
              std dev =       0.545286945388
             le_variance =       0.297337852811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641492196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414921982       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414921982       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414921982       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414921982       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216409279687       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216417494090       residual = 9.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216414649646       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216416921274       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216412052107       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216412721159       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+09 is 2.513842e-13

solving harmonic davidson linear method for identity shift 1.5259e+10, overlap shift 1.5259e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414921982       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414921982       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414921982       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216420922500       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216417401134       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216404596176       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216415354379       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216414739507       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216415446282       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216403325349       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216411616489       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+10 is 6.268415e-14

solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216414921982       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414921982       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414921982       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216414921982       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216422798997       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216379936073       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216410056859       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216431595257       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216370893893       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216368021022       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216398360134       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216603464939       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215416561575       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217309660481       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215672855949       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216444559162       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216193615064       residual = 8.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215960497045       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214966508230       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217493598884       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215721914662       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.217015288010       residual = 7.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.216602818268       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.213344243221       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.221447928022       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.218162955998       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216583693586       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.217554045162       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.215972929065       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.221699465152       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.218922256343       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.213427589022       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.217021610366       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.216933425143       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.214623292021       residual = 5.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.215877560950       residual = 7.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.220146498066       residual = 2.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.214649702470       residual = 5.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.199061008499       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.214959527228       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.233832926843       residual = 4.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.217856427084       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.211970904668       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.227184317315       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.207442189778       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.217001132665       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.195283451937       residual = 6.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.231326666625       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.219664203087       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.200635062685       residual = 4.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.202741670287       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.219252378143       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.227102092062       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.207686676709       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.210542492236       residual = 8.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.171197562696       residual = 3.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.256737223333       residual = 2.69e-01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -17.210971583435       residual = 8.87e-03           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.209519864295       residual = 9.27e-03           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.280190031226       residual = 6.23e-01           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.112618482504       residual = 1.63e+00           smallest_sin_value = 9.96e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.969032105838       residual = 9.12e+00           smallest_sin_value = 9.96e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.143766273047       residual = 8.41e-01           smallest_sin_value = 9.96e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.440149215463       residual = 7.72e+00           smallest_sin_value = 9.96e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+10 is 1.504630e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.617847 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6634e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.189023
====================================================
  Execution time = 2.0489e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1248e-01
  Total weights = 1.9565e+06
  Execution time = 1.8081e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386475325
  error estimate for blocks of size 2^( 2) =       0.000396539765
  error estimate for blocks of size 2^( 3) =       0.000405449170
  error estimate for blocks of size 2^( 4) =       0.000413036271
  error estimate for blocks of size 2^( 5) =       0.000417111312
  error estimate for blocks of size 2^( 6) =       0.000418243311
  error estimate for blocks of size 2^( 7) =       0.000419522937

      target function =                  N/A
              le_mean =     -17.216223197578
             les_mean =     296.710821591640
             stat err =       0.000416978458
             autocorr =       1.164082322804
              std dev =       0.546558646693
             le_variance =       0.298726354275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386475325
  error estimate for blocks of size 2^( 2) =       0.000396539765
  error estimate for blocks of size 2^( 3) =       0.000405449170
  error estimate for blocks of size 2^( 4) =       0.000413036271
  error estimate for blocks of size 2^( 5) =       0.000417111312
  error estimate for blocks of size 2^( 6) =       0.000418243311
  error estimate for blocks of size 2^( 7) =       0.000419522937

      target function =                  N/A
              le_mean =     -17.216223197578
             les_mean =     296.710821591639
             stat err =       0.000416978458
             autocorr =       1.164082322803
              std dev =       0.546558646693
             le_variance =       0.298726354275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386475325
  error estimate for blocks of size 2^( 2) =       0.000396539765
  error estimate for blocks of size 2^( 3) =       0.000405449170
  error estimate for blocks of size 2^( 4) =       0.000413036271
  error estimate for blocks of size 2^( 5) =       0.000417111312
  error estimate for blocks of size 2^( 6) =       0.000418243311
  error estimate for blocks of size 2^( 7) =       0.000419522937

      target function =                  N/A
              le_mean =     -17.216223197578
             les_mean =     296.710821591639
             stat err =       0.000416978458
             autocorr =       1.164082322797
              std dev =       0.546558646693
             le_variance =       0.298726354275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298736086142
                                         uncertainty =       0.002135199240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386475325
  error estimate for blocks of size 2^( 2) =       0.000396539765
  error estimate for blocks of size 2^( 3) =       0.000405449170
  error estimate for blocks of size 2^( 4) =       0.000413036271
  error estimate for blocks of size 2^( 5) =       0.000417111312
  error estimate for blocks of size 2^( 6) =       0.000418243311
  error estimate for blocks of size 2^( 7) =       0.000419522937

      target function =                  N/A
              le_mean =     -17.216223197578
             les_mean =     296.710821591640
             stat err =       0.000416978458
             autocorr =       1.164082322809
              std dev =       0.546558646693
             le_variance =       0.298726354275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216223197578        initial  <--
     3.8147e+09     3.8147e+10             2.5138e-13       -17.216223197578
     1.5259e+10     1.5259e+11             6.2684e-14       -17.216223197578
     6.1035e+10     6.1035e+11             1.5046e-14       -17.216223197578

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6307
  </log>
  <optVariables href="H2O.s024.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.295
    reference variance = 1.03616
====================================================
  Execution time = 2.2707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1453e-01
  Total weights = 1.956803790e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297726216675
                                         uncertainty =       0.001852077103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297726216675
                                         uncertainty =       0.001852077103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385819145
  error estimate for blocks of size 2^( 2) =       0.000395742272
  error estimate for blocks of size 2^( 3) =       0.000404852295
  error estimate for blocks of size 2^( 4) =       0.000411999217
  error estimate for blocks of size 2^( 5) =       0.000417248881
  error estimate for blocks of size 2^( 6) =       0.000419411703
  error estimate for blocks of size 2^( 7) =       0.000417705040

      target function =                  N/A
              le_mean =     -17.216802025175
             les_mean =     296.732804041885
             stat err =       0.000416591210
             autocorr =       1.165876787692
              std dev =       0.545630667566
             le_variance =       0.297712825389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680202518e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802025202       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216802025202       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216802025202       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216812023696       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216760582240       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216801676064       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216788423635       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216825984879       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216795156281       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216809188981       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216827222965       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216826198124       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216772723315       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216673955251       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216902102440       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216661606788       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216744100744       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217606560121       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216595724553       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216668434644       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.218241359024       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.216322053339       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217521642577       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216183597453       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.216006170395       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.216107917721       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216075788889       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.215060203734       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.216512180115       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.216564357919       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.213989687343       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.212261356233       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.212148029842       residual = 3.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.219904613771       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.219351957834       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.210710338229       residual = 5.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.197056612991       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.213158433295       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.222117823011       residual = 3.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.219797794994       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.220847045985       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.201129422455       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.216867174480       residual = 7.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.220907237861       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.224718475341       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.210761680895       residual = 9.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.199137099640       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.210425394097       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.212899223524       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.214799154342       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.220070526109       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.199926146177       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.225879016616       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.223162497194       residual = 6.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.230094059942       residual = 4.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.203550548781       residual = 4.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.257809010878       residual = 2.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.259154621592       residual = 2.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.216071194248       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -17.211360798231       residual = 1.91e-02           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.185313743821       residual = 2.12e-01           smallest_sin_value = 9.95e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.239715019297       residual = 6.98e-02           smallest_sin_value = 9.92e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+10 is 2.925061e-14

solving harmonic davidson linear method for identity shift 1.5259e+11, overlap shift 1.5259e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802025202       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216802025202       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216802025202       residual = 5.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216802025202       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216802025202       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216821321551       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216773017240       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216219736038       residual = 5.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217090189915       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216568801608       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217567797948       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216143393356       residual = 9.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217817982920       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216269729482       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216967259854       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.221810212224       residual = 3.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215379822213       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.212746090366       residual = 2.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216435674890       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.214533459778       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217952485644       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212944895443       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214809699655       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216668285800       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.215688952932       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.214499894037       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.216025583255       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.221049434452       residual = 3.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.211946043403       residual = 5.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.230576883057       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.234184362168       residual = 4.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.215883028691       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.222251075901       residual = 6.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.196953183535       residual = 6.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.239256967730       residual = 7.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.248012728795       residual = 1.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.272314671293       residual = 4.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.240975966548       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.270578615933       residual = 4.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.231803181388       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.217234684509       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.216118479173       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.204290978316       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.275703275424       residual = 5.71e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.255246884006       residual = 2.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.247761605630       residual = 1.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.160861097625       residual = 6.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.165133085539       residual = 4.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.223456589220       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.179178653091       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.244092536287       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.244665270972       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.213802808718       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.231541085572       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.213576644258       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.203866129818       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.314272158489       residual = 1.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.630855748597       residual = 2.74e+01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.495192322142       residual = 1.17e+01           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.765154587109       residual = 3.27e+01           smallest_sin_value = 9.98e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.336396649145       residual = 1.19e+02           smallest_sin_value = 9.98e-01
davidson iteration   61:   krylov dim =  62   energy =     -17.242236558012       residual = 4.41e-01           smallest_sin_value = 9.95e-01
davidson iteration   62 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         62 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+11 is 6.534444e-15

solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216802025202       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216802025202       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216802025202       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216802025202       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216802025202       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216802025202       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216950640276       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215933628119       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216059713609       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216181987095       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216175282625       residual = 8.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216648709397       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.207633734681       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.203829395533       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.205424916829       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.223349978935       residual = 7.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.236321411182       residual = 5.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211164534187       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.205759338533       residual = 2.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200160389496       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215636264226       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.238098146914       residual = 7.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.229561231660       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.220188896371       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.224810759973       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.222667890509       residual = 5.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.226048624788       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.241379786157       residual = 8.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.182085102819       residual = 1.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.155438538723       residual = 5.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.204704515967       residual = 2.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.163577906493       residual = 4.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.176232113501       residual = 2.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.090995879308       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.191694480158       residual = 8.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.055380091425       residual = 4.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.173900429186       residual = 3.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.271637502102       residual = 4.58e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.271932613795       residual = 5.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.192207148027       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.310491984331       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.320618048511       residual = 1.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.223970091840       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.243542674638       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.237105331503       residual = 2.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.167265352843       residual = 4.69e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.198653440220       residual = 9.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.269240071400       residual = 4.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.182487806494       residual = 2.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.061579906676       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.875989223018       residual = 1.83e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.328641003528       residual = 1.87e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.413722258439       residual = 6.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.098676357116       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.655882949752       residual = 4.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.559758789296       residual = 7.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.969800218587       residual = 9.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -15.699058556512       residual = 3.63e+02           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -18.031372593284       residual = 1.08e+02           smallest_sin_value = 9.99e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.542574983596       residual = 1.79e+01           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.824103701799       residual = 6.59e+01           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -18.043849364726       residual = 1.05e+02           smallest_sin_value = 9.98e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.390424953294       residual = 4.56e+00           smallest_sin_value = 9.92e-01
davidson iteration   63:   krylov dim =  64   energy =     -18.393257517469       residual = 2.27e+02           smallest_sin_value = 9.90e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.47e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+11 is 1.676984e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.913607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9121e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0735
    reference variance = 0.279298
====================================================
  Execution time = 2.0516e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1427e-01
  Total weights = 1.9561e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386978926
  error estimate for blocks of size 2^( 2) =       0.000397122179
  error estimate for blocks of size 2^( 3) =       0.000405830247
  error estimate for blocks of size 2^( 4) =       0.000413093101
  error estimate for blocks of size 2^( 5) =       0.000416565781
  error estimate for blocks of size 2^( 6) =       0.000419377746
  error estimate for blocks of size 2^( 7) =       0.000422076803

      target function =                  N/A
              le_mean =     -17.217045719477
             les_mean =     296.740936450563
             stat err =       0.000417778358
             autocorr =       1.165513334964
              std dev =       0.547270845665
             le_variance =       0.299505378515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386978926
  error estimate for blocks of size 2^( 2) =       0.000397122179
  error estimate for blocks of size 2^( 3) =       0.000405830247
  error estimate for blocks of size 2^( 4) =       0.000413093101
  error estimate for blocks of size 2^( 5) =       0.000416565781
  error estimate for blocks of size 2^( 6) =       0.000419377746
  error estimate for blocks of size 2^( 7) =       0.000422076803

      target function =                  N/A
              le_mean =     -17.217045719477
             les_mean =     296.740936450563
             stat err =       0.000417778358
             autocorr =       1.165513334964
              std dev =       0.547270845665
             le_variance =       0.299505378515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386978926
  error estimate for blocks of size 2^( 2) =       0.000397122179
  error estimate for blocks of size 2^( 3) =       0.000405830247
  error estimate for blocks of size 2^( 4) =       0.000413093101
  error estimate for blocks of size 2^( 5) =       0.000416565781
  error estimate for blocks of size 2^( 6) =       0.000419377746
  error estimate for blocks of size 2^( 7) =       0.000422076803

      target function =                  N/A
              le_mean =     -17.217045719477
             les_mean =     296.740936450563
             stat err =       0.000417778358
             autocorr =       1.165513334967
              std dev =       0.547270845665
             le_variance =       0.299505378515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299555034209
                                         uncertainty =       0.002082345046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386978926
  error estimate for blocks of size 2^( 2) =       0.000397122179
  error estimate for blocks of size 2^( 3) =       0.000405830247
  error estimate for blocks of size 2^( 4) =       0.000413093101
  error estimate for blocks of size 2^( 5) =       0.000416565781
  error estimate for blocks of size 2^( 6) =       0.000419377746
  error estimate for blocks of size 2^( 7) =       0.000422076803

      target function =                  N/A
              le_mean =     -17.217045719477
             les_mean =     296.740936450563
             stat err =       0.000417778358
             autocorr =       1.165513334966
              std dev =       0.547270845665
             le_variance =       0.299505378515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217045719477        initial  <--
     3.8147e+10     3.8147e+11             2.9251e-14       -17.217045719477
     1.5259e+11     1.5259e+12             6.5344e-15       -17.217045719477
     6.1035e+11     6.1035e+12             1.6770e-15       -17.217045719477

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8119
  </log>
  <optVariables href="H2O.s025.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2366
    reference variance = 0.170874
====================================================
  Execution time = 2.0830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1210e-01
  Total weights = 1.956586236e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298380536194
                                         uncertainty =       0.001938564087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298380536194
                                         uncertainty =       0.001938564087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386183831
  error estimate for blocks of size 2^( 2) =       0.000396320651
  error estimate for blocks of size 2^( 3) =       0.000405053945
  error estimate for blocks of size 2^( 4) =       0.000412420622
  error estimate for blocks of size 2^( 5) =       0.000416370622
  error estimate for blocks of size 2^( 6) =       0.000419019129
  error estimate for blocks of size 2^( 7) =       0.000420540915

      target function =                  N/A
              le_mean =     -17.216176934552
             les_mean =     296.708852721693
             stat err =       0.000417087822
             autocorr =       1.166451934572
              std dev =       0.546146410775
             le_variance =       0.298275902002


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617693455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+11, overlap shift 3.8147e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216176934599       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216176934599       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216176934599       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216176934599       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216424780632       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216273025875       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215571045458       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215893631463       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216508216804       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215926106178       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216043112859       residual = 6.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214538437995       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214661440074       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.218921590924       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214566244750       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.214946753313       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216169349160       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.213500500313       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.214165889496       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217023394737       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.210098065339       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.213454851586       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.217663747390       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.215579539954       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.223636674257       residual = 8.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.218435806559       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.199915966680       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.210056212309       residual = 5.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.232174581318       residual = 4.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.250169696334       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.217416195714       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.217652590065       residual = 6.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.215501588383       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.221866090328       residual = 5.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.199923287847       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.218683060337       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.180996505739       residual = 1.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.217107095348       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.223325498157       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.217996868534       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.213696349587       residual = 3.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.152337879854       residual = 6.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.173485891059       residual = 2.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.226593902140       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.245335290874       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.158807803145       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.262037536515       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.314895377683       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.167868675659       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.343560651623       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.311424010357       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -17.225002282139       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.201993456632       residual = 9.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.195810905772       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.074029407597       residual = 3.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -17.202329770850       residual = 5.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -17.262178712524       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.169414527471       residual = 3.96e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -17.167379475591       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.866752997858       residual = 1.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -17.261897835798       residual = 5.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -17.079030763888       residual = 3.26e+00           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.226686094772       residual = 8.45e-02           smallest_sin_value = 9.97e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.257991298543       residual = 4.28e-01           smallest_sin_value = 9.97e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+11 is 2.593942e-15

solving harmonic davidson linear method for identity shift 1.5259e+12, overlap shift 1.5259e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216176934599       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216176934599       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216176934599       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216176934599       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216171599039       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216831422265       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217452409236       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.212657539940       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215485975875       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210017450864       residual = 5.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.199603208131       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.185387200704       residual = 1.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.206603127405       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.189744775928       residual = 1.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216652789989       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.266552754488       residual = 3.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.196609761786       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.222442143919       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.229123126391       residual = 2.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.282384322147       residual = 6.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.389206275107       residual = 4.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.106229283217       residual = 1.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.076226086050       residual = 3.05e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.165818948547       residual = 3.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.144087048171       residual = 7.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.215435951171       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.220020730389       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.241482971494       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.183119619317       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.127544820041       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.699715820507       residual = 4.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.755599712059       residual = 3.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.692349086369       residual = 3.84e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.240340213701       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.167587092089       residual = 6.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.019281918732       residual = 7.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.257203977776       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.230378067709       residual = 4.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.301654481954       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.142827327981       residual = 7.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.299535782039       residual = 1.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.415680341043       residual = 5.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.232603794361       residual = 2.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.785212156102       residual = 2.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.190796710118       residual = 6.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.984051438061       residual = 8.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.149043052628       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.508556276792       residual = 1.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.491565851702       residual = 1.10e+01           smallest_sin_value = 9.99e-01
davidson iteration   49:   krylov dim =  50   energy =     -17.142829800462       residual = 2.87e+00           smallest_sin_value = 9.99e-01
davidson iteration   50:   krylov dim =  51   energy =     -17.459797776363       residual = 1.02e+01           smallest_sin_value = 9.98e-01
davidson iteration   51:   krylov dim =  52   energy =     -17.706208411503       residual = 3.37e+01           smallest_sin_value = 9.98e-01
davidson iteration   52:   krylov dim =  53   energy =     -15.704919000404       residual = 3.70e+02           smallest_sin_value = 9.98e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.389783144415       residual = 4.26e+00           smallest_sin_value = 9.91e-01
davidson iteration   54 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         54 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+12 is 2.751286e-16

solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216176934599       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216176934599       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.083835 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7025e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.259
    reference variance = 0.250823
====================================================
  Execution time = 2.0578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1044e-01
  Total weights = 1.9565e+06
  Execution time = 1.8155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385409356
  error estimate for blocks of size 2^( 2) =       0.000395395476
  error estimate for blocks of size 2^( 3) =       0.000404347371
  error estimate for blocks of size 2^( 4) =       0.000409760245
  error estimate for blocks of size 2^( 5) =       0.000413438325
  error estimate for blocks of size 2^( 6) =       0.000417312474
  error estimate for blocks of size 2^( 7) =       0.000417523013

      target function =                  N/A
              le_mean =     -17.216318970205
             les_mean =     296.712075003584
             stat err =       0.000414508514
             autocorr =       1.156704446970
              std dev =       0.545051138435
             le_variance =       0.297080743509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385409356
  error estimate for blocks of size 2^( 2) =       0.000395395476
  error estimate for blocks of size 2^( 3) =       0.000404347371
  error estimate for blocks of size 2^( 4) =       0.000409760245
  error estimate for blocks of size 2^( 5) =       0.000413438325
  error estimate for blocks of size 2^( 6) =       0.000417312474
  error estimate for blocks of size 2^( 7) =       0.000417523013

      target function =                  N/A
              le_mean =     -17.216318970205
             les_mean =     296.712075003584
             stat err =       0.000414508514
             autocorr =       1.156704446966
              std dev =       0.545051138435
             le_variance =       0.297080743509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385409356
  error estimate for blocks of size 2^( 2) =       0.000395395476
  error estimate for blocks of size 2^( 3) =       0.000404347371
  error estimate for blocks of size 2^( 4) =       0.000409760245
  error estimate for blocks of size 2^( 5) =       0.000413438325
  error estimate for blocks of size 2^( 6) =       0.000417312474
  error estimate for blocks of size 2^( 7) =       0.000417523013

      target function =                  N/A
              le_mean =     -17.216318970205
             les_mean =     296.712075003584
             stat err =       0.000414508514
             autocorr =       1.156704446969
              std dev =       0.545051138435
             le_variance =       0.297080743509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297064141467
                                         uncertainty =       0.001721511816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385409356
  error estimate for blocks of size 2^( 2) =       0.000395395476
  error estimate for blocks of size 2^( 3) =       0.000404347371
  error estimate for blocks of size 2^( 4) =       0.000409760245
  error estimate for blocks of size 2^( 5) =       0.000413438325
  error estimate for blocks of size 2^( 6) =       0.000417312474
  error estimate for blocks of size 2^( 7) =       0.000417523013

      target function =                  N/A
              le_mean =     -17.216318970205
             les_mean =     296.712075003584
             stat err =       0.000414508514
             autocorr =       1.156704446970
              std dev =       0.545051138435
             le_variance =       0.297080743509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216318970205        initial  <--
     3.8147e+11     3.8147e+12             2.5939e-15       -17.216318970205
     1.5259e+12     1.5259e+13             2.7513e-16       -17.216318970205
     6.1035e+12     6.1035e+13             0.0000e+00       -17.216318970205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7509
  </log>
  <optVariables href="H2O.s026.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6782e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.166605
====================================================
  Execution time = 2.0891e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1427e-01
  Total weights = 1.956484457e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299559121279
                                         uncertainty =       0.001994830631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299559121279
                                         uncertainty =       0.001994830631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386991739
  error estimate for blocks of size 2^( 2) =       0.000397150581
  error estimate for blocks of size 2^( 3) =       0.000406570535
  error estimate for blocks of size 2^( 4) =       0.000412636971
  error estimate for blocks of size 2^( 5) =       0.000417026644
  error estimate for blocks of size 2^( 6) =       0.000419195244
  error estimate for blocks of size 2^( 7) =       0.000420358806

      target function =                  N/A
              le_mean =     -17.216178639809
             les_mean =     296.711072901995
             stat err =       0.000417304416
             autocorr =       1.162793437358
              std dev =       0.547288966410
             le_variance =       0.299525212754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721617863981e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216178639807       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216178639807       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216178639807       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215905419852       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215439944754       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216642828324       residual = 7.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213933514907       residual = 8.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.232307934628       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.198161099598       residual = 5.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.218755034171       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.233215996049       residual = 4.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.125103841280       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.242472135391       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.284872192328       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.160429659988       residual = 4.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.309783085827       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.207104037366       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.550828883872       residual = 1.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.089730423157       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.396009575666       residual = 4.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.235899360539       residual = 6.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.269562290379       residual = 4.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.015716796741       residual = 6.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.205275112862       residual = 7.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.367501031714       residual = 3.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.398672794238       residual = 5.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906189507790       residual = 1.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.095199265481       residual = 2.27e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.435006981546       residual = 7.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.293724524023       residual = 8.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.090210895948       residual = 2.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.093903843486       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.978292004534       residual = 9.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.866364892632       residual = 2.06e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.957686670781       residual = 8.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.188780542410       residual = 8.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.797655518647       residual = 2.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.260298158042       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.987653842159       residual = 7.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.603431284581       residual = 1.89e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.270202353188       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.348354776602       residual = 2.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.698098461465       residual = 3.96e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.332543344522       residual = 6.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.395573685397       residual = 7.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.209226648952       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.291242609933       residual = 2.94e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.678733070946       residual = 3.26e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.502624239215       residual = 9.33e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.632354536837       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -18.631185975931       residual = 3.22e+02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.860564419289       residual = 3.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.508388673812       residual = 1.86e+01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.628825333451       residual = 3.25e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.315526616731       residual = 6.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.625417135084       residual = 1.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -11.710224987325       residual = 5.00e+03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -19.111161599400       residual = 6.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -19.018816791275       residual = 5.80e+02           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.467179355050       residual = 1.39e+02           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -14.397183501685       residual = 1.07e+03           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.536394540358       residual = 1.64e+02           smallest_sin_value = 9.98e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.462577270019       residual = 2.73e+02           smallest_sin_value = 9.96e-01
davidson iteration   63:   krylov dim =  64   energy =     -17.744232332351       residual = 4.28e+02           smallest_sin_value = 9.94e-01
davidson iteration   64 stopping due to small subspace S singular value of 9.52e-01
davidson solver did not converge after         64 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+12 is 2.058659e-16

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216178639807       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216178639807       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216178639807       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216178639807       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.29e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.192725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7033e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1993
    reference variance = 0.185477
====================================================
  Execution time = 2.0697e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1227e-01
  Total weights = 1.9565e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385690066
  error estimate for blocks of size 2^( 2) =       0.000395758014
  error estimate for blocks of size 2^( 3) =       0.000404581247
  error estimate for blocks of size 2^( 4) =       0.000411833458
  error estimate for blocks of size 2^( 5) =       0.000416292968
  error estimate for blocks of size 2^( 6) =       0.000420019184
  error estimate for blocks of size 2^( 7) =       0.000418923629

      target function =                  N/A
              le_mean =     -17.216180073708
             les_mean =     296.709131079334
             stat err =       0.000416767310
             autocorr =       1.167643822202
              std dev =       0.545448122905
             le_variance =       0.297513654780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385690066
  error estimate for blocks of size 2^( 2) =       0.000395758014
  error estimate for blocks of size 2^( 3) =       0.000404581247
  error estimate for blocks of size 2^( 4) =       0.000411833458
  error estimate for blocks of size 2^( 5) =       0.000416292968
  error estimate for blocks of size 2^( 6) =       0.000420019184
  error estimate for blocks of size 2^( 7) =       0.000418923629

      target function =                  N/A
              le_mean =     -17.216180073708
             les_mean =     296.709131079334
             stat err =       0.000416767310
             autocorr =       1.167643822199
              std dev =       0.545448122905
             le_variance =       0.297513654780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385690066
  error estimate for blocks of size 2^( 2) =       0.000395758014
  error estimate for blocks of size 2^( 3) =       0.000404581247
  error estimate for blocks of size 2^( 4) =       0.000411833458
  error estimate for blocks of size 2^( 5) =       0.000416292968
  error estimate for blocks of size 2^( 6) =       0.000420019184
  error estimate for blocks of size 2^( 7) =       0.000418923629

      target function =                  N/A
              le_mean =     -17.216180073708
             les_mean =     296.709131079334
             stat err =       0.000416767310
             autocorr =       1.167643822202
              std dev =       0.545448122905
             le_variance =       0.297513654780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297373007855
                                         uncertainty =       0.002275876770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385690066
  error estimate for blocks of size 2^( 2) =       0.000395758014
  error estimate for blocks of size 2^( 3) =       0.000404581247
  error estimate for blocks of size 2^( 4) =       0.000411833458
  error estimate for blocks of size 2^( 5) =       0.000416292968
  error estimate for blocks of size 2^( 6) =       0.000420019184
  error estimate for blocks of size 2^( 7) =       0.000418923629

      target function =                  N/A
              le_mean =     -17.216180073708
             les_mean =     296.709131079334
             stat err =       0.000416767310
             autocorr =       1.167643822202
              std dev =       0.545448122905
             le_variance =       0.297513654780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216180073708        initial
     3.8147e+12     3.8147e+13             2.0587e-16       -17.216180073708  <--
     1.5259e+13     1.5259e+14             0.0000e+00       -17.216180073708
     6.1035e+13     6.1035e+14             0.0000e+00       -17.216180073708

*****************************************************************************
Applying the update for shift_i =   3.8147e+12     and shift_s =   3.8147e+13
*****************************************************************************

  Execution time = 2.9865e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1989
    reference variance = 0.161799
====================================================
  Execution time = 2.0909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1309e-01
  Total weights = 1.956757836e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298480362104
                                         uncertainty =       0.001956443259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298480362104
                                         uncertainty =       0.001956443259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386332072
  error estimate for blocks of size 2^( 2) =       0.000396400263
  error estimate for blocks of size 2^( 3) =       0.000405607785
  error estimate for blocks of size 2^( 4) =       0.000412395562
  error estimate for blocks of size 2^( 5) =       0.000416350927
  error estimate for blocks of size 2^( 6) =       0.000418028550
  error estimate for blocks of size 2^( 7) =       0.000420724620

      target function =                  N/A
              le_mean =     -17.215901243354
             les_mean =     296.700344630554
             stat err =       0.000416874915
             autocorr =       1.164367295128
              std dev =       0.546356055832
             le_variance =       0.298504939744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590124335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+11, overlap shift 9.5367e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901243399       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901243399       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901243399       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901243399       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.211728251175       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215587031719       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215148221857       residual = 8.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.222845076164       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213396487193       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.208454383103       residual = 8.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.220081200551       residual = 3.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.221238776925       residual = 4.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.209098803517       residual = 6.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.202988872993       residual = 2.69e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.210523540587       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.221989417469       residual = 6.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.193898866920       residual = 7.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.200840426258       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.229063449387       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.200113655946       residual = 3.65e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.243515284494       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.208037647866       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.200829169415       residual = 3.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.173433221463       residual = 2.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.182450655023       residual = 1.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.199245286017       residual = 4.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.233771564616       residual = 5.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.199604521569       residual = 4.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.274484244506       residual = 5.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.219282003571       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.172831920649       residual = 2.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.255287778071       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.257656994777       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.123063754574       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.162591099529       residual = 4.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.262066089635       residual = 3.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.195945332540       residual = 8.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -17.177488674394       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.159460718207       residual = 4.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.257741485214       residual = 2.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.203957296654       residual = 8.76e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.066099750390       residual = 3.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.169948992474       residual = 3.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -17.315582672080       residual = 1.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -17.199528893269       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.274671478997       residual = 5.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -17.162228460601       residual = 4.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.290396409405       residual = 7.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.316833207785       residual = 1.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.278295411964       residual = 1.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -17.243253286347       residual = 5.86e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -18.208104906895       residual = 1.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -17.095747988421       residual = 2.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -17.301759492237       residual = 9.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -17.437081501483       residual = 9.89e+00           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.688414309352       residual = 4.12e+01           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -17.281792749575       residual = 9.67e-01           smallest_sin_value = 9.98e-01
davidson iteration   57:   krylov dim =  58   energy =     -18.011301427696       residual = 1.01e+02           smallest_sin_value = 9.97e-01
davidson iteration   58:   krylov dim =  59   energy =     -17.350204840995       residual = 3.74e+00           smallest_sin_value = 9.96e-01
davidson iteration   59 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         59 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+11 is 5.039225e-16

solving harmonic davidson linear method for identity shift 3.8147e+12, overlap shift 3.8147e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901243399       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901243399       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901243399       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901243399       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215019010384       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217748537721       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.210778019068       residual = 5.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.218721610653       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.234915746355       residual = 5.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210616222816       residual = 7.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.226556273104       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.268433413312       residual = 4.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.186341518731       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.205583003002       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.197535399217       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.334798475864       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.275106927079       residual = 6.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.326511806100       residual = 1.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.113484830463       residual = 1.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.276230286540       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.194228574519       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.003208547067       residual = 6.95e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.022029197737       residual = 5.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.216156302497       residual = 2.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.503203349880       residual = 1.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.459147680505       residual = 9.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.477154688513       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.092633720548       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.748312601587       residual = 3.54e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.065856253859       residual = 3.85e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.061336459951       residual = 3.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.138515009775       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -17.645099932367       residual = 2.99e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.693165127539       residual = 3.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -17.871644962506       residual = 6.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.329339100770       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -18.030975270334       residual = 1.12e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -18.584576814390       residual = 2.99e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.399709515368       residual = 5.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -17.346492882088       residual = 2.61e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -17.657403900626       residual = 3.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -17.454598373617       residual = 9.30e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.358889791625       residual = 3.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.155750437359       residual = 1.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.728575143836       residual = 3.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -17.025479692474       residual = 8.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.731715421497       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.887524704498       residual = 2.09e+01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -17.793247506686       residual = 5.32e+01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -17.288550618196       residual = 7.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.778692176535       residual = 3.10e+01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.614973484062       residual = 6.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.108517697116       residual = 1.84e+02           smallest_sin_value = 9.99e-01
davidson iteration   53:   krylov dim =  54   energy =     -17.873332759008       residual = 7.00e+01           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -17.905603241310       residual = 8.96e+01           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.137919168040       residual = 1.97e+02           smallest_sin_value = 9.98e-01
davidson iteration   56 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         56 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+12 is 1.358551e-16

solving harmonic davidson linear method for identity shift 1.5259e+13, overlap shift 1.5259e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215901243399       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215901243399       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215901243399       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215901243399       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+13 is 2.793219e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.346380 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7136e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1988
    reference variance = 0.462353
====================================================
  Execution time = 2.0486e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2079e-01
  Total weights = 1.9569e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387691428
  error estimate for blocks of size 2^( 2) =       0.000397554241
  error estimate for blocks of size 2^( 3) =       0.000406651867
  error estimate for blocks of size 2^( 4) =       0.000413302421
  error estimate for blocks of size 2^( 5) =       0.000418116268
  error estimate for blocks of size 2^( 6) =       0.000419171017
  error estimate for blocks of size 2^( 7) =       0.000422289736

      target function =                  N/A
              le_mean =     -17.216273244732
             les_mean =     296.720854041077
             stat err =       0.000418219860
             autocorr =       1.163688944922
              std dev =       0.548278475161
             le_variance =       0.300609286325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387691428
  error estimate for blocks of size 2^( 2) =       0.000397554241
  error estimate for blocks of size 2^( 3) =       0.000406651867
  error estimate for blocks of size 2^( 4) =       0.000413302421
  error estimate for blocks of size 2^( 5) =       0.000418116268
  error estimate for blocks of size 2^( 6) =       0.000419171017
  error estimate for blocks of size 2^( 7) =       0.000422289736

      target function =                  N/A
              le_mean =     -17.216273244732
             les_mean =     296.720854041077
             stat err =       0.000418219860
             autocorr =       1.163688944926
              std dev =       0.548278475161
             le_variance =       0.300609286325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387691428
  error estimate for blocks of size 2^( 2) =       0.000397554241
  error estimate for blocks of size 2^( 3) =       0.000406651867
  error estimate for blocks of size 2^( 4) =       0.000413302421
  error estimate for blocks of size 2^( 5) =       0.000418116268
  error estimate for blocks of size 2^( 6) =       0.000419171017
  error estimate for blocks of size 2^( 7) =       0.000422289736

      target function =                  N/A
              le_mean =     -17.216273244732
             les_mean =     296.720854041077
             stat err =       0.000418219860
             autocorr =       1.163688944922
              std dev =       0.548278475161
             le_variance =       0.300609286325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300626356498
                                         uncertainty =       0.002425417514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387691428
  error estimate for blocks of size 2^( 2) =       0.000397554241
  error estimate for blocks of size 2^( 3) =       0.000406651867
  error estimate for blocks of size 2^( 4) =       0.000413302421
  error estimate for blocks of size 2^( 5) =       0.000418116268
  error estimate for blocks of size 2^( 6) =       0.000419171017
  error estimate for blocks of size 2^( 7) =       0.000422289736

      target function =                  N/A
              le_mean =     -17.216273244732
             les_mean =     296.720854041077
             stat err =       0.000418219860
             autocorr =       1.163688944923
              std dev =       0.548278475161
             le_variance =       0.300609286325


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216273244732        initial  <--
     9.5367e+11     9.5367e+12             5.0392e-16       -17.216273244732
     3.8147e+12     3.8147e+13             1.3586e-16       -17.216273244732
     1.5259e+13     1.5259e+14             2.7932e-17       -17.216273244732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6522
  </log>
  <optVariables href="H2O.s028.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6794e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.226125
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2075e-01
  Total weights = 1.956776796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299330222910
                                         uncertainty =       0.002437849826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299330222910
                                         uncertainty =       0.002437849826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386794819
  error estimate for blocks of size 2^( 2) =       0.000396761783
  error estimate for blocks of size 2^( 3) =       0.000405377124
  error estimate for blocks of size 2^( 4) =       0.000411381150
  error estimate for blocks of size 2^( 5) =       0.000415319604
  error estimate for blocks of size 2^( 6) =       0.000417038465
  error estimate for blocks of size 2^( 7) =       0.000417092608

      target function =                  N/A
              le_mean =     -17.216783998363
             les_mean =     296.738397357472
             stat err =       0.000415207957
             autocorr =       1.152311877640
              std dev =       0.547010479029
             le_variance =       0.299220464167


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678399836e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+12, overlap shift 9.5367e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+13, overlap shift 3.8147e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+14, overlap shift 1.5259e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216783998413       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.60e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.347536 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6469e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.234272
====================================================
  Execution time = 2.0315e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1500e-01
  Total weights = 1.9563e+06
  Execution time = 1.8112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387598782
  error estimate for blocks of size 2^( 2) =       0.000397240955
  error estimate for blocks of size 2^( 3) =       0.000406221998
  error estimate for blocks of size 2^( 4) =       0.000413382904
  error estimate for blocks of size 2^( 5) =       0.000416845504
  error estimate for blocks of size 2^( 6) =       0.000418917119
  error estimate for blocks of size 2^( 7) =       0.000419442977

      target function =                  N/A
              le_mean =     -17.216789545241
             les_mean =     296.732840924597
             stat err =       0.000417147126
             autocorr =       1.158280387886
              std dev =       0.548147454951
             le_variance =       0.300465632370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387598782
  error estimate for blocks of size 2^( 2) =       0.000397240955
  error estimate for blocks of size 2^( 3) =       0.000406221998
  error estimate for blocks of size 2^( 4) =       0.000413382904
  error estimate for blocks of size 2^( 5) =       0.000416845504
  error estimate for blocks of size 2^( 6) =       0.000418917119
  error estimate for blocks of size 2^( 7) =       0.000419442977

      target function =                  N/A
              le_mean =     -17.216789545241
             les_mean =     296.732840924597
             stat err =       0.000417147126
             autocorr =       1.158280387886
              std dev =       0.548147454951
             le_variance =       0.300465632370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387598782
  error estimate for blocks of size 2^( 2) =       0.000397240955
  error estimate for blocks of size 2^( 3) =       0.000406221998
  error estimate for blocks of size 2^( 4) =       0.000413382904
  error estimate for blocks of size 2^( 5) =       0.000416845504
  error estimate for blocks of size 2^( 6) =       0.000418917119
  error estimate for blocks of size 2^( 7) =       0.000419442977

      target function =                  N/A
              le_mean =     -17.216789545241
             les_mean =     296.732840924597
             stat err =       0.000417147126
             autocorr =       1.158280387886
              std dev =       0.548147454951
             le_variance =       0.300465632370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300479125013
                                         uncertainty =       0.002099820374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387598782
  error estimate for blocks of size 2^( 2) =       0.000397240955
  error estimate for blocks of size 2^( 3) =       0.000406221998
  error estimate for blocks of size 2^( 4) =       0.000413382904
  error estimate for blocks of size 2^( 5) =       0.000416845504
  error estimate for blocks of size 2^( 6) =       0.000418917119
  error estimate for blocks of size 2^( 7) =       0.000419442977

      target function =                  N/A
              le_mean =     -17.216789545241
             les_mean =     296.732840924597
             stat err =       0.000417147126
             autocorr =       1.158280387886
              std dev =       0.548147454951
             le_variance =       0.300465632370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216789545241        initial  <--
     9.5367e+12     9.5367e+13             0.0000e+00       -17.216789545241
     3.8147e+13     3.8147e+14             0.0000e+00       -17.216789545241
     1.5259e+14     1.5259e+15             0.0000e+00       -17.216789545241

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4693
  </log>
  <optVariables href="H2O.s029.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2572
    reference variance = 0.286416
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1241e-01
  Total weights = 1.956683017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298741765810
                                         uncertainty =       0.002063677704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298741765810
                                         uncertainty =       0.002063677704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386433119
  error estimate for blocks of size 2^( 2) =       0.000396467541
  error estimate for blocks of size 2^( 3) =       0.000405740799
  error estimate for blocks of size 2^( 4) =       0.000412479710
  error estimate for blocks of size 2^( 5) =       0.000416797653
  error estimate for blocks of size 2^( 6) =       0.000419053899
  error estimate for blocks of size 2^( 7) =       0.000421254106

      target function =                  N/A
              le_mean =     -17.215799559060
             les_mean =     296.696163592041
             stat err =       0.000417396342
             autocorr =       1.166671518358
              std dev =       0.546498958226
             le_variance =       0.298661111342


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721579955906e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+13, overlap shift 9.5367e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+14, overlap shift 3.8147e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+15, overlap shift 1.5259e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215799559095       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.348796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7013e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2278
    reference variance = 0.180564
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1058e-01
  Total weights = 1.9567e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385041920
  error estimate for blocks of size 2^( 2) =       0.000395742454
  error estimate for blocks of size 2^( 3) =       0.000405286057
  error estimate for blocks of size 2^( 4) =       0.000412079097
  error estimate for blocks of size 2^( 5) =       0.000416706617
  error estimate for blocks of size 2^( 6) =       0.000420258381
  error estimate for blocks of size 2^( 7) =       0.000422070868

      target function =                  N/A
              le_mean =     -17.216113973006
             les_mean =     296.705158322055
             stat err =       0.000417778741
             autocorr =       1.177271538798
              std dev =       0.544531505061
             le_variance =       0.296514560004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385041920
  error estimate for blocks of size 2^( 2) =       0.000395742454
  error estimate for blocks of size 2^( 3) =       0.000405286057
  error estimate for blocks of size 2^( 4) =       0.000412079097
  error estimate for blocks of size 2^( 5) =       0.000416706617
  error estimate for blocks of size 2^( 6) =       0.000420258381
  error estimate for blocks of size 2^( 7) =       0.000422070868

      target function =                  N/A
              le_mean =     -17.216113973006
             les_mean =     296.705158322055
             stat err =       0.000417778741
             autocorr =       1.177271538798
              std dev =       0.544531505061
             le_variance =       0.296514560004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385041920
  error estimate for blocks of size 2^( 2) =       0.000395742454
  error estimate for blocks of size 2^( 3) =       0.000405286057
  error estimate for blocks of size 2^( 4) =       0.000412079097
  error estimate for blocks of size 2^( 5) =       0.000416706617
  error estimate for blocks of size 2^( 6) =       0.000420258381
  error estimate for blocks of size 2^( 7) =       0.000422070868

      target function =                  N/A
              le_mean =     -17.216113973006
             les_mean =     296.705158322055
             stat err =       0.000417778741
             autocorr =       1.177271538798
              std dev =       0.544531505061
             le_variance =       0.296514560004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296560428559
                                         uncertainty =       0.001749565194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385041920
  error estimate for blocks of size 2^( 2) =       0.000395742454
  error estimate for blocks of size 2^( 3) =       0.000405286057
  error estimate for blocks of size 2^( 4) =       0.000412079097
  error estimate for blocks of size 2^( 5) =       0.000416706617
  error estimate for blocks of size 2^( 6) =       0.000420258381
  error estimate for blocks of size 2^( 7) =       0.000422070868

      target function =                  N/A
              le_mean =     -17.216113973006
             les_mean =     296.705158322055
             stat err =       0.000417778741
             autocorr =       1.177271538798
              std dev =       0.544531505061
             le_variance =       0.296514560004


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216113973006        initial  <--
     9.5367e+13     9.5367e+14             0.0000e+00       -17.216113973006
     3.8147e+14     3.8147e+15             0.0000e+00       -17.216113973006
     1.5259e+15     1.5259e+16             0.0000e+00       -17.216113973006

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5739
  </log>
  <optVariables href="H2O.s030.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1304
    reference variance = 0.461795
====================================================
  Execution time = 2.0685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1013e-01
  Total weights = 1.956775564e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295696635359
                                         uncertainty =       0.001794196081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295696635359
                                         uncertainty =       0.001794196081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384475508
  error estimate for blocks of size 2^( 2) =       0.000394526631
  error estimate for blocks of size 2^( 3) =       0.000403284330
  error estimate for blocks of size 2^( 4) =       0.000410025892
  error estimate for blocks of size 2^( 5) =       0.000413367374
  error estimate for blocks of size 2^( 6) =       0.000414607053
  error estimate for blocks of size 2^( 7) =       0.000415345209

      target function =                  N/A
              le_mean =     -17.216411743432
             les_mean =     296.714961258762
             stat err =       0.000413336382
             autocorr =       1.155765983847
              std dev =       0.543730477747
             le_variance =       0.295642832431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641174343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+14, overlap shift 9.5367e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216411743478       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216411743478       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216411743478       residual = 1.36e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216411743478       residual = 8.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -19.398395084049       residual = 7.37e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -20.130393479623       residual = 1.27e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.252305455889       residual = 1.58e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -14.913754431986       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =      -9.602703643635       residual = 9.36e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -10.847430483448       residual = 6.29e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -24.959675889602       residual = 1.02e+04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -14.439108153650       residual = 1.36e+03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -21.657850512790       residual = 2.97e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -13.292718470315       residual = 2.45e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =      -7.281139547969       residual = 1.57e+04           smallest_sin_value = 1.00e+00
davidson iteration   15 stopping due to too large eigenvalue change
davidson solver did not converge after         15 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+14 is 3.326678e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+15, overlap shift 3.8147e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216411743478       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216411743478       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216411743478       residual = 6.67e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216411743478       residual = 1.84e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -13.601470481745       residual = 2.36e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+15 is 8.316694e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+16, overlap shift 1.5259e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216411743478       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216411743478       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216411743478       residual = 7.34e+01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216411743477       residual = 9.13e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216411743479       residual = 1.17e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -21.079677669796       residual = 2.30e+03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -13.788115263018       residual = 1.83e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+16 is 2.079174e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.353645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6789e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1844
    reference variance = 0.251176
====================================================
  Execution time = 2.0661e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0967e-01
  Total weights = 1.9563e+06
  Execution time = 1.8131e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384387008
  error estimate for blocks of size 2^( 2) =       0.000394599256
  error estimate for blocks of size 2^( 3) =       0.000403264044
  error estimate for blocks of size 2^( 4) =       0.000410389261
  error estimate for blocks of size 2^( 5) =       0.000413816414
  error estimate for blocks of size 2^( 6) =       0.000414219836
  error estimate for blocks of size 2^( 7) =       0.000415368978

      target function =                  N/A
              le_mean =     -17.215925329918
             les_mean =     296.697755175810
             stat err =       0.000413448622
             autocorr =       1.156926311795
              std dev =       0.543605319414
             le_variance =       0.295506743296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384387008
  error estimate for blocks of size 2^( 2) =       0.000394599256
  error estimate for blocks of size 2^( 3) =       0.000403264044
  error estimate for blocks of size 2^( 4) =       0.000410389261
  error estimate for blocks of size 2^( 5) =       0.000413816414
  error estimate for blocks of size 2^( 6) =       0.000414219836
  error estimate for blocks of size 2^( 7) =       0.000415368978

      target function =                  N/A
              le_mean =     -17.215925329918
             les_mean =     296.697755175810
             stat err =       0.000413448622
             autocorr =       1.156926311795
              std dev =       0.543605319414
             le_variance =       0.295506743296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384387008
  error estimate for blocks of size 2^( 2) =       0.000394599256
  error estimate for blocks of size 2^( 3) =       0.000403264044
  error estimate for blocks of size 2^( 4) =       0.000410389261
  error estimate for blocks of size 2^( 5) =       0.000413816414
  error estimate for blocks of size 2^( 6) =       0.000414219836
  error estimate for blocks of size 2^( 7) =       0.000415368978

      target function =                  N/A
              le_mean =     -17.215925329918
             les_mean =     296.697755175810
             stat err =       0.000413448622
             autocorr =       1.156926311795
              std dev =       0.543605319414
             le_variance =       0.295506743296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295508910301
                                         uncertainty =       0.001566099020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384387008
  error estimate for blocks of size 2^( 2) =       0.000394599256
  error estimate for blocks of size 2^( 3) =       0.000403264044
  error estimate for blocks of size 2^( 4) =       0.000410389261
  error estimate for blocks of size 2^( 5) =       0.000413816414
  error estimate for blocks of size 2^( 6) =       0.000414219836
  error estimate for blocks of size 2^( 7) =       0.000415368978

      target function =                  N/A
              le_mean =     -17.215925329918
             les_mean =     296.697755175810
             stat err =       0.000413448622
             autocorr =       1.156926311795
              std dev =       0.543605319414
             le_variance =       0.295506743296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215925329918        initial  <--
     9.5367e+14     9.5367e+15             3.3267e-19       -17.215925329918
     3.8147e+15     3.8147e+16             8.3167e-20       -17.215925329918
     1.5259e+16     1.5259e+17             2.0792e-20       -17.215925329918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8296
  </log>
  <optVariables href="H2O.s031.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6626e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1793
    reference variance = 0.210811
====================================================
  Execution time = 2.0880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1496e-01
  Total weights = 1.956502142e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297689251421
                                         uncertainty =       0.001857812865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297689251421
                                         uncertainty =       0.001857812865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385755412
  error estimate for blocks of size 2^( 2) =       0.000396000159
  error estimate for blocks of size 2^( 3) =       0.000405701823
  error estimate for blocks of size 2^( 4) =       0.000412672022
  error estimate for blocks of size 2^( 5) =       0.000417778144
  error estimate for blocks of size 2^( 6) =       0.000419747478
  error estimate for blocks of size 2^( 7) =       0.000420394827

      target function =                  N/A
              le_mean =     -17.216590202451
             les_mean =     296.725934424763
             stat err =       0.000417648118
             autocorr =       1.172187270682
              std dev =       0.545540535707
             le_variance =       0.297614476099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659020245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+15, overlap shift 9.5367e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+16, overlap shift 3.8147e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.26e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+17, overlap shift 1.5259e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590202495       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.354850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6933e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1189
    reference variance = 0.234499
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1522e-01
  Total weights = 1.9564e+06
  Execution time = 1.8116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387465817
  error estimate for blocks of size 2^( 2) =       0.000397885138
  error estimate for blocks of size 2^( 3) =       0.000407356630
  error estimate for blocks of size 2^( 4) =       0.000413830906
  error estimate for blocks of size 2^( 5) =       0.000418548605
  error estimate for blocks of size 2^( 6) =       0.000419130738
  error estimate for blocks of size 2^( 7) =       0.000420103238

      target function =                  N/A
              le_mean =     -17.216157990586
             les_mean =     296.711318695586
             stat err =       0.000417903372
             autocorr =       1.163281877262
              std dev =       0.547959413203
             le_variance =       0.300259518517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387465817
  error estimate for blocks of size 2^( 2) =       0.000397885138
  error estimate for blocks of size 2^( 3) =       0.000407356630
  error estimate for blocks of size 2^( 4) =       0.000413830906
  error estimate for blocks of size 2^( 5) =       0.000418548605
  error estimate for blocks of size 2^( 6) =       0.000419130738
  error estimate for blocks of size 2^( 7) =       0.000420103238

      target function =                  N/A
              le_mean =     -17.216157990586
             les_mean =     296.711318695586
             stat err =       0.000417903372
             autocorr =       1.163281877262
              std dev =       0.547959413203
             le_variance =       0.300259518517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387465817
  error estimate for blocks of size 2^( 2) =       0.000397885138
  error estimate for blocks of size 2^( 3) =       0.000407356630
  error estimate for blocks of size 2^( 4) =       0.000413830906
  error estimate for blocks of size 2^( 5) =       0.000418548605
  error estimate for blocks of size 2^( 6) =       0.000419130738
  error estimate for blocks of size 2^( 7) =       0.000420103238

      target function =                  N/A
              le_mean =     -17.216157990586
             les_mean =     296.711318695586
             stat err =       0.000417903372
             autocorr =       1.163281877262
              std dev =       0.547959413203
             le_variance =       0.300259518517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300287416980
                                         uncertainty =       0.002210900171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387465817
  error estimate for blocks of size 2^( 2) =       0.000397885138
  error estimate for blocks of size 2^( 3) =       0.000407356630
  error estimate for blocks of size 2^( 4) =       0.000413830906
  error estimate for blocks of size 2^( 5) =       0.000418548605
  error estimate for blocks of size 2^( 6) =       0.000419130738
  error estimate for blocks of size 2^( 7) =       0.000420103238

      target function =                  N/A
              le_mean =     -17.216157990586
             les_mean =     296.711318695586
             stat err =       0.000417903372
             autocorr =       1.163281877262
              std dev =       0.547959413203
             le_variance =       0.300259518517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216157990586        initial  <--
     9.5367e+15     9.5367e+16             0.0000e+00       -17.216157990586
     3.8147e+16     3.8147e+17             0.0000e+00       -17.216157990586
     1.5259e+17     1.5259e+18             0.0000e+00       -17.216157990586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6095
  </log>
  <optVariables href="H2O.s032.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1365
    reference variance = 0.465019
====================================================
  Execution time = 2.0760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1838e-01
  Total weights = 1.956440077e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301206741305
                                         uncertainty =       0.002599445081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301206741305
                                         uncertainty =       0.002599445081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388203073
  error estimate for blocks of size 2^( 2) =       0.000398361117
  error estimate for blocks of size 2^( 3) =       0.000407414588
  error estimate for blocks of size 2^( 4) =       0.000414288288
  error estimate for blocks of size 2^( 5) =       0.000419506247
  error estimate for blocks of size 2^( 6) =       0.000421068408
  error estimate for blocks of size 2^( 7) =       0.000423648479

      target function =                  N/A
              le_mean =     -17.215652247740
             les_mean =     296.697061870412
             stat err =       0.000419627856
             autocorr =       1.168451477209
              std dev =       0.549002050581
             le_variance =       0.301403251542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721565224774e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+16, overlap shift 9.5367e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215652247769       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+16 is 4.529135e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+17, overlap shift 3.8147e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215652247769       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+17 is 1.132284e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+18, overlap shift 1.5259e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215652247769       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215652247769       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+18 is 2.830709e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.356373 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6853e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1025
    reference variance = 0.230692
====================================================
  Execution time = 2.0531e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1616e-01
  Total weights = 1.9564e+06
  Execution time = 1.8009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386840112
  error estimate for blocks of size 2^( 2) =       0.000396635753
  error estimate for blocks of size 2^( 3) =       0.000405216270
  error estimate for blocks of size 2^( 4) =       0.000412404681
  error estimate for blocks of size 2^( 5) =       0.000417603660
  error estimate for blocks of size 2^( 6) =       0.000419989798
  error estimate for blocks of size 2^( 7) =       0.000419190306

      target function =                  N/A
              le_mean =     -17.215648819566
             les_mean =     296.694721356478
             stat err =       0.000417297111
             autocorr =       1.163664424604
              std dev =       0.547074532186
             le_variance =       0.299290543767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386840112
  error estimate for blocks of size 2^( 2) =       0.000396635753
  error estimate for blocks of size 2^( 3) =       0.000405216270
  error estimate for blocks of size 2^( 4) =       0.000412404681
  error estimate for blocks of size 2^( 5) =       0.000417603660
  error estimate for blocks of size 2^( 6) =       0.000419989798
  error estimate for blocks of size 2^( 7) =       0.000419190306

      target function =                  N/A
              le_mean =     -17.215648819566
             les_mean =     296.694721356478
             stat err =       0.000417297111
             autocorr =       1.163664424604
              std dev =       0.547074532186
             le_variance =       0.299290543767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386840112
  error estimate for blocks of size 2^( 2) =       0.000396635753
  error estimate for blocks of size 2^( 3) =       0.000405216270
  error estimate for blocks of size 2^( 4) =       0.000412404681
  error estimate for blocks of size 2^( 5) =       0.000417603660
  error estimate for blocks of size 2^( 6) =       0.000419989798
  error estimate for blocks of size 2^( 7) =       0.000419190306

      target function =                  N/A
              le_mean =     -17.215648819566
             les_mean =     296.694721356478
             stat err =       0.000417297111
             autocorr =       1.163664424604
              std dev =       0.547074532186
             le_variance =       0.299290543767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299302832292
                                         uncertainty =       0.002438333829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386840112
  error estimate for blocks of size 2^( 2) =       0.000396635753
  error estimate for blocks of size 2^( 3) =       0.000405216270
  error estimate for blocks of size 2^( 4) =       0.000412404681
  error estimate for blocks of size 2^( 5) =       0.000417603660
  error estimate for blocks of size 2^( 6) =       0.000419989798
  error estimate for blocks of size 2^( 7) =       0.000419190306

      target function =                  N/A
              le_mean =     -17.215648819566
             les_mean =     296.694721356478
             stat err =       0.000417297111
             autocorr =       1.163664424604
              std dev =       0.547074532186
             le_variance =       0.299290543767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215648819566        initial  <--
     9.5367e+16     9.5367e+17             4.5291e-21       -17.215648819566
     3.8147e+17     3.8147e+18             1.1323e-21       -17.215648819566
     1.5259e+18     1.5259e+19             2.8307e-22       -17.215648819566

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7258
  </log>
  <optVariables href="H2O.s033.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1567
    reference variance = 0.251468
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1428e-01
  Total weights = 1.956527680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295332197338
                                         uncertainty =       0.001794162630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295332197338
                                         uncertainty =       0.001794162630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384232620
  error estimate for blocks of size 2^( 2) =       0.000394065292
  error estimate for blocks of size 2^( 3) =       0.000403127691
  error estimate for blocks of size 2^( 4) =       0.000410010618
  error estimate for blocks of size 2^( 5) =       0.000414609122
  error estimate for blocks of size 2^( 6) =       0.000416520282
  error estimate for blocks of size 2^( 7) =       0.000417224227

      target function =                  N/A
              le_mean =     -17.216350887648
             les_mean =     296.717021483333
             stat err =       0.000414591062
             autocorr =       1.164263832768
              std dev =       0.543386982205
             le_variance =       0.295269412430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635088765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+17, overlap shift 9.5367e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+18, overlap shift 3.8147e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+19, overlap shift 1.5259e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216350887685       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.357664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6809e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.211497
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1663e-01
  Total weights = 1.9564e+06
  Execution time = 1.8205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387094325
  error estimate for blocks of size 2^( 2) =       0.000396708958
  error estimate for blocks of size 2^( 3) =       0.000405561099
  error estimate for blocks of size 2^( 4) =       0.000412577061
  error estimate for blocks of size 2^( 5) =       0.000417385272
  error estimate for blocks of size 2^( 6) =       0.000420086568
  error estimate for blocks of size 2^( 7) =       0.000420811480

      target function =                  N/A
              le_mean =     -17.216704715026
             les_mean =     296.731553751682
             stat err =       0.000417715095
             autocorr =       1.164465779560
              std dev =       0.547434044834
             le_variance =       0.299684033443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387094325
  error estimate for blocks of size 2^( 2) =       0.000396708958
  error estimate for blocks of size 2^( 3) =       0.000405561099
  error estimate for blocks of size 2^( 4) =       0.000412577061
  error estimate for blocks of size 2^( 5) =       0.000417385272
  error estimate for blocks of size 2^( 6) =       0.000420086568
  error estimate for blocks of size 2^( 7) =       0.000420811480

      target function =                  N/A
              le_mean =     -17.216704715026
             les_mean =     296.731553751682
             stat err =       0.000417715095
             autocorr =       1.164465779560
              std dev =       0.547434044834
             le_variance =       0.299684033443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387094325
  error estimate for blocks of size 2^( 2) =       0.000396708958
  error estimate for blocks of size 2^( 3) =       0.000405561099
  error estimate for blocks of size 2^( 4) =       0.000412577061
  error estimate for blocks of size 2^( 5) =       0.000417385272
  error estimate for blocks of size 2^( 6) =       0.000420086568
  error estimate for blocks of size 2^( 7) =       0.000420811480

      target function =                  N/A
              le_mean =     -17.216704715026
             les_mean =     296.731553751682
             stat err =       0.000417715095
             autocorr =       1.164465779560
              std dev =       0.547434044834
             le_variance =       0.299684033443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299670596523
                                         uncertainty =       0.002154212639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387094325
  error estimate for blocks of size 2^( 2) =       0.000396708958
  error estimate for blocks of size 2^( 3) =       0.000405561099
  error estimate for blocks of size 2^( 4) =       0.000412577061
  error estimate for blocks of size 2^( 5) =       0.000417385272
  error estimate for blocks of size 2^( 6) =       0.000420086568
  error estimate for blocks of size 2^( 7) =       0.000420811480

      target function =                  N/A
              le_mean =     -17.216704715026
             les_mean =     296.731553751682
             stat err =       0.000417715095
             autocorr =       1.164465779560
              std dev =       0.547434044834
             le_variance =       0.299684033443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216704715026        initial  <--
     9.5367e+17     9.5367e+18             0.0000e+00       -17.216704715026
     3.8147e+18     3.8147e+19             0.0000e+00       -17.216704715026
     1.5259e+19     1.5259e+20             0.0000e+00       -17.216704715026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7535
  </log>
  <optVariables href="H2O.s034.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2235
    reference variance = 0.316769
====================================================
  Execution time = 2.0545e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0934e-01
  Total weights = 1.956329175e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294229303589
                                         uncertainty =       0.001211516436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294229303589
                                         uncertainty =       0.001211516436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383604038
  error estimate for blocks of size 2^( 2) =       0.000393625381
  error estimate for blocks of size 2^( 3) =       0.000402722834
  error estimate for blocks of size 2^( 4) =       0.000409640504
  error estimate for blocks of size 2^( 5) =       0.000413149361
  error estimate for blocks of size 2^( 6) =       0.000416626850
  error estimate for blocks of size 2^( 7) =       0.000418573152

      target function =                  N/A
              le_mean =     -17.216216417244
             les_mean =     296.707446360277
             stat err =       0.000414497467
             autocorr =       1.167555197709
              std dev =       0.542498032846
             le_variance =       0.294304115641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621641724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+18, overlap shift 9.5367e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+19, overlap shift 3.8147e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+20, overlap shift 1.5259e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216216417295       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.358896 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6609e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.241091
====================================================
  Execution time = 2.2501e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1383e-01
  Total weights = 1.9565e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961341
  error estimate for blocks of size 2^( 2) =       0.000396490722
  error estimate for blocks of size 2^( 3) =       0.000405055548
  error estimate for blocks of size 2^( 4) =       0.000411728690
  error estimate for blocks of size 2^( 5) =       0.000414778560
  error estimate for blocks of size 2^( 6) =       0.000416067818
  error estimate for blocks of size 2^( 7) =       0.000419611523

      target function =                  N/A
              le_mean =     -17.216430933662
             les_mean =     296.719326073142
             stat err =       0.000415546648
             autocorr =       1.153199399833
              std dev =       0.547245976528
             le_variance =       0.299478158826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961341
  error estimate for blocks of size 2^( 2) =       0.000396490722
  error estimate for blocks of size 2^( 3) =       0.000405055548
  error estimate for blocks of size 2^( 4) =       0.000411728690
  error estimate for blocks of size 2^( 5) =       0.000414778560
  error estimate for blocks of size 2^( 6) =       0.000416067818
  error estimate for blocks of size 2^( 7) =       0.000419611523

      target function =                  N/A
              le_mean =     -17.216430933662
             les_mean =     296.719326073142
             stat err =       0.000415546648
             autocorr =       1.153199399833
              std dev =       0.547245976528
             le_variance =       0.299478158826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961341
  error estimate for blocks of size 2^( 2) =       0.000396490722
  error estimate for blocks of size 2^( 3) =       0.000405055548
  error estimate for blocks of size 2^( 4) =       0.000411728690
  error estimate for blocks of size 2^( 5) =       0.000414778560
  error estimate for blocks of size 2^( 6) =       0.000416067818
  error estimate for blocks of size 2^( 7) =       0.000419611523

      target function =                  N/A
              le_mean =     -17.216430933662
             les_mean =     296.719326073142
             stat err =       0.000415546648
             autocorr =       1.153199399833
              std dev =       0.547245976528
             le_variance =       0.299478158826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299461200043
                                         uncertainty =       0.002422236551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386961341
  error estimate for blocks of size 2^( 2) =       0.000396490722
  error estimate for blocks of size 2^( 3) =       0.000405055548
  error estimate for blocks of size 2^( 4) =       0.000411728690
  error estimate for blocks of size 2^( 5) =       0.000414778560
  error estimate for blocks of size 2^( 6) =       0.000416067818
  error estimate for blocks of size 2^( 7) =       0.000419611523

      target function =                  N/A
              le_mean =     -17.216430933662
             les_mean =     296.719326073142
             stat err =       0.000415546648
             autocorr =       1.153199399833
              std dev =       0.547245976528
             le_variance =       0.299478158826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216430933662        initial  <--
     9.5367e+18     9.5367e+19             0.0000e+00       -17.216430933662
     3.8147e+19     3.8147e+20             0.0000e+00       -17.216430933662
     1.5259e+20     1.5259e+21             0.0000e+00       -17.216430933662

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6927
  </log>
  <optVariables href="H2O.s035.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.213
    reference variance = 0.34151
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1225e-01
  Total weights = 1.955902215e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0811e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298832599435
                                         uncertainty =       0.001667362774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298832599435
                                         uncertainty =       0.001667362774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386505216
  error estimate for blocks of size 2^( 2) =       0.000396580781
  error estimate for blocks of size 2^( 3) =       0.000405441677
  error estimate for blocks of size 2^( 4) =       0.000412274961
  error estimate for blocks of size 2^( 5) =       0.000415138790
  error estimate for blocks of size 2^( 6) =       0.000416917825
  error estimate for blocks of size 2^( 7) =       0.000419023977

      target function =                  N/A
              le_mean =     -17.216564313121
             les_mean =     296.722339084295
             stat err =       0.000415838888
             autocorr =       1.157549265805
              std dev =       0.546600918231
             le_variance =       0.298772563811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656431312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+19, overlap shift 9.5367e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564313164       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564313164       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216564313164       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216564313161       residual = 9.44e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+19 is 3.782164e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+20, overlap shift 3.8147e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564313164       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564313164       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216564313164       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216564313164       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216564313276       residual = 1.22e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216564417104       residual = 1.27e+01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+20 is 9.455410e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+21, overlap shift 1.5259e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216564313164       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216564313164       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216564313164       residual = 8.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216564313245       residual = 5.99e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216564313509       residual = 7.67e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+21 is 2.363853e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.361106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6634e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1897
    reference variance = 0.304488
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2255e-01
  Total weights = 1.9566e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388177589
  error estimate for blocks of size 2^( 2) =       0.000398256714
  error estimate for blocks of size 2^( 3) =       0.000406847760
  error estimate for blocks of size 2^( 4) =       0.000413529715
  error estimate for blocks of size 2^( 5) =       0.000418492060
  error estimate for blocks of size 2^( 6) =       0.000420264629
  error estimate for blocks of size 2^( 7) =       0.000424681890

      target function =                  N/A
              le_mean =     -17.216306988062
             les_mean =     296.723773827191
             stat err =       0.000419242073
             autocorr =       1.166457187004
              std dev =       0.548966011087
             le_variance =       0.301363681329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388177589
  error estimate for blocks of size 2^( 2) =       0.000398256714
  error estimate for blocks of size 2^( 3) =       0.000406847760
  error estimate for blocks of size 2^( 4) =       0.000413529715
  error estimate for blocks of size 2^( 5) =       0.000418492060
  error estimate for blocks of size 2^( 6) =       0.000420264629
  error estimate for blocks of size 2^( 7) =       0.000424681890

      target function =                  N/A
              le_mean =     -17.216306988062
             les_mean =     296.723773827191
             stat err =       0.000419242073
             autocorr =       1.166457187004
              std dev =       0.548966011087
             le_variance =       0.301363681329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388177589
  error estimate for blocks of size 2^( 2) =       0.000398256714
  error estimate for blocks of size 2^( 3) =       0.000406847760
  error estimate for blocks of size 2^( 4) =       0.000413529715
  error estimate for blocks of size 2^( 5) =       0.000418492060
  error estimate for blocks of size 2^( 6) =       0.000420264629
  error estimate for blocks of size 2^( 7) =       0.000424681890

      target function =                  N/A
              le_mean =     -17.216306988062
             les_mean =     296.723773827191
             stat err =       0.000419242073
             autocorr =       1.166457187004
              std dev =       0.548966011087
             le_variance =       0.301363681329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301343419236
                                         uncertainty =       0.002276374888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388177589
  error estimate for blocks of size 2^( 2) =       0.000398256714
  error estimate for blocks of size 2^( 3) =       0.000406847760
  error estimate for blocks of size 2^( 4) =       0.000413529715
  error estimate for blocks of size 2^( 5) =       0.000418492060
  error estimate for blocks of size 2^( 6) =       0.000420264629
  error estimate for blocks of size 2^( 7) =       0.000424681890

      target function =                  N/A
              le_mean =     -17.216306988062
             les_mean =     296.723773827191
             stat err =       0.000419242073
             autocorr =       1.166457187004
              std dev =       0.548966011087
             le_variance =       0.301363681329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216306988062        initial  <--
     9.5367e+19     9.5367e+20             3.7822e-24       -17.216306988062
     3.8147e+20     3.8147e+21             9.4554e-25       -17.216306988062
     1.5259e+21     1.5259e+22             2.3639e-25       -17.216306988062

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5017
  </log>
  <optVariables href="H2O.s036.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1974
    reference variance = 0.250249
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1398e-01
  Total weights = 1.956645897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299192478868
                                         uncertainty =       0.001984353032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299192478868
                                         uncertainty =       0.001984353032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386782039
  error estimate for blocks of size 2^( 2) =       0.000396928398
  error estimate for blocks of size 2^( 3) =       0.000405203949
  error estimate for blocks of size 2^( 4) =       0.000411818446
  error estimate for blocks of size 2^( 5) =       0.000415986252
  error estimate for blocks of size 2^( 6) =       0.000419163453
  error estimate for blocks of size 2^( 7) =       0.000421345936

      target function =                  N/A
              le_mean =     -17.216885017511
             les_mean =     296.735105835522
             stat err =       0.000417078522
             autocorr =       1.162794729847
              std dev =       0.546992404808
             le_variance =       0.299200690918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688501751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+20, overlap shift 9.5367e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885017558       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885017558       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885017558       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+20 is 3.812415e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+21, overlap shift 3.8147e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885017558       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885017558       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885017558       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+21 is 9.531038e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+22, overlap shift 1.5259e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216885017558       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216885017558       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216885017558       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+22 is 2.382760e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.362594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6903e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2609
    reference variance = 0.31426
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1235e-01
  Total weights = 1.9571e+06
  Execution time = 1.8159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385533287
  error estimate for blocks of size 2^( 2) =       0.000395890058
  error estimate for blocks of size 2^( 3) =       0.000405051431
  error estimate for blocks of size 2^( 4) =       0.000411434877
  error estimate for blocks of size 2^( 5) =       0.000416545010
  error estimate for blocks of size 2^( 6) =       0.000418153406
  error estimate for blocks of size 2^( 7) =       0.000419538520

      target function =                  N/A
              le_mean =     -17.216934108243
             les_mean =     296.735166926937
             stat err =       0.000416417953
             autocorr =       1.166635342929
              std dev =       0.545226402571
             le_variance =       0.297271830060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385533287
  error estimate for blocks of size 2^( 2) =       0.000395890058
  error estimate for blocks of size 2^( 3) =       0.000405051431
  error estimate for blocks of size 2^( 4) =       0.000411434877
  error estimate for blocks of size 2^( 5) =       0.000416545010
  error estimate for blocks of size 2^( 6) =       0.000418153406
  error estimate for blocks of size 2^( 7) =       0.000419538520

      target function =                  N/A
              le_mean =     -17.216934108243
             les_mean =     296.735166926937
             stat err =       0.000416417953
             autocorr =       1.166635342929
              std dev =       0.545226402571
             le_variance =       0.297271830060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385533287
  error estimate for blocks of size 2^( 2) =       0.000395890058
  error estimate for blocks of size 2^( 3) =       0.000405051431
  error estimate for blocks of size 2^( 4) =       0.000411434877
  error estimate for blocks of size 2^( 5) =       0.000416545010
  error estimate for blocks of size 2^( 6) =       0.000418153406
  error estimate for blocks of size 2^( 7) =       0.000419538520

      target function =                  N/A
              le_mean =     -17.216934108243
             les_mean =     296.735166926937
             stat err =       0.000416417953
             autocorr =       1.166635342929
              std dev =       0.545226402571
             le_variance =       0.297271830060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297358663506
                                         uncertainty =       0.001656916029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385533287
  error estimate for blocks of size 2^( 2) =       0.000395890058
  error estimate for blocks of size 2^( 3) =       0.000405051431
  error estimate for blocks of size 2^( 4) =       0.000411434877
  error estimate for blocks of size 2^( 5) =       0.000416545010
  error estimate for blocks of size 2^( 6) =       0.000418153406
  error estimate for blocks of size 2^( 7) =       0.000419538520

      target function =                  N/A
              le_mean =     -17.216934108243
             les_mean =     296.735166926937
             stat err =       0.000416417953
             autocorr =       1.166635342929
              std dev =       0.545226402571
             le_variance =       0.297271830060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934108243        initial  <--
     9.5367e+20     9.5367e+21             3.8124e-25       -17.216934108243
     3.8147e+21     3.8147e+22             9.5310e-26       -17.216934108243
     1.5259e+22     1.5259e+23             2.3828e-26       -17.216934108243

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5479
  </log>
  <optVariables href="H2O.s037.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6458e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2778
    reference variance = 0.144869
====================================================
  Execution time = 2.0776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1018e-01
  Total weights = 1.956655350e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0494e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297321433273
                                         uncertainty =       0.001790475122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297321433273
                                         uncertainty =       0.001790475122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385578560
  error estimate for blocks of size 2^( 2) =       0.000395895643
  error estimate for blocks of size 2^( 3) =       0.000405075493
  error estimate for blocks of size 2^( 4) =       0.000412411735
  error estimate for blocks of size 2^( 5) =       0.000417929428
  error estimate for blocks of size 2^( 6) =       0.000419764752
  error estimate for blocks of size 2^( 7) =       0.000422212732

      target function =                  N/A
              le_mean =     -17.216508113513
             les_mean =     296.718335824620
             stat err =       0.000418079662
             autocorr =       1.175688657229
              std dev =       0.545290428586
             le_variance =       0.297341651508


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650811351e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+21, overlap shift 9.5367e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+22, overlap shift 3.8147e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+23, overlap shift 1.5259e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216508113577       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.363820 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6831e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1744
    reference variance = 0.242373
====================================================
  Execution time = 2.0582e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0944e-01
  Total weights = 1.9566e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385102202
  error estimate for blocks of size 2^( 2) =       0.000395091834
  error estimate for blocks of size 2^( 3) =       0.000403901937
  error estimate for blocks of size 2^( 4) =       0.000410656239
  error estimate for blocks of size 2^( 5) =       0.000415421494
  error estimate for blocks of size 2^( 6) =       0.000417960107
  error estimate for blocks of size 2^( 7) =       0.000419871493

      target function =                  N/A
              le_mean =     -17.216527115900
             les_mean =     296.718244457012
             stat err =       0.000415977333
             autocorr =       1.166775572909
              std dev =       0.544616757574
             le_variance =       0.296607412630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385102202
  error estimate for blocks of size 2^( 2) =       0.000395091834
  error estimate for blocks of size 2^( 3) =       0.000403901937
  error estimate for blocks of size 2^( 4) =       0.000410656239
  error estimate for blocks of size 2^( 5) =       0.000415421494
  error estimate for blocks of size 2^( 6) =       0.000417960107
  error estimate for blocks of size 2^( 7) =       0.000419871493

      target function =                  N/A
              le_mean =     -17.216527115900
             les_mean =     296.718244457012
             stat err =       0.000415977333
             autocorr =       1.166775572909
              std dev =       0.544616757574
             le_variance =       0.296607412630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385102202
  error estimate for blocks of size 2^( 2) =       0.000395091834
  error estimate for blocks of size 2^( 3) =       0.000403901937
  error estimate for blocks of size 2^( 4) =       0.000410656239
  error estimate for blocks of size 2^( 5) =       0.000415421494
  error estimate for blocks of size 2^( 6) =       0.000417960107
  error estimate for blocks of size 2^( 7) =       0.000419871493

      target function =                  N/A
              le_mean =     -17.216527115900
             les_mean =     296.718244457012
             stat err =       0.000415977333
             autocorr =       1.166775572909
              std dev =       0.544616757574
             le_variance =       0.296607412630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296624800853
                                         uncertainty =       0.001749294748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385102202
  error estimate for blocks of size 2^( 2) =       0.000395091834
  error estimate for blocks of size 2^( 3) =       0.000403901937
  error estimate for blocks of size 2^( 4) =       0.000410656239
  error estimate for blocks of size 2^( 5) =       0.000415421494
  error estimate for blocks of size 2^( 6) =       0.000417960107
  error estimate for blocks of size 2^( 7) =       0.000419871493

      target function =                  N/A
              le_mean =     -17.216527115900
             les_mean =     296.718244457012
             stat err =       0.000415977333
             autocorr =       1.166775572909
              std dev =       0.544616757574
             le_variance =       0.296607412630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216527115900        initial  <--
     9.5367e+21     9.5367e+22             0.0000e+00       -17.216527115900
     3.8147e+22     3.8147e+23             0.0000e+00       -17.216527115900
     1.5259e+23     1.5259e+24             0.0000e+00       -17.216527115900

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7478
  </log>
  <optVariables href="H2O.s038.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1854
    reference variance = 0.287098
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1551e-01
  Total weights = 1.956762402e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299690941778
                                         uncertainty =       0.001866115901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299690941778
                                         uncertainty =       0.001866115901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387126896
  error estimate for blocks of size 2^( 2) =       0.000397450960
  error estimate for blocks of size 2^( 3) =       0.000406676322
  error estimate for blocks of size 2^( 4) =       0.000413711353
  error estimate for blocks of size 2^( 5) =       0.000417939101
  error estimate for blocks of size 2^( 6) =       0.000420496742
  error estimate for blocks of size 2^( 7) =       0.000421832168

      target function =                  N/A
              le_mean =     -17.216311009555
             les_mean =     296.716873063914
             stat err =       0.000418494841
             autocorr =       1.168620570533
              std dev =       0.547480106383
             le_variance =       0.299734466885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631100955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+22, overlap shift 9.5367e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+23, overlap shift 3.8147e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+24, overlap shift 1.5259e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216311009599       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.365077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6658e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1253
    reference variance = 1.03812
====================================================
  Execution time = 2.0466e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1309e-01
  Total weights = 1.9567e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385892748
  error estimate for blocks of size 2^( 2) =       0.000396127468
  error estimate for blocks of size 2^( 3) =       0.000405409624
  error estimate for blocks of size 2^( 4) =       0.000412246992
  error estimate for blocks of size 2^( 5) =       0.000416532307
  error estimate for blocks of size 2^( 6) =       0.000418778675
  error estimate for blocks of size 2^( 7) =       0.000419961108

      target function =                  N/A
              le_mean =     -17.215981198786
             les_mean =     296.703100876799
             stat err =       0.000416879770
             autocorr =       1.167047162923
              std dev =       0.545734758206
             le_variance =       0.297826426314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385892748
  error estimate for blocks of size 2^( 2) =       0.000396127468
  error estimate for blocks of size 2^( 3) =       0.000405409624
  error estimate for blocks of size 2^( 4) =       0.000412246992
  error estimate for blocks of size 2^( 5) =       0.000416532307
  error estimate for blocks of size 2^( 6) =       0.000418778675
  error estimate for blocks of size 2^( 7) =       0.000419961108

      target function =                  N/A
              le_mean =     -17.215981198786
             les_mean =     296.703100876799
             stat err =       0.000416879770
             autocorr =       1.167047162923
              std dev =       0.545734758206
             le_variance =       0.297826426314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385892748
  error estimate for blocks of size 2^( 2) =       0.000396127468
  error estimate for blocks of size 2^( 3) =       0.000405409624
  error estimate for blocks of size 2^( 4) =       0.000412246992
  error estimate for blocks of size 2^( 5) =       0.000416532307
  error estimate for blocks of size 2^( 6) =       0.000418778675
  error estimate for blocks of size 2^( 7) =       0.000419961108

      target function =                  N/A
              le_mean =     -17.215981198786
             les_mean =     296.703100876799
             stat err =       0.000416879770
             autocorr =       1.167047162923
              std dev =       0.545734758206
             le_variance =       0.297826426314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297846865688
                                         uncertainty =       0.002033772056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385892748
  error estimate for blocks of size 2^( 2) =       0.000396127468
  error estimate for blocks of size 2^( 3) =       0.000405409624
  error estimate for blocks of size 2^( 4) =       0.000412246992
  error estimate for blocks of size 2^( 5) =       0.000416532307
  error estimate for blocks of size 2^( 6) =       0.000418778675
  error estimate for blocks of size 2^( 7) =       0.000419961108

      target function =                  N/A
              le_mean =     -17.215981198786
             les_mean =     296.703100876799
             stat err =       0.000416879770
             autocorr =       1.167047162923
              std dev =       0.545734758206
             le_variance =       0.297826426314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215981198786        initial  <--
     9.5367e+22     9.5367e+23             0.0000e+00       -17.215981198786
     3.8147e+23     3.8147e+24             0.0000e+00       -17.215981198786
     1.5259e+24     1.5259e+25             0.0000e+00       -17.215981198786

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6923
  </log>
  <optVariables href="H2O.s039.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6356e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1021
    reference variance = 0.191304
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1135e-01
  Total weights = 1.956591318e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296713486161
                                         uncertainty =       0.002169604264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296713486161
                                         uncertainty =       0.002169604264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385194452
  error estimate for blocks of size 2^( 2) =       0.000395219382
  error estimate for blocks of size 2^( 3) =       0.000403972123
  error estimate for blocks of size 2^( 4) =       0.000410720744
  error estimate for blocks of size 2^( 5) =       0.000414879293
  error estimate for blocks of size 2^( 6) =       0.000416077290
  error estimate for blocks of size 2^( 7) =       0.000417813811

      target function =                  N/A
              le_mean =     -17.216395272889
             les_mean =     296.715617782729
             stat err =       0.000414872784
             autocorr =       1.160031668336
              std dev =       0.544747218385
             le_variance =       0.296749531938


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639527289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+23, overlap shift 9.5367e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+24, overlap shift 3.8147e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+25, overlap shift 1.5259e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216395272956       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.366245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6592e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1549
    reference variance = 0.294954
====================================================
  Execution time = 2.0312e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1547e-01
  Total weights = 1.9568e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387795230
  error estimate for blocks of size 2^( 2) =       0.000397813625
  error estimate for blocks of size 2^( 3) =       0.000407191001
  error estimate for blocks of size 2^( 4) =       0.000414469767
  error estimate for blocks of size 2^( 5) =       0.000419625972
  error estimate for blocks of size 2^( 6) =       0.000424154790
  error estimate for blocks of size 2^( 7) =       0.000422872499

      target function =                  N/A
              le_mean =     -17.216316399798
             les_mean =     296.717019584307
             stat err =       0.000420280757
             autocorr =       1.174556969251
              std dev =       0.548425273709
             le_variance =       0.300770280842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387795230
  error estimate for blocks of size 2^( 2) =       0.000397813625
  error estimate for blocks of size 2^( 3) =       0.000407191001
  error estimate for blocks of size 2^( 4) =       0.000414469767
  error estimate for blocks of size 2^( 5) =       0.000419625972
  error estimate for blocks of size 2^( 6) =       0.000424154790
  error estimate for blocks of size 2^( 7) =       0.000422872499

      target function =                  N/A
              le_mean =     -17.216316399798
             les_mean =     296.717019584307
             stat err =       0.000420280757
             autocorr =       1.174556969251
              std dev =       0.548425273709
             le_variance =       0.300770280842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387795230
  error estimate for blocks of size 2^( 2) =       0.000397813625
  error estimate for blocks of size 2^( 3) =       0.000407191001
  error estimate for blocks of size 2^( 4) =       0.000414469767
  error estimate for blocks of size 2^( 5) =       0.000419625972
  error estimate for blocks of size 2^( 6) =       0.000424154790
  error estimate for blocks of size 2^( 7) =       0.000422872499

      target function =                  N/A
              le_mean =     -17.216316399798
             les_mean =     296.717019584307
             stat err =       0.000420280757
             autocorr =       1.174556969251
              std dev =       0.548425273709
             le_variance =       0.300770280842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300781728359
                                         uncertainty =       0.002450029556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387795230
  error estimate for blocks of size 2^( 2) =       0.000397813625
  error estimate for blocks of size 2^( 3) =       0.000407191001
  error estimate for blocks of size 2^( 4) =       0.000414469767
  error estimate for blocks of size 2^( 5) =       0.000419625972
  error estimate for blocks of size 2^( 6) =       0.000424154790
  error estimate for blocks of size 2^( 7) =       0.000422872499

      target function =                  N/A
              le_mean =     -17.216316399798
             les_mean =     296.717019584307
             stat err =       0.000420280757
             autocorr =       1.174556969251
              std dev =       0.548425273709
             le_variance =       0.300770280842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216316399798        initial  <--
     9.5367e+23     9.5367e+24             0.0000e+00       -17.216316399798
     3.8147e+24     3.8147e+25             0.0000e+00       -17.216316399798
     1.5259e+25     1.5259e+26             0.0000e+00       -17.216316399798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.2920
  </log>
  <optVariables href="H2O.s040.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.21576
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1244e-01
  Total weights = 1.956624558e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297665117665
                                         uncertainty =       0.002091094218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297665117665
                                         uncertainty =       0.002091094218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385745258
  error estimate for blocks of size 2^( 2) =       0.000395967950
  error estimate for blocks of size 2^( 3) =       0.000404946866
  error estimate for blocks of size 2^( 4) =       0.000411660973
  error estimate for blocks of size 2^( 5) =       0.000415962302
  error estimate for blocks of size 2^( 6) =       0.000417815194
  error estimate for blocks of size 2^( 7) =       0.000420686398

      target function =                  N/A
              le_mean =     -17.216853786729
             les_mean =     296.732498848355
             stat err =       0.000416531217
             autocorr =       1.165987565649
              std dev =       0.545526175170
             le_variance =       0.297598807796


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685378673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+24, overlap shift 9.5367e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+25, overlap shift 3.8147e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+26, overlap shift 1.5259e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216853786790       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.367476 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6622e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2871
    reference variance = 0.206239
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1142e-01
  Total weights = 1.9564e+06
  Execution time = 1.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386100972
  error estimate for blocks of size 2^( 2) =       0.000396127097
  error estimate for blocks of size 2^( 3) =       0.000405332013
  error estimate for blocks of size 2^( 4) =       0.000411275647
  error estimate for blocks of size 2^( 5) =       0.000415378628
  error estimate for blocks of size 2^( 6) =       0.000416874390
  error estimate for blocks of size 2^( 7) =       0.000419412668

      target function =                  N/A
              le_mean =     -17.216506648951
             les_mean =     296.719521141360
             stat err =       0.000415735333
             autocorr =       1.159396763414
              std dev =       0.546029231077
             le_variance =       0.298147921191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386100972
  error estimate for blocks of size 2^( 2) =       0.000396127097
  error estimate for blocks of size 2^( 3) =       0.000405332013
  error estimate for blocks of size 2^( 4) =       0.000411275647
  error estimate for blocks of size 2^( 5) =       0.000415378628
  error estimate for blocks of size 2^( 6) =       0.000416874390
  error estimate for blocks of size 2^( 7) =       0.000419412668

      target function =                  N/A
              le_mean =     -17.216506648951
             les_mean =     296.719521141360
             stat err =       0.000415735333
             autocorr =       1.159396763414
              std dev =       0.546029231077
             le_variance =       0.298147921191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386100972
  error estimate for blocks of size 2^( 2) =       0.000396127097
  error estimate for blocks of size 2^( 3) =       0.000405332013
  error estimate for blocks of size 2^( 4) =       0.000411275647
  error estimate for blocks of size 2^( 5) =       0.000415378628
  error estimate for blocks of size 2^( 6) =       0.000416874390
  error estimate for blocks of size 2^( 7) =       0.000419412668

      target function =                  N/A
              le_mean =     -17.216506648951
             les_mean =     296.719521141360
             stat err =       0.000415735333
             autocorr =       1.159396763414
              std dev =       0.546029231077
             le_variance =       0.298147921191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298203781370
                                         uncertainty =       0.002339348920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386100972
  error estimate for blocks of size 2^( 2) =       0.000396127097
  error estimate for blocks of size 2^( 3) =       0.000405332013
  error estimate for blocks of size 2^( 4) =       0.000411275647
  error estimate for blocks of size 2^( 5) =       0.000415378628
  error estimate for blocks of size 2^( 6) =       0.000416874390
  error estimate for blocks of size 2^( 7) =       0.000419412668

      target function =                  N/A
              le_mean =     -17.216506648951
             les_mean =     296.719521141360
             stat err =       0.000415735333
             autocorr =       1.159396763414
              std dev =       0.546029231077
             le_variance =       0.298147921191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216506648951        initial  <--
     9.5367e+24     9.5367e+25             0.0000e+00       -17.216506648951
     3.8147e+25     3.8147e+26             0.0000e+00       -17.216506648951
     1.5259e+26     1.5259e+27             0.0000e+00       -17.216506648951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7972
  </log>
  <optVariables href="H2O.s041.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6426e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2174
    reference variance = 0.230276
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1134e-01
  Total weights = 1.956708585e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297614713026
                                         uncertainty =       0.002106895262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297614713026
                                         uncertainty =       0.002106895262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385708866
  error estimate for blocks of size 2^( 2) =       0.000395683287
  error estimate for blocks of size 2^( 3) =       0.000404474415
  error estimate for blocks of size 2^( 4) =       0.000411471092
  error estimate for blocks of size 2^( 5) =       0.000416232520
  error estimate for blocks of size 2^( 6) =       0.000418037891
  error estimate for blocks of size 2^( 7) =       0.000417790517

      target function =                  N/A
              le_mean =     -17.216875562681
             les_mean =     296.732143450529
             stat err =       0.000415883005
             autocorr =       1.162580682838
              std dev =       0.545474709665
             le_variance =       0.297542658884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687556268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+25, overlap shift 9.5367e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+26, overlap shift 3.8147e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+27, overlap shift 1.5259e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216875562721       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.368730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6606e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.153705
====================================================
  Execution time = 2.0944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1363e-01
  Total weights = 1.9565e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384768318
  error estimate for blocks of size 2^( 2) =       0.000395086044
  error estimate for blocks of size 2^( 3) =       0.000404701132
  error estimate for blocks of size 2^( 4) =       0.000411176727
  error estimate for blocks of size 2^( 5) =       0.000416531261
  error estimate for blocks of size 2^( 6) =       0.000419263619
  error estimate for blocks of size 2^( 7) =       0.000420254250

      target function =                  N/A
              le_mean =     -17.217217433606
             les_mean =     296.746207597844
             stat err =       0.000416806464
             autocorr =       1.173465384266
              std dev =       0.544144573118
             le_variance =       0.296093316453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384768318
  error estimate for blocks of size 2^( 2) =       0.000395086044
  error estimate for blocks of size 2^( 3) =       0.000404701132
  error estimate for blocks of size 2^( 4) =       0.000411176727
  error estimate for blocks of size 2^( 5) =       0.000416531261
  error estimate for blocks of size 2^( 6) =       0.000419263619
  error estimate for blocks of size 2^( 7) =       0.000420254250

      target function =                  N/A
              le_mean =     -17.217217433606
             les_mean =     296.746207597844
             stat err =       0.000416806464
             autocorr =       1.173465384266
              std dev =       0.544144573118
             le_variance =       0.296093316453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384768318
  error estimate for blocks of size 2^( 2) =       0.000395086044
  error estimate for blocks of size 2^( 3) =       0.000404701132
  error estimate for blocks of size 2^( 4) =       0.000411176727
  error estimate for blocks of size 2^( 5) =       0.000416531261
  error estimate for blocks of size 2^( 6) =       0.000419263619
  error estimate for blocks of size 2^( 7) =       0.000420254250

      target function =                  N/A
              le_mean =     -17.217217433606
             les_mean =     296.746207597844
             stat err =       0.000416806464
             autocorr =       1.173465384266
              std dev =       0.544144573118
             le_variance =       0.296093316453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296033855332
                                         uncertainty =       0.001861245175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384768318
  error estimate for blocks of size 2^( 2) =       0.000395086044
  error estimate for blocks of size 2^( 3) =       0.000404701132
  error estimate for blocks of size 2^( 4) =       0.000411176727
  error estimate for blocks of size 2^( 5) =       0.000416531261
  error estimate for blocks of size 2^( 6) =       0.000419263619
  error estimate for blocks of size 2^( 7) =       0.000420254250

      target function =                  N/A
              le_mean =     -17.217217433606
             les_mean =     296.746207597844
             stat err =       0.000416806464
             autocorr =       1.173465384266
              std dev =       0.544144573118
             le_variance =       0.296093316453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217217433606        initial  <--
     9.5367e+25     9.5367e+26             0.0000e+00       -17.217217433606
     3.8147e+26     3.8147e+27             0.0000e+00       -17.217217433606
     1.5259e+27     1.5259e+28             0.0000e+00       -17.217217433606

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1148
  </log>
  <optVariables href="H2O.s042.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1921
    reference variance = 0.463794
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1575e-01
  Total weights = 1.956736999e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300824010583
                                         uncertainty =       0.002366524382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300824010583
                                         uncertainty =       0.002366524382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387805463
  error estimate for blocks of size 2^( 2) =       0.000397941350
  error estimate for blocks of size 2^( 3) =       0.000407350265
  error estimate for blocks of size 2^( 4) =       0.000413674533
  error estimate for blocks of size 2^( 5) =       0.000416975999
  error estimate for blocks of size 2^( 6) =       0.000418795052
  error estimate for blocks of size 2^( 7) =       0.000421568588

      target function =                  N/A
              le_mean =     -17.216985604599
             les_mean =     296.740340980712
             stat err =       0.000417753543
             autocorr =       1.160412607317
              std dev =       0.548439744726
             le_variance =       0.300786153595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698560460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+26, overlap shift 9.5367e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+27, overlap shift 3.8147e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+27 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+28, overlap shift 1.5259e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985604646       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.369954 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6621e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.24577
====================================================
  Execution time = 2.0365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1293e-01
  Total weights = 1.9567e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386593765
  error estimate for blocks of size 2^( 2) =       0.000396667887
  error estimate for blocks of size 2^( 3) =       0.000405278970
  error estimate for blocks of size 2^( 4) =       0.000412169133
  error estimate for blocks of size 2^( 5) =       0.000416067239
  error estimate for blocks of size 2^( 6) =       0.000417079317
  error estimate for blocks of size 2^( 7) =       0.000417172697

      target function =                  N/A
              le_mean =     -17.217250379500
             les_mean =     296.746644371183
             stat err =       0.000415622097
             autocorr =       1.155812977174
              std dev =       0.546726145791
             le_variance =       0.298909478492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386593765
  error estimate for blocks of size 2^( 2) =       0.000396667887
  error estimate for blocks of size 2^( 3) =       0.000405278970
  error estimate for blocks of size 2^( 4) =       0.000412169133
  error estimate for blocks of size 2^( 5) =       0.000416067239
  error estimate for blocks of size 2^( 6) =       0.000417079317
  error estimate for blocks of size 2^( 7) =       0.000417172697

      target function =                  N/A
              le_mean =     -17.217250379500
             les_mean =     296.746644371183
             stat err =       0.000415622097
             autocorr =       1.155812977174
              std dev =       0.546726145791
             le_variance =       0.298909478492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386593765
  error estimate for blocks of size 2^( 2) =       0.000396667887
  error estimate for blocks of size 2^( 3) =       0.000405278970
  error estimate for blocks of size 2^( 4) =       0.000412169133
  error estimate for blocks of size 2^( 5) =       0.000416067239
  error estimate for blocks of size 2^( 6) =       0.000417079317
  error estimate for blocks of size 2^( 7) =       0.000417172697

      target function =                  N/A
              le_mean =     -17.217250379500
             les_mean =     296.746644371183
             stat err =       0.000415622097
             autocorr =       1.155812977174
              std dev =       0.546726145791
             le_variance =       0.298909478492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298939082791
                                         uncertainty =       0.002010264889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386593765
  error estimate for blocks of size 2^( 2) =       0.000396667887
  error estimate for blocks of size 2^( 3) =       0.000405278970
  error estimate for blocks of size 2^( 4) =       0.000412169133
  error estimate for blocks of size 2^( 5) =       0.000416067239
  error estimate for blocks of size 2^( 6) =       0.000417079317
  error estimate for blocks of size 2^( 7) =       0.000417172697

      target function =                  N/A
              le_mean =     -17.217250379500
             les_mean =     296.746644371183
             stat err =       0.000415622097
             autocorr =       1.155812977174
              std dev =       0.546726145791
             le_variance =       0.298909478492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217250379500        initial  <--
     9.5367e+26     9.5367e+27             0.0000e+00       -17.217250379500
     3.8147e+27     3.8147e+28             0.0000e+00       -17.217250379500
     1.5259e+28     1.5259e+29             0.0000e+00       -17.217250379500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7604
  </log>
  <optVariables href="H2O.s043.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6388e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.272093
====================================================
  Execution time = 2.0643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1252e-01
  Total weights = 1.956570069e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300227840188
                                         uncertainty =       0.002507945761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300227840188
                                         uncertainty =       0.002507945761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387401263
  error estimate for blocks of size 2^( 2) =       0.000397317974
  error estimate for blocks of size 2^( 3) =       0.000406922460
  error estimate for blocks of size 2^( 4) =       0.000413263667
  error estimate for blocks of size 2^( 5) =       0.000417201528
  error estimate for blocks of size 2^( 6) =       0.000419697934
  error estimate for blocks of size 2^( 7) =       0.000419911793

      target function =                  N/A
              le_mean =     -17.216714227876
             les_mean =     296.727771973194
             stat err =       0.000417518730
             autocorr =       1.161528477320
              std dev =       0.547868120190
             le_variance =       0.300159477120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671422788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+27, overlap shift 9.5367e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+28, overlap shift 3.8147e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+29, overlap shift 1.5259e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216714227928       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.373819 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6711e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2542
    reference variance = 0.238893
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1550e-01
  Total weights = 1.9568e+06
  Execution time = 1.8139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387236704
  error estimate for blocks of size 2^( 2) =       0.000397776777
  error estimate for blocks of size 2^( 3) =       0.000406204930
  error estimate for blocks of size 2^( 4) =       0.000413116014
  error estimate for blocks of size 2^( 5) =       0.000416603323
  error estimate for blocks of size 2^( 6) =       0.000418401114
  error estimate for blocks of size 2^( 7) =       0.000419551066

      target function =                  N/A
              le_mean =     -17.217253889047
             les_mean =     296.749332422217
             stat err =       0.000416917879
             autocorr =       1.159172342918
              std dev =       0.547635398205
             le_variance =       0.299904529367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387236704
  error estimate for blocks of size 2^( 2) =       0.000397776777
  error estimate for blocks of size 2^( 3) =       0.000406204930
  error estimate for blocks of size 2^( 4) =       0.000413116014
  error estimate for blocks of size 2^( 5) =       0.000416603323
  error estimate for blocks of size 2^( 6) =       0.000418401114
  error estimate for blocks of size 2^( 7) =       0.000419551066

      target function =                  N/A
              le_mean =     -17.217253889047
             les_mean =     296.749332422217
             stat err =       0.000416917879
             autocorr =       1.159172342918
              std dev =       0.547635398205
             le_variance =       0.299904529367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387236704
  error estimate for blocks of size 2^( 2) =       0.000397776777
  error estimate for blocks of size 2^( 3) =       0.000406204930
  error estimate for blocks of size 2^( 4) =       0.000413116014
  error estimate for blocks of size 2^( 5) =       0.000416603323
  error estimate for blocks of size 2^( 6) =       0.000418401114
  error estimate for blocks of size 2^( 7) =       0.000419551066

      target function =                  N/A
              le_mean =     -17.217253889047
             les_mean =     296.749332422217
             stat err =       0.000416917879
             autocorr =       1.159172342918
              std dev =       0.547635398205
             le_variance =       0.299904529367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300044616750
                                         uncertainty =       0.002572430022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387236704
  error estimate for blocks of size 2^( 2) =       0.000397776777
  error estimate for blocks of size 2^( 3) =       0.000406204930
  error estimate for blocks of size 2^( 4) =       0.000413116014
  error estimate for blocks of size 2^( 5) =       0.000416603323
  error estimate for blocks of size 2^( 6) =       0.000418401114
  error estimate for blocks of size 2^( 7) =       0.000419551066

      target function =                  N/A
              le_mean =     -17.217253889047
             les_mean =     296.749332422217
             stat err =       0.000416917879
             autocorr =       1.159172342918
              std dev =       0.547635398205
             le_variance =       0.299904529367


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217253889047        initial  <--
     9.5367e+27     9.5367e+28             0.0000e+00       -17.217253889047
     3.8147e+28     3.8147e+29             0.0000e+00       -17.217253889047
     1.5259e+29     1.5259e+30             0.0000e+00       -17.217253889047

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7511
  </log>
  <optVariables href="H2O.s044.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.19
    reference variance = 0.181613
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1042e-01
  Total weights = 1.956580480e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296013656694
                                         uncertainty =       0.001897459502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296013656694
                                         uncertainty =       0.001897459502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384690914
  error estimate for blocks of size 2^( 2) =       0.000395136142
  error estimate for blocks of size 2^( 3) =       0.000404166819
  error estimate for blocks of size 2^( 4) =       0.000410544112
  error estimate for blocks of size 2^( 5) =       0.000415217132
  error estimate for blocks of size 2^( 6) =       0.000417099271
  error estimate for blocks of size 2^( 7) =       0.000418882013

      target function =                  N/A
              le_mean =     -17.216368501559
             les_mean =     296.713763007352
             stat err =       0.000415435632
             autocorr =       1.166228442382
              std dev =       0.544035108131
             le_variance =       0.295974198879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636850156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+28, overlap shift 9.5367e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+29, overlap shift 3.8147e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+30, overlap shift 1.5259e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368501591       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.375035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6588e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.247284
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1925e-01
  Total weights = 1.9564e+06
  Execution time = 1.8195e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387913693
  error estimate for blocks of size 2^( 2) =       0.000398075563
  error estimate for blocks of size 2^( 3) =       0.000407289215
  error estimate for blocks of size 2^( 4) =       0.000414249738
  error estimate for blocks of size 2^( 5) =       0.000418470895
  error estimate for blocks of size 2^( 6) =       0.000420079025
  error estimate for blocks of size 2^( 7) =       0.000422370872

      target function =                  N/A
              le_mean =     -17.216840430346
             les_mean =     296.738843236936
             stat err =       0.000418792632
             autocorr =       1.165541775996
              std dev =       0.548592806253
             le_variance =       0.300954067073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387913693
  error estimate for blocks of size 2^( 2) =       0.000398075563
  error estimate for blocks of size 2^( 3) =       0.000407289215
  error estimate for blocks of size 2^( 4) =       0.000414249738
  error estimate for blocks of size 2^( 5) =       0.000418470895
  error estimate for blocks of size 2^( 6) =       0.000420079025
  error estimate for blocks of size 2^( 7) =       0.000422370872

      target function =                  N/A
              le_mean =     -17.216840430346
             les_mean =     296.738843236936
             stat err =       0.000418792632
             autocorr =       1.165541775996
              std dev =       0.548592806253
             le_variance =       0.300954067073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387913693
  error estimate for blocks of size 2^( 2) =       0.000398075563
  error estimate for blocks of size 2^( 3) =       0.000407289215
  error estimate for blocks of size 2^( 4) =       0.000414249738
  error estimate for blocks of size 2^( 5) =       0.000418470895
  error estimate for blocks of size 2^( 6) =       0.000420079025
  error estimate for blocks of size 2^( 7) =       0.000422370872

      target function =                  N/A
              le_mean =     -17.216840430346
             les_mean =     296.738843236936
             stat err =       0.000418792632
             autocorr =       1.165541775996
              std dev =       0.548592806253
             le_variance =       0.300954067073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300969524525
                                         uncertainty =       0.002118674322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387913693
  error estimate for blocks of size 2^( 2) =       0.000398075563
  error estimate for blocks of size 2^( 3) =       0.000407289215
  error estimate for blocks of size 2^( 4) =       0.000414249738
  error estimate for blocks of size 2^( 5) =       0.000418470895
  error estimate for blocks of size 2^( 6) =       0.000420079025
  error estimate for blocks of size 2^( 7) =       0.000422370872

      target function =                  N/A
              le_mean =     -17.216840430346
             les_mean =     296.738843236936
             stat err =       0.000418792632
             autocorr =       1.165541775996
              std dev =       0.548592806253
             le_variance =       0.300954067073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216840430346        initial  <--
     9.5367e+28     9.5367e+29             0.0000e+00       -17.216840430346
     3.8147e+29     3.8147e+30             0.0000e+00       -17.216840430346
     1.5259e+30     1.5259e+31             0.0000e+00       -17.216840430346

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6417
  </log>
  <optVariables href="H2O.s045.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6236e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.523978
====================================================
  Execution time = 2.2688e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1758e-01
  Total weights = 1.956629825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300351293636
                                         uncertainty =       0.001813467294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300351293636
                                         uncertainty =       0.001813467294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387500100
  error estimate for blocks of size 2^( 2) =       0.000397515560
  error estimate for blocks of size 2^( 3) =       0.000406738284
  error estimate for blocks of size 2^( 4) =       0.000413636212
  error estimate for blocks of size 2^( 5) =       0.000418700294
  error estimate for blocks of size 2^( 6) =       0.000421058469
  error estimate for blocks of size 2^( 7) =       0.000420665872

      target function =                  N/A
              le_mean =     -17.217197526960
             les_mean =     296.749473504138
             stat err =       0.000418515212
             autocorr =       1.166484192324
              std dev =       0.548007896839
             le_variance =       0.300312654998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721719752696e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+29, overlap shift 9.5367e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+30, overlap shift 3.8147e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+31, overlap shift 1.5259e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217197527011       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.376320 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8672e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.21695
====================================================
  Execution time = 2.0638e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1666e-01
  Total weights = 1.9566e+06
  Execution time = 1.8236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386606049
  error estimate for blocks of size 2^( 2) =       0.000396717554
  error estimate for blocks of size 2^( 3) =       0.000405668117
  error estimate for blocks of size 2^( 4) =       0.000412379520
  error estimate for blocks of size 2^( 5) =       0.000415346017
  error estimate for blocks of size 2^( 6) =       0.000418194996
  error estimate for blocks of size 2^( 7) =       0.000421307796

      target function =                  N/A
              le_mean =     -17.216234837923
             les_mean =     296.715401247657
             stat err =       0.000416807082
             autocorr =       1.162339214472
              std dev =       0.546743517610
             le_variance =       0.298928474049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386606049
  error estimate for blocks of size 2^( 2) =       0.000396717554
  error estimate for blocks of size 2^( 3) =       0.000405668117
  error estimate for blocks of size 2^( 4) =       0.000412379520
  error estimate for blocks of size 2^( 5) =       0.000415346017
  error estimate for blocks of size 2^( 6) =       0.000418194996
  error estimate for blocks of size 2^( 7) =       0.000421307796

      target function =                  N/A
              le_mean =     -17.216234837923
             les_mean =     296.715401247657
             stat err =       0.000416807082
             autocorr =       1.162339214472
              std dev =       0.546743517610
             le_variance =       0.298928474049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386606049
  error estimate for blocks of size 2^( 2) =       0.000396717554
  error estimate for blocks of size 2^( 3) =       0.000405668117
  error estimate for blocks of size 2^( 4) =       0.000412379520
  error estimate for blocks of size 2^( 5) =       0.000415346017
  error estimate for blocks of size 2^( 6) =       0.000418194996
  error estimate for blocks of size 2^( 7) =       0.000421307796

      target function =                  N/A
              le_mean =     -17.216234837923
             les_mean =     296.715401247657
             stat err =       0.000416807082
             autocorr =       1.162339214472
              std dev =       0.546743517610
             le_variance =       0.298928474049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298968724154
                                         uncertainty =       0.002131565412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386606049
  error estimate for blocks of size 2^( 2) =       0.000396717554
  error estimate for blocks of size 2^( 3) =       0.000405668117
  error estimate for blocks of size 2^( 4) =       0.000412379520
  error estimate for blocks of size 2^( 5) =       0.000415346017
  error estimate for blocks of size 2^( 6) =       0.000418194996
  error estimate for blocks of size 2^( 7) =       0.000421307796

      target function =                  N/A
              le_mean =     -17.216234837923
             les_mean =     296.715401247657
             stat err =       0.000416807082
             autocorr =       1.162339214472
              std dev =       0.546743517610
             le_variance =       0.298928474049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216234837923        initial  <--
     9.5367e+29     9.5367e+30             0.0000e+00       -17.216234837923
     3.8147e+30     3.8147e+31             0.0000e+00       -17.216234837923
     1.5259e+31     1.5259e+32             0.0000e+00       -17.216234837923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8444
  </log>
  <optVariables href="H2O.s046.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8523e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2392
    reference variance = 0.166064
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1627e-01
  Total weights = 1.956552921e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301398570704
                                         uncertainty =       0.002407001435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301398570704
                                         uncertainty =       0.002407001435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388381564
  error estimate for blocks of size 2^( 2) =       0.000398412423
  error estimate for blocks of size 2^( 3) =       0.000407497815
  error estimate for blocks of size 2^( 4) =       0.000414310884
  error estimate for blocks of size 2^( 5) =       0.000419823052
  error estimate for blocks of size 2^( 6) =       0.000422226291
  error estimate for blocks of size 2^( 7) =       0.000424272885

      target function =                  N/A
              le_mean =     -17.216703235255
             les_mean =     296.731136775010
             stat err =       0.000420158278
             autocorr =       1.170330804606
              std dev =       0.549254475232
             le_variance =       0.301680478562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670323526e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+30, overlap shift 9.5367e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+31, overlap shift 3.8147e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+32, overlap shift 1.5259e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703235295       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.377522 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6533e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2786
    reference variance = 0.194365
====================================================
  Execution time = 2.0317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2169e-01
  Total weights = 1.9568e+06
  Execution time = 1.8304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388491388
  error estimate for blocks of size 2^( 2) =       0.000399054045
  error estimate for blocks of size 2^( 3) =       0.000408504020
  error estimate for blocks of size 2^( 4) =       0.000415265888
  error estimate for blocks of size 2^( 5) =       0.000419547788
  error estimate for blocks of size 2^( 6) =       0.000421830177
  error estimate for blocks of size 2^( 7) =       0.000422512215

      target function =                  N/A
              le_mean =     -17.215938585439
             les_mean =     296.710234320055
             stat err =       0.000419789017
             autocorr =       1.167614159576
              std dev =       0.549409789232
             le_variance =       0.301851116504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388491388
  error estimate for blocks of size 2^( 2) =       0.000399054045
  error estimate for blocks of size 2^( 3) =       0.000408504020
  error estimate for blocks of size 2^( 4) =       0.000415265888
  error estimate for blocks of size 2^( 5) =       0.000419547788
  error estimate for blocks of size 2^( 6) =       0.000421830177
  error estimate for blocks of size 2^( 7) =       0.000422512215

      target function =                  N/A
              le_mean =     -17.215938585439
             les_mean =     296.710234320055
             stat err =       0.000419789017
             autocorr =       1.167614159576
              std dev =       0.549409789232
             le_variance =       0.301851116504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388491388
  error estimate for blocks of size 2^( 2) =       0.000399054045
  error estimate for blocks of size 2^( 3) =       0.000408504020
  error estimate for blocks of size 2^( 4) =       0.000415265888
  error estimate for blocks of size 2^( 5) =       0.000419547788
  error estimate for blocks of size 2^( 6) =       0.000421830177
  error estimate for blocks of size 2^( 7) =       0.000422512215

      target function =                  N/A
              le_mean =     -17.215938585439
             les_mean =     296.710234320055
             stat err =       0.000419789017
             autocorr =       1.167614159576
              std dev =       0.549409789232
             le_variance =       0.301851116504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301807050292
                                         uncertainty =       0.002862518498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388491388
  error estimate for blocks of size 2^( 2) =       0.000399054045
  error estimate for blocks of size 2^( 3) =       0.000408504020
  error estimate for blocks of size 2^( 4) =       0.000415265888
  error estimate for blocks of size 2^( 5) =       0.000419547788
  error estimate for blocks of size 2^( 6) =       0.000421830177
  error estimate for blocks of size 2^( 7) =       0.000422512215

      target function =                  N/A
              le_mean =     -17.215938585439
             les_mean =     296.710234320055
             stat err =       0.000419789017
             autocorr =       1.167614159576
              std dev =       0.549409789232
             le_variance =       0.301851116504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215938585439        initial  <--
     9.5367e+30     9.5367e+31             0.0000e+00       -17.215938585439
     3.8147e+31     3.8147e+32             0.0000e+00       -17.215938585439
     1.5259e+32     1.5259e+33             0.0000e+00       -17.215938585439

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5409
  </log>
  <optVariables href="H2O.s047.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6081e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.154
    reference variance = 0.336668
====================================================
  Execution time = 2.0758e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1019e-01
  Total weights = 1.956535607e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100924456
                                         uncertainty =       0.001900307040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296100924456
                                         uncertainty =       0.001900307040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384745026
  error estimate for blocks of size 2^( 2) =       0.000395176038
  error estimate for blocks of size 2^( 3) =       0.000404130173
  error estimate for blocks of size 2^( 4) =       0.000410903372
  error estimate for blocks of size 2^( 5) =       0.000415032738
  error estimate for blocks of size 2^( 6) =       0.000417305055
  error estimate for blocks of size 2^( 7) =       0.000417463404

      target function =                  N/A
              le_mean =     -17.216574585964
             les_mean =     296.720634631349
             stat err =       0.000415176143
             autocorr =       1.164444385106
              std dev =       0.544111633808
             le_variance =       0.296057470045


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657458596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+31, overlap shift 9.5367e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574585977       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574585977       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574585977       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216574585065       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+31 is 3.840900e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+32, overlap shift 3.8147e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574585977       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574585977       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574585997       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+32 is 8.461986e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+33, overlap shift 1.5259e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574585977       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574585977       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574585977       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+33 is 2.400563e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.379146 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6787e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.254127
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1981e-01
  Total weights = 1.9566e+06
  Execution time = 1.8287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388708523
  error estimate for blocks of size 2^( 2) =       0.000398984766
  error estimate for blocks of size 2^( 3) =       0.000408081042
  error estimate for blocks of size 2^( 4) =       0.000414966323
  error estimate for blocks of size 2^( 5) =       0.000418451429
  error estimate for blocks of size 2^( 6) =       0.000421049787
  error estimate for blocks of size 2^( 7) =       0.000420104503

      target function =                  N/A
              le_mean =     -17.216587317348
             les_mean =     296.730687162222
             stat err =       0.000418643011
             autocorr =       1.159950785030
              std dev =       0.549716865076
             le_variance =       0.302188631749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388708523
  error estimate for blocks of size 2^( 2) =       0.000398984766
  error estimate for blocks of size 2^( 3) =       0.000408081042
  error estimate for blocks of size 2^( 4) =       0.000414966323
  error estimate for blocks of size 2^( 5) =       0.000418451429
  error estimate for blocks of size 2^( 6) =       0.000421049787
  error estimate for blocks of size 2^( 7) =       0.000420104503

      target function =                  N/A
              le_mean =     -17.216587317348
             les_mean =     296.730687162222
             stat err =       0.000418643011
             autocorr =       1.159950785030
              std dev =       0.549716865076
             le_variance =       0.302188631749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388708523
  error estimate for blocks of size 2^( 2) =       0.000398984766
  error estimate for blocks of size 2^( 3) =       0.000408081042
  error estimate for blocks of size 2^( 4) =       0.000414966323
  error estimate for blocks of size 2^( 5) =       0.000418451429
  error estimate for blocks of size 2^( 6) =       0.000421049787
  error estimate for blocks of size 2^( 7) =       0.000420104503

      target function =                  N/A
              le_mean =     -17.216587317348
             les_mean =     296.730687162222
             stat err =       0.000418643011
             autocorr =       1.159950785030
              std dev =       0.549716865076
             le_variance =       0.302188631749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302160543278
                                         uncertainty =       0.002330004871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388708523
  error estimate for blocks of size 2^( 2) =       0.000398984766
  error estimate for blocks of size 2^( 3) =       0.000408081042
  error estimate for blocks of size 2^( 4) =       0.000414966323
  error estimate for blocks of size 2^( 5) =       0.000418451429
  error estimate for blocks of size 2^( 6) =       0.000421049787
  error estimate for blocks of size 2^( 7) =       0.000420104503

      target function =                  N/A
              le_mean =     -17.216587317348
             les_mean =     296.730687162222
             stat err =       0.000418643011
             autocorr =       1.159950785030
              std dev =       0.549716865076
             le_variance =       0.302188631749


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216587317348        initial  <--
     9.5367e+31     9.5367e+32             3.8409e-36       -17.216587317348
     3.8147e+32     3.8147e+33             8.4620e-37       -17.216587317348
     1.5259e+33     1.5259e+34             2.4006e-37       -17.216587317348

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6293
  </log>
  <optVariables href="H2O.s048.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6423e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1689
    reference variance = 0.225004
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1387e-01
  Total weights = 1.956553508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300118836064
                                         uncertainty =       0.002214904774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300118836064
                                         uncertainty =       0.002214904774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387340116
  error estimate for blocks of size 2^( 2) =       0.000397623867
  error estimate for blocks of size 2^( 3) =       0.000406616947
  error estimate for blocks of size 2^( 4) =       0.000413989412
  error estimate for blocks of size 2^( 5) =       0.000418816973
  error estimate for blocks of size 2^( 6) =       0.000421760092
  error estimate for blocks of size 2^( 7) =       0.000423579725

      target function =                  N/A
              le_mean =     -17.216856811321
             les_mean =     296.734030113549
             stat err =       0.000419536551
             autocorr =       1.173152980973
              std dev =       0.547781645998
             le_variance =       0.300064731692


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685681132e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+32, overlap shift 9.5367e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+33, overlap shift 3.8147e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+34, overlap shift 1.5259e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856811362       residual = 9.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.380441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6545e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.3495
    reference variance = 4.02935
====================================================
  Execution time = 2.0393e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1140e-01
  Total weights = 1.9567e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250358
  error estimate for blocks of size 2^( 2) =       0.000396231023
  error estimate for blocks of size 2^( 3) =       0.000404674161
  error estimate for blocks of size 2^( 4) =       0.000411380631
  error estimate for blocks of size 2^( 5) =       0.000415444655
  error estimate for blocks of size 2^( 6) =       0.000417180845
  error estimate for blocks of size 2^( 7) =       0.000418247428

      target function =                  N/A
              le_mean =     -17.216464384751
             les_mean =     296.718048285861
             stat err =       0.000415563390
             autocorr =       1.157542035512
              std dev =       0.546240494467
             le_variance =       0.298378677796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250358
  error estimate for blocks of size 2^( 2) =       0.000396231023
  error estimate for blocks of size 2^( 3) =       0.000404674161
  error estimate for blocks of size 2^( 4) =       0.000411380631
  error estimate for blocks of size 2^( 5) =       0.000415444655
  error estimate for blocks of size 2^( 6) =       0.000417180845
  error estimate for blocks of size 2^( 7) =       0.000418247428

      target function =                  N/A
              le_mean =     -17.216464384751
             les_mean =     296.718048285861
             stat err =       0.000415563390
             autocorr =       1.157542035512
              std dev =       0.546240494467
             le_variance =       0.298378677796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250358
  error estimate for blocks of size 2^( 2) =       0.000396231023
  error estimate for blocks of size 2^( 3) =       0.000404674161
  error estimate for blocks of size 2^( 4) =       0.000411380631
  error estimate for blocks of size 2^( 5) =       0.000415444655
  error estimate for blocks of size 2^( 6) =       0.000417180845
  error estimate for blocks of size 2^( 7) =       0.000418247428

      target function =                  N/A
              le_mean =     -17.216464384751
             les_mean =     296.718048285861
             stat err =       0.000415563390
             autocorr =       1.157542035512
              std dev =       0.546240494467
             le_variance =       0.298378677796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298240671183
                                         uncertainty =       0.001667592525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386250358
  error estimate for blocks of size 2^( 2) =       0.000396231023
  error estimate for blocks of size 2^( 3) =       0.000404674161
  error estimate for blocks of size 2^( 4) =       0.000411380631
  error estimate for blocks of size 2^( 5) =       0.000415444655
  error estimate for blocks of size 2^( 6) =       0.000417180845
  error estimate for blocks of size 2^( 7) =       0.000418247428

      target function =                  N/A
              le_mean =     -17.216464384751
             les_mean =     296.718048285861
             stat err =       0.000415563390
             autocorr =       1.157542035512
              std dev =       0.546240494467
             le_variance =       0.298378677796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216464384751        initial  <--
     9.5367e+32     9.5367e+33             0.0000e+00       -17.216464384751
     3.8147e+33     3.8147e+34             0.0000e+00       -17.216464384751
     1.5259e+34     1.5259e+35             0.0000e+00       -17.216464384751

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5896
  </log>
  <optVariables href="H2O.s049.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.160819
====================================================
  Execution time = 2.0482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1505e-01
  Total weights = 1.956792534e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300122662687
                                         uncertainty =       0.002192957591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300122662687
                                         uncertainty =       0.002192957591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387361480
  error estimate for blocks of size 2^( 2) =       0.000397400624
  error estimate for blocks of size 2^( 3) =       0.000405766009
  error estimate for blocks of size 2^( 4) =       0.000411772544
  error estimate for blocks of size 2^( 5) =       0.000416429124
  error estimate for blocks of size 2^( 6) =       0.000419470387
  error estimate for blocks of size 2^( 7) =       0.000417874010

      target function =                  N/A
              le_mean =     -17.215628920953
             les_mean =     296.692926740942
             stat err =       0.000416386516
             autocorr =       1.155474729088
              std dev =       0.547811858671
             le_variance =       0.300097832501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721562892095e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+33, overlap shift 9.5367e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215628921019       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215628921019       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215628862381       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+33 is 3.086163e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+34, overlap shift 3.8147e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215628921019       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215628921019       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215629100800       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+34 is 7.715407e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+35, overlap shift 1.5259e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215628921019       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215628921019       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.381854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6583e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1336
    reference variance = 0.297471
====================================================
  Execution time = 2.0530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2358e-01
  Total weights = 1.9568e+06
  Execution time = 1.8304e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388087099
  error estimate for blocks of size 2^( 2) =       0.000398007950
  error estimate for blocks of size 2^( 3) =       0.000407086775
  error estimate for blocks of size 2^( 4) =       0.000413417680
  error estimate for blocks of size 2^( 5) =       0.000418341073
  error estimate for blocks of size 2^( 6) =       0.000421335940
  error estimate for blocks of size 2^( 7) =       0.000425508133

      target function =                  N/A
              le_mean =     -17.215984293040
             les_mean =     296.713697126630
             stat err =       0.000419650707
             autocorr =       1.169277265055
              std dev =       0.548838038855
             le_variance =       0.301223192895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388087099
  error estimate for blocks of size 2^( 2) =       0.000398007950
  error estimate for blocks of size 2^( 3) =       0.000407086775
  error estimate for blocks of size 2^( 4) =       0.000413417680
  error estimate for blocks of size 2^( 5) =       0.000418341073
  error estimate for blocks of size 2^( 6) =       0.000421335940
  error estimate for blocks of size 2^( 7) =       0.000425508133

      target function =                  N/A
              le_mean =     -17.215984293040
             les_mean =     296.713697126630
             stat err =       0.000419650707
             autocorr =       1.169277265055
              std dev =       0.548838038855
             le_variance =       0.301223192895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388087099
  error estimate for blocks of size 2^( 2) =       0.000398007950
  error estimate for blocks of size 2^( 3) =       0.000407086775
  error estimate for blocks of size 2^( 4) =       0.000413417680
  error estimate for blocks of size 2^( 5) =       0.000418341073
  error estimate for blocks of size 2^( 6) =       0.000421335940
  error estimate for blocks of size 2^( 7) =       0.000425508133

      target function =                  N/A
              le_mean =     -17.215984293040
             les_mean =     296.713697126630
             stat err =       0.000419650707
             autocorr =       1.169277265055
              std dev =       0.548838038855
             le_variance =       0.301223192895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301252050316
                                         uncertainty =       0.002128918675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388087099
  error estimate for blocks of size 2^( 2) =       0.000398007950
  error estimate for blocks of size 2^( 3) =       0.000407086775
  error estimate for blocks of size 2^( 4) =       0.000413417680
  error estimate for blocks of size 2^( 5) =       0.000418341073
  error estimate for blocks of size 2^( 6) =       0.000421335940
  error estimate for blocks of size 2^( 7) =       0.000425508133

      target function =                  N/A
              le_mean =     -17.215984293040
             les_mean =     296.713697126630
             stat err =       0.000419650707
             autocorr =       1.169277265055
              std dev =       0.548838038855
             le_variance =       0.301223192895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215984293040        initial  <--
     9.5367e+33     9.5367e+34             3.0862e-38       -17.215984293040
     3.8147e+34     3.8147e+35             7.7154e-39       -17.215984293040
     1.5259e+35     1.5259e+36             0.0000e+00       -17.215984293040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7586
  </log>
  <optVariables href="H2O.s050.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1797
    reference variance = 0.248384
====================================================
  Execution time = 2.0815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1030e-01
  Total weights = 1.956743150e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297188135096
                                         uncertainty =       0.001983807017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297188135096
                                         uncertainty =       0.001983807017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385441572
  error estimate for blocks of size 2^( 2) =       0.000395524692
  error estimate for blocks of size 2^( 3) =       0.000404404388
  error estimate for blocks of size 2^( 4) =       0.000410890623
  error estimate for blocks of size 2^( 5) =       0.000414321148
  error estimate for blocks of size 2^( 6) =       0.000416486988
  error estimate for blocks of size 2^( 7) =       0.000415925817

      target function =                  N/A
              le_mean =     -17.217472651913
             les_mean =     296.751660616966
             stat err =       0.000414406144
             autocorr =       1.155939922160
              std dev =       0.545096699050
             le_variance =       0.297130411315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721747265191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+34, overlap shift 9.5367e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+35, overlap shift 3.8147e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+36, overlap shift 1.5259e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217472651976       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.383089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6895e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.19384
====================================================
  Execution time = 2.2931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1460e-01
  Total weights = 1.9564e+06
  Execution time = 1.8157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519505
  error estimate for blocks of size 2^( 2) =       0.000397309758
  error estimate for blocks of size 2^( 3) =       0.000406272079
  error estimate for blocks of size 2^( 4) =       0.000412851637
  error estimate for blocks of size 2^( 5) =       0.000416728823
  error estimate for blocks of size 2^( 6) =       0.000420481815
  error estimate for blocks of size 2^( 7) =       0.000421345497

      target function =                  N/A
              le_mean =     -17.216229322906
             les_mean =     296.713150416446
             stat err =       0.000417851943
             autocorr =       1.162673348393
              std dev =       0.548035340288
             le_variance =       0.300342734204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519505
  error estimate for blocks of size 2^( 2) =       0.000397309758
  error estimate for blocks of size 2^( 3) =       0.000406272079
  error estimate for blocks of size 2^( 4) =       0.000412851637
  error estimate for blocks of size 2^( 5) =       0.000416728823
  error estimate for blocks of size 2^( 6) =       0.000420481815
  error estimate for blocks of size 2^( 7) =       0.000421345497

      target function =                  N/A
              le_mean =     -17.216229322906
             les_mean =     296.713150416446
             stat err =       0.000417851943
             autocorr =       1.162673348393
              std dev =       0.548035340288
             le_variance =       0.300342734204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519505
  error estimate for blocks of size 2^( 2) =       0.000397309758
  error estimate for blocks of size 2^( 3) =       0.000406272079
  error estimate for blocks of size 2^( 4) =       0.000412851637
  error estimate for blocks of size 2^( 5) =       0.000416728823
  error estimate for blocks of size 2^( 6) =       0.000420481815
  error estimate for blocks of size 2^( 7) =       0.000421345497

      target function =                  N/A
              le_mean =     -17.216229322906
             les_mean =     296.713150416446
             stat err =       0.000417851943
             autocorr =       1.162673348393
              std dev =       0.548035340288
             le_variance =       0.300342734204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300410510720
                                         uncertainty =       0.002114832784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387519505
  error estimate for blocks of size 2^( 2) =       0.000397309758
  error estimate for blocks of size 2^( 3) =       0.000406272079
  error estimate for blocks of size 2^( 4) =       0.000412851637
  error estimate for blocks of size 2^( 5) =       0.000416728823
  error estimate for blocks of size 2^( 6) =       0.000420481815
  error estimate for blocks of size 2^( 7) =       0.000421345497

      target function =                  N/A
              le_mean =     -17.216229322906
             les_mean =     296.713150416446
             stat err =       0.000417851943
             autocorr =       1.162673348393
              std dev =       0.548035340288
             le_variance =       0.300342734204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216229322906        initial  <--
     9.5367e+34     9.5367e+35             0.0000e+00       -17.216229322906
     3.8147e+35     3.8147e+36             0.0000e+00       -17.216229322906
     1.5259e+36     1.5259e+37             0.0000e+00       -17.216229322906

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1007
  </log>
  <optVariables href="H2O.s051.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.3096
    reference variance = 0.374883
====================================================
  Execution time = 2.0528e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1680e-01
  Total weights = 1.956481001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301649970287
                                         uncertainty =       0.002882570352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301649970287
                                         uncertainty =       0.002882570352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388407278
  error estimate for blocks of size 2^( 2) =       0.000398326626
  error estimate for blocks of size 2^( 3) =       0.000407199554
  error estimate for blocks of size 2^( 4) =       0.000414014704
  error estimate for blocks of size 2^( 5) =       0.000418324501
  error estimate for blocks of size 2^( 6) =       0.000420690940
  error estimate for blocks of size 2^( 7) =       0.000421058824

      target function =                  N/A
              le_mean =     -17.216464342306
             les_mean =     296.723447873233
             stat err =       0.000418522242
             autocorr =       1.161080598635
              std dev =       0.549290840715
             le_variance =       0.301720427694


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646434231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+35, overlap shift 9.5367e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464342338       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464342338       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464342338       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461181641       residual = 6.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461181641       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+35 is 4.001961e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+36, overlap shift 3.8147e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464342338       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464342338       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464342338       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461181641       residual = 6.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461181641       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+36 is 1.000490e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+37, overlap shift 1.5259e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216464342338       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216464342338       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464342338       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430664062       residual = 6.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+37 is 2.501225e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.385163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6553e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.252
    reference variance = 0.164312
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1236e-01
  Total weights = 1.9562e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385276921
  error estimate for blocks of size 2^( 2) =       0.000395363967
  error estimate for blocks of size 2^( 3) =       0.000404692958
  error estimate for blocks of size 2^( 4) =       0.000411333558
  error estimate for blocks of size 2^( 5) =       0.000415040369
  error estimate for blocks of size 2^( 6) =       0.000417818342
  error estimate for blocks of size 2^( 7) =       0.000418538937

      target function =                  N/A
              le_mean =     -17.215516570973
             les_mean =     296.686373008418
             stat err =       0.000415682802
             autocorr =       1.164067393597
              std dev =       0.544863846620
             le_variance =       0.296876611354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385276921
  error estimate for blocks of size 2^( 2) =       0.000395363967
  error estimate for blocks of size 2^( 3) =       0.000404692958
  error estimate for blocks of size 2^( 4) =       0.000411333558
  error estimate for blocks of size 2^( 5) =       0.000415040369
  error estimate for blocks of size 2^( 6) =       0.000417818342
  error estimate for blocks of size 2^( 7) =       0.000418538937

      target function =                  N/A
              le_mean =     -17.215516570973
             les_mean =     296.686373008418
             stat err =       0.000415682802
             autocorr =       1.164067393597
              std dev =       0.544863846620
             le_variance =       0.296876611354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385276921
  error estimate for blocks of size 2^( 2) =       0.000395363967
  error estimate for blocks of size 2^( 3) =       0.000404692958
  error estimate for blocks of size 2^( 4) =       0.000411333558
  error estimate for blocks of size 2^( 5) =       0.000415040369
  error estimate for blocks of size 2^( 6) =       0.000417818342
  error estimate for blocks of size 2^( 7) =       0.000418538937

      target function =                  N/A
              le_mean =     -17.215516570973
             les_mean =     296.686373008418
             stat err =       0.000415682802
             autocorr =       1.164067393597
              std dev =       0.544863846620
             le_variance =       0.296876611354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296917863939
                                         uncertainty =       0.002249993920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385276921
  error estimate for blocks of size 2^( 2) =       0.000395363967
  error estimate for blocks of size 2^( 3) =       0.000404692958
  error estimate for blocks of size 2^( 4) =       0.000411333558
  error estimate for blocks of size 2^( 5) =       0.000415040369
  error estimate for blocks of size 2^( 6) =       0.000417818342
  error estimate for blocks of size 2^( 7) =       0.000418538937

      target function =                  N/A
              le_mean =     -17.215516570973
             les_mean =     296.686373008418
             stat err =       0.000415682802
             autocorr =       1.164067393597
              std dev =       0.544863846620
             le_variance =       0.296876611354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215516570973        initial  <--
     9.5367e+35     9.5367e+36             4.0020e-40       -17.215516570973
     3.8147e+36     3.8147e+37             1.0005e-40       -17.215516570973
     1.5259e+37     1.5259e+38             2.5012e-41       -17.215516570973

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7017
  </log>
  <optVariables href="H2O.s052.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2502
    reference variance = 0.229235
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1317e-01
  Total weights = 1.956324223e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298880816189
                                         uncertainty =       0.001893619708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298880816189
                                         uncertainty =       0.001893619708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386610547
  error estimate for blocks of size 2^( 2) =       0.000396360628
  error estimate for blocks of size 2^( 3) =       0.000405649109
  error estimate for blocks of size 2^( 4) =       0.000412480418
  error estimate for blocks of size 2^( 5) =       0.000417585582
  error estimate for blocks of size 2^( 6) =       0.000418852873
  error estimate for blocks of size 2^( 7) =       0.000419885894

      target function =                  N/A
              le_mean =     -17.216748802202
             les_mean =     296.729611977930
             stat err =       0.000417201192
             autocorr =       1.164511239582
              std dev =       0.546749879325
             le_variance =       0.298935430542


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674880220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+36, overlap shift 9.5367e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216748802230       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216748802230       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216748802230       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216751098633       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+36 is 4.007701e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+37, overlap shift 3.8147e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216748802230       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216748802230       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216748802230       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216735839844       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+37 is 1.001925e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+38, overlap shift 1.5259e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216748802230       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216748802230       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216748802230       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216735839844       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+38 is 2.504813e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.386971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6753e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2611
    reference variance = 0.240673
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 1.9566e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386695687
  error estimate for blocks of size 2^( 2) =       0.000397086548
  error estimate for blocks of size 2^( 3) =       0.000405824715
  error estimate for blocks of size 2^( 4) =       0.000412931287
  error estimate for blocks of size 2^( 5) =       0.000416566986
  error estimate for blocks of size 2^( 6) =       0.000419050780
  error estimate for blocks of size 2^( 7) =       0.000419101369

      target function =                  N/A
              le_mean =     -17.215695408702
             les_mean =     296.693689147605
             stat err =       0.000416912606
             autocorr =       1.162388745222
              std dev =       0.546870285248
             le_variance =       0.299067108887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386695687
  error estimate for blocks of size 2^( 2) =       0.000397086548
  error estimate for blocks of size 2^( 3) =       0.000405824715
  error estimate for blocks of size 2^( 4) =       0.000412931287
  error estimate for blocks of size 2^( 5) =       0.000416566986
  error estimate for blocks of size 2^( 6) =       0.000419050780
  error estimate for blocks of size 2^( 7) =       0.000419101369

      target function =                  N/A
              le_mean =     -17.215695408702
             les_mean =     296.693689147605
             stat err =       0.000416912606
             autocorr =       1.162388745222
              std dev =       0.546870285248
             le_variance =       0.299067108887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386695687
  error estimate for blocks of size 2^( 2) =       0.000397086548
  error estimate for blocks of size 2^( 3) =       0.000405824715
  error estimate for blocks of size 2^( 4) =       0.000412931287
  error estimate for blocks of size 2^( 5) =       0.000416566986
  error estimate for blocks of size 2^( 6) =       0.000419050780
  error estimate for blocks of size 2^( 7) =       0.000419101369

      target function =                  N/A
              le_mean =     -17.215695408702
             les_mean =     296.693689147605
             stat err =       0.000416912606
             autocorr =       1.162388745222
              std dev =       0.546870285248
             le_variance =       0.299067108887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299133832783
                                         uncertainty =       0.002239559068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386695687
  error estimate for blocks of size 2^( 2) =       0.000397086548
  error estimate for blocks of size 2^( 3) =       0.000405824715
  error estimate for blocks of size 2^( 4) =       0.000412931287
  error estimate for blocks of size 2^( 5) =       0.000416566986
  error estimate for blocks of size 2^( 6) =       0.000419050780
  error estimate for blocks of size 2^( 7) =       0.000419101369

      target function =                  N/A
              le_mean =     -17.215695408702
             les_mean =     296.693689147605
             stat err =       0.000416912606
             autocorr =       1.162388745222
              std dev =       0.546870285248
             le_variance =       0.299067108887


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215695408702        initial  <--
     9.5367e+36     9.5367e+37             4.0077e-41       -17.215695408702
     3.8147e+37     3.8147e+38             1.0019e-41       -17.215695408702
     1.5259e+38     1.5259e+39             2.5048e-42       -17.215695408702

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6585
  </log>
  <optVariables href="H2O.s053.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.362478
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1549e-01
  Total weights = 1.956628747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301785467080
                                         uncertainty =       0.004078026043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301785467080
                                         uncertainty =       0.004078026043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388385023
  error estimate for blocks of size 2^( 2) =       0.000398409962
  error estimate for blocks of size 2^( 3) =       0.000407294685
  error estimate for blocks of size 2^( 4) =       0.000413837918
  error estimate for blocks of size 2^( 5) =       0.000418812608
  error estimate for blocks of size 2^( 6) =       0.000420798354
  error estimate for blocks of size 2^( 7) =       0.000424490700

      target function =                  N/A
              le_mean =     -17.216379256398
             les_mean =     296.719204675812
             stat err =       0.000419484895
             autocorr =       1.166561679314
              std dev =       0.549259367237
             le_variance =       0.301685852498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637925640e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+37, overlap shift 9.5367e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+38, overlap shift 3.8147e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+39, overlap shift 1.5259e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379256441       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.388285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6570e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1829
    reference variance = 0.188062
====================================================
  Execution time = 2.0402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1429e-01
  Total weights = 1.9566e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618786
  error estimate for blocks of size 2^( 2) =       0.000397994820
  error estimate for blocks of size 2^( 3) =       0.000406982135
  error estimate for blocks of size 2^( 4) =       0.000413492734
  error estimate for blocks of size 2^( 5) =       0.000418181965
  error estimate for blocks of size 2^( 6) =       0.000420914882
  error estimate for blocks of size 2^( 7) =       0.000422314875

      target function =                  N/A
              le_mean =     -17.216707435553
             les_mean =     296.729304004297
             stat err =       0.000418726114
             autocorr =       1.166945193218
              std dev =       0.548175744111
             le_variance =       0.300496646432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618786
  error estimate for blocks of size 2^( 2) =       0.000397994820
  error estimate for blocks of size 2^( 3) =       0.000406982135
  error estimate for blocks of size 2^( 4) =       0.000413492734
  error estimate for blocks of size 2^( 5) =       0.000418181965
  error estimate for blocks of size 2^( 6) =       0.000420914882
  error estimate for blocks of size 2^( 7) =       0.000422314875

      target function =                  N/A
              le_mean =     -17.216707435553
             les_mean =     296.729304004297
             stat err =       0.000418726114
             autocorr =       1.166945193218
              std dev =       0.548175744111
             le_variance =       0.300496646432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618786
  error estimate for blocks of size 2^( 2) =       0.000397994820
  error estimate for blocks of size 2^( 3) =       0.000406982135
  error estimate for blocks of size 2^( 4) =       0.000413492734
  error estimate for blocks of size 2^( 5) =       0.000418181965
  error estimate for blocks of size 2^( 6) =       0.000420914882
  error estimate for blocks of size 2^( 7) =       0.000422314875

      target function =                  N/A
              le_mean =     -17.216707435553
             les_mean =     296.729304004297
             stat err =       0.000418726114
             autocorr =       1.166945193218
              std dev =       0.548175744111
             le_variance =       0.300496646432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300498925662
                                         uncertainty =       0.002155468162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387618786
  error estimate for blocks of size 2^( 2) =       0.000397994820
  error estimate for blocks of size 2^( 3) =       0.000406982135
  error estimate for blocks of size 2^( 4) =       0.000413492734
  error estimate for blocks of size 2^( 5) =       0.000418181965
  error estimate for blocks of size 2^( 6) =       0.000420914882
  error estimate for blocks of size 2^( 7) =       0.000422314875

      target function =                  N/A
              le_mean =     -17.216707435553
             les_mean =     296.729304004297
             stat err =       0.000418726114
             autocorr =       1.166945193218
              std dev =       0.548175744111
             le_variance =       0.300496646432


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216707435553        initial  <--
     9.5367e+37     9.5367e+38             0.0000e+00       -17.216707435553
     3.8147e+38     3.8147e+39             0.0000e+00       -17.216707435553
     1.5259e+39     1.5259e+40             0.0000e+00       -17.216707435553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6600
  </log>
  <optVariables href="H2O.s054.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1652
    reference variance = 0.59097
====================================================
  Execution time = 2.0749e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1734e-01
  Total weights = 1.956663275e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299063210008
                                         uncertainty =       0.001797190823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299063210008
                                         uncertainty =       0.001797190823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386713442
  error estimate for blocks of size 2^( 2) =       0.000396617950
  error estimate for blocks of size 2^( 3) =       0.000405386171
  error estimate for blocks of size 2^( 4) =       0.000412600959
  error estimate for blocks of size 2^( 5) =       0.000417507411
  error estimate for blocks of size 2^( 6) =       0.000418943342
  error estimate for blocks of size 2^( 7) =       0.000420026068

      target function =                  N/A
              le_mean =     -17.215436111307
             les_mean =     296.688584416711
             stat err =       0.000417269445
             autocorr =       1.164272482653
              std dev =       0.546895393729
             le_variance =       0.299094571682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721543611131e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+38, overlap shift 9.5367e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+39, overlap shift 3.8147e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+40, overlap shift 1.5259e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215436111350       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.389524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6777e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2493
    reference variance = 0.33494
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1247e-01
  Total weights = 1.9566e+06
  Execution time = 1.8254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386506021
  error estimate for blocks of size 2^( 2) =       0.000396405500
  error estimate for blocks of size 2^( 3) =       0.000405390002
  error estimate for blocks of size 2^( 4) =       0.000412066375
  error estimate for blocks of size 2^( 5) =       0.000416167172
  error estimate for blocks of size 2^( 6) =       0.000418340525
  error estimate for blocks of size 2^( 7) =       0.000420369154

      target function =                  N/A
              le_mean =     -17.215908616079
             les_mean =     296.699978125481
             stat err =       0.000416735807
             autocorr =       1.162543217726
              std dev =       0.546602056929
             le_variance =       0.298773808640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386506021
  error estimate for blocks of size 2^( 2) =       0.000396405500
  error estimate for blocks of size 2^( 3) =       0.000405390002
  error estimate for blocks of size 2^( 4) =       0.000412066375
  error estimate for blocks of size 2^( 5) =       0.000416167172
  error estimate for blocks of size 2^( 6) =       0.000418340525
  error estimate for blocks of size 2^( 7) =       0.000420369154

      target function =                  N/A
              le_mean =     -17.215908616079
             les_mean =     296.699978125481
             stat err =       0.000416735807
             autocorr =       1.162543217726
              std dev =       0.546602056929
             le_variance =       0.298773808640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386506021
  error estimate for blocks of size 2^( 2) =       0.000396405500
  error estimate for blocks of size 2^( 3) =       0.000405390002
  error estimate for blocks of size 2^( 4) =       0.000412066375
  error estimate for blocks of size 2^( 5) =       0.000416167172
  error estimate for blocks of size 2^( 6) =       0.000418340525
  error estimate for blocks of size 2^( 7) =       0.000420369154

      target function =                  N/A
              le_mean =     -17.215908616079
             les_mean =     296.699978125481
             stat err =       0.000416735807
             autocorr =       1.162543217726
              std dev =       0.546602056929
             le_variance =       0.298773808640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298836457596
                                         uncertainty =       0.002237763589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386506021
  error estimate for blocks of size 2^( 2) =       0.000396405500
  error estimate for blocks of size 2^( 3) =       0.000405390002
  error estimate for blocks of size 2^( 4) =       0.000412066375
  error estimate for blocks of size 2^( 5) =       0.000416167172
  error estimate for blocks of size 2^( 6) =       0.000418340525
  error estimate for blocks of size 2^( 7) =       0.000420369154

      target function =                  N/A
              le_mean =     -17.215908616079
             les_mean =     296.699978125481
             stat err =       0.000416735807
             autocorr =       1.162543217726
              std dev =       0.546602056929
             le_variance =       0.298773808640


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215908616079        initial  <--
     9.5367e+38     9.5367e+39             0.0000e+00       -17.215908616079
     3.8147e+39     3.8147e+40             0.0000e+00       -17.215908616079
     1.5259e+40     1.5259e+41             0.0000e+00       -17.215908616079

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9410
  </log>
  <optVariables href="H2O.s055.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1832
    reference variance = 0.131592
====================================================
  Execution time = 2.0584e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1206e-01
  Total weights = 1.956470955e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298319645869
                                         uncertainty =       0.001903531212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298319645869
                                         uncertainty =       0.001903531212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386195504
  error estimate for blocks of size 2^( 2) =       0.000396541064
  error estimate for blocks of size 2^( 3) =       0.000405721209
  error estimate for blocks of size 2^( 4) =       0.000412671974
  error estimate for blocks of size 2^( 5) =       0.000417083049
  error estimate for blocks of size 2^( 6) =       0.000418831121
  error estimate for blocks of size 2^( 7) =       0.000420072353

      target function =                  N/A
              le_mean =     -17.216477577371
             les_mean =     296.719158200899
             stat err =       0.000417164624
             autocorr =       1.166811008284
              std dev =       0.546162920093
             le_variance =       0.298293935284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647757737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+39, overlap shift 9.5367e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+40, overlap shift 3.8147e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+41, overlap shift 1.5259e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477577388       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.390767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6832e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.212
    reference variance = 0.211358
====================================================
  Execution time = 2.1809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1041e-01
  Total weights = 1.9567e+06
  Execution time = 2.1794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385546678
  error estimate for blocks of size 2^( 2) =       0.000395601044
  error estimate for blocks of size 2^( 3) =       0.000404783699
  error estimate for blocks of size 2^( 4) =       0.000411710958
  error estimate for blocks of size 2^( 5) =       0.000414915776
  error estimate for blocks of size 2^( 6) =       0.000417992005
  error estimate for blocks of size 2^( 7) =       0.000417162845

      target function =                  N/A
              le_mean =     -17.216137528203
             les_mean =     296.705800058547
             stat err =       0.000415445396
             autocorr =       1.161111619001
              std dev =       0.545245340473
             le_variance =       0.297292481308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385546678
  error estimate for blocks of size 2^( 2) =       0.000395601044
  error estimate for blocks of size 2^( 3) =       0.000404783699
  error estimate for blocks of size 2^( 4) =       0.000411710958
  error estimate for blocks of size 2^( 5) =       0.000414915776
  error estimate for blocks of size 2^( 6) =       0.000417992005
  error estimate for blocks of size 2^( 7) =       0.000417162845

      target function =                  N/A
              le_mean =     -17.216137528203
             les_mean =     296.705800058547
             stat err =       0.000415445396
             autocorr =       1.161111619001
              std dev =       0.545245340473
             le_variance =       0.297292481308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385546678
  error estimate for blocks of size 2^( 2) =       0.000395601044
  error estimate for blocks of size 2^( 3) =       0.000404783699
  error estimate for blocks of size 2^( 4) =       0.000411710958
  error estimate for blocks of size 2^( 5) =       0.000414915776
  error estimate for blocks of size 2^( 6) =       0.000417992005
  error estimate for blocks of size 2^( 7) =       0.000417162845

      target function =                  N/A
              le_mean =     -17.216137528203
             les_mean =     296.705800058547
             stat err =       0.000415445396
             autocorr =       1.161111619001
              std dev =       0.545245340473
             le_variance =       0.297292481308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297246143440
                                         uncertainty =       0.001673024960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385546678
  error estimate for blocks of size 2^( 2) =       0.000395601044
  error estimate for blocks of size 2^( 3) =       0.000404783699
  error estimate for blocks of size 2^( 4) =       0.000411710958
  error estimate for blocks of size 2^( 5) =       0.000414915776
  error estimate for blocks of size 2^( 6) =       0.000417992005
  error estimate for blocks of size 2^( 7) =       0.000417162845

      target function =                  N/A
              le_mean =     -17.216137528203
             les_mean =     296.705800058547
             stat err =       0.000415445396
             autocorr =       1.161111619001
              std dev =       0.545245340473
             le_variance =       0.297292481308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216137528203        initial  <--
     9.5367e+39     9.5367e+40             0.0000e+00       -17.216137528203
     3.8147e+40     3.8147e+41             0.0000e+00       -17.216137528203
     1.5259e+41     1.5259e+42             0.0000e+00       -17.216137528203

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3513
  </log>
  <optVariables href="H2O.s056.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2929
    reference variance = 0.435618
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1317e-01
  Total weights = 1.956491022e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298398182096
                                         uncertainty =       0.002467624897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298398182096
                                         uncertainty =       0.002467624897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386299253
  error estimate for blocks of size 2^( 2) =       0.000396547786
  error estimate for blocks of size 2^( 3) =       0.000405351231
  error estimate for blocks of size 2^( 4) =       0.000411905077
  error estimate for blocks of size 2^( 5) =       0.000417047640
  error estimate for blocks of size 2^( 6) =       0.000419474416
  error estimate for blocks of size 2^( 7) =       0.000421246328

      target function =                  N/A
              le_mean =     -17.215917052598
             les_mean =     296.700974813445
             stat err =       0.000417418365
             autocorr =       1.167603447235
              std dev =       0.546309643095
             le_variance =       0.298454226138


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721591705260e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+40, overlap shift 9.5367e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+41, overlap shift 3.8147e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+42, overlap shift 1.5259e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215917052623       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.392014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6526e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1376
    reference variance = 0.809059
====================================================
  Execution time = 2.0407e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1295e-01
  Total weights = 1.9567e+06
  Execution time = 1.8316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387078994
  error estimate for blocks of size 2^( 2) =       0.000397105406
  error estimate for blocks of size 2^( 3) =       0.000406133434
  error estimate for blocks of size 2^( 4) =       0.000413069670
  error estimate for blocks of size 2^( 5) =       0.000417372152
  error estimate for blocks of size 2^( 6) =       0.000420585501
  error estimate for blocks of size 2^( 7) =       0.000422516250

      target function =                  N/A
              le_mean =     -17.216169418489
             les_mean =     296.709439396153
             stat err =       0.000418385893
             autocorr =       1.168301297964
              std dev =       0.547412362765
             le_variance =       0.299660294908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387078994
  error estimate for blocks of size 2^( 2) =       0.000397105406
  error estimate for blocks of size 2^( 3) =       0.000406133434
  error estimate for blocks of size 2^( 4) =       0.000413069670
  error estimate for blocks of size 2^( 5) =       0.000417372152
  error estimate for blocks of size 2^( 6) =       0.000420585501
  error estimate for blocks of size 2^( 7) =       0.000422516250

      target function =                  N/A
              le_mean =     -17.216169418489
             les_mean =     296.709439396153
             stat err =       0.000418385893
             autocorr =       1.168301297964
              std dev =       0.547412362765
             le_variance =       0.299660294908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387078994
  error estimate for blocks of size 2^( 2) =       0.000397105406
  error estimate for blocks of size 2^( 3) =       0.000406133434
  error estimate for blocks of size 2^( 4) =       0.000413069670
  error estimate for blocks of size 2^( 5) =       0.000417372152
  error estimate for blocks of size 2^( 6) =       0.000420585501
  error estimate for blocks of size 2^( 7) =       0.000422516250

      target function =                  N/A
              le_mean =     -17.216169418489
             les_mean =     296.709439396153
             stat err =       0.000418385893
             autocorr =       1.168301297964
              std dev =       0.547412362765
             le_variance =       0.299660294908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299641608980
                                         uncertainty =       0.001876236557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387078994
  error estimate for blocks of size 2^( 2) =       0.000397105406
  error estimate for blocks of size 2^( 3) =       0.000406133434
  error estimate for blocks of size 2^( 4) =       0.000413069670
  error estimate for blocks of size 2^( 5) =       0.000417372152
  error estimate for blocks of size 2^( 6) =       0.000420585501
  error estimate for blocks of size 2^( 7) =       0.000422516250

      target function =                  N/A
              le_mean =     -17.216169418489
             les_mean =     296.709439396153
             stat err =       0.000418385893
             autocorr =       1.168301297964
              std dev =       0.547412362765
             le_variance =       0.299660294908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216169418489        initial  <--
     9.5367e+40     9.5367e+41             0.0000e+00       -17.216169418489
     3.8147e+41     3.8147e+42             0.0000e+00       -17.216169418489
     1.5259e+42     1.5259e+43             0.0000e+00       -17.216169418489

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6430
  </log>
  <optVariables href="H2O.s057.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1771
    reference variance = 0.275861
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1324e-01
  Total weights = 1.956758368e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299363106853
                                         uncertainty =       0.002029992617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299363106853
                                         uncertainty =       0.002029992617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386849182
  error estimate for blocks of size 2^( 2) =       0.000397007013
  error estimate for blocks of size 2^( 3) =       0.000405877320
  error estimate for blocks of size 2^( 4) =       0.000413133678
  error estimate for blocks of size 2^( 5) =       0.000418318474
  error estimate for blocks of size 2^( 6) =       0.000422244739
  error estimate for blocks of size 2^( 7) =       0.000424273692

      target function =                  N/A
              le_mean =     -17.216496433323
             les_mean =     296.720993459101
             stat err =       0.000419492646
             autocorr =       1.175886318634
              std dev =       0.547087359404
             le_variance =       0.299304578819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649643332e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+41, overlap shift 9.5367e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496433357       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496433357       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216796875000       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+41 is 4.174808e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+42, overlap shift 3.8147e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496433357       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496433357       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214843750000       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216496433357       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+42 is 1.043702e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+43, overlap shift 1.5259e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496433357       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496433357       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 9.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+43 is 2.609255e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.393715 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6682e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1722
    reference variance = 0.166685
====================================================
  Execution time = 2.0511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1068e-01
  Total weights = 1.9565e+06
  Execution time = 1.8274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385498940
  error estimate for blocks of size 2^( 2) =       0.000395279381
  error estimate for blocks of size 2^( 3) =       0.000404221253
  error estimate for blocks of size 2^( 4) =       0.000410916808
  error estimate for blocks of size 2^( 5) =       0.000415915770
  error estimate for blocks of size 2^( 6) =       0.000417884026
  error estimate for blocks of size 2^( 7) =       0.000420277989

      target function =                  N/A
              le_mean =     -17.216206312683
             les_mean =     296.708443663020
             stat err =       0.000416248648
             autocorr =       1.165894610481
              std dev =       0.545177829905
             le_variance =       0.297218866220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385498940
  error estimate for blocks of size 2^( 2) =       0.000395279381
  error estimate for blocks of size 2^( 3) =       0.000404221253
  error estimate for blocks of size 2^( 4) =       0.000410916808
  error estimate for blocks of size 2^( 5) =       0.000415915770
  error estimate for blocks of size 2^( 6) =       0.000417884026
  error estimate for blocks of size 2^( 7) =       0.000420277989

      target function =                  N/A
              le_mean =     -17.216206312683
             les_mean =     296.708443663020
             stat err =       0.000416248648
             autocorr =       1.165894610481
              std dev =       0.545177829905
             le_variance =       0.297218866220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385498940
  error estimate for blocks of size 2^( 2) =       0.000395279381
  error estimate for blocks of size 2^( 3) =       0.000404221253
  error estimate for blocks of size 2^( 4) =       0.000410916808
  error estimate for blocks of size 2^( 5) =       0.000415915770
  error estimate for blocks of size 2^( 6) =       0.000417884026
  error estimate for blocks of size 2^( 7) =       0.000420277989

      target function =                  N/A
              le_mean =     -17.216206312683
             les_mean =     296.708443663020
             stat err =       0.000416248648
             autocorr =       1.165894610481
              std dev =       0.545177829905
             le_variance =       0.297218866220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297218324185
                                         uncertainty =       0.001792262629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385498940
  error estimate for blocks of size 2^( 2) =       0.000395279381
  error estimate for blocks of size 2^( 3) =       0.000404221253
  error estimate for blocks of size 2^( 4) =       0.000410916808
  error estimate for blocks of size 2^( 5) =       0.000415915770
  error estimate for blocks of size 2^( 6) =       0.000417884026
  error estimate for blocks of size 2^( 7) =       0.000420277989

      target function =                  N/A
              le_mean =     -17.216206312683
             les_mean =     296.708443663020
             stat err =       0.000416248648
             autocorr =       1.165894610481
              std dev =       0.545177829905
             le_variance =       0.297218866220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216206312683        initial  <--
     9.5367e+41     9.5367e+42             4.1748e-46       -17.216206312683
     3.8147e+42     3.8147e+43             1.0437e-46       -17.216206312683
     1.5259e+43     1.5259e+44             2.6093e-47       -17.216206312683

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7277
  </log>
  <optVariables href="H2O.s058.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1711
    reference variance = 0.255159
====================================================
  Execution time = 2.0581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5312e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1797e-01
  Total weights = 1.956621880e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300220723346
                                         uncertainty =       0.001809162546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300220723346
                                         uncertainty =       0.001809162546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387455658
  error estimate for blocks of size 2^( 2) =       0.000397322822
  error estimate for blocks of size 2^( 3) =       0.000406025353
  error estimate for blocks of size 2^( 4) =       0.000413091173
  error estimate for blocks of size 2^( 5) =       0.000418658365
  error estimate for blocks of size 2^( 6) =       0.000420806759
  error estimate for blocks of size 2^( 7) =       0.000422363316

      target function =                  N/A
              le_mean =     -17.215967613422
             les_mean =     296.707511369616
             stat err =       0.000418729903
             autocorr =       1.167949159738
              std dev =       0.547945046956
             le_variance =       0.300243774484


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721596761342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+42, overlap shift 9.5367e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967613455       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215967613455       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215967613455       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+42 is 5.386326e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+43, overlap shift 3.8147e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967613455       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215967613455       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.187500000000       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+43 is 1.346581e-47

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+44, overlap shift 1.5259e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215967613455       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215967613455       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215967613455       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+44 is 3.366453e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.395296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6650e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1378
    reference variance = 0.289224
====================================================
  Execution time = 2.0255e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1481e-01
  Total weights = 1.9564e+06
  Execution time = 1.8224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385844674
  error estimate for blocks of size 2^( 2) =       0.000395891865
  error estimate for blocks of size 2^( 3) =       0.000405062648
  error estimate for blocks of size 2^( 4) =       0.000411455545
  error estimate for blocks of size 2^( 5) =       0.000416345887
  error estimate for blocks of size 2^( 6) =       0.000417274909
  error estimate for blocks of size 2^( 7) =       0.000419797118

      target function =                  N/A
              le_mean =     -17.216938632618
             les_mean =     296.737786937629
             stat err =       0.000416218364
             autocorr =       1.163636823002
              std dev =       0.545666771608
             le_variance =       0.297752225637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385844674
  error estimate for blocks of size 2^( 2) =       0.000395891865
  error estimate for blocks of size 2^( 3) =       0.000405062648
  error estimate for blocks of size 2^( 4) =       0.000411455545
  error estimate for blocks of size 2^( 5) =       0.000416345887
  error estimate for blocks of size 2^( 6) =       0.000417274909
  error estimate for blocks of size 2^( 7) =       0.000419797118

      target function =                  N/A
              le_mean =     -17.216938632618
             les_mean =     296.737786937629
             stat err =       0.000416218364
             autocorr =       1.163636823002
              std dev =       0.545666771608
             le_variance =       0.297752225637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385844674
  error estimate for blocks of size 2^( 2) =       0.000395891865
  error estimate for blocks of size 2^( 3) =       0.000405062648
  error estimate for blocks of size 2^( 4) =       0.000411455545
  error estimate for blocks of size 2^( 5) =       0.000416345887
  error estimate for blocks of size 2^( 6) =       0.000417274909
  error estimate for blocks of size 2^( 7) =       0.000419797118

      target function =                  N/A
              le_mean =     -17.216938632618
             les_mean =     296.737786937629
             stat err =       0.000416218364
             autocorr =       1.163636823002
              std dev =       0.545666771608
             le_variance =       0.297752225637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297787019463
                                         uncertainty =       0.002144909442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385844674
  error estimate for blocks of size 2^( 2) =       0.000395891865
  error estimate for blocks of size 2^( 3) =       0.000405062648
  error estimate for blocks of size 2^( 4) =       0.000411455545
  error estimate for blocks of size 2^( 5) =       0.000416345887
  error estimate for blocks of size 2^( 6) =       0.000417274909
  error estimate for blocks of size 2^( 7) =       0.000419797118

      target function =                  N/A
              le_mean =     -17.216938632618
             les_mean =     296.737786937629
             stat err =       0.000416218364
             autocorr =       1.163636823002
              std dev =       0.545666771608
             le_variance =       0.297752225637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216938632618        initial  <--
     9.5367e+42     9.5367e+43             5.3863e-47       -17.216938632618
     3.8147e+43     3.8147e+44             1.3466e-47       -17.216938632618
     1.5259e+44     1.5259e+45             3.3665e-48       -17.216938632618

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4847
  </log>
  <optVariables href="H2O.s059.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1786
    reference variance = 0.207114
====================================================
  Execution time = 2.0840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1953e-01
  Total weights = 1.956536271e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302723613519
                                         uncertainty =       0.002049178870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302723613519
                                         uncertainty =       0.002049178870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389020338
  error estimate for blocks of size 2^( 2) =       0.000399128759
  error estimate for blocks of size 2^( 3) =       0.000408633990
  error estimate for blocks of size 2^( 4) =       0.000415036504
  error estimate for blocks of size 2^( 5) =       0.000418991642
  error estimate for blocks of size 2^( 6) =       0.000420471420
  error estimate for blocks of size 2^( 7) =       0.000422215318

      target function =                  N/A
              le_mean =     -17.216090429146
             les_mean =     296.713300205792
             stat err =       0.000419178721
             autocorr =       1.161057804878
              std dev =       0.550157838640
             le_variance =       0.302673647417


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609042915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+43, overlap shift 9.5367e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090429167       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090429167       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.000000000000       residual = 1.72e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+43 is 2.435337e-48

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+44, overlap shift 3.8147e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090429167       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090429167       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.218750000000       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+44 is 6.088343e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+45, overlap shift 1.5259e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216090429167       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216090429167       residual = 8.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.187500000000       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+45 is 1.522086e-49

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.396903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6876e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.185428
====================================================
  Execution time = 2.0438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1556e-01
  Total weights = 1.9565e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386566896
  error estimate for blocks of size 2^( 2) =       0.000396123611
  error estimate for blocks of size 2^( 3) =       0.000405139883
  error estimate for blocks of size 2^( 4) =       0.000411300861
  error estimate for blocks of size 2^( 5) =       0.000416255949
  error estimate for blocks of size 2^( 6) =       0.000418705387
  error estimate for blocks of size 2^( 7) =       0.000421452691

      target function =                  N/A
              le_mean =     -17.216731083175
             les_mean =     296.731390195107
             stat err =       0.000416928722
             autocorr =       1.163253340920
              std dev =       0.546688147321
             le_variance =       0.298867930421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386566896
  error estimate for blocks of size 2^( 2) =       0.000396123611
  error estimate for blocks of size 2^( 3) =       0.000405139883
  error estimate for blocks of size 2^( 4) =       0.000411300861
  error estimate for blocks of size 2^( 5) =       0.000416255949
  error estimate for blocks of size 2^( 6) =       0.000418705387
  error estimate for blocks of size 2^( 7) =       0.000421452691

      target function =                  N/A
              le_mean =     -17.216731083175
             les_mean =     296.731390195107
             stat err =       0.000416928722
             autocorr =       1.163253340920
              std dev =       0.546688147321
             le_variance =       0.298867930421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386566896
  error estimate for blocks of size 2^( 2) =       0.000396123611
  error estimate for blocks of size 2^( 3) =       0.000405139883
  error estimate for blocks of size 2^( 4) =       0.000411300861
  error estimate for blocks of size 2^( 5) =       0.000416255949
  error estimate for blocks of size 2^( 6) =       0.000418705387
  error estimate for blocks of size 2^( 7) =       0.000421452691

      target function =                  N/A
              le_mean =     -17.216731083175
             les_mean =     296.731390195107
             stat err =       0.000416928722
             autocorr =       1.163253340920
              std dev =       0.546688147321
             le_variance =       0.298867930421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298905469314
                                         uncertainty =       0.001946166312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386566896
  error estimate for blocks of size 2^( 2) =       0.000396123611
  error estimate for blocks of size 2^( 3) =       0.000405139883
  error estimate for blocks of size 2^( 4) =       0.000411300861
  error estimate for blocks of size 2^( 5) =       0.000416255949
  error estimate for blocks of size 2^( 6) =       0.000418705387
  error estimate for blocks of size 2^( 7) =       0.000421452691

      target function =                  N/A
              le_mean =     -17.216731083175
             les_mean =     296.731390195107
             stat err =       0.000416928722
             autocorr =       1.163253340920
              std dev =       0.546688147321
             le_variance =       0.298867930421


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216731083175        initial  <--
     9.5367e+43     9.5367e+44             2.4353e-48       -17.216731083175
     3.8147e+44     3.8147e+45             6.0883e-49       -17.216731083175
     1.5259e+45     1.5259e+46             1.5221e-49       -17.216731083175

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6636
  </log>
  <optVariables href="H2O.s060.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6569e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.130666
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1591e-01
  Total weights = 1.956695182e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302263976803
                                         uncertainty =       0.002536550607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302263976803
                                         uncertainty =       0.002536550607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388781521
  error estimate for blocks of size 2^( 2) =       0.000398793078
  error estimate for blocks of size 2^( 3) =       0.000407838359
  error estimate for blocks of size 2^( 4) =       0.000414983851
  error estimate for blocks of size 2^( 5) =       0.000419142822
  error estimate for blocks of size 2^( 6) =       0.000423231863
  error estimate for blocks of size 2^( 7) =       0.000426137755

      target function =                  N/A
              le_mean =     -17.216648128998
             les_mean =     296.728879390377
             stat err =       0.000420874073
             autocorr =       1.171906914735
              std dev =       0.549820099373
             le_variance =       0.302302141675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721664812900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+44, overlap shift 9.5367e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+45, overlap shift 3.8147e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+46, overlap shift 1.5259e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216648129033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.398134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6604e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.435912
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1258e-01
  Total weights = 1.9565e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385375262
  error estimate for blocks of size 2^( 2) =       0.000395313497
  error estimate for blocks of size 2^( 3) =       0.000404680748
  error estimate for blocks of size 2^( 4) =       0.000411856046
  error estimate for blocks of size 2^( 5) =       0.000415383615
  error estimate for blocks of size 2^( 6) =       0.000417679415
  error estimate for blocks of size 2^( 7) =       0.000418123693

      target function =                  N/A
              le_mean =     -17.216322678642
             les_mean =     296.714344752478
             stat err =       0.000415760692
             autocorr =       1.163909430745
              std dev =       0.545002922698
             le_variance =       0.297028185750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385375262
  error estimate for blocks of size 2^( 2) =       0.000395313497
  error estimate for blocks of size 2^( 3) =       0.000404680748
  error estimate for blocks of size 2^( 4) =       0.000411856046
  error estimate for blocks of size 2^( 5) =       0.000415383615
  error estimate for blocks of size 2^( 6) =       0.000417679415
  error estimate for blocks of size 2^( 7) =       0.000418123693

      target function =                  N/A
              le_mean =     -17.216322678642
             les_mean =     296.714344752478
             stat err =       0.000415760692
             autocorr =       1.163909430745
              std dev =       0.545002922698
             le_variance =       0.297028185750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385375262
  error estimate for blocks of size 2^( 2) =       0.000395313497
  error estimate for blocks of size 2^( 3) =       0.000404680748
  error estimate for blocks of size 2^( 4) =       0.000411856046
  error estimate for blocks of size 2^( 5) =       0.000415383615
  error estimate for blocks of size 2^( 6) =       0.000417679415
  error estimate for blocks of size 2^( 7) =       0.000418123693

      target function =                  N/A
              le_mean =     -17.216322678642
             les_mean =     296.714344752478
             stat err =       0.000415760692
             autocorr =       1.163909430745
              std dev =       0.545002922698
             le_variance =       0.297028185750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297047710528
                                         uncertainty =       0.001953164484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385375262
  error estimate for blocks of size 2^( 2) =       0.000395313497
  error estimate for blocks of size 2^( 3) =       0.000404680748
  error estimate for blocks of size 2^( 4) =       0.000411856046
  error estimate for blocks of size 2^( 5) =       0.000415383615
  error estimate for blocks of size 2^( 6) =       0.000417679415
  error estimate for blocks of size 2^( 7) =       0.000418123693

      target function =                  N/A
              le_mean =     -17.216322678642
             les_mean =     296.714344752478
             stat err =       0.000415760692
             autocorr =       1.163909430745
              std dev =       0.545002922698
             le_variance =       0.297028185750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216322678642        initial  <--
     9.5367e+44     9.5367e+45             0.0000e+00       -17.216322678642
     3.8147e+45     3.8147e+46             0.0000e+00       -17.216322678642
     1.5259e+46     1.5259e+47             0.0000e+00       -17.216322678642

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6280
  </log>
  <optVariables href="H2O.s061.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6239e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.172057
====================================================
  Execution time = 2.2623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1205e-01
  Total weights = 1.956328052e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298965528921
                                         uncertainty =       0.002274223996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298965528921
                                         uncertainty =       0.002274223996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386553732
  error estimate for blocks of size 2^( 2) =       0.000396238308
  error estimate for blocks of size 2^( 3) =       0.000405367421
  error estimate for blocks of size 2^( 4) =       0.000412265193
  error estimate for blocks of size 2^( 5) =       0.000415990548
  error estimate for blocks of size 2^( 6) =       0.000419010797
  error estimate for blocks of size 2^( 7) =       0.000421012475

      target function =                  N/A
              le_mean =     -17.216552906895
             les_mean =     296.721747116429
             stat err =       0.000417069753
             autocorr =       1.164119728267
              std dev =       0.546669530458
             le_variance =       0.298847575532


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655290689e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+45, overlap shift 9.5367e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+46, overlap shift 3.8147e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+47, overlap shift 1.5259e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216552906917       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.399393 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8663e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2725
    reference variance = 0.267825
====================================================
  Execution time = 2.0666e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2636e-01
  Total weights = 1.9567e+06
  Execution time = 1.8225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390256231
  error estimate for blocks of size 2^( 2) =       0.000400187128
  error estimate for blocks of size 2^( 3) =       0.000409141887
  error estimate for blocks of size 2^( 4) =       0.000416028357
  error estimate for blocks of size 2^( 5) =       0.000419885709
  error estimate for blocks of size 2^( 6) =       0.000422149601
  error estimate for blocks of size 2^( 7) =       0.000423640755

      target function =                  N/A
              le_mean =     -17.215922790740
             les_mean =     296.714360027260
             stat err =       0.000420426105
             autocorr =       1.160592227479
              std dev =       0.551905654545
             le_variance =       0.304599851519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390256231
  error estimate for blocks of size 2^( 2) =       0.000400187128
  error estimate for blocks of size 2^( 3) =       0.000409141887
  error estimate for blocks of size 2^( 4) =       0.000416028357
  error estimate for blocks of size 2^( 5) =       0.000419885709
  error estimate for blocks of size 2^( 6) =       0.000422149601
  error estimate for blocks of size 2^( 7) =       0.000423640755

      target function =                  N/A
              le_mean =     -17.215922790740
             les_mean =     296.714360027260
             stat err =       0.000420426105
             autocorr =       1.160592227479
              std dev =       0.551905654545
             le_variance =       0.304599851519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390256231
  error estimate for blocks of size 2^( 2) =       0.000400187128
  error estimate for blocks of size 2^( 3) =       0.000409141887
  error estimate for blocks of size 2^( 4) =       0.000416028357
  error estimate for blocks of size 2^( 5) =       0.000419885709
  error estimate for blocks of size 2^( 6) =       0.000422149601
  error estimate for blocks of size 2^( 7) =       0.000423640755

      target function =                  N/A
              le_mean =     -17.215922790740
             les_mean =     296.714360027260
             stat err =       0.000420426105
             autocorr =       1.160592227479
              std dev =       0.551905654545
             le_variance =       0.304599851519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304620017223
                                         uncertainty =       0.002570741915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390256231
  error estimate for blocks of size 2^( 2) =       0.000400187128
  error estimate for blocks of size 2^( 3) =       0.000409141887
  error estimate for blocks of size 2^( 4) =       0.000416028357
  error estimate for blocks of size 2^( 5) =       0.000419885709
  error estimate for blocks of size 2^( 6) =       0.000422149601
  error estimate for blocks of size 2^( 7) =       0.000423640755

      target function =                  N/A
              le_mean =     -17.215922790740
             les_mean =     296.714360027260
             stat err =       0.000420426105
             autocorr =       1.160592227479
              std dev =       0.551905654545
             le_variance =       0.304599851519


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215922790740        initial  <--
     9.5367e+45     9.5367e+46             0.0000e+00       -17.215922790740
     3.8147e+46     3.8147e+47             0.0000e+00       -17.215922790740
     1.5259e+47     1.5259e+48             0.0000e+00       -17.215922790740

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8491
  </log>
  <optVariables href="H2O.s062.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8519e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1753
    reference variance = 0.354209
====================================================
  Execution time = 2.0559e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1579e-01
  Total weights = 1.956645919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0693e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300067887619
                                         uncertainty =       0.002090896419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300067887619
                                         uncertainty =       0.002090896419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387275315
  error estimate for blocks of size 2^( 2) =       0.000397450698
  error estimate for blocks of size 2^( 3) =       0.000406186100
  error estimate for blocks of size 2^( 4) =       0.000412785545
  error estimate for blocks of size 2^( 5) =       0.000416707760
  error estimate for blocks of size 2^( 6) =       0.000417753617
  error estimate for blocks of size 2^( 7) =       0.000420047608

      target function =                  N/A
              le_mean =     -17.216210063064
             les_mean =     296.713675287305
             stat err =       0.000416823633
             autocorr =       1.158417304533
              std dev =       0.547690002928
             le_variance =       0.299964339307


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621006306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+46, overlap shift 9.5367e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+47, overlap shift 3.8147e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+48, overlap shift 1.5259e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210063112       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.400613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6633e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.273228
====================================================
  Execution time = 2.0401e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1329e-01
  Total weights = 1.9565e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228333
  error estimate for blocks of size 2^( 2) =       0.000396394640
  error estimate for blocks of size 2^( 3) =       0.000405679511
  error estimate for blocks of size 2^( 4) =       0.000412675474
  error estimate for blocks of size 2^( 5) =       0.000417459755
  error estimate for blocks of size 2^( 6) =       0.000419264388
  error estimate for blocks of size 2^( 7) =       0.000423272705

      target function =                  N/A
              le_mean =     -17.216158314928
             les_mean =     296.709393356072
             stat err =       0.000418168081
             autocorr =       1.172231803730
              std dev =       0.546209346552
             le_variance =       0.298344650261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228333
  error estimate for blocks of size 2^( 2) =       0.000396394640
  error estimate for blocks of size 2^( 3) =       0.000405679511
  error estimate for blocks of size 2^( 4) =       0.000412675474
  error estimate for blocks of size 2^( 5) =       0.000417459755
  error estimate for blocks of size 2^( 6) =       0.000419264388
  error estimate for blocks of size 2^( 7) =       0.000423272705

      target function =                  N/A
              le_mean =     -17.216158314928
             les_mean =     296.709393356072
             stat err =       0.000418168081
             autocorr =       1.172231803730
              std dev =       0.546209346552
             le_variance =       0.298344650261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228333
  error estimate for blocks of size 2^( 2) =       0.000396394640
  error estimate for blocks of size 2^( 3) =       0.000405679511
  error estimate for blocks of size 2^( 4) =       0.000412675474
  error estimate for blocks of size 2^( 5) =       0.000417459755
  error estimate for blocks of size 2^( 6) =       0.000419264388
  error estimate for blocks of size 2^( 7) =       0.000423272705

      target function =                  N/A
              le_mean =     -17.216158314928
             les_mean =     296.709393356072
             stat err =       0.000418168081
             autocorr =       1.172231803730
              std dev =       0.546209346552
             le_variance =       0.298344650261

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298381469024
                                         uncertainty =       0.001902374042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386228333
  error estimate for blocks of size 2^( 2) =       0.000396394640
  error estimate for blocks of size 2^( 3) =       0.000405679511
  error estimate for blocks of size 2^( 4) =       0.000412675474
  error estimate for blocks of size 2^( 5) =       0.000417459755
  error estimate for blocks of size 2^( 6) =       0.000419264388
  error estimate for blocks of size 2^( 7) =       0.000423272705

      target function =                  N/A
              le_mean =     -17.216158314928
             les_mean =     296.709393356072
             stat err =       0.000418168081
             autocorr =       1.172231803730
              std dev =       0.546209346552
             le_variance =       0.298344650261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216158314928        initial  <--
     9.5367e+46     9.5367e+47             0.0000e+00       -17.216158314928
     3.8147e+47     3.8147e+48             0.0000e+00       -17.216158314928
     1.5259e+48     1.5259e+49             0.0000e+00       -17.216158314928

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5550
  </log>
  <optVariables href="H2O.s063.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6195e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.19929
====================================================
  Execution time = 2.0841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1007e-01
  Total weights = 1.956732620e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294460417226
                                         uncertainty =       0.001708744864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294460417226
                                         uncertainty =       0.001708744864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383721650
  error estimate for blocks of size 2^( 2) =       0.000394112300
  error estimate for blocks of size 2^( 3) =       0.000403236187
  error estimate for blocks of size 2^( 4) =       0.000409858970
  error estimate for blocks of size 2^( 5) =       0.000414730293
  error estimate for blocks of size 2^( 6) =       0.000417635535
  error estimate for blocks of size 2^( 7) =       0.000418946533

      target function =                  N/A
              le_mean =     -17.215477593340
             les_mean =     296.682737942129
             stat err =       0.000415292833
             autocorr =       1.171321904209
              std dev =       0.542664362059
             le_variance =       0.294484609849


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721547759334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+47, overlap shift 9.5367e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+47 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+48, overlap shift 3.8147e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+49, overlap shift 1.5259e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215477593375       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.401830 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7023e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.179431
====================================================
  Execution time = 2.0804e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1762e-01
  Total weights = 1.9568e+06
  Execution time = 1.8285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388167056
  error estimate for blocks of size 2^( 2) =       0.000398223603
  error estimate for blocks of size 2^( 3) =       0.000407417831
  error estimate for blocks of size 2^( 4) =       0.000415001667
  error estimate for blocks of size 2^( 5) =       0.000419100036
  error estimate for blocks of size 2^( 6) =       0.000422082256
  error estimate for blocks of size 2^( 7) =       0.000423993875

      target function =                  N/A
              le_mean =     -17.217399934046
             les_mean =     296.756483901520
             stat err =       0.000420044459
             autocorr =       1.170989960754
              std dev =       0.548951115422
             le_variance =       0.301347327123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388167056
  error estimate for blocks of size 2^( 2) =       0.000398223603
  error estimate for blocks of size 2^( 3) =       0.000407417831
  error estimate for blocks of size 2^( 4) =       0.000415001667
  error estimate for blocks of size 2^( 5) =       0.000419100036
  error estimate for blocks of size 2^( 6) =       0.000422082256
  error estimate for blocks of size 2^( 7) =       0.000423993875

      target function =                  N/A
              le_mean =     -17.217399934046
             les_mean =     296.756483901520
             stat err =       0.000420044459
             autocorr =       1.170989960754
              std dev =       0.548951115422
             le_variance =       0.301347327123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388167056
  error estimate for blocks of size 2^( 2) =       0.000398223603
  error estimate for blocks of size 2^( 3) =       0.000407417831
  error estimate for blocks of size 2^( 4) =       0.000415001667
  error estimate for blocks of size 2^( 5) =       0.000419100036
  error estimate for blocks of size 2^( 6) =       0.000422082256
  error estimate for blocks of size 2^( 7) =       0.000423993875

      target function =                  N/A
              le_mean =     -17.217399934046
             les_mean =     296.756483901520
             stat err =       0.000420044459
             autocorr =       1.170989960754
              std dev =       0.548951115422
             le_variance =       0.301347327123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301389505259
                                         uncertainty =       0.002366757592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388167056
  error estimate for blocks of size 2^( 2) =       0.000398223603
  error estimate for blocks of size 2^( 3) =       0.000407417831
  error estimate for blocks of size 2^( 4) =       0.000415001667
  error estimate for blocks of size 2^( 5) =       0.000419100036
  error estimate for blocks of size 2^( 6) =       0.000422082256
  error estimate for blocks of size 2^( 7) =       0.000423993875

      target function =                  N/A
              le_mean =     -17.217399934046
             les_mean =     296.756483901520
             stat err =       0.000420044459
             autocorr =       1.170989960754
              std dev =       0.548951115422
             le_variance =       0.301347327123


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217399934046        initial  <--
     9.5367e+47     9.5367e+48             0.0000e+00       -17.217399934046
     3.8147e+48     3.8147e+49             0.0000e+00       -17.217399934046
     1.5259e+49     1.5259e+50             0.0000e+00       -17.217399934046

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0748
  </log>
  <optVariables href="H2O.s064.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.218285
====================================================
  Execution time = 2.0871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1778e-01
  Total weights = 1.956333643e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300600929850
                                         uncertainty =       0.001662139936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300600929850
                                         uncertainty =       0.001662139936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387694164
  error estimate for blocks of size 2^( 2) =       0.000398051915
  error estimate for blocks of size 2^( 3) =       0.000406955568
  error estimate for blocks of size 2^( 4) =       0.000414970809
  error estimate for blocks of size 2^( 5) =       0.000419030801
  error estimate for blocks of size 2^( 6) =       0.000421264586
  error estimate for blocks of size 2^( 7) =       0.000421806971

      target function =                  N/A
              le_mean =     -17.216308596074
             les_mean =     296.719060532974
             stat err =       0.000419268292
             autocorr =       1.169514234884
              std dev =       0.548282344083
             le_variance =       0.300613528833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630859607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+48, overlap shift 9.5367e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+49, overlap shift 3.8147e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+50, overlap shift 1.5259e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216308596129       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.403060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6976e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.268355
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1588e-01
  Total weights = 1.9563e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386379816
  error estimate for blocks of size 2^( 2) =       0.000396655172
  error estimate for blocks of size 2^( 3) =       0.000405967822
  error estimate for blocks of size 2^( 4) =       0.000412377996
  error estimate for blocks of size 2^( 5) =       0.000417252730
  error estimate for blocks of size 2^( 6) =       0.000419716024
  error estimate for blocks of size 2^( 7) =       0.000422302478

      target function =                  N/A
              le_mean =     -17.216605689100
             les_mean =     296.727392311007
             stat err =       0.000417912307
             autocorr =       1.169880386050
              std dev =       0.546423575454
             le_variance =       0.298578723812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386379816
  error estimate for blocks of size 2^( 2) =       0.000396655172
  error estimate for blocks of size 2^( 3) =       0.000405967822
  error estimate for blocks of size 2^( 4) =       0.000412377996
  error estimate for blocks of size 2^( 5) =       0.000417252730
  error estimate for blocks of size 2^( 6) =       0.000419716024
  error estimate for blocks of size 2^( 7) =       0.000422302478

      target function =                  N/A
              le_mean =     -17.216605689100
             les_mean =     296.727392311007
             stat err =       0.000417912307
             autocorr =       1.169880386050
              std dev =       0.546423575454
             le_variance =       0.298578723812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386379816
  error estimate for blocks of size 2^( 2) =       0.000396655172
  error estimate for blocks of size 2^( 3) =       0.000405967822
  error estimate for blocks of size 2^( 4) =       0.000412377996
  error estimate for blocks of size 2^( 5) =       0.000417252730
  error estimate for blocks of size 2^( 6) =       0.000419716024
  error estimate for blocks of size 2^( 7) =       0.000422302478

      target function =                  N/A
              le_mean =     -17.216605689100
             les_mean =     296.727392311007
             stat err =       0.000417912307
             autocorr =       1.169880386050
              std dev =       0.546423575454
             le_variance =       0.298578723812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298451653982
                                         uncertainty =       0.002203145938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386379816
  error estimate for blocks of size 2^( 2) =       0.000396655172
  error estimate for blocks of size 2^( 3) =       0.000405967822
  error estimate for blocks of size 2^( 4) =       0.000412377996
  error estimate for blocks of size 2^( 5) =       0.000417252730
  error estimate for blocks of size 2^( 6) =       0.000419716024
  error estimate for blocks of size 2^( 7) =       0.000422302478

      target function =                  N/A
              le_mean =     -17.216605689100
             les_mean =     296.727392311007
             stat err =       0.000417912307
             autocorr =       1.169880386050
              std dev =       0.546423575454
             le_variance =       0.298578723812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216605689100        initial  <--
     9.5367e+48     9.5367e+49             0.0000e+00       -17.216605689100
     3.8147e+49     3.8147e+50             0.0000e+00       -17.216605689100
     1.5259e+50     1.5259e+51             0.0000e+00       -17.216605689100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7137
  </log>
  <optVariables href="H2O.s065.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6715e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2677
    reference variance = 0.326597
====================================================
  Execution time = 2.0714e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1465e-01
  Total weights = 1.956662390e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298493525568
                                         uncertainty =       0.002159902901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298493525568
                                         uncertainty =       0.002159902901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386343642
  error estimate for blocks of size 2^( 2) =       0.000396433308
  error estimate for blocks of size 2^( 3) =       0.000405112122
  error estimate for blocks of size 2^( 4) =       0.000411451967
  error estimate for blocks of size 2^( 5) =       0.000416304100
  error estimate for blocks of size 2^( 6) =       0.000420136838
  error estimate for blocks of size 2^( 7) =       0.000419417738

      target function =                  N/A
              le_mean =     -17.216526472700
             les_mean =     296.723428969883
             stat err =       0.000416827661
             autocorr =       1.164033618505
              std dev =       0.546372417998
             le_variance =       0.298522819149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652647270e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+49, overlap shift 9.5367e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+50, overlap shift 3.8147e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+51, overlap shift 1.5259e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216526472758       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.404351 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6743e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.48174
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2210e-01
  Total weights = 1.9562e+06
  Execution time = 1.8266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390122094
  error estimate for blocks of size 2^( 2) =       0.000400094544
  error estimate for blocks of size 2^( 3) =       0.000409614581
  error estimate for blocks of size 2^( 4) =       0.000416555714
  error estimate for blocks of size 2^( 5) =       0.000421657671
  error estimate for blocks of size 2^( 6) =       0.000425845609
  error estimate for blocks of size 2^( 7) =       0.000427542939

      target function =                  N/A
              le_mean =     -17.216675608896
             les_mean =     296.736020118019
             stat err =       0.000422900483
             autocorr =       1.175101197779
              std dev =       0.551715956309
             le_variance =       0.304390496446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390122094
  error estimate for blocks of size 2^( 2) =       0.000400094544
  error estimate for blocks of size 2^( 3) =       0.000409614581
  error estimate for blocks of size 2^( 4) =       0.000416555714
  error estimate for blocks of size 2^( 5) =       0.000421657671
  error estimate for blocks of size 2^( 6) =       0.000425845609
  error estimate for blocks of size 2^( 7) =       0.000427542939

      target function =                  N/A
              le_mean =     -17.216675608896
             les_mean =     296.736020118019
             stat err =       0.000422900483
             autocorr =       1.175101197779
              std dev =       0.551715956309
             le_variance =       0.304390496446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390122094
  error estimate for blocks of size 2^( 2) =       0.000400094544
  error estimate for blocks of size 2^( 3) =       0.000409614581
  error estimate for blocks of size 2^( 4) =       0.000416555714
  error estimate for blocks of size 2^( 5) =       0.000421657671
  error estimate for blocks of size 2^( 6) =       0.000425845609
  error estimate for blocks of size 2^( 7) =       0.000427542939

      target function =                  N/A
              le_mean =     -17.216675608896
             les_mean =     296.736020118019
             stat err =       0.000422900483
             autocorr =       1.175101197779
              std dev =       0.551715956309
             le_variance =       0.304390496446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304401233967
                                         uncertainty =       0.002985362834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390122094
  error estimate for blocks of size 2^( 2) =       0.000400094544
  error estimate for blocks of size 2^( 3) =       0.000409614581
  error estimate for blocks of size 2^( 4) =       0.000416555714
  error estimate for blocks of size 2^( 5) =       0.000421657671
  error estimate for blocks of size 2^( 6) =       0.000425845609
  error estimate for blocks of size 2^( 7) =       0.000427542939

      target function =                  N/A
              le_mean =     -17.216675608896
             les_mean =     296.736020118019
             stat err =       0.000422900483
             autocorr =       1.175101197779
              std dev =       0.551715956309
             le_variance =       0.304390496446


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216675608896        initial  <--
     9.5367e+49     9.5367e+50             0.0000e+00       -17.216675608896
     3.8147e+50     3.8147e+51             0.0000e+00       -17.216675608896
     1.5259e+51     1.5259e+52             0.0000e+00       -17.216675608896

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5633
  </log>
  <optVariables href="H2O.s066.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2275
    reference variance = 0.374831
====================================================
  Execution time = 2.0615e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1103e-01
  Total weights = 1.956512279e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296221185788
                                         uncertainty =       0.001905884535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296221185788
                                         uncertainty =       0.001905884535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384911587
  error estimate for blocks of size 2^( 2) =       0.000394983837
  error estimate for blocks of size 2^( 3) =       0.000403759894
  error estimate for blocks of size 2^( 4) =       0.000410281193
  error estimate for blocks of size 2^( 5) =       0.000415103729
  error estimate for blocks of size 2^( 6) =       0.000416813786
  error estimate for blocks of size 2^( 7) =       0.000419016012

      target function =                  N/A
              le_mean =     -17.215922920133
             les_mean =     296.699031651303
             stat err =       0.000415303680
             autocorr =       1.164151733985
              std dev =       0.544347186582
             le_variance =       0.296313859540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592292013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+50, overlap shift 9.5367e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922920163       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922920163       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215922920163       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215922920163       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+50 is 3.991313e-55

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+51, overlap shift 3.8147e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922920163       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922920163       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215922920163       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215922920163       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+51 is 9.978282e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+52, overlap shift 1.5259e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215922920163       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215922920163       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215922920163       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215922920163       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+52 is 2.494570e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.406196 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7163e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.2331
    reference variance = 0.189208
====================================================
  Execution time = 2.0525e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1248e-01
  Total weights = 1.9566e+06
  Execution time = 1.8465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386326593
  error estimate for blocks of size 2^( 2) =       0.000396169045
  error estimate for blocks of size 2^( 3) =       0.000405128727
  error estimate for blocks of size 2^( 4) =       0.000411934989
  error estimate for blocks of size 2^( 5) =       0.000415678017
  error estimate for blocks of size 2^( 6) =       0.000418752758
  error estimate for blocks of size 2^( 7) =       0.000420086863

      target function =                  N/A
              le_mean =     -17.215421702687
             les_mean =     296.683227374876
             stat err =       0.000416613157
             autocorr =       1.162938513815
              std dev =       0.546348307925
             le_variance =       0.298496473572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386326593
  error estimate for blocks of size 2^( 2) =       0.000396169045
  error estimate for blocks of size 2^( 3) =       0.000405128727
  error estimate for blocks of size 2^( 4) =       0.000411934989
  error estimate for blocks of size 2^( 5) =       0.000415678017
  error estimate for blocks of size 2^( 6) =       0.000418752758
  error estimate for blocks of size 2^( 7) =       0.000420086863

      target function =                  N/A
              le_mean =     -17.215421702687
             les_mean =     296.683227374876
             stat err =       0.000416613157
             autocorr =       1.162938513815
              std dev =       0.546348307925
             le_variance =       0.298496473572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386326593
  error estimate for blocks of size 2^( 2) =       0.000396169045
  error estimate for blocks of size 2^( 3) =       0.000405128727
  error estimate for blocks of size 2^( 4) =       0.000411934989
  error estimate for blocks of size 2^( 5) =       0.000415678017
  error estimate for blocks of size 2^( 6) =       0.000418752758
  error estimate for blocks of size 2^( 7) =       0.000420086863

      target function =                  N/A
              le_mean =     -17.215421702687
             les_mean =     296.683227374876
             stat err =       0.000416613157
             autocorr =       1.162938513815
              std dev =       0.546348307925
             le_variance =       0.298496473572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298508793123
                                         uncertainty =       0.002102446330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386326593
  error estimate for blocks of size 2^( 2) =       0.000396169045
  error estimate for blocks of size 2^( 3) =       0.000405128727
  error estimate for blocks of size 2^( 4) =       0.000411934989
  error estimate for blocks of size 2^( 5) =       0.000415678017
  error estimate for blocks of size 2^( 6) =       0.000418752758
  error estimate for blocks of size 2^( 7) =       0.000420086863

      target function =                  N/A
              le_mean =     -17.215421702687
             les_mean =     296.683227374876
             stat err =       0.000416613157
             autocorr =       1.162938513815
              std dev =       0.546348307925
             le_variance =       0.298496473572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215421702687        initial  <--
     9.5367e+50     9.5367e+51             3.9913e-55       -17.215421702687
     3.8147e+51     3.8147e+52             9.9783e-56       -17.215421702687
     1.5259e+52     1.5259e+53             2.4946e-56       -17.215421702687

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7399
  </log>
  <optVariables href="H2O.s067.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.193255
====================================================
  Execution time = 2.0707e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1092e-01
  Total weights = 1.956736414e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0670e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297254491902
                                         uncertainty =       0.002025477213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297254491902
                                         uncertainty =       0.002025477213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385522028
  error estimate for blocks of size 2^( 2) =       0.000395619414
  error estimate for blocks of size 2^( 3) =       0.000404794947
  error estimate for blocks of size 2^( 4) =       0.000411941451
  error estimate for blocks of size 2^( 5) =       0.000415762224
  error estimate for blocks of size 2^( 6) =       0.000419555566
  error estimate for blocks of size 2^( 7) =       0.000420585546

      target function =                  N/A
              le_mean =     -17.216420263474
             les_mean =     296.716045334438
             stat err =       0.000416961197
             autocorr =       1.169749546571
              std dev =       0.545210480499
             le_variance =       0.297254468046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642026347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+51, overlap shift 9.5367e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420263503       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420263503       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+51 is 3.844239e-56

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+52, overlap shift 3.8147e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420263503       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420263503       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+52 is 9.610597e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+53, overlap shift 1.5259e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420263503       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420263503       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+53 is 2.402649e-57

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.407666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6781e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2343
    reference variance = 0.31762
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1249e-01
  Total weights = 1.9562e+06
  Execution time = 1.8267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387602591
  error estimate for blocks of size 2^( 2) =       0.000397717676
  error estimate for blocks of size 2^( 3) =       0.000406576796
  error estimate for blocks of size 2^( 4) =       0.000413451317
  error estimate for blocks of size 2^( 5) =       0.000416558499
  error estimate for blocks of size 2^( 6) =       0.000418635057
  error estimate for blocks of size 2^( 7) =       0.000420892865

      target function =                  N/A
              le_mean =     -17.215597904530
             les_mean =     296.689296606367
             stat err =       0.000417384434
             autocorr =       1.159575830211
              std dev =       0.548152841153
             le_variance =       0.300471537264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387602591
  error estimate for blocks of size 2^( 2) =       0.000397717676
  error estimate for blocks of size 2^( 3) =       0.000406576796
  error estimate for blocks of size 2^( 4) =       0.000413451317
  error estimate for blocks of size 2^( 5) =       0.000416558499
  error estimate for blocks of size 2^( 6) =       0.000418635057
  error estimate for blocks of size 2^( 7) =       0.000420892865

      target function =                  N/A
              le_mean =     -17.215597904530
             les_mean =     296.689296606367
             stat err =       0.000417384434
             autocorr =       1.159575830211
              std dev =       0.548152841153
             le_variance =       0.300471537264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387602591
  error estimate for blocks of size 2^( 2) =       0.000397717676
  error estimate for blocks of size 2^( 3) =       0.000406576796
  error estimate for blocks of size 2^( 4) =       0.000413451317
  error estimate for blocks of size 2^( 5) =       0.000416558499
  error estimate for blocks of size 2^( 6) =       0.000418635057
  error estimate for blocks of size 2^( 7) =       0.000420892865

      target function =                  N/A
              le_mean =     -17.215597904530
             les_mean =     296.689296606367
             stat err =       0.000417384434
             autocorr =       1.159575830211
              std dev =       0.548152841153
             le_variance =       0.300471537264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300537858974
                                         uncertainty =       0.002147578502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387602591
  error estimate for blocks of size 2^( 2) =       0.000397717676
  error estimate for blocks of size 2^( 3) =       0.000406576796
  error estimate for blocks of size 2^( 4) =       0.000413451317
  error estimate for blocks of size 2^( 5) =       0.000416558499
  error estimate for blocks of size 2^( 6) =       0.000418635057
  error estimate for blocks of size 2^( 7) =       0.000420892865

      target function =                  N/A
              le_mean =     -17.215597904530
             les_mean =     296.689296606367
             stat err =       0.000417384434
             autocorr =       1.159575830211
              std dev =       0.548152841153
             le_variance =       0.300471537264


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215597904530        initial  <--
     9.5367e+51     9.5367e+52             3.8442e-56       -17.215597904530
     3.8147e+52     3.8147e+53             9.6106e-57       -17.215597904530
     1.5259e+53     1.5259e+54             2.4026e-57       -17.215597904530

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4913
  </log>
  <optVariables href="H2O.s068.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6278e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.202
    reference variance = 0.211814
====================================================
  Execution time = 2.0718e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1745e-01
  Total weights = 1.956373628e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298763319167
                                         uncertainty =       0.002215902261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298763319167
                                         uncertainty =       0.002215902261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386513164
  error estimate for blocks of size 2^( 2) =       0.000396666018
  error estimate for blocks of size 2^( 3) =       0.000405919474
  error estimate for blocks of size 2^( 4) =       0.000412781452
  error estimate for blocks of size 2^( 5) =       0.000416920394
  error estimate for blocks of size 2^( 6) =       0.000420728130
  error estimate for blocks of size 2^( 7) =       0.000423242366

      target function =                  N/A
              le_mean =     -17.216750761273
             les_mean =     296.733953054246
             stat err =       0.000418418086
             autocorr =       1.171904753231
              std dev =       0.546612159038
             le_variance =       0.298784852408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675076127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+52, overlap shift 9.5367e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+53, overlap shift 3.8147e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+54, overlap shift 1.5259e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216750761291       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.408891 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6777e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.0966
    reference variance = 0.612396
====================================================
  Execution time = 2.0619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2098e-01
  Total weights = 1.9570e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391026285
  error estimate for blocks of size 2^( 2) =       0.000401086453
  error estimate for blocks of size 2^( 3) =       0.000409928266
  error estimate for blocks of size 2^( 4) =       0.000416819151
  error estimate for blocks of size 2^( 5) =       0.000421350878
  error estimate for blocks of size 2^( 6) =       0.000424866090
  error estimate for blocks of size 2^( 7) =       0.000425801418

      target function =                  N/A
              le_mean =     -17.216372343723
             les_mean =     296.724461527619
             stat err =       0.000422209384
             autocorr =       1.165853178198
              std dev =       0.552994674925
             le_variance =       0.305803110496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391026285
  error estimate for blocks of size 2^( 2) =       0.000401086453
  error estimate for blocks of size 2^( 3) =       0.000409928266
  error estimate for blocks of size 2^( 4) =       0.000416819151
  error estimate for blocks of size 2^( 5) =       0.000421350878
  error estimate for blocks of size 2^( 6) =       0.000424866090
  error estimate for blocks of size 2^( 7) =       0.000425801418

      target function =                  N/A
              le_mean =     -17.216372343723
             les_mean =     296.724461527619
             stat err =       0.000422209384
             autocorr =       1.165853178198
              std dev =       0.552994674925
             le_variance =       0.305803110496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391026285
  error estimate for blocks of size 2^( 2) =       0.000401086453
  error estimate for blocks of size 2^( 3) =       0.000409928266
  error estimate for blocks of size 2^( 4) =       0.000416819151
  error estimate for blocks of size 2^( 5) =       0.000421350878
  error estimate for blocks of size 2^( 6) =       0.000424866090
  error estimate for blocks of size 2^( 7) =       0.000425801418

      target function =                  N/A
              le_mean =     -17.216372343723
             les_mean =     296.724461527619
             stat err =       0.000422209384
             autocorr =       1.165853178198
              std dev =       0.552994674925
             le_variance =       0.305803110496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305841548619
                                         uncertainty =       0.002860481800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391026285
  error estimate for blocks of size 2^( 2) =       0.000401086453
  error estimate for blocks of size 2^( 3) =       0.000409928266
  error estimate for blocks of size 2^( 4) =       0.000416819151
  error estimate for blocks of size 2^( 5) =       0.000421350878
  error estimate for blocks of size 2^( 6) =       0.000424866090
  error estimate for blocks of size 2^( 7) =       0.000425801418

      target function =                  N/A
              le_mean =     -17.216372343723
             les_mean =     296.724461527619
             stat err =       0.000422209384
             autocorr =       1.165853178198
              std dev =       0.552994674925
             le_variance =       0.305803110496


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216372343723        initial  <--
     9.5367e+52     9.5367e+53             0.0000e+00       -17.216372343723
     3.8147e+53     3.8147e+54             0.0000e+00       -17.216372343723
     1.5259e+54     1.5259e+55             0.0000e+00       -17.216372343723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8404
  </log>
  <optVariables href="H2O.s069.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6625e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2794
    reference variance = 0.249009
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1691e-01
  Total weights = 1.956405564e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303320789377
                                         uncertainty =       0.002270636457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303320789377
                                         uncertainty =       0.002270636457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389493301
  error estimate for blocks of size 2^( 2) =       0.000399473989
  error estimate for blocks of size 2^( 3) =       0.000408215828
  error estimate for blocks of size 2^( 4) =       0.000414357496
  error estimate for blocks of size 2^( 5) =       0.000418347103
  error estimate for blocks of size 2^( 6) =       0.000420626216
  error estimate for blocks of size 2^( 7) =       0.000420613012

      target function =                  N/A
              le_mean =     -17.216041206968
             les_mean =     296.708985809986
             stat err =       0.000418485957
             autocorr =       1.154414551771
              std dev =       0.550826708816
             le_variance =       0.303410063145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604120697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+53, overlap shift 9.5367e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041206987       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041206987       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+53 is 3.679670e-58

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+54, overlap shift 3.8147e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041206987       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041206987       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+54 is 9.199175e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+55, overlap shift 1.5259e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216041206987       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216041206987       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+55 is 2.299794e-59

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.410084 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6680e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.135168
====================================================
  Execution time = 2.0861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1181e-01
  Total weights = 1.9566e+06
  Execution time = 1.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469412
  error estimate for blocks of size 2^( 2) =       0.000396582382
  error estimate for blocks of size 2^( 3) =       0.000405371334
  error estimate for blocks of size 2^( 4) =       0.000412250988
  error estimate for blocks of size 2^( 5) =       0.000416315448
  error estimate for blocks of size 2^( 6) =       0.000417470134
  error estimate for blocks of size 2^( 7) =       0.000418176060

      target function =                  N/A
              le_mean =     -17.216664341176
             les_mean =     296.725337304326
             stat err =       0.000416053158
             autocorr =       1.158957184276
              std dev =       0.546550283936
             le_variance =       0.298717212870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469412
  error estimate for blocks of size 2^( 2) =       0.000396582382
  error estimate for blocks of size 2^( 3) =       0.000405371334
  error estimate for blocks of size 2^( 4) =       0.000412250988
  error estimate for blocks of size 2^( 5) =       0.000416315448
  error estimate for blocks of size 2^( 6) =       0.000417470134
  error estimate for blocks of size 2^( 7) =       0.000418176060

      target function =                  N/A
              le_mean =     -17.216664341176
             les_mean =     296.725337304326
             stat err =       0.000416053158
             autocorr =       1.158957184276
              std dev =       0.546550283936
             le_variance =       0.298717212870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469412
  error estimate for blocks of size 2^( 2) =       0.000396582382
  error estimate for blocks of size 2^( 3) =       0.000405371334
  error estimate for blocks of size 2^( 4) =       0.000412250988
  error estimate for blocks of size 2^( 5) =       0.000416315448
  error estimate for blocks of size 2^( 6) =       0.000417470134
  error estimate for blocks of size 2^( 7) =       0.000418176060

      target function =                  N/A
              le_mean =     -17.216664341176
             les_mean =     296.725337304326
             stat err =       0.000416053158
             autocorr =       1.158957184276
              std dev =       0.546550283936
             le_variance =       0.298717212870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298664324220
                                         uncertainty =       0.001809841582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386469412
  error estimate for blocks of size 2^( 2) =       0.000396582382
  error estimate for blocks of size 2^( 3) =       0.000405371334
  error estimate for blocks of size 2^( 4) =       0.000412250988
  error estimate for blocks of size 2^( 5) =       0.000416315448
  error estimate for blocks of size 2^( 6) =       0.000417470134
  error estimate for blocks of size 2^( 7) =       0.000418176060

      target function =                  N/A
              le_mean =     -17.216664341176
             les_mean =     296.725337304326
             stat err =       0.000416053158
             autocorr =       1.158957184276
              std dev =       0.546550283936
             le_variance =       0.298717212870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216664341176        initial  <--
     9.5367e+53     9.5367e+54             3.6797e-58       -17.216664341176
     3.8147e+54     3.8147e+55             9.1992e-59       -17.216664341176
     1.5259e+55     1.5259e+56             2.2998e-59       -17.216664341176

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0449
  </log>
  <optVariables href="H2O.s070.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2986
    reference variance = 0.308171
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0988e-01
  Total weights = 1.956688068e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118688574
                                         uncertainty =       0.001641454540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298118688574
                                         uncertainty =       0.001641454540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386032535
  error estimate for blocks of size 2^( 2) =       0.000396055324
  error estimate for blocks of size 2^( 3) =       0.000405554188
  error estimate for blocks of size 2^( 4) =       0.000412393210
  error estimate for blocks of size 2^( 5) =       0.000416025249
  error estimate for blocks of size 2^( 6) =       0.000418131872
  error estimate for blocks of size 2^( 7) =       0.000420669803

      target function =                  N/A
              le_mean =     -17.216238171211
             les_mean =     296.708739756000
             stat err =       0.000416805033
             autocorr =       1.165784004708
              std dev =       0.545932446636
             le_variance =       0.298042236290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623817121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+54, overlap shift 9.5367e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+55, overlap shift 3.8147e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+56, overlap shift 1.5259e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216238171253       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.411327 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6448e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1164
    reference variance = 0.296327
====================================================
  Execution time = 2.0603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1158e-01
  Total weights = 1.9569e+06
  Execution time = 1.8214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386011053
  error estimate for blocks of size 2^( 2) =       0.000396110675
  error estimate for blocks of size 2^( 3) =       0.000405190753
  error estimate for blocks of size 2^( 4) =       0.000411421550
  error estimate for blocks of size 2^( 5) =       0.000416802823
  error estimate for blocks of size 2^( 6) =       0.000418726321
  error estimate for blocks of size 2^( 7) =       0.000419156174

      target function =                  N/A
              le_mean =     -17.216735742112
             les_mean =     296.727567608240
             stat err =       0.000416526717
             autocorr =       1.164357233312
              std dev =       0.545902066532
             le_variance =       0.298009066244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386011053
  error estimate for blocks of size 2^( 2) =       0.000396110675
  error estimate for blocks of size 2^( 3) =       0.000405190753
  error estimate for blocks of size 2^( 4) =       0.000411421550
  error estimate for blocks of size 2^( 5) =       0.000416802823
  error estimate for blocks of size 2^( 6) =       0.000418726321
  error estimate for blocks of size 2^( 7) =       0.000419156174

      target function =                  N/A
              le_mean =     -17.216735742112
             les_mean =     296.727567608240
             stat err =       0.000416526717
             autocorr =       1.164357233312
              std dev =       0.545902066532
             le_variance =       0.298009066244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386011053
  error estimate for blocks of size 2^( 2) =       0.000396110675
  error estimate for blocks of size 2^( 3) =       0.000405190753
  error estimate for blocks of size 2^( 4) =       0.000411421550
  error estimate for blocks of size 2^( 5) =       0.000416802823
  error estimate for blocks of size 2^( 6) =       0.000418726321
  error estimate for blocks of size 2^( 7) =       0.000419156174

      target function =                  N/A
              le_mean =     -17.216735742112
             les_mean =     296.727567608240
             stat err =       0.000416526717
             autocorr =       1.164357233312
              std dev =       0.545902066532
             le_variance =       0.298009066244

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298031343989
                                         uncertainty =       0.002042223969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386011053
  error estimate for blocks of size 2^( 2) =       0.000396110675
  error estimate for blocks of size 2^( 3) =       0.000405190753
  error estimate for blocks of size 2^( 4) =       0.000411421550
  error estimate for blocks of size 2^( 5) =       0.000416802823
  error estimate for blocks of size 2^( 6) =       0.000418726321
  error estimate for blocks of size 2^( 7) =       0.000419156174

      target function =                  N/A
              le_mean =     -17.216735742112
             les_mean =     296.727567608240
             stat err =       0.000416526717
             autocorr =       1.164357233312
              std dev =       0.545902066532
             le_variance =       0.298009066244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216735742112        initial  <--
     9.5367e+54     9.5367e+55             0.0000e+00       -17.216735742112
     3.8147e+55     3.8147e+56             0.0000e+00       -17.216735742112
     1.5259e+56     1.5259e+57             0.0000e+00       -17.216735742112

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7803
  </log>
  <optVariables href="H2O.s071.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6236e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2037
    reference variance = 0.179354
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1705e-01
  Total weights = 1.956370378e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302302170008
                                         uncertainty =       0.003693016767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302302170008
                                         uncertainty =       0.003693016767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388800981
  error estimate for blocks of size 2^( 2) =       0.000398518218
  error estimate for blocks of size 2^( 3) =       0.000407559597
  error estimate for blocks of size 2^( 4) =       0.000414768270
  error estimate for blocks of size 2^( 5) =       0.000419403665
  error estimate for blocks of size 2^( 6) =       0.000422607394
  error estimate for blocks of size 2^( 7) =       0.000421989889

      target function =                  N/A
              le_mean =     -17.216431417469
             les_mean =     296.722562948661
             stat err =       0.000419692305
             autocorr =       1.165218329390
              std dev =       0.549847620845
             le_variance =       0.302332406149


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643141747e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+55, overlap shift 9.5367e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431417493       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431417493       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+55 is 4.670379e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+56, overlap shift 3.8147e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431417493       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431417493       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216431417493       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+56 is 1.167595e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+57, overlap shift 1.5259e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216431417493       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216431417493       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+57 is 2.918987e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.412701 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6616e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.257291
====================================================
  Execution time = 2.2513e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1300e-01
  Total weights = 1.9567e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386890053
  error estimate for blocks of size 2^( 2) =       0.000396865486
  error estimate for blocks of size 2^( 3) =       0.000406103485
  error estimate for blocks of size 2^( 4) =       0.000412851691
  error estimate for blocks of size 2^( 5) =       0.000416591687
  error estimate for blocks of size 2^( 6) =       0.000419093288
  error estimate for blocks of size 2^( 7) =       0.000420844729

      target function =                  N/A
              le_mean =     -17.215431586316
             les_mean =     296.684084153045
             stat err =       0.000417345349
             autocorr =       1.163632995780
              std dev =       0.547145160098
             le_variance =       0.299367826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386890053
  error estimate for blocks of size 2^( 2) =       0.000396865486
  error estimate for blocks of size 2^( 3) =       0.000406103485
  error estimate for blocks of size 2^( 4) =       0.000412851691
  error estimate for blocks of size 2^( 5) =       0.000416591687
  error estimate for blocks of size 2^( 6) =       0.000419093288
  error estimate for blocks of size 2^( 7) =       0.000420844729

      target function =                  N/A
              le_mean =     -17.215431586316
             les_mean =     296.684084153045
             stat err =       0.000417345349
             autocorr =       1.163632995780
              std dev =       0.547145160098
             le_variance =       0.299367826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386890053
  error estimate for blocks of size 2^( 2) =       0.000396865486
  error estimate for blocks of size 2^( 3) =       0.000406103485
  error estimate for blocks of size 2^( 4) =       0.000412851691
  error estimate for blocks of size 2^( 5) =       0.000416591687
  error estimate for blocks of size 2^( 6) =       0.000419093288
  error estimate for blocks of size 2^( 7) =       0.000420844729

      target function =                  N/A
              le_mean =     -17.215431586316
             les_mean =     296.684084153045
             stat err =       0.000417345349
             autocorr =       1.163632995780
              std dev =       0.547145160098
             le_variance =       0.299367826219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299462727350
                                         uncertainty =       0.002122011026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386890053
  error estimate for blocks of size 2^( 2) =       0.000396865486
  error estimate for blocks of size 2^( 3) =       0.000406103485
  error estimate for blocks of size 2^( 4) =       0.000412851691
  error estimate for blocks of size 2^( 5) =       0.000416591687
  error estimate for blocks of size 2^( 6) =       0.000419093288
  error estimate for blocks of size 2^( 7) =       0.000420844729

      target function =                  N/A
              le_mean =     -17.215431586316
             les_mean =     296.684084153045
             stat err =       0.000417345349
             autocorr =       1.163632995780
              std dev =       0.547145160098
             le_variance =       0.299367826219


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215431586316        initial  <--
     9.5367e+55     9.5367e+56             4.6704e-60       -17.215431586316
     3.8147e+56     3.8147e+57             1.1676e-60       -17.215431586316
     1.5259e+57     1.5259e+58             2.9190e-61       -17.215431586316

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7109
  </log>
  <optVariables href="H2O.s072.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8335e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.175489
====================================================
  Execution time = 2.0499e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1500e-01
  Total weights = 1.956466181e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299522226119
                                         uncertainty =       0.002357466886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299522226119
                                         uncertainty =       0.002357466886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386945721
  error estimate for blocks of size 2^( 2) =       0.000396849134
  error estimate for blocks of size 2^( 3) =       0.000405966446
  error estimate for blocks of size 2^( 4) =       0.000412841855
  error estimate for blocks of size 2^( 5) =       0.000417204797
  error estimate for blocks of size 2^( 6) =       0.000419159937
  error estimate for blocks of size 2^( 7) =       0.000418587614

      target function =                  N/A
              le_mean =     -17.216367220700
             les_mean =     296.718296713860
             stat err =       0.000416948551
             autocorr =       1.161087210317
              std dev =       0.547223886333
             le_variance =       0.299453981774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636722070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+56, overlap shift 9.5367e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367220743       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367220743       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+56 is 3.849516e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+57, overlap shift 3.8147e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367220743       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367220743       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216367220743       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+57 is 9.623791e-62

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+58, overlap shift 1.5259e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216367220743       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216367220743       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.414041 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6567e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2769
    reference variance = 0.190109
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1634e-01
  Total weights = 1.9566e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387931165
  error estimate for blocks of size 2^( 2) =       0.000397824226
  error estimate for blocks of size 2^( 3) =       0.000406697439
  error estimate for blocks of size 2^( 4) =       0.000414261109
  error estimate for blocks of size 2^( 5) =       0.000419269093
  error estimate for blocks of size 2^( 6) =       0.000420600457
  error estimate for blocks of size 2^( 7) =       0.000420909990

      target function =                  N/A
              le_mean =     -17.216194638369
             les_mean =     296.713695752969
             stat err =       0.000418760162
             autocorr =       1.165256082065
              std dev =       0.548617514169
             le_variance =       0.300981176853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387931165
  error estimate for blocks of size 2^( 2) =       0.000397824226
  error estimate for blocks of size 2^( 3) =       0.000406697439
  error estimate for blocks of size 2^( 4) =       0.000414261109
  error estimate for blocks of size 2^( 5) =       0.000419269093
  error estimate for blocks of size 2^( 6) =       0.000420600457
  error estimate for blocks of size 2^( 7) =       0.000420909990

      target function =                  N/A
              le_mean =     -17.216194638369
             les_mean =     296.713695752969
             stat err =       0.000418760162
             autocorr =       1.165256082065
              std dev =       0.548617514169
             le_variance =       0.300981176853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387931165
  error estimate for blocks of size 2^( 2) =       0.000397824226
  error estimate for blocks of size 2^( 3) =       0.000406697439
  error estimate for blocks of size 2^( 4) =       0.000414261109
  error estimate for blocks of size 2^( 5) =       0.000419269093
  error estimate for blocks of size 2^( 6) =       0.000420600457
  error estimate for blocks of size 2^( 7) =       0.000420909990

      target function =                  N/A
              le_mean =     -17.216194638369
             les_mean =     296.713695752969
             stat err =       0.000418760162
             autocorr =       1.165256082065
              std dev =       0.548617514169
             le_variance =       0.300981176853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301070449473
                                         uncertainty =       0.002144445128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387931165
  error estimate for blocks of size 2^( 2) =       0.000397824226
  error estimate for blocks of size 2^( 3) =       0.000406697439
  error estimate for blocks of size 2^( 4) =       0.000414261109
  error estimate for blocks of size 2^( 5) =       0.000419269093
  error estimate for blocks of size 2^( 6) =       0.000420600457
  error estimate for blocks of size 2^( 7) =       0.000420909990

      target function =                  N/A
              le_mean =     -17.216194638369
             les_mean =     296.713695752969
             stat err =       0.000418760162
             autocorr =       1.165256082065
              std dev =       0.548617514169
             le_variance =       0.300981176853


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216194638369        initial  <--
     9.5367e+56     9.5367e+57             3.8495e-61       -17.216194638369
     3.8147e+57     3.8147e+58             9.6238e-62       -17.216194638369
     1.5259e+58     1.5259e+59             0.0000e+00       -17.216194638369

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7670
  </log>
  <optVariables href="H2O.s073.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6341e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.224943
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1169e-01
  Total weights = 1.956882881e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946765825
                                         uncertainty =       0.002385233642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297946765825
                                         uncertainty =       0.002385233642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385948012
  error estimate for blocks of size 2^( 2) =       0.000395682874
  error estimate for blocks of size 2^( 3) =       0.000404976322
  error estimate for blocks of size 2^( 4) =       0.000411422359
  error estimate for blocks of size 2^( 5) =       0.000415132616
  error estimate for blocks of size 2^( 6) =       0.000417743384
  error estimate for blocks of size 2^( 7) =       0.000417798458

      target function =                  N/A
              le_mean =     -17.216506802637
             les_mean =     296.719795339007
             stat err =       0.000415524204
             autocorr =       1.159137714021
              std dev =       0.545812913067
             le_variance =       0.297911736071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650680264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+57, overlap shift 9.5367e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+58, overlap shift 3.8147e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+59, overlap shift 1.5259e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506802656       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.415271 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6708e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1585
    reference variance = 0.188717
====================================================
  Execution time = 2.0601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1202e-01
  Total weights = 1.9567e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383974500
  error estimate for blocks of size 2^( 2) =       0.000394168424
  error estimate for blocks of size 2^( 3) =       0.000403119177
  error estimate for blocks of size 2^( 4) =       0.000409422086
  error estimate for blocks of size 2^( 5) =       0.000414352815
  error estimate for blocks of size 2^( 6) =       0.000417381245
  error estimate for blocks of size 2^( 7) =       0.000420221150

      target function =                  N/A
              le_mean =     -17.215999716047
             les_mean =     296.702666039559
             stat err =       0.000415344324
             autocorr =       1.170069863548
              std dev =       0.543021944941
             le_variance =       0.294872832688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383974500
  error estimate for blocks of size 2^( 2) =       0.000394168424
  error estimate for blocks of size 2^( 3) =       0.000403119177
  error estimate for blocks of size 2^( 4) =       0.000409422086
  error estimate for blocks of size 2^( 5) =       0.000414352815
  error estimate for blocks of size 2^( 6) =       0.000417381245
  error estimate for blocks of size 2^( 7) =       0.000420221150

      target function =                  N/A
              le_mean =     -17.215999716047
             les_mean =     296.702666039559
             stat err =       0.000415344324
             autocorr =       1.170069863548
              std dev =       0.543021944941
             le_variance =       0.294872832688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383974500
  error estimate for blocks of size 2^( 2) =       0.000394168424
  error estimate for blocks of size 2^( 3) =       0.000403119177
  error estimate for blocks of size 2^( 4) =       0.000409422086
  error estimate for blocks of size 2^( 5) =       0.000414352815
  error estimate for blocks of size 2^( 6) =       0.000417381245
  error estimate for blocks of size 2^( 7) =       0.000420221150

      target function =                  N/A
              le_mean =     -17.215999716047
             les_mean =     296.702666039559
             stat err =       0.000415344324
             autocorr =       1.170069863548
              std dev =       0.543021944941
             le_variance =       0.294872832688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294904906795
                                         uncertainty =       0.001869148674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383974500
  error estimate for blocks of size 2^( 2) =       0.000394168424
  error estimate for blocks of size 2^( 3) =       0.000403119177
  error estimate for blocks of size 2^( 4) =       0.000409422086
  error estimate for blocks of size 2^( 5) =       0.000414352815
  error estimate for blocks of size 2^( 6) =       0.000417381245
  error estimate for blocks of size 2^( 7) =       0.000420221150

      target function =                  N/A
              le_mean =     -17.215999716047
             les_mean =     296.702666039559
             stat err =       0.000415344324
             autocorr =       1.170069863548
              std dev =       0.543021944941
             le_variance =       0.294872832688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215999716047        initial  <--
     9.5367e+57     9.5367e+58             0.0000e+00       -17.215999716047
     3.8147e+58     3.8147e+59             0.0000e+00       -17.215999716047
     1.5259e+59     1.5259e+60             0.0000e+00       -17.215999716047

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8025
  </log>
  <optVariables href="H2O.s074.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1936
    reference variance = 0.393815
====================================================
  Execution time = 2.0594e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1432e-01
  Total weights = 1.956483200e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675142021
                                         uncertainty =       0.002210724224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300675142021
                                         uncertainty =       0.002210724224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387740176
  error estimate for blocks of size 2^( 2) =       0.000397686991
  error estimate for blocks of size 2^( 3) =       0.000407088795
  error estimate for blocks of size 2^( 4) =       0.000413363081
  error estimate for blocks of size 2^( 5) =       0.000417123952
  error estimate for blocks of size 2^( 6) =       0.000417560265
  error estimate for blocks of size 2^( 7) =       0.000418868748

      target function =                  N/A
              le_mean =     -17.216258644092
             les_mean =     296.713884179563
             stat err =       0.000416729011
             autocorr =       1.155116707955
              std dev =       0.548347415330
             le_variance =       0.300684887899


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625864409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+58, overlap shift 9.5367e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216258644127       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216258644127       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+58 is 2.043912e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+59, overlap shift 3.8147e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216258644127       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216258644127       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+60, overlap shift 1.5259e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216258644127       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216258644127       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+60 is 1.277445e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.416584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6717e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2296
    reference variance = 0.197672
====================================================
  Execution time = 2.0733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1343e-01
  Total weights = 1.9564e+06
  Execution time = 1.8247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386622642
  error estimate for blocks of size 2^( 2) =       0.000396651199
  error estimate for blocks of size 2^( 3) =       0.000406073554
  error estimate for blocks of size 2^( 4) =       0.000412597691
  error estimate for blocks of size 2^( 5) =       0.000416976667
  error estimate for blocks of size 2^( 6) =       0.000418438923
  error estimate for blocks of size 2^( 7) =       0.000418485631

      target function =                  N/A
              le_mean =     -17.217353967786
             les_mean =     296.750712257181
             stat err =       0.000416624728
             autocorr =       1.161222701613
              std dev =       0.546766983796
             le_variance =       0.298954134569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386622642
  error estimate for blocks of size 2^( 2) =       0.000396651199
  error estimate for blocks of size 2^( 3) =       0.000406073554
  error estimate for blocks of size 2^( 4) =       0.000412597691
  error estimate for blocks of size 2^( 5) =       0.000416976667
  error estimate for blocks of size 2^( 6) =       0.000418438923
  error estimate for blocks of size 2^( 7) =       0.000418485631

      target function =                  N/A
              le_mean =     -17.217353967786
             les_mean =     296.750712257181
             stat err =       0.000416624728
             autocorr =       1.161222701613
              std dev =       0.546766983796
             le_variance =       0.298954134569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386622642
  error estimate for blocks of size 2^( 2) =       0.000396651199
  error estimate for blocks of size 2^( 3) =       0.000406073554
  error estimate for blocks of size 2^( 4) =       0.000412597691
  error estimate for blocks of size 2^( 5) =       0.000416976667
  error estimate for blocks of size 2^( 6) =       0.000418438923
  error estimate for blocks of size 2^( 7) =       0.000418485631

      target function =                  N/A
              le_mean =     -17.217353967786
             les_mean =     296.750712257181
             stat err =       0.000416624728
             autocorr =       1.161222701613
              std dev =       0.546766983796
             le_variance =       0.298954134569

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298970181403
                                         uncertainty =       0.001944832288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386622642
  error estimate for blocks of size 2^( 2) =       0.000396651199
  error estimate for blocks of size 2^( 3) =       0.000406073554
  error estimate for blocks of size 2^( 4) =       0.000412597691
  error estimate for blocks of size 2^( 5) =       0.000416976667
  error estimate for blocks of size 2^( 6) =       0.000418438923
  error estimate for blocks of size 2^( 7) =       0.000418485631

      target function =                  N/A
              le_mean =     -17.217353967786
             les_mean =     296.750712257181
             stat err =       0.000416624728
             autocorr =       1.161222701613
              std dev =       0.546766983796
             le_variance =       0.298954134569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217353967786        initial  <--
     9.5367e+58     9.5367e+59             2.0439e-63       -17.217353967786
     3.8147e+59     3.8147e+60             0.0000e+00       -17.217353967786
     1.5259e+60     1.5259e+61             1.2774e-64       -17.217353967786

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9413
  </log>
  <optVariables href="H2O.s075.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6665e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.285829
====================================================
  Execution time = 2.0818e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2301e-01
  Total weights = 1.956514636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302765577853
                                         uncertainty =       0.002643152943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302765577853
                                         uncertainty =       0.002643152943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389149458
  error estimate for blocks of size 2^( 2) =       0.000399123342
  error estimate for blocks of size 2^( 3) =       0.000408594540
  error estimate for blocks of size 2^( 4) =       0.000415023036
  error estimate for blocks of size 2^( 5) =       0.000419667813
  error estimate for blocks of size 2^( 6) =       0.000422099470
  error estimate for blocks of size 2^( 7) =       0.000423856688

      target function =                  N/A
              le_mean =     -17.216694064773
             les_mean =     296.737562314550
             stat err =       0.000420161752
             autocorr =       1.165735896023
              std dev =       0.550340441676
             le_variance =       0.302874601744


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669406477e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+59, overlap shift 9.5367e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694064822       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694064822       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+59 is 3.471575e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+60, overlap shift 3.8147e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694064822       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694064822       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216694064822       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+60 is 8.678936e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+61, overlap shift 1.5259e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694064822       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694064822       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+61 is 2.169734e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.417860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6816e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2884
    reference variance = 0.261491
====================================================
  Execution time = 2.0856e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1719e-01
  Total weights = 1.9567e+06
  Execution time = 1.8213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387444050
  error estimate for blocks of size 2^( 2) =       0.000397562537
  error estimate for blocks of size 2^( 3) =       0.000406682643
  error estimate for blocks of size 2^( 4) =       0.000414026545
  error estimate for blocks of size 2^( 5) =       0.000417567035
  error estimate for blocks of size 2^( 6) =       0.000419388914
  error estimate for blocks of size 2^( 7) =       0.000421814603

      target function =                  N/A
              le_mean =     -17.216073878011
             les_mean =     296.710385818857
             stat err =       0.000418199274
             autocorr =       1.165060716285
              std dev =       0.547928629644
             le_variance =       0.300225783183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387444050
  error estimate for blocks of size 2^( 2) =       0.000397562537
  error estimate for blocks of size 2^( 3) =       0.000406682643
  error estimate for blocks of size 2^( 4) =       0.000414026545
  error estimate for blocks of size 2^( 5) =       0.000417567035
  error estimate for blocks of size 2^( 6) =       0.000419388914
  error estimate for blocks of size 2^( 7) =       0.000421814603

      target function =                  N/A
              le_mean =     -17.216073878011
             les_mean =     296.710385818857
             stat err =       0.000418199274
             autocorr =       1.165060716285
              std dev =       0.547928629644
             le_variance =       0.300225783183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387444050
  error estimate for blocks of size 2^( 2) =       0.000397562537
  error estimate for blocks of size 2^( 3) =       0.000406682643
  error estimate for blocks of size 2^( 4) =       0.000414026545
  error estimate for blocks of size 2^( 5) =       0.000417567035
  error estimate for blocks of size 2^( 6) =       0.000419388914
  error estimate for blocks of size 2^( 7) =       0.000421814603

      target function =                  N/A
              le_mean =     -17.216073878011
             les_mean =     296.710385818857
             stat err =       0.000418199274
             autocorr =       1.165060716285
              std dev =       0.547928629644
             le_variance =       0.300225783183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300292537817
                                         uncertainty =       0.002823590741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387444050
  error estimate for blocks of size 2^( 2) =       0.000397562537
  error estimate for blocks of size 2^( 3) =       0.000406682643
  error estimate for blocks of size 2^( 4) =       0.000414026545
  error estimate for blocks of size 2^( 5) =       0.000417567035
  error estimate for blocks of size 2^( 6) =       0.000419388914
  error estimate for blocks of size 2^( 7) =       0.000421814603

      target function =                  N/A
              le_mean =     -17.216073878011
             les_mean =     296.710385818857
             stat err =       0.000418199274
             autocorr =       1.165060716285
              std dev =       0.547928629644
             le_variance =       0.300225783183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216073878011        initial  <--
     9.5367e+59     9.5367e+60             3.4716e-64       -17.216073878011
     3.8147e+60     3.8147e+61             8.6789e-65       -17.216073878011
     1.5259e+61     1.5259e+62             2.1697e-65       -17.216073878011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0433
  </log>
  <optVariables href="H2O.s076.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1496
    reference variance = 0.594987
====================================================
  Execution time = 2.0616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1136e-01
  Total weights = 1.956453301e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296159759849
                                         uncertainty =       0.001557815298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296159759849
                                         uncertainty =       0.001557815298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384890158
  error estimate for blocks of size 2^( 2) =       0.000394887469
  error estimate for blocks of size 2^( 3) =       0.000403761727
  error estimate for blocks of size 2^( 4) =       0.000409905206
  error estimate for blocks of size 2^( 5) =       0.000413838035
  error estimate for blocks of size 2^( 6) =       0.000416626622
  error estimate for blocks of size 2^( 7) =       0.000417609811

      target function =                  N/A
              le_mean =     -17.215958401295
             les_mean =     296.700587214754
             stat err =       0.000414494919
             autocorr =       1.159751142117
              std dev =       0.544316881970
             le_variance =       0.296280867997


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595840129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+60, overlap shift 9.5367e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+61, overlap shift 3.8147e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+62, overlap shift 1.5259e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215958401302       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.419109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6704e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2784
    reference variance = 0.246878
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1024e-01
  Total weights = 1.9561e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384265387
  error estimate for blocks of size 2^( 2) =       0.000394479647
  error estimate for blocks of size 2^( 3) =       0.000403872228
  error estimate for blocks of size 2^( 4) =       0.000410617497
  error estimate for blocks of size 2^( 5) =       0.000415518896
  error estimate for blocks of size 2^( 6) =       0.000418051575
  error estimate for blocks of size 2^( 7) =       0.000418759224

      target function =                  N/A
              le_mean =     -17.215940467822
             les_mean =     296.698842105908
             stat err =       0.000415736798
             autocorr =       1.170508035457
              std dev =       0.543433322141
             le_variance =       0.295319775613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384265387
  error estimate for blocks of size 2^( 2) =       0.000394479647
  error estimate for blocks of size 2^( 3) =       0.000403872228
  error estimate for blocks of size 2^( 4) =       0.000410617497
  error estimate for blocks of size 2^( 5) =       0.000415518896
  error estimate for blocks of size 2^( 6) =       0.000418051575
  error estimate for blocks of size 2^( 7) =       0.000418759224

      target function =                  N/A
              le_mean =     -17.215940467822
             les_mean =     296.698842105908
             stat err =       0.000415736798
             autocorr =       1.170508035457
              std dev =       0.543433322141
             le_variance =       0.295319775613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384265387
  error estimate for blocks of size 2^( 2) =       0.000394479647
  error estimate for blocks of size 2^( 3) =       0.000403872228
  error estimate for blocks of size 2^( 4) =       0.000410617497
  error estimate for blocks of size 2^( 5) =       0.000415518896
  error estimate for blocks of size 2^( 6) =       0.000418051575
  error estimate for blocks of size 2^( 7) =       0.000418759224

      target function =                  N/A
              le_mean =     -17.215940467822
             les_mean =     296.698842105908
             stat err =       0.000415736798
             autocorr =       1.170508035457
              std dev =       0.543433322141
             le_variance =       0.295319775613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295227692538
                                         uncertainty =       0.001725381270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384265387
  error estimate for blocks of size 2^( 2) =       0.000394479647
  error estimate for blocks of size 2^( 3) =       0.000403872228
  error estimate for blocks of size 2^( 4) =       0.000410617497
  error estimate for blocks of size 2^( 5) =       0.000415518896
  error estimate for blocks of size 2^( 6) =       0.000418051575
  error estimate for blocks of size 2^( 7) =       0.000418759224

      target function =                  N/A
              le_mean =     -17.215940467822
             les_mean =     296.698842105908
             stat err =       0.000415736798
             autocorr =       1.170508035457
              std dev =       0.543433322141
             le_variance =       0.295319775613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215940467822        initial  <--
     9.5367e+60     9.5367e+61             0.0000e+00       -17.215940467822
     3.8147e+61     3.8147e+62             0.0000e+00       -17.215940467822
     1.5259e+62     1.5259e+63             0.0000e+00       -17.215940467822

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0235
  </log>
  <optVariables href="H2O.s077.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9734e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1512
    reference variance = 0.258951
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0892e-01
  Total weights = 1.956690919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296454779064
                                         uncertainty =       0.002763444185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296454779064
                                         uncertainty =       0.002763444185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384996003
  error estimate for blocks of size 2^( 2) =       0.000394976926
  error estimate for blocks of size 2^( 3) =       0.000404136599
  error estimate for blocks of size 2^( 4) =       0.000410600648
  error estimate for blocks of size 2^( 5) =       0.000416504575
  error estimate for blocks of size 2^( 6) =       0.000419449261
  error estimate for blocks of size 2^( 7) =       0.000421245405

      target function =                  N/A
              le_mean =     -17.215640284818
             les_mean =     296.687189852358
             stat err =       0.000416949972
             autocorr =       1.172885069800
              std dev =       0.544466568275
             le_variance =       0.296443843969


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721564028482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+61, overlap shift 9.5367e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+62, overlap shift 3.8147e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+63, overlap shift 1.5259e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215640284829       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.420377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6972e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2479
    reference variance = 0.200268
====================================================
  Execution time = 2.0280e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1557e-01
  Total weights = 1.9565e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386497083
  error estimate for blocks of size 2^( 2) =       0.000396875633
  error estimate for blocks of size 2^( 3) =       0.000405815113
  error estimate for blocks of size 2^( 4) =       0.000412413498
  error estimate for blocks of size 2^( 5) =       0.000416400427
  error estimate for blocks of size 2^( 6) =       0.000419354880
  error estimate for blocks of size 2^( 7) =       0.000420359341

      target function =                  N/A
              le_mean =     -17.216466131318
             les_mean =     296.722274055419
             stat err =       0.000417132037
             autocorr =       1.164808823075
              std dev =       0.546589416101
             le_variance =       0.298759989793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386497083
  error estimate for blocks of size 2^( 2) =       0.000396875633
  error estimate for blocks of size 2^( 3) =       0.000405815113
  error estimate for blocks of size 2^( 4) =       0.000412413498
  error estimate for blocks of size 2^( 5) =       0.000416400427
  error estimate for blocks of size 2^( 6) =       0.000419354880
  error estimate for blocks of size 2^( 7) =       0.000420359341

      target function =                  N/A
              le_mean =     -17.216466131318
             les_mean =     296.722274055419
             stat err =       0.000417132037
             autocorr =       1.164808823075
              std dev =       0.546589416101
             le_variance =       0.298759989793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386497083
  error estimate for blocks of size 2^( 2) =       0.000396875633
  error estimate for blocks of size 2^( 3) =       0.000405815113
  error estimate for blocks of size 2^( 4) =       0.000412413498
  error estimate for blocks of size 2^( 5) =       0.000416400427
  error estimate for blocks of size 2^( 6) =       0.000419354880
  error estimate for blocks of size 2^( 7) =       0.000420359341

      target function =                  N/A
              le_mean =     -17.216466131318
             les_mean =     296.722274055419
             stat err =       0.000417132037
             autocorr =       1.164808823075
              std dev =       0.546589416101
             le_variance =       0.298759989793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298824176960
                                         uncertainty =       0.001960872339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386497083
  error estimate for blocks of size 2^( 2) =       0.000396875633
  error estimate for blocks of size 2^( 3) =       0.000405815113
  error estimate for blocks of size 2^( 4) =       0.000412413498
  error estimate for blocks of size 2^( 5) =       0.000416400427
  error estimate for blocks of size 2^( 6) =       0.000419354880
  error estimate for blocks of size 2^( 7) =       0.000420359341

      target function =                  N/A
              le_mean =     -17.216466131318
             les_mean =     296.722274055419
             stat err =       0.000417132037
             autocorr =       1.164808823075
              std dev =       0.546589416101
             le_variance =       0.298759989793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216466131318        initial  <--
     9.5367e+61     9.5367e+62             0.0000e+00       -17.216466131318
     3.8147e+62     3.8147e+63             0.0000e+00       -17.216466131318
     1.5259e+63     1.5259e+64             0.0000e+00       -17.216466131318

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4785
  </log>
  <optVariables href="H2O.s078.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1742
    reference variance = 0.248012
====================================================
  Execution time = 2.0535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1302e-01
  Total weights = 1.956520135e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299103629377
                                         uncertainty =       0.002257591495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299103629377
                                         uncertainty =       0.002257591495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386680903
  error estimate for blocks of size 2^( 2) =       0.000396353724
  error estimate for blocks of size 2^( 3) =       0.000404850401
  error estimate for blocks of size 2^( 4) =       0.000412000841
  error estimate for blocks of size 2^( 5) =       0.000416089073
  error estimate for blocks of size 2^( 6) =       0.000417877342
  error estimate for blocks of size 2^( 7) =       0.000418533587

      target function =                  N/A
              le_mean =     -17.216472053676
             les_mean =     296.719925444324
             stat err =       0.000416125211
             autocorr =       1.158090790058
              std dev =       0.546849377458
             le_variance =       0.299044241626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647205368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+62, overlap shift 9.5367e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+63, overlap shift 3.8147e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+64, overlap shift 1.5259e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216472053722       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.421610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6619e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.0069
    reference variance = 6.46646
====================================================
  Execution time = 2.0649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2033e-01
  Total weights = 1.9566e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388081694
  error estimate for blocks of size 2^( 2) =       0.000397879701
  error estimate for blocks of size 2^( 3) =       0.000406991192
  error estimate for blocks of size 2^( 4) =       0.000413504911
  error estimate for blocks of size 2^( 5) =       0.000417550397
  error estimate for blocks of size 2^( 6) =       0.000420107618
  error estimate for blocks of size 2^( 7) =       0.000418979987

      target function =                  N/A
              le_mean =     -17.215680348971
             les_mean =     296.699976578739
             stat err =       0.000417535728
             autocorr =       1.157553232803
              std dev =       0.548830394781
             le_variance =       0.301214802235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388081694
  error estimate for blocks of size 2^( 2) =       0.000397879701
  error estimate for blocks of size 2^( 3) =       0.000406991192
  error estimate for blocks of size 2^( 4) =       0.000413504911
  error estimate for blocks of size 2^( 5) =       0.000417550397
  error estimate for blocks of size 2^( 6) =       0.000420107618
  error estimate for blocks of size 2^( 7) =       0.000418979987

      target function =                  N/A
              le_mean =     -17.215680348971
             les_mean =     296.699976578739
             stat err =       0.000417535728
             autocorr =       1.157553232803
              std dev =       0.548830394781
             le_variance =       0.301214802235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388081694
  error estimate for blocks of size 2^( 2) =       0.000397879701
  error estimate for blocks of size 2^( 3) =       0.000406991192
  error estimate for blocks of size 2^( 4) =       0.000413504911
  error estimate for blocks of size 2^( 5) =       0.000417550397
  error estimate for blocks of size 2^( 6) =       0.000420107618
  error estimate for blocks of size 2^( 7) =       0.000418979987

      target function =                  N/A
              le_mean =     -17.215680348971
             les_mean =     296.699976578739
             stat err =       0.000417535728
             autocorr =       1.157553232803
              std dev =       0.548830394781
             le_variance =       0.301214802235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300872427702
                                         uncertainty =       0.002312437435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388081694
  error estimate for blocks of size 2^( 2) =       0.000397879701
  error estimate for blocks of size 2^( 3) =       0.000406991192
  error estimate for blocks of size 2^( 4) =       0.000413504911
  error estimate for blocks of size 2^( 5) =       0.000417550397
  error estimate for blocks of size 2^( 6) =       0.000420107618
  error estimate for blocks of size 2^( 7) =       0.000418979987

      target function =                  N/A
              le_mean =     -17.215680348971
             les_mean =     296.699976578739
             stat err =       0.000417535728
             autocorr =       1.157553232803
              std dev =       0.548830394781
             le_variance =       0.301214802235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215680348971        initial  <--
     9.5367e+62     9.5367e+63             0.0000e+00       -17.215680348971
     3.8147e+63     3.8147e+64             0.0000e+00       -17.215680348971
     1.5259e+64     1.5259e+65             0.0000e+00       -17.215680348971

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8378
  </log>
  <optVariables href="H2O.s079.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6464e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.166505
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0648e-01
  Total weights = 1.956371088e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294416339031
                                         uncertainty =       0.001666878288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294416339031
                                         uncertainty =       0.001666878288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383683177
  error estimate for blocks of size 2^( 2) =       0.000393885904
  error estimate for blocks of size 2^( 3) =       0.000403469455
  error estimate for blocks of size 2^( 4) =       0.000410411601
  error estimate for blocks of size 2^( 5) =       0.000414264886
  error estimate for blocks of size 2^( 6) =       0.000415167993
  error estimate for blocks of size 2^( 7) =       0.000415883274

      target function =                  N/A
              le_mean =     -17.216205692753
             les_mean =     296.704219738856
             stat err =       0.000413931939
             autocorr =       1.163891134518
              std dev =       0.542609952309
             le_variance =       0.294425560345


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620569275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+63, overlap shift 9.5367e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+64, overlap shift 3.8147e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+65, overlap shift 1.5259e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216205692813       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.422848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6750e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1917
    reference variance = 0.135838
====================================================
  Execution time = 2.0530e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1407e-01
  Total weights = 1.9568e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386132982
  error estimate for blocks of size 2^( 2) =       0.000396107342
  error estimate for blocks of size 2^( 3) =       0.000405353092
  error estimate for blocks of size 2^( 4) =       0.000412280815
  error estimate for blocks of size 2^( 5) =       0.000417025000
  error estimate for blocks of size 2^( 6) =       0.000419117868
  error estimate for blocks of size 2^( 7) =       0.000422171074

      target function =                  N/A
              le_mean =     -17.216385906340
             les_mean =     296.718017935865
             stat err =       0.000417648689
             autocorr =       1.169899210421
              std dev =       0.546074500072
             le_variance =       0.298197359629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386132982
  error estimate for blocks of size 2^( 2) =       0.000396107342
  error estimate for blocks of size 2^( 3) =       0.000405353092
  error estimate for blocks of size 2^( 4) =       0.000412280815
  error estimate for blocks of size 2^( 5) =       0.000417025000
  error estimate for blocks of size 2^( 6) =       0.000419117868
  error estimate for blocks of size 2^( 7) =       0.000422171074

      target function =                  N/A
              le_mean =     -17.216385906340
             les_mean =     296.718017935865
             stat err =       0.000417648689
             autocorr =       1.169899210421
              std dev =       0.546074500072
             le_variance =       0.298197359629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386132982
  error estimate for blocks of size 2^( 2) =       0.000396107342
  error estimate for blocks of size 2^( 3) =       0.000405353092
  error estimate for blocks of size 2^( 4) =       0.000412280815
  error estimate for blocks of size 2^( 5) =       0.000417025000
  error estimate for blocks of size 2^( 6) =       0.000419117868
  error estimate for blocks of size 2^( 7) =       0.000422171074

      target function =                  N/A
              le_mean =     -17.216385906340
             les_mean =     296.718017935865
             stat err =       0.000417648689
             autocorr =       1.169899210421
              std dev =       0.546074500072
             le_variance =       0.298197359629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298264622530
                                         uncertainty =       0.003158526071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386132982
  error estimate for blocks of size 2^( 2) =       0.000396107342
  error estimate for blocks of size 2^( 3) =       0.000405353092
  error estimate for blocks of size 2^( 4) =       0.000412280815
  error estimate for blocks of size 2^( 5) =       0.000417025000
  error estimate for blocks of size 2^( 6) =       0.000419117868
  error estimate for blocks of size 2^( 7) =       0.000422171074

      target function =                  N/A
              le_mean =     -17.216385906340
             les_mean =     296.718017935865
             stat err =       0.000417648689
             autocorr =       1.169899210421
              std dev =       0.546074500072
             le_variance =       0.298197359629


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216385906340        initial  <--
     9.5367e+63     9.5367e+64             0.0000e+00       -17.216385906340
     3.8147e+64     3.8147e+65             0.0000e+00       -17.216385906340
     1.5259e+65     1.5259e+66             0.0000e+00       -17.216385906340

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7180
  </log>
  <optVariables href="H2O.s080.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1957
    reference variance = 0.461505
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1978e-01
  Total weights = 1.956139315e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304769714774
                                         uncertainty =       0.002569525302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304769714774
                                         uncertainty =       0.002569525302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390446310
  error estimate for blocks of size 2^( 2) =       0.000400554947
  error estimate for blocks of size 2^( 3) =       0.000409872256
  error estimate for blocks of size 2^( 4) =       0.000416988381
  error estimate for blocks of size 2^( 5) =       0.000421069268
  error estimate for blocks of size 2^( 6) =       0.000424383210
  error estimate for blocks of size 2^( 7) =       0.000424506907

      target function =                  N/A
              le_mean =     -17.216384071144
             les_mean =     296.723659772406
             stat err =       0.000421736942
             autocorr =       1.166703881550
              std dev =       0.552174467283
             le_variance =       0.304896642320


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638407114e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+64, overlap shift 9.5367e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384071155       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384071155       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+64 is 4.239330e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+65, overlap shift 3.8147e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384071155       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384071155       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+65 is 1.059833e-69

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+66, overlap shift 1.5259e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216384071155       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216384071155       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+66 is 2.649582e-70

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.424065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6871e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.262282
====================================================
  Execution time = 2.0699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1182e-01
  Total weights = 1.9565e+06
  Execution time = 1.8313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385688552
  error estimate for blocks of size 2^( 2) =       0.000395758416
  error estimate for blocks of size 2^( 3) =       0.000404555943
  error estimate for blocks of size 2^( 4) =       0.000411556928
  error estimate for blocks of size 2^( 5) =       0.000415747017
  error estimate for blocks of size 2^( 6) =       0.000418259502
  error estimate for blocks of size 2^( 7) =       0.000419873289

      target function =                  N/A
              le_mean =     -17.215963181083
             les_mean =     296.701213096441
             stat err =       0.000416359184
             autocorr =       1.165367230493
              std dev =       0.545445980393
             le_variance =       0.297511317527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385688552
  error estimate for blocks of size 2^( 2) =       0.000395758416
  error estimate for blocks of size 2^( 3) =       0.000404555943
  error estimate for blocks of size 2^( 4) =       0.000411556928
  error estimate for blocks of size 2^( 5) =       0.000415747017
  error estimate for blocks of size 2^( 6) =       0.000418259502
  error estimate for blocks of size 2^( 7) =       0.000419873289

      target function =                  N/A
              le_mean =     -17.215963181083
             les_mean =     296.701213096441
             stat err =       0.000416359184
             autocorr =       1.165367230493
              std dev =       0.545445980393
             le_variance =       0.297511317527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385688552
  error estimate for blocks of size 2^( 2) =       0.000395758416
  error estimate for blocks of size 2^( 3) =       0.000404555943
  error estimate for blocks of size 2^( 4) =       0.000411556928
  error estimate for blocks of size 2^( 5) =       0.000415747017
  error estimate for blocks of size 2^( 6) =       0.000418259502
  error estimate for blocks of size 2^( 7) =       0.000419873289

      target function =                  N/A
              le_mean =     -17.215963181083
             les_mean =     296.701213096441
             stat err =       0.000416359184
             autocorr =       1.165367230493
              std dev =       0.545445980393
             le_variance =       0.297511317527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297553403487
                                         uncertainty =       0.002003002872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385688552
  error estimate for blocks of size 2^( 2) =       0.000395758416
  error estimate for blocks of size 2^( 3) =       0.000404555943
  error estimate for blocks of size 2^( 4) =       0.000411556928
  error estimate for blocks of size 2^( 5) =       0.000415747017
  error estimate for blocks of size 2^( 6) =       0.000418259502
  error estimate for blocks of size 2^( 7) =       0.000419873289

      target function =                  N/A
              le_mean =     -17.215963181083
             les_mean =     296.701213096441
             stat err =       0.000416359184
             autocorr =       1.165367230493
              std dev =       0.545445980393
             le_variance =       0.297511317527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215963181083        initial  <--
     9.5367e+64     9.5367e+65             4.2393e-69       -17.215963181083
     3.8147e+65     3.8147e+66             1.0598e-69       -17.215963181083
     1.5259e+66     1.5259e+67             2.6496e-70       -17.215963181083

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9049
  </log>
  <optVariables href="H2O.s081.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.303284
====================================================
  Execution time = 2.0626e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1453e-01
  Total weights = 1.956502427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299709270025
                                         uncertainty =       0.002007217108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299709270025
                                         uncertainty =       0.002007217108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387107623
  error estimate for blocks of size 2^( 2) =       0.000397365584
  error estimate for blocks of size 2^( 3) =       0.000406495126
  error estimate for blocks of size 2^( 4) =       0.000413139906
  error estimate for blocks of size 2^( 5) =       0.000416492468
  error estimate for blocks of size 2^( 6) =       0.000418324673
  error estimate for blocks of size 2^( 7) =       0.000419017623

      target function =                  N/A
              le_mean =     -17.217237675392
             les_mean =     296.747798315285
             stat err =       0.000416743667
             autocorr =       1.158976339449
              std dev =       0.547452851226
             le_variance =       0.299704624315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721723767539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+65, overlap shift 9.5367e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+66, overlap shift 3.8147e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+67, overlap shift 1.5259e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217237675459       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.425299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6711e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2273
    reference variance = 0.121732
====================================================
  Execution time = 2.0851e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1635e-01
  Total weights = 1.9564e+06
  Execution time = 1.8237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387953446
  error estimate for blocks of size 2^( 2) =       0.000398008756
  error estimate for blocks of size 2^( 3) =       0.000407151873
  error estimate for blocks of size 2^( 4) =       0.000414463946
  error estimate for blocks of size 2^( 5) =       0.000419744066
  error estimate for blocks of size 2^( 6) =       0.000422479136
  error estimate for blocks of size 2^( 7) =       0.000422172287

      target function =                  N/A
              le_mean =     -17.217020194938
             les_mean =     296.742136359639
             stat err =       0.000419714859
             autocorr =       1.170440823315
              std dev =       0.548649024992
             le_variance =       0.301015752625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387953446
  error estimate for blocks of size 2^( 2) =       0.000398008756
  error estimate for blocks of size 2^( 3) =       0.000407151873
  error estimate for blocks of size 2^( 4) =       0.000414463946
  error estimate for blocks of size 2^( 5) =       0.000419744066
  error estimate for blocks of size 2^( 6) =       0.000422479136
  error estimate for blocks of size 2^( 7) =       0.000422172287

      target function =                  N/A
              le_mean =     -17.217020194938
             les_mean =     296.742136359639
             stat err =       0.000419714859
             autocorr =       1.170440823315
              std dev =       0.548649024992
             le_variance =       0.301015752625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387953446
  error estimate for blocks of size 2^( 2) =       0.000398008756
  error estimate for blocks of size 2^( 3) =       0.000407151873
  error estimate for blocks of size 2^( 4) =       0.000414463946
  error estimate for blocks of size 2^( 5) =       0.000419744066
  error estimate for blocks of size 2^( 6) =       0.000422479136
  error estimate for blocks of size 2^( 7) =       0.000422172287

      target function =                  N/A
              le_mean =     -17.217020194938
             les_mean =     296.742136359639
             stat err =       0.000419714859
             autocorr =       1.170440823315
              std dev =       0.548649024992
             le_variance =       0.301015752625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301080598130
                                         uncertainty =       0.002507438267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387953446
  error estimate for blocks of size 2^( 2) =       0.000398008756
  error estimate for blocks of size 2^( 3) =       0.000407151873
  error estimate for blocks of size 2^( 4) =       0.000414463946
  error estimate for blocks of size 2^( 5) =       0.000419744066
  error estimate for blocks of size 2^( 6) =       0.000422479136
  error estimate for blocks of size 2^( 7) =       0.000422172287

      target function =                  N/A
              le_mean =     -17.217020194938
             les_mean =     296.742136359639
             stat err =       0.000419714859
             autocorr =       1.170440823315
              std dev =       0.548649024992
             le_variance =       0.301015752625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217020194938        initial  <--
     9.5367e+65     9.5367e+66             0.0000e+00       -17.217020194938
     3.8147e+66     3.8147e+67             0.0000e+00       -17.217020194938
     1.5259e+67     1.5259e+68             0.0000e+00       -17.217020194938

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0117
  </log>
  <optVariables href="H2O.s082.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.34055
====================================================
  Execution time = 2.2322e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1394e-01
  Total weights = 1.956422415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300543811321
                                         uncertainty =       0.002564808406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300543811321
                                         uncertainty =       0.002564808406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387634921
  error estimate for blocks of size 2^( 2) =       0.000397715641
  error estimate for blocks of size 2^( 3) =       0.000406358784
  error estimate for blocks of size 2^( 4) =       0.000413786373
  error estimate for blocks of size 2^( 5) =       0.000417960578
  error estimate for blocks of size 2^( 6) =       0.000419520019
  error estimate for blocks of size 2^( 7) =       0.000420379866

      target function =                  N/A
              le_mean =     -17.216305252128
             les_mean =     296.715105446324
             stat err =       0.000417911709
             autocorr =       1.162313516304
              std dev =       0.548198563115
             le_variance =       0.300521664601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630525213e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+66, overlap shift 9.5367e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+67, overlap shift 3.8147e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+68, overlap shift 1.5259e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216305252175       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.426541 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8485e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2025
    reference variance = 0.203305
====================================================
  Execution time = 2.0785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1500e-01
  Total weights = 1.9565e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385717768
  error estimate for blocks of size 2^( 2) =       0.000395966314
  error estimate for blocks of size 2^( 3) =       0.000404807930
  error estimate for blocks of size 2^( 4) =       0.000411529313
  error estimate for blocks of size 2^( 5) =       0.000416155921
  error estimate for blocks of size 2^( 6) =       0.000419073888
  error estimate for blocks of size 2^( 7) =       0.000423723723

      target function =                  N/A
              le_mean =     -17.215596949145
             les_mean =     296.691777672978
             stat err =       0.000417620711
             autocorr =       1.172262215147
              std dev =       0.545487299061
             le_variance =       0.297556393437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385717768
  error estimate for blocks of size 2^( 2) =       0.000395966314
  error estimate for blocks of size 2^( 3) =       0.000404807930
  error estimate for blocks of size 2^( 4) =       0.000411529313
  error estimate for blocks of size 2^( 5) =       0.000416155921
  error estimate for blocks of size 2^( 6) =       0.000419073888
  error estimate for blocks of size 2^( 7) =       0.000423723723

      target function =                  N/A
              le_mean =     -17.215596949145
             les_mean =     296.691777672978
             stat err =       0.000417620711
             autocorr =       1.172262215147
              std dev =       0.545487299061
             le_variance =       0.297556393437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385717768
  error estimate for blocks of size 2^( 2) =       0.000395966314
  error estimate for blocks of size 2^( 3) =       0.000404807930
  error estimate for blocks of size 2^( 4) =       0.000411529313
  error estimate for blocks of size 2^( 5) =       0.000416155921
  error estimate for blocks of size 2^( 6) =       0.000419073888
  error estimate for blocks of size 2^( 7) =       0.000423723723

      target function =                  N/A
              le_mean =     -17.215596949145
             les_mean =     296.691777672978
             stat err =       0.000417620711
             autocorr =       1.172262215147
              std dev =       0.545487299061
             le_variance =       0.297556393437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297663633521
                                         uncertainty =       0.001892010724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385717768
  error estimate for blocks of size 2^( 2) =       0.000395966314
  error estimate for blocks of size 2^( 3) =       0.000404807930
  error estimate for blocks of size 2^( 4) =       0.000411529313
  error estimate for blocks of size 2^( 5) =       0.000416155921
  error estimate for blocks of size 2^( 6) =       0.000419073888
  error estimate for blocks of size 2^( 7) =       0.000423723723

      target function =                  N/A
              le_mean =     -17.215596949145
             les_mean =     296.691777672978
             stat err =       0.000417620711
             autocorr =       1.172262215147
              std dev =       0.545487299061
             le_variance =       0.297556393437


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215596949145        initial  <--
     9.5367e+66     9.5367e+67             0.0000e+00       -17.215596949145
     3.8147e+67     3.8147e+68             0.0000e+00       -17.215596949145
     1.5259e+68     1.5259e+69             0.0000e+00       -17.215596949145

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9860
  </log>
  <optVariables href="H2O.s083.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1619
    reference variance = 0.204159
====================================================
  Execution time = 2.0515e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1710e-01
  Total weights = 1.956357795e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302298128276
                                         uncertainty =       0.002128283584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302298128276
                                         uncertainty =       0.002128283584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388739076
  error estimate for blocks of size 2^( 2) =       0.000398413088
  error estimate for blocks of size 2^( 3) =       0.000407325354
  error estimate for blocks of size 2^( 4) =       0.000413330665
  error estimate for blocks of size 2^( 5) =       0.000417367138
  error estimate for blocks of size 2^( 6) =       0.000419771038
  error estimate for blocks of size 2^( 7) =       0.000420476844

      target function =                  N/A
              le_mean =     -17.216840236828
             les_mean =     296.736683825082
             stat err =       0.000417736421
             autocorr =       1.154750842131
              std dev =       0.549760073538
             le_variance =       0.302236138456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684023683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+67, overlap shift 9.5367e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+67 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+68, overlap shift 3.8147e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+68 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+69, overlap shift 1.5259e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216840236855       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.427784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6550e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.230063
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1999e-01
  Total weights = 1.9566e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389760670
  error estimate for blocks of size 2^( 2) =       0.000399684959
  error estimate for blocks of size 2^( 3) =       0.000408375274
  error estimate for blocks of size 2^( 4) =       0.000415415714
  error estimate for blocks of size 2^( 5) =       0.000418928993
  error estimate for blocks of size 2^( 6) =       0.000420358769
  error estimate for blocks of size 2^( 7) =       0.000423278157

      target function =                  N/A
              le_mean =     -17.216262197699
             les_mean =     296.719677221854
             stat err =       0.000419495408
             autocorr =       1.158399590992
              std dev =       0.551204825936
             le_variance =       0.303826760136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389760670
  error estimate for blocks of size 2^( 2) =       0.000399684959
  error estimate for blocks of size 2^( 3) =       0.000408375274
  error estimate for blocks of size 2^( 4) =       0.000415415714
  error estimate for blocks of size 2^( 5) =       0.000418928993
  error estimate for blocks of size 2^( 6) =       0.000420358769
  error estimate for blocks of size 2^( 7) =       0.000423278157

      target function =                  N/A
              le_mean =     -17.216262197699
             les_mean =     296.719677221854
             stat err =       0.000419495408
             autocorr =       1.158399590992
              std dev =       0.551204825936
             le_variance =       0.303826760136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389760670
  error estimate for blocks of size 2^( 2) =       0.000399684959
  error estimate for blocks of size 2^( 3) =       0.000408375274
  error estimate for blocks of size 2^( 4) =       0.000415415714
  error estimate for blocks of size 2^( 5) =       0.000418928993
  error estimate for blocks of size 2^( 6) =       0.000420358769
  error estimate for blocks of size 2^( 7) =       0.000423278157

      target function =                  N/A
              le_mean =     -17.216262197699
             les_mean =     296.719677221854
             stat err =       0.000419495408
             autocorr =       1.158399590992
              std dev =       0.551204825936
             le_variance =       0.303826760136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303922755348
                                         uncertainty =       0.002612899784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389760670
  error estimate for blocks of size 2^( 2) =       0.000399684959
  error estimate for blocks of size 2^( 3) =       0.000408375274
  error estimate for blocks of size 2^( 4) =       0.000415415714
  error estimate for blocks of size 2^( 5) =       0.000418928993
  error estimate for blocks of size 2^( 6) =       0.000420358769
  error estimate for blocks of size 2^( 7) =       0.000423278157

      target function =                  N/A
              le_mean =     -17.216262197699
             les_mean =     296.719677221854
             stat err =       0.000419495408
             autocorr =       1.158399590992
              std dev =       0.551204825936
             le_variance =       0.303826760136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216262197699        initial  <--
     9.5367e+67     9.5367e+68             0.0000e+00       -17.216262197699
     3.8147e+68     3.8147e+69             0.0000e+00       -17.216262197699
     1.5259e+69     1.5259e+70             0.0000e+00       -17.216262197699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7726
  </log>
  <optVariables href="H2O.s084.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6329e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.17024
====================================================
  Execution time = 2.0623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1603e-01
  Total weights = 1.956582417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297921085509
                                         uncertainty =       0.001758877785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297921085509
                                         uncertainty =       0.001758877785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385983836
  error estimate for blocks of size 2^( 2) =       0.000395947557
  error estimate for blocks of size 2^( 3) =       0.000404919692
  error estimate for blocks of size 2^( 4) =       0.000411649328
  error estimate for blocks of size 2^( 5) =       0.000415724557
  error estimate for blocks of size 2^( 6) =       0.000419623840
  error estimate for blocks of size 2^( 7) =       0.000420630826

      target function =                  N/A
              le_mean =     -17.216371944720
             les_mean =     296.719495908019
             stat err =       0.000416907138
             autocorr =       1.166649573064
              std dev =       0.545863575053
             le_variance =       0.297967042570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637194472e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+68, overlap shift 9.5367e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216371944744       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216371944744       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216371944744       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+68 is 4.832509e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+69, overlap shift 3.8147e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216371944744       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216371944744       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216371944744       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+69 is 1.208127e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+70, overlap shift 1.5259e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216371944744       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216371944744       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216371944744       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+70 is 3.020318e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.429279 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6798e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2197
    reference variance = 0.298279
====================================================
  Execution time = 2.0713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1608e-01
  Total weights = 1.9568e+06
  Execution time = 1.8224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387758494
  error estimate for blocks of size 2^( 2) =       0.000397630341
  error estimate for blocks of size 2^( 3) =       0.000407170241
  error estimate for blocks of size 2^( 4) =       0.000414204601
  error estimate for blocks of size 2^( 5) =       0.000418755120
  error estimate for blocks of size 2^( 6) =       0.000420980069
  error estimate for blocks of size 2^( 7) =       0.000421841578

      target function =                  N/A
              le_mean =     -17.216573909056
             les_mean =     296.726497438003
             stat err =       0.000418945342
             autocorr =       1.167325819695
              std dev =       0.548373321521
             le_variance =       0.300713299755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387758494
  error estimate for blocks of size 2^( 2) =       0.000397630341
  error estimate for blocks of size 2^( 3) =       0.000407170241
  error estimate for blocks of size 2^( 4) =       0.000414204601
  error estimate for blocks of size 2^( 5) =       0.000418755120
  error estimate for blocks of size 2^( 6) =       0.000420980069
  error estimate for blocks of size 2^( 7) =       0.000421841578

      target function =                  N/A
              le_mean =     -17.216573909056
             les_mean =     296.726497438003
             stat err =       0.000418945342
             autocorr =       1.167325819695
              std dev =       0.548373321521
             le_variance =       0.300713299755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387758494
  error estimate for blocks of size 2^( 2) =       0.000397630341
  error estimate for blocks of size 2^( 3) =       0.000407170241
  error estimate for blocks of size 2^( 4) =       0.000414204601
  error estimate for blocks of size 2^( 5) =       0.000418755120
  error estimate for blocks of size 2^( 6) =       0.000420980069
  error estimate for blocks of size 2^( 7) =       0.000421841578

      target function =                  N/A
              le_mean =     -17.216573909056
             les_mean =     296.726497438003
             stat err =       0.000418945342
             autocorr =       1.167325819695
              std dev =       0.548373321521
             le_variance =       0.300713299755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300592453567
                                         uncertainty =       0.002438171191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387758494
  error estimate for blocks of size 2^( 2) =       0.000397630341
  error estimate for blocks of size 2^( 3) =       0.000407170241
  error estimate for blocks of size 2^( 4) =       0.000414204601
  error estimate for blocks of size 2^( 5) =       0.000418755120
  error estimate for blocks of size 2^( 6) =       0.000420980069
  error estimate for blocks of size 2^( 7) =       0.000421841578

      target function =                  N/A
              le_mean =     -17.216573909056
             les_mean =     296.726497438003
             stat err =       0.000418945342
             autocorr =       1.167325819695
              std dev =       0.548373321521
             le_variance =       0.300713299755


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216573909056        initial  <--
     9.5367e+68     9.5367e+69             4.8325e-73       -17.216573909056
     3.8147e+69     3.8147e+70             1.2081e-73       -17.216573909056
     1.5259e+70     1.5259e+71             3.0203e-74       -17.216573909056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8985
  </log>
  <optVariables href="H2O.s085.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1273
    reference variance = 0.300771
====================================================
  Execution time = 2.0831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2083e-01
  Total weights = 1.956550510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303239251662
                                         uncertainty =       0.002575068794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303239251662
                                         uncertainty =       0.002575068794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389351838
  error estimate for blocks of size 2^( 2) =       0.000399302822
  error estimate for blocks of size 2^( 3) =       0.000408526550
  error estimate for blocks of size 2^( 4) =       0.000415530554
  error estimate for blocks of size 2^( 5) =       0.000420285587
  error estimate for blocks of size 2^( 6) =       0.000424040915
  error estimate for blocks of size 2^( 7) =       0.000427832493

      target function =                  N/A
              le_mean =     -17.216066535146
             les_mean =     296.713778131757
             stat err =       0.000421922387
             autocorr =       1.174304383459
              std dev =       0.550626649264
             le_variance =       0.303189706880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721606653515e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+69, overlap shift 9.5367e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+70, overlap shift 3.8147e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+71, overlap shift 1.5259e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216066535179       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.430513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6966e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1509
    reference variance = 0.16463
====================================================
  Execution time = 2.0763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1505e-01
  Total weights = 1.9564e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891653
  error estimate for blocks of size 2^( 2) =       0.000396019614
  error estimate for blocks of size 2^( 3) =       0.000404900266
  error estimate for blocks of size 2^( 4) =       0.000411267721
  error estimate for blocks of size 2^( 5) =       0.000415932274
  error estimate for blocks of size 2^( 6) =       0.000419321650
  error estimate for blocks of size 2^( 7) =       0.000419766483

      target function =                  N/A
              le_mean =     -17.215985674015
             les_mean =     296.705211820647
             stat err =       0.000416572032
             autocorr =       1.165331398998
              std dev =       0.545733208759
             le_variance =       0.297824735142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891653
  error estimate for blocks of size 2^( 2) =       0.000396019614
  error estimate for blocks of size 2^( 3) =       0.000404900266
  error estimate for blocks of size 2^( 4) =       0.000411267721
  error estimate for blocks of size 2^( 5) =       0.000415932274
  error estimate for blocks of size 2^( 6) =       0.000419321650
  error estimate for blocks of size 2^( 7) =       0.000419766483

      target function =                  N/A
              le_mean =     -17.215985674015
             les_mean =     296.705211820647
             stat err =       0.000416572032
             autocorr =       1.165331398998
              std dev =       0.545733208759
             le_variance =       0.297824735142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891653
  error estimate for blocks of size 2^( 2) =       0.000396019614
  error estimate for blocks of size 2^( 3) =       0.000404900266
  error estimate for blocks of size 2^( 4) =       0.000411267721
  error estimate for blocks of size 2^( 5) =       0.000415932274
  error estimate for blocks of size 2^( 6) =       0.000419321650
  error estimate for blocks of size 2^( 7) =       0.000419766483

      target function =                  N/A
              le_mean =     -17.215985674015
             les_mean =     296.705211820647
             stat err =       0.000416572032
             autocorr =       1.165331398998
              std dev =       0.545733208759
             le_variance =       0.297824735142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297802675768
                                         uncertainty =       0.001967961963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385891653
  error estimate for blocks of size 2^( 2) =       0.000396019614
  error estimate for blocks of size 2^( 3) =       0.000404900266
  error estimate for blocks of size 2^( 4) =       0.000411267721
  error estimate for blocks of size 2^( 5) =       0.000415932274
  error estimate for blocks of size 2^( 6) =       0.000419321650
  error estimate for blocks of size 2^( 7) =       0.000419766483

      target function =                  N/A
              le_mean =     -17.215985674015
             les_mean =     296.705211820647
             stat err =       0.000416572032
             autocorr =       1.165331398998
              std dev =       0.545733208759
             le_variance =       0.297824735142


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215985674015        initial  <--
     9.5367e+69     9.5367e+70             0.0000e+00       -17.215985674015
     3.8147e+70     3.8147e+71             0.0000e+00       -17.215985674015
     1.5259e+71     1.5259e+72             0.0000e+00       -17.215985674015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9751
  </log>
  <optVariables href="H2O.s086.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6948e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1869
    reference variance = 0.188056
====================================================
  Execution time = 2.0738e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1214e-01
  Total weights = 1.956854592e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297432560913
                                         uncertainty =       0.001858772685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297432560913
                                         uncertainty =       0.001858772685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385616293
  error estimate for blocks of size 2^( 2) =       0.000395839925
  error estimate for blocks of size 2^( 3) =       0.000405235287
  error estimate for blocks of size 2^( 4) =       0.000412086596
  error estimate for blocks of size 2^( 5) =       0.000415965866
  error estimate for blocks of size 2^( 6) =       0.000416126349
  error estimate for blocks of size 2^( 7) =       0.000417271479

      target function =                  N/A
              le_mean =     -17.216790941648
             les_mean =     296.730031325552
             stat err =       0.000415362572
             autocorr =       1.160229681160
              std dev =       0.545343790726
             le_variance =       0.297399850083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679094165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+70, overlap shift 9.5367e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+70 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+71, overlap shift 3.8147e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+71 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+72, overlap shift 1.5259e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790941700       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+72 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.431736 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6800e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.1399
    reference variance = 0.211638
====================================================
  Execution time = 2.0618e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1042e-01
  Total weights = 1.9567e+06
  Execution time = 1.8158e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385976409
  error estimate for blocks of size 2^( 2) =       0.000396241600
  error estimate for blocks of size 2^( 3) =       0.000405684024
  error estimate for blocks of size 2^( 4) =       0.000411492081
  error estimate for blocks of size 2^( 5) =       0.000416579679
  error estimate for blocks of size 2^( 6) =       0.000418915160
  error estimate for blocks of size 2^( 7) =       0.000418593855

      target function =                  N/A
              le_mean =     -17.216567166609
             les_mean =     296.720602455059
             stat err =       0.000416395194
             autocorr =       1.163830927265
              std dev =       0.545853072236
             le_variance =       0.297955576470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385976409
  error estimate for blocks of size 2^( 2) =       0.000396241600
  error estimate for blocks of size 2^( 3) =       0.000405684024
  error estimate for blocks of size 2^( 4) =       0.000411492081
  error estimate for blocks of size 2^( 5) =       0.000416579679
  error estimate for blocks of size 2^( 6) =       0.000418915160
  error estimate for blocks of size 2^( 7) =       0.000418593855

      target function =                  N/A
              le_mean =     -17.216567166609
             les_mean =     296.720602455059
             stat err =       0.000416395194
             autocorr =       1.163830927265
              std dev =       0.545853072236
             le_variance =       0.297955576470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385976409
  error estimate for blocks of size 2^( 2) =       0.000396241600
  error estimate for blocks of size 2^( 3) =       0.000405684024
  error estimate for blocks of size 2^( 4) =       0.000411492081
  error estimate for blocks of size 2^( 5) =       0.000416579679
  error estimate for blocks of size 2^( 6) =       0.000418915160
  error estimate for blocks of size 2^( 7) =       0.000418593855

      target function =                  N/A
              le_mean =     -17.216567166609
             les_mean =     296.720602455059
             stat err =       0.000416395194
             autocorr =       1.163830927265
              std dev =       0.545853072236
             le_variance =       0.297955576470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297951336464
                                         uncertainty =       0.001900012661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385976409
  error estimate for blocks of size 2^( 2) =       0.000396241600
  error estimate for blocks of size 2^( 3) =       0.000405684024
  error estimate for blocks of size 2^( 4) =       0.000411492081
  error estimate for blocks of size 2^( 5) =       0.000416579679
  error estimate for blocks of size 2^( 6) =       0.000418915160
  error estimate for blocks of size 2^( 7) =       0.000418593855

      target function =                  N/A
              le_mean =     -17.216567166609
             les_mean =     296.720602455059
             stat err =       0.000416395194
             autocorr =       1.163830927265
              std dev =       0.545853072236
             le_variance =       0.297955576470


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216567166609        initial  <--
     9.5367e+70     9.5367e+71             0.0000e+00       -17.216567166609
     3.8147e+71     3.8147e+72             0.0000e+00       -17.216567166609
     1.5259e+72     1.5259e+73             0.0000e+00       -17.216567166609

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7672
  </log>
  <optVariables href="H2O.s087.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1691
    reference variance = 0.30098
====================================================
  Execution time = 2.0820e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1974e-01
  Total weights = 1.956313606e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1050e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303228287395
                                         uncertainty =       0.003097942049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303228287395
                                         uncertainty =       0.003097942049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389346430
  error estimate for blocks of size 2^( 2) =       0.000399619353
  error estimate for blocks of size 2^( 3) =       0.000408648097
  error estimate for blocks of size 2^( 4) =       0.000415187080
  error estimate for blocks of size 2^( 5) =       0.000418862440
  error estimate for blocks of size 2^( 6) =       0.000422401849
  error estimate for blocks of size 2^( 7) =       0.000422792716

      target function =                  N/A
              le_mean =     -17.217542747318
             les_mean =     296.763515057385
             stat err =       0.000419811021
             autocorr =       1.162613275919
              std dev =       0.550619002061
             le_variance =       0.303181285431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721754274732e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+71, overlap shift 9.5367e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+71 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+72, overlap shift 3.8147e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+73, overlap shift 1.5259e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217542747385       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.433051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0250e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.3313
    reference variance = 0.496276
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1284e-01
  Total weights = 1.9565e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386289526
  error estimate for blocks of size 2^( 2) =       0.000396256699
  error estimate for blocks of size 2^( 3) =       0.000405217170
  error estimate for blocks of size 2^( 4) =       0.000411705355
  error estimate for blocks of size 2^( 5) =       0.000415257248
  error estimate for blocks of size 2^( 6) =       0.000416063437
  error estimate for blocks of size 2^( 7) =       0.000416955495

      target function =                  N/A
              le_mean =     -17.216441376225
             les_mean =     296.718689619369
             stat err =       0.000414995384
             autocorr =       1.154145775162
              std dev =       0.546295886885
             le_variance =       0.298439196027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386289526
  error estimate for blocks of size 2^( 2) =       0.000396256699
  error estimate for blocks of size 2^( 3) =       0.000405217170
  error estimate for blocks of size 2^( 4) =       0.000411705355
  error estimate for blocks of size 2^( 5) =       0.000415257248
  error estimate for blocks of size 2^( 6) =       0.000416063437
  error estimate for blocks of size 2^( 7) =       0.000416955495

      target function =                  N/A
              le_mean =     -17.216441376225
             les_mean =     296.718689619369
             stat err =       0.000414995384
             autocorr =       1.154145775162
              std dev =       0.546295886885
             le_variance =       0.298439196027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386289526
  error estimate for blocks of size 2^( 2) =       0.000396256699
  error estimate for blocks of size 2^( 3) =       0.000405217170
  error estimate for blocks of size 2^( 4) =       0.000411705355
  error estimate for blocks of size 2^( 5) =       0.000415257248
  error estimate for blocks of size 2^( 6) =       0.000416063437
  error estimate for blocks of size 2^( 7) =       0.000416955495

      target function =                  N/A
              le_mean =     -17.216441376225
             les_mean =     296.718689619369
             stat err =       0.000414995384
             autocorr =       1.154145775162
              std dev =       0.546295886885
             le_variance =       0.298439196027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298323541031
                                         uncertainty =       0.001980758021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386289526
  error estimate for blocks of size 2^( 2) =       0.000396256699
  error estimate for blocks of size 2^( 3) =       0.000405217170
  error estimate for blocks of size 2^( 4) =       0.000411705355
  error estimate for blocks of size 2^( 5) =       0.000415257248
  error estimate for blocks of size 2^( 6) =       0.000416063437
  error estimate for blocks of size 2^( 7) =       0.000416955495

      target function =                  N/A
              le_mean =     -17.216441376225
             les_mean =     296.718689619369
             stat err =       0.000414995384
             autocorr =       1.154145775162
              std dev =       0.546295886885
             le_variance =       0.298439196027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216441376225        initial  <--
     9.5367e+71     9.5367e+72             0.0000e+00       -17.216441376225
     3.8147e+72     3.8147e+73             0.0000e+00       -17.216441376225
     1.5259e+73     1.5259e+74             0.0000e+00       -17.216441376225

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4987
  </log>
  <optVariables href="H2O.s088.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.225174
====================================================
  Execution time = 2.0454e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1520e-01
  Total weights = 1.956355050e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298829559457
                                         uncertainty =       0.002591326024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298829559457
                                         uncertainty =       0.002591326024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386534801
  error estimate for blocks of size 2^( 2) =       0.000396189471
  error estimate for blocks of size 2^( 3) =       0.000404916682
  error estimate for blocks of size 2^( 4) =       0.000410777655
  error estimate for blocks of size 2^( 5) =       0.000415408790
  error estimate for blocks of size 2^( 6) =       0.000416481718
  error estimate for blocks of size 2^( 7) =       0.000417805812

      target function =                  N/A
              le_mean =     -17.216677819659
             les_mean =     296.729194808575
             stat err =       0.000415118494
             autocorr =       1.153365516412
              std dev =       0.546642757616
             le_variance =       0.298818304454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667781966e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+72, overlap shift 9.5367e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+73, overlap shift 3.8147e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+74, overlap shift 1.5259e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216677819690       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.434286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6527e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2243
    reference variance = 0.320062
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1961e-01
  Total weights = 1.9565e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388842032
  error estimate for blocks of size 2^( 2) =       0.000398978333
  error estimate for blocks of size 2^( 3) =       0.000407832726
  error estimate for blocks of size 2^( 4) =       0.000414350029
  error estimate for blocks of size 2^( 5) =       0.000418945690
  error estimate for blocks of size 2^( 6) =       0.000422216566
  error estimate for blocks of size 2^( 7) =       0.000423602502

      target function =                  N/A
              le_mean =     -17.216941864869
             les_mean =     296.742693045721
             stat err =       0.000419778697
             autocorr =       1.165451971472
              std dev =       0.549905675855
             le_variance =       0.302396252337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388842032
  error estimate for blocks of size 2^( 2) =       0.000398978333
  error estimate for blocks of size 2^( 3) =       0.000407832726
  error estimate for blocks of size 2^( 4) =       0.000414350029
  error estimate for blocks of size 2^( 5) =       0.000418945690
  error estimate for blocks of size 2^( 6) =       0.000422216566
  error estimate for blocks of size 2^( 7) =       0.000423602502

      target function =                  N/A
              le_mean =     -17.216941864869
             les_mean =     296.742693045721
             stat err =       0.000419778697
             autocorr =       1.165451971472
              std dev =       0.549905675855
             le_variance =       0.302396252337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388842032
  error estimate for blocks of size 2^( 2) =       0.000398978333
  error estimate for blocks of size 2^( 3) =       0.000407832726
  error estimate for blocks of size 2^( 4) =       0.000414350029
  error estimate for blocks of size 2^( 5) =       0.000418945690
  error estimate for blocks of size 2^( 6) =       0.000422216566
  error estimate for blocks of size 2^( 7) =       0.000423602502

      target function =                  N/A
              le_mean =     -17.216941864869
             les_mean =     296.742693045721
             stat err =       0.000419778697
             autocorr =       1.165451971472
              std dev =       0.549905675855
             le_variance =       0.302396252337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302441930484
                                         uncertainty =       0.001915942602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388842032
  error estimate for blocks of size 2^( 2) =       0.000398978333
  error estimate for blocks of size 2^( 3) =       0.000407832726
  error estimate for blocks of size 2^( 4) =       0.000414350029
  error estimate for blocks of size 2^( 5) =       0.000418945690
  error estimate for blocks of size 2^( 6) =       0.000422216566
  error estimate for blocks of size 2^( 7) =       0.000423602502

      target function =                  N/A
              le_mean =     -17.216941864869
             les_mean =     296.742693045721
             stat err =       0.000419778697
             autocorr =       1.165451971472
              std dev =       0.549905675855
             le_variance =       0.302396252337


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216941864869        initial  <--
     9.5367e+72     9.5367e+73             0.0000e+00       -17.216941864869
     3.8147e+73     3.8147e+74             0.0000e+00       -17.216941864869
     1.5259e+74     1.5259e+75             0.0000e+00       -17.216941864869

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5870
  </log>
  <optVariables href="H2O.s089.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1813
    reference variance = 0.305972
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1297e-01
  Total weights = 1.956643517e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793073203
                                         uncertainty =       0.002206439292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298793073203
                                         uncertainty =       0.002206439292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386487163
  error estimate for blocks of size 2^( 2) =       0.000396573548
  error estimate for blocks of size 2^( 3) =       0.000404932752
  error estimate for blocks of size 2^( 4) =       0.000411067977
  error estimate for blocks of size 2^( 5) =       0.000415894094
  error estimate for blocks of size 2^( 6) =       0.000416071151
  error estimate for blocks of size 2^( 7) =       0.000418176274

      target function =                  N/A
              le_mean =     -17.216340446485
             les_mean =     296.715343795326
             stat err =       0.000415302374
             autocorr =       1.154672120964
              std dev =       0.546575387572
             le_variance =       0.298744654299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634044649e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+73, overlap shift 9.5367e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+74, overlap shift 3.8147e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+75, overlap shift 1.5259e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216340446508       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.435532 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6622e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2112
    reference variance = 0.272967
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1662e-01
  Total weights = 1.9562e+06
  Execution time = 1.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387579342
  error estimate for blocks of size 2^( 2) =       0.000397546280
  error estimate for blocks of size 2^( 3) =       0.000406145105
  error estimate for blocks of size 2^( 4) =       0.000412886195
  error estimate for blocks of size 2^( 5) =       0.000417296536
  error estimate for blocks of size 2^( 6) =       0.000420016682
  error estimate for blocks of size 2^( 7) =       0.000422564853

      target function =                  N/A
              le_mean =     -17.216501057931
             les_mean =     296.724530883011
             stat err =       0.000418191067
             autocorr =       1.164201784930
              std dev =       0.548119961454
             le_variance =       0.300435492144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387579342
  error estimate for blocks of size 2^( 2) =       0.000397546280
  error estimate for blocks of size 2^( 3) =       0.000406145105
  error estimate for blocks of size 2^( 4) =       0.000412886195
  error estimate for blocks of size 2^( 5) =       0.000417296536
  error estimate for blocks of size 2^( 6) =       0.000420016682
  error estimate for blocks of size 2^( 7) =       0.000422564853

      target function =                  N/A
              le_mean =     -17.216501057931
             les_mean =     296.724530883011
             stat err =       0.000418191067
             autocorr =       1.164201784930
              std dev =       0.548119961454
             le_variance =       0.300435492144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387579342
  error estimate for blocks of size 2^( 2) =       0.000397546280
  error estimate for blocks of size 2^( 3) =       0.000406145105
  error estimate for blocks of size 2^( 4) =       0.000412886195
  error estimate for blocks of size 2^( 5) =       0.000417296536
  error estimate for blocks of size 2^( 6) =       0.000420016682
  error estimate for blocks of size 2^( 7) =       0.000422564853

      target function =                  N/A
              le_mean =     -17.216501057931
             les_mean =     296.724530883011
             stat err =       0.000418191067
             autocorr =       1.164201784930
              std dev =       0.548119961454
             le_variance =       0.300435492144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300433271011
                                         uncertainty =       0.002204888713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387579342
  error estimate for blocks of size 2^( 2) =       0.000397546280
  error estimate for blocks of size 2^( 3) =       0.000406145105
  error estimate for blocks of size 2^( 4) =       0.000412886195
  error estimate for blocks of size 2^( 5) =       0.000417296536
  error estimate for blocks of size 2^( 6) =       0.000420016682
  error estimate for blocks of size 2^( 7) =       0.000422564853

      target function =                  N/A
              le_mean =     -17.216501057931
             les_mean =     296.724530883011
             stat err =       0.000418191067
             autocorr =       1.164201784930
              std dev =       0.548119961454
             le_variance =       0.300435492144


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216501057931        initial  <--
     9.5367e+73     9.5367e+74             0.0000e+00       -17.216501057931
     3.8147e+74     3.8147e+75             0.0000e+00       -17.216501057931
     1.5259e+75     1.5259e+76             0.0000e+00       -17.216501057931

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6806
  </log>
  <optVariables href="H2O.s090.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2992
    reference variance = 0.313766
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1525e-01
  Total weights = 1.956387575e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300549451203
                                         uncertainty =       0.001865036626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300549451203
                                         uncertainty =       0.001865036626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387689997
  error estimate for blocks of size 2^( 2) =       0.000397687569
  error estimate for blocks of size 2^( 3) =       0.000406549362
  error estimate for blocks of size 2^( 4) =       0.000413171972
  error estimate for blocks of size 2^( 5) =       0.000417843318
  error estimate for blocks of size 2^( 6) =       0.000420907901
  error estimate for blocks of size 2^( 7) =       0.000423336740

      target function =                  N/A
              le_mean =     -17.216596690677
             les_mean =     296.726450496375
             stat err =       0.000418814983
             autocorr =       1.167011746732
              std dev =       0.548276452230
             le_variance =       0.300607068070


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659669068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+74, overlap shift 9.5367e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+74 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+75, overlap shift 3.8147e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+76, overlap shift 1.5259e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216596690693       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.436767 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6537e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2226
    reference variance = 0.168121
====================================================
  Execution time = 2.0696e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1846e-01
  Total weights = 1.9570e+06
  Execution time = 1.8141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387980723
  error estimate for blocks of size 2^( 2) =       0.000397875306
  error estimate for blocks of size 2^( 3) =       0.000407037625
  error estimate for blocks of size 2^( 4) =       0.000413894764
  error estimate for blocks of size 2^( 5) =       0.000417629743
  error estimate for blocks of size 2^( 6) =       0.000420606119
  error estimate for blocks of size 2^( 7) =       0.000421881495

      target function =                  N/A
              le_mean =     -17.216640439343
             les_mean =     296.731170587115
             stat err =       0.000418503030
             autocorr =       1.163528211605
              std dev =       0.548687600484
             le_variance =       0.301058082925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387980723
  error estimate for blocks of size 2^( 2) =       0.000397875306
  error estimate for blocks of size 2^( 3) =       0.000407037625
  error estimate for blocks of size 2^( 4) =       0.000413894764
  error estimate for blocks of size 2^( 5) =       0.000417629743
  error estimate for blocks of size 2^( 6) =       0.000420606119
  error estimate for blocks of size 2^( 7) =       0.000421881495

      target function =                  N/A
              le_mean =     -17.216640439343
             les_mean =     296.731170587115
             stat err =       0.000418503030
             autocorr =       1.163528211605
              std dev =       0.548687600484
             le_variance =       0.301058082925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387980723
  error estimate for blocks of size 2^( 2) =       0.000397875306
  error estimate for blocks of size 2^( 3) =       0.000407037625
  error estimate for blocks of size 2^( 4) =       0.000413894764
  error estimate for blocks of size 2^( 5) =       0.000417629743
  error estimate for blocks of size 2^( 6) =       0.000420606119
  error estimate for blocks of size 2^( 7) =       0.000421881495

      target function =                  N/A
              le_mean =     -17.216640439343
             les_mean =     296.731170587115
             stat err =       0.000418503030
             autocorr =       1.163528211605
              std dev =       0.548687600484
             le_variance =       0.301058082925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300996853154
                                         uncertainty =       0.002149931823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387980723
  error estimate for blocks of size 2^( 2) =       0.000397875306
  error estimate for blocks of size 2^( 3) =       0.000407037625
  error estimate for blocks of size 2^( 4) =       0.000413894764
  error estimate for blocks of size 2^( 5) =       0.000417629743
  error estimate for blocks of size 2^( 6) =       0.000420606119
  error estimate for blocks of size 2^( 7) =       0.000421881495

      target function =                  N/A
              le_mean =     -17.216640439343
             les_mean =     296.731170587115
             stat err =       0.000418503030
             autocorr =       1.163528211605
              std dev =       0.548687600484
             le_variance =       0.301058082925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216640439343        initial  <--
     9.5367e+74     9.5367e+75             0.0000e+00       -17.216640439343
     3.8147e+75     3.8147e+76             0.0000e+00       -17.216640439343
     1.5259e+76     1.5259e+77             0.0000e+00       -17.216640439343

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8366
  </log>
  <optVariables href="H2O.s091.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6381e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1384
    reference variance = 0.218937
====================================================
  Execution time = 2.0343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1310e-01
  Total weights = 1.956537354e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0452e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297180556265
                                         uncertainty =       0.002010704931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297180556265
                                         uncertainty =       0.002010704931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385424884
  error estimate for blocks of size 2^( 2) =       0.000395597164
  error estimate for blocks of size 2^( 3) =       0.000404568859
  error estimate for blocks of size 2^( 4) =       0.000411730784
  error estimate for blocks of size 2^( 5) =       0.000415909554
  error estimate for blocks of size 2^( 6) =       0.000418835324
  error estimate for blocks of size 2^( 7) =       0.000420525451

      target function =                  N/A
              le_mean =     -17.216420189716
             les_mean =     296.718223439174
             stat err =       0.000416750278
             autocorr =       1.169155552144
              std dev =       0.545073097941
             le_variance =       0.297104682099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642018972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+75, overlap shift 9.5367e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+75 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+76, overlap shift 3.8147e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+76 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+77, overlap shift 1.5259e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216420189739       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.437991 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6393e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.1991
    reference variance = 0.192361
====================================================
  Execution time = 2.0409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1442e-01
  Total weights = 1.9565e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388173771
  error estimate for blocks of size 2^( 2) =       0.000397804413
  error estimate for blocks of size 2^( 3) =       0.000407031525
  error estimate for blocks of size 2^( 4) =       0.000413650557
  error estimate for blocks of size 2^( 5) =       0.000417825893
  error estimate for blocks of size 2^( 6) =       0.000419967723
  error estimate for blocks of size 2^( 7) =       0.000420617339

      target function =                  N/A
              le_mean =     -17.216555694390
             les_mean =     296.724214750449
             stat err =       0.000418015378
             autocorr =       1.159663919701
              std dev =       0.548960610917
             le_variance =       0.301357752338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388173771
  error estimate for blocks of size 2^( 2) =       0.000397804413
  error estimate for blocks of size 2^( 3) =       0.000407031525
  error estimate for blocks of size 2^( 4) =       0.000413650557
  error estimate for blocks of size 2^( 5) =       0.000417825893
  error estimate for blocks of size 2^( 6) =       0.000419967723
  error estimate for blocks of size 2^( 7) =       0.000420617339

      target function =                  N/A
              le_mean =     -17.216555694390
             les_mean =     296.724214750449
             stat err =       0.000418015378
             autocorr =       1.159663919701
              std dev =       0.548960610917
             le_variance =       0.301357752338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388173771
  error estimate for blocks of size 2^( 2) =       0.000397804413
  error estimate for blocks of size 2^( 3) =       0.000407031525
  error estimate for blocks of size 2^( 4) =       0.000413650557
  error estimate for blocks of size 2^( 5) =       0.000417825893
  error estimate for blocks of size 2^( 6) =       0.000419967723
  error estimate for blocks of size 2^( 7) =       0.000420617339

      target function =                  N/A
              le_mean =     -17.216555694390
             les_mean =     296.724214750449
             stat err =       0.000418015378
             autocorr =       1.159663919701
              std dev =       0.548960610917
             le_variance =       0.301357752338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301369461699
                                         uncertainty =       0.001884067259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388173771
  error estimate for blocks of size 2^( 2) =       0.000397804413
  error estimate for blocks of size 2^( 3) =       0.000407031525
  error estimate for blocks of size 2^( 4) =       0.000413650557
  error estimate for blocks of size 2^( 5) =       0.000417825893
  error estimate for blocks of size 2^( 6) =       0.000419967723
  error estimate for blocks of size 2^( 7) =       0.000420617339

      target function =                  N/A
              le_mean =     -17.216555694390
             les_mean =     296.724214750449
             stat err =       0.000418015378
             autocorr =       1.159663919701
              std dev =       0.548960610917
             le_variance =       0.301357752338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216555694390        initial  <--
     9.5367e+75     9.5367e+76             0.0000e+00       -17.216555694390
     3.8147e+76     3.8147e+77             0.0000e+00       -17.216555694390
     1.5259e+77     1.5259e+78             0.0000e+00       -17.216555694390

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6021
  </log>
  <optVariables href="H2O.s092.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.942047
====================================================
  Execution time = 2.0578e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5287e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2452e-01
  Total weights = 1.956372535e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306085047913
                                         uncertainty =       0.003738914693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.306085047913
                                         uncertainty =       0.003738914693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391242770
  error estimate for blocks of size 2^( 2) =       0.000401085390
  error estimate for blocks of size 2^( 3) =       0.000409875123
  error estimate for blocks of size 2^( 4) =       0.000416428060
  error estimate for blocks of size 2^( 5) =       0.000420845636
  error estimate for blocks of size 2^( 6) =       0.000422589757
  error estimate for blocks of size 2^( 7) =       0.000421593452

      target function =                  N/A
              le_mean =     -17.216513025468
             les_mean =     296.732840614213
             stat err =       0.000420364226
             autocorr =       1.154406724893
              std dev =       0.553300832089
             le_variance =       0.306141810791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651302547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+76, overlap shift 9.5367e+77 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+76 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.8147e+77, overlap shift 3.8147e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+77 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.5259e+78, overlap shift 1.5259e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513025534       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+78 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.439215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6734e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.31117
====================================================
  Execution time = 2.2368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1571e-01
  Total weights = 1.9568e+06
  Execution time = 1.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950301
  error estimate for blocks of size 2^( 2) =       0.000396087337
  error estimate for blocks of size 2^( 3) =       0.000404491676
  error estimate for blocks of size 2^( 4) =       0.000411092997
  error estimate for blocks of size 2^( 5) =       0.000413640969
  error estimate for blocks of size 2^( 6) =       0.000416201785
  error estimate for blocks of size 2^( 7) =       0.000420363820

      target function =                  N/A
              le_mean =     -17.216326844433
             les_mean =     296.717622655763
             stat err =       0.000415324893
             autocorr =       1.158012254010
              std dev =       0.545816150078
             le_variance =       0.297915269686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950301
  error estimate for blocks of size 2^( 2) =       0.000396087337
  error estimate for blocks of size 2^( 3) =       0.000404491676
  error estimate for blocks of size 2^( 4) =       0.000411092997
  error estimate for blocks of size 2^( 5) =       0.000413640969
  error estimate for blocks of size 2^( 6) =       0.000416201785
  error estimate for blocks of size 2^( 7) =       0.000420363820

      target function =                  N/A
              le_mean =     -17.216326844433
             les_mean =     296.717622655763
             stat err =       0.000415324893
             autocorr =       1.158012254010
              std dev =       0.545816150078
             le_variance =       0.297915269686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950301
  error estimate for blocks of size 2^( 2) =       0.000396087337
  error estimate for blocks of size 2^( 3) =       0.000404491676
  error estimate for blocks of size 2^( 4) =       0.000411092997
  error estimate for blocks of size 2^( 5) =       0.000413640969
  error estimate for blocks of size 2^( 6) =       0.000416201785
  error estimate for blocks of size 2^( 7) =       0.000420363820

      target function =                  N/A
              le_mean =     -17.216326844433
             les_mean =     296.717622655763
             stat err =       0.000415324893
             autocorr =       1.158012254010
              std dev =       0.545816150078
             le_variance =       0.297915269686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297948966919
                                         uncertainty =       0.002409796651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385950301
  error estimate for blocks of size 2^( 2) =       0.000396087337
  error estimate for blocks of size 2^( 3) =       0.000404491676
  error estimate for blocks of size 2^( 4) =       0.000411092997
  error estimate for blocks of size 2^( 5) =       0.000413640969
  error estimate for blocks of size 2^( 6) =       0.000416201785
  error estimate for blocks of size 2^( 7) =       0.000420363820

      target function =                  N/A
              le_mean =     -17.216326844433
             les_mean =     296.717622655763
             stat err =       0.000415324893
             autocorr =       1.158012254010
              std dev =       0.545816150078
             le_variance =       0.297915269686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216326844433        initial  <--
     9.5367e+76     9.5367e+77             0.0000e+00       -17.216326844433
     3.8147e+77     3.8147e+78             0.0000e+00       -17.216326844433
     1.5259e+78     1.5259e+79             0.0000e+00       -17.216326844433

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5408
  </log>
  <optVariables href="H2O.s093.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8282e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1866
    reference variance = 0.275876
====================================================
  Execution time = 2.1097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0897e-01
  Total weights = 1.956727218e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295939889782
                                         uncertainty =       0.001813318246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295939889782
                                         uncertainty =       0.001813318246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384669743
  error estimate for blocks of size 2^( 2) =       0.000394664361
  error estimate for blocks of size 2^( 3) =       0.000403450861
  error estimate for blocks of size 2^( 4) =       0.000409910013
  error estimate for blocks of size 2^( 5) =       0.000413927063
  error estimate for blocks of size 2^( 6) =       0.000417736911
  error estimate for blocks of size 2^( 7) =       0.000418810101

      target function =                  N/A
              le_mean =     -17.215943226074
             les_mean =     296.697672913326
             stat err =       0.000415096022
             autocorr =       1.164450649275
              std dev =       0.544005168082
             le_variance =       0.295941622900


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721594322607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+77, overlap shift 9.5367e+78 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+77 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+78, overlap shift 3.8147e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+79, overlap shift 1.5259e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215943226099       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.440504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7139e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.274923
====================================================
  Execution time = 2.0543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1031e-01
  Total weights = 1.9561e+06
  Execution time = 1.8237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865862
  error estimate for blocks of size 2^( 2) =       0.000395643307
  error estimate for blocks of size 2^( 3) =       0.000405271516
  error estimate for blocks of size 2^( 4) =       0.000412487696
  error estimate for blocks of size 2^( 5) =       0.000416184838
  error estimate for blocks of size 2^( 6) =       0.000418989382
  error estimate for blocks of size 2^( 7) =       0.000419779263

      target function =                  N/A
              le_mean =     -17.216250766555
             les_mean =     296.709600060472
             stat err =       0.000416860295
             autocorr =       1.167100745030
              std dev =       0.545696735704
             le_variance =       0.297784927357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865862
  error estimate for blocks of size 2^( 2) =       0.000395643307
  error estimate for blocks of size 2^( 3) =       0.000405271516
  error estimate for blocks of size 2^( 4) =       0.000412487696
  error estimate for blocks of size 2^( 5) =       0.000416184838
  error estimate for blocks of size 2^( 6) =       0.000418989382
  error estimate for blocks of size 2^( 7) =       0.000419779263

      target function =                  N/A
              le_mean =     -17.216250766555
             les_mean =     296.709600060472
             stat err =       0.000416860295
             autocorr =       1.167100745030
              std dev =       0.545696735704
             le_variance =       0.297784927357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865862
  error estimate for blocks of size 2^( 2) =       0.000395643307
  error estimate for blocks of size 2^( 3) =       0.000405271516
  error estimate for blocks of size 2^( 4) =       0.000412487696
  error estimate for blocks of size 2^( 5) =       0.000416184838
  error estimate for blocks of size 2^( 6) =       0.000418989382
  error estimate for blocks of size 2^( 7) =       0.000419779263

      target function =                  N/A
              le_mean =     -17.216250766555
             les_mean =     296.709600060472
             stat err =       0.000416860295
             autocorr =       1.167100745030
              std dev =       0.545696735704
             le_variance =       0.297784927357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297831440337
                                         uncertainty =       0.002330915114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385865862
  error estimate for blocks of size 2^( 2) =       0.000395643307
  error estimate for blocks of size 2^( 3) =       0.000405271516
  error estimate for blocks of size 2^( 4) =       0.000412487696
  error estimate for blocks of size 2^( 5) =       0.000416184838
  error estimate for blocks of size 2^( 6) =       0.000418989382
  error estimate for blocks of size 2^( 7) =       0.000419779263

      target function =                  N/A
              le_mean =     -17.216250766555
             les_mean =     296.709600060472
             stat err =       0.000416860295
             autocorr =       1.167100745030
              std dev =       0.545696735704
             le_variance =       0.297784927357


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216250766555        initial  <--
     9.5367e+77     9.5367e+78             0.0000e+00       -17.216250766555
     3.8147e+78     3.8147e+79             0.0000e+00       -17.216250766555
     1.5259e+79     1.5259e+80             0.0000e+00       -17.216250766555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7253
  </log>
  <optVariables href="H2O.s094.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1407
    reference variance = 0.543152
====================================================
  Execution time = 2.0494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1543e-01
  Total weights = 1.956540129e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301183426815
                                         uncertainty =       0.002181334923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301183426815
                                         uncertainty =       0.002181334923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388065737
  error estimate for blocks of size 2^( 2) =       0.000398193120
  error estimate for blocks of size 2^( 3) =       0.000407954283
  error estimate for blocks of size 2^( 4) =       0.000414586910
  error estimate for blocks of size 2^( 5) =       0.000418511511
  error estimate for blocks of size 2^( 6) =       0.000420591521
  error estimate for blocks of size 2^( 7) =       0.000420795592

      target function =                  N/A
              le_mean =     -17.216688043496
             les_mean =     296.729781352069
             stat err =       0.000418621384
             autocorr =       1.163676376512
              std dev =       0.548807828336
             le_variance =       0.301190032442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668804350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+78, overlap shift 9.5367e+79 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+78 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+79, overlap shift 3.8147e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+80, overlap shift 1.5259e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216688043530       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+80 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.441758 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6476e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.3242
    reference variance = 0.944104
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1274e-01
  Total weights = 1.9567e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386458313
  error estimate for blocks of size 2^( 2) =       0.000396061396
  error estimate for blocks of size 2^( 3) =       0.000405046647
  error estimate for blocks of size 2^( 4) =       0.000411604053
  error estimate for blocks of size 2^( 5) =       0.000416481792
  error estimate for blocks of size 2^( 6) =       0.000419580617
  error estimate for blocks of size 2^( 7) =       0.000420906388

      target function =                  N/A
              le_mean =     -17.216819515399
             les_mean =     296.731613760146
             stat err =       0.000417143213
             autocorr =       1.165104970057
              std dev =       0.546534587955
             le_variance =       0.298700055831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386458313
  error estimate for blocks of size 2^( 2) =       0.000396061396
  error estimate for blocks of size 2^( 3) =       0.000405046647
  error estimate for blocks of size 2^( 4) =       0.000411604053
  error estimate for blocks of size 2^( 5) =       0.000416481792
  error estimate for blocks of size 2^( 6) =       0.000419580617
  error estimate for blocks of size 2^( 7) =       0.000420906388

      target function =                  N/A
              le_mean =     -17.216819515399
             les_mean =     296.731613760146
             stat err =       0.000417143213
             autocorr =       1.165104970057
              std dev =       0.546534587955
             le_variance =       0.298700055831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386458313
  error estimate for blocks of size 2^( 2) =       0.000396061396
  error estimate for blocks of size 2^( 3) =       0.000405046647
  error estimate for blocks of size 2^( 4) =       0.000411604053
  error estimate for blocks of size 2^( 5) =       0.000416481792
  error estimate for blocks of size 2^( 6) =       0.000419580617
  error estimate for blocks of size 2^( 7) =       0.000420906388

      target function =                  N/A
              le_mean =     -17.216819515399
             les_mean =     296.731613760146
             stat err =       0.000417143213
             autocorr =       1.165104970057
              std dev =       0.546534587955
             le_variance =       0.298700055831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298582193854
                                         uncertainty =       0.002073169061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386458313
  error estimate for blocks of size 2^( 2) =       0.000396061396
  error estimate for blocks of size 2^( 3) =       0.000405046647
  error estimate for blocks of size 2^( 4) =       0.000411604053
  error estimate for blocks of size 2^( 5) =       0.000416481792
  error estimate for blocks of size 2^( 6) =       0.000419580617
  error estimate for blocks of size 2^( 7) =       0.000420906388

      target function =                  N/A
              le_mean =     -17.216819515399
             les_mean =     296.731613760146
             stat err =       0.000417143213
             autocorr =       1.165104970057
              std dev =       0.546534587955
             le_variance =       0.298700055831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216819515399        initial  <--
     9.5367e+78     9.5367e+79             0.0000e+00       -17.216819515399
     3.8147e+79     3.8147e+80             0.0000e+00       -17.216819515399
     1.5259e+80     1.5259e+81             0.0000e+00       -17.216819515399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5629
  </log>
  <optVariables href="H2O.s095.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6046e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1301
    reference variance = 0.142029
====================================================
  Execution time = 2.0703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2046e-01
  Total weights = 1.956407161e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303882026377
                                         uncertainty =       0.006387019682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303882026377
                                         uncertainty =       0.006387019682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389854628
  error estimate for blocks of size 2^( 2) =       0.000399861505
  error estimate for blocks of size 2^( 3) =       0.000408670318
  error estimate for blocks of size 2^( 4) =       0.000415819370
  error estimate for blocks of size 2^( 5) =       0.000420251852
  error estimate for blocks of size 2^( 6) =       0.000421833246
  error estimate for blocks of size 2^( 7) =       0.000424765041

      target function =                  N/A
              le_mean =     -17.216846633031
             les_mean =     296.740271659383
             stat err =       0.000420667377
             autocorr =       1.164319789578
              std dev =       0.551337702605
             le_variance =       0.303973262314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684663303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+79, overlap shift 9.5367e+80 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+79 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+80, overlap shift 3.8147e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+80 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+81, overlap shift 1.5259e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216846633050       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+81 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.442996 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6664e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.201577
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1558e-01
  Total weights = 1.9569e+06
  Execution time = 1.8160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387526370
  error estimate for blocks of size 2^( 2) =       0.000397443895
  error estimate for blocks of size 2^( 3) =       0.000406299847
  error estimate for blocks of size 2^( 4) =       0.000412929548
  error estimate for blocks of size 2^( 5) =       0.000416837356
  error estimate for blocks of size 2^( 6) =       0.000419064159
  error estimate for blocks of size 2^( 7) =       0.000419571762

      target function =                  N/A
              le_mean =     -17.216827603228
             les_mean =     296.734736782358
             stat err =       0.000417100706
             autocorr =       1.158455429951
              std dev =       0.548045048631
             le_variance =       0.300353375329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387526370
  error estimate for blocks of size 2^( 2) =       0.000397443895
  error estimate for blocks of size 2^( 3) =       0.000406299847
  error estimate for blocks of size 2^( 4) =       0.000412929548
  error estimate for blocks of size 2^( 5) =       0.000416837356
  error estimate for blocks of size 2^( 6) =       0.000419064159
  error estimate for blocks of size 2^( 7) =       0.000419571762

      target function =                  N/A
              le_mean =     -17.216827603228
             les_mean =     296.734736782358
             stat err =       0.000417100706
             autocorr =       1.158455429951
              std dev =       0.548045048631
             le_variance =       0.300353375329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387526370
  error estimate for blocks of size 2^( 2) =       0.000397443895
  error estimate for blocks of size 2^( 3) =       0.000406299847
  error estimate for blocks of size 2^( 4) =       0.000412929548
  error estimate for blocks of size 2^( 5) =       0.000416837356
  error estimate for blocks of size 2^( 6) =       0.000419064159
  error estimate for blocks of size 2^( 7) =       0.000419571762

      target function =                  N/A
              le_mean =     -17.216827603228
             les_mean =     296.734736782358
             stat err =       0.000417100706
             autocorr =       1.158455429951
              std dev =       0.548045048631
             le_variance =       0.300353375329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300374301833
                                         uncertainty =       0.002142325764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387526370
  error estimate for blocks of size 2^( 2) =       0.000397443895
  error estimate for blocks of size 2^( 3) =       0.000406299847
  error estimate for blocks of size 2^( 4) =       0.000412929548
  error estimate for blocks of size 2^( 5) =       0.000416837356
  error estimate for blocks of size 2^( 6) =       0.000419064159
  error estimate for blocks of size 2^( 7) =       0.000419571762

      target function =                  N/A
              le_mean =     -17.216827603228
             les_mean =     296.734736782358
             stat err =       0.000417100706
             autocorr =       1.158455429951
              std dev =       0.548045048631
             le_variance =       0.300353375329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216827603228        initial  <--
     9.5367e+79     9.5367e+80             0.0000e+00       -17.216827603228
     3.8147e+80     3.8147e+81             0.0000e+00       -17.216827603228
     1.5259e+81     1.5259e+82             0.0000e+00       -17.216827603228

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6187
  </log>
  <optVariables href="H2O.s096.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1343
    reference variance = 0.205137
====================================================
  Execution time = 2.0570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2011e-01
  Total weights = 1.956656541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0229e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301916206547
                                         uncertainty =       0.002478350820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301916206547
                                         uncertainty =       0.002478350820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388499535
  error estimate for blocks of size 2^( 2) =       0.000398760450
  error estimate for blocks of size 2^( 3) =       0.000407977011
  error estimate for blocks of size 2^( 4) =       0.000415010890
  error estimate for blocks of size 2^( 5) =       0.000419618456
  error estimate for blocks of size 2^( 6) =       0.000423080227
  error estimate for blocks of size 2^( 7) =       0.000424906253

      target function =                  N/A
              le_mean =     -17.216953353954
             les_mean =     296.743589765277
             stat err =       0.000420653957
             autocorr =       1.172381477970
              std dev =       0.549421312047
             le_variance =       0.301863778132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695335395e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+80, overlap shift 9.5367e+81 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+80 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+81, overlap shift 3.8147e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+81 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+82, overlap shift 1.5259e+83 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216953353979       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+82 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.444237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6598e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1707
    reference variance = 0.252079
====================================================
  Execution time = 2.0790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1205e-01
  Total weights = 1.9561e+06
  Execution time = 1.8163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386119900
  error estimate for blocks of size 2^( 2) =       0.000396673312
  error estimate for blocks of size 2^( 3) =       0.000405837527
  error estimate for blocks of size 2^( 4) =       0.000412760641
  error estimate for blocks of size 2^( 5) =       0.000418380731
  error estimate for blocks of size 2^( 6) =       0.000420656721
  error estimate for blocks of size 2^( 7) =       0.000421882086

      target function =                  N/A
              le_mean =     -17.216768334286
             les_mean =     296.729164866188
             stat err =       0.000418420045
             autocorr =       1.174304144326
              std dev =       0.546055998914
             le_variance =       0.298177153950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386119900
  error estimate for blocks of size 2^( 2) =       0.000396673312
  error estimate for blocks of size 2^( 3) =       0.000405837527
  error estimate for blocks of size 2^( 4) =       0.000412760641
  error estimate for blocks of size 2^( 5) =       0.000418380731
  error estimate for blocks of size 2^( 6) =       0.000420656721
  error estimate for blocks of size 2^( 7) =       0.000421882086

      target function =                  N/A
              le_mean =     -17.216768334286
             les_mean =     296.729164866188
             stat err =       0.000418420045
             autocorr =       1.174304144326
              std dev =       0.546055998914
             le_variance =       0.298177153950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386119900
  error estimate for blocks of size 2^( 2) =       0.000396673312
  error estimate for blocks of size 2^( 3) =       0.000405837527
  error estimate for blocks of size 2^( 4) =       0.000412760641
  error estimate for blocks of size 2^( 5) =       0.000418380731
  error estimate for blocks of size 2^( 6) =       0.000420656721
  error estimate for blocks of size 2^( 7) =       0.000421882086

      target function =                  N/A
              le_mean =     -17.216768334286
             les_mean =     296.729164866188
             stat err =       0.000418420045
             autocorr =       1.174304144326
              std dev =       0.546055998914
             le_variance =       0.298177153950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298138004513
                                         uncertainty =       0.001907693365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386119900
  error estimate for blocks of size 2^( 2) =       0.000396673312
  error estimate for blocks of size 2^( 3) =       0.000405837527
  error estimate for blocks of size 2^( 4) =       0.000412760641
  error estimate for blocks of size 2^( 5) =       0.000418380731
  error estimate for blocks of size 2^( 6) =       0.000420656721
  error estimate for blocks of size 2^( 7) =       0.000421882086

      target function =                  N/A
              le_mean =     -17.216768334286
             les_mean =     296.729164866188
             stat err =       0.000418420045
             autocorr =       1.174304144326
              std dev =       0.546055998914
             le_variance =       0.298177153950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216768334286        initial  <--
     9.5367e+80     9.5367e+81             0.0000e+00       -17.216768334286
     3.8147e+81     3.8147e+82             0.0000e+00       -17.216768334286
     1.5259e+82     1.5259e+83             0.0000e+00       -17.216768334286

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9931
  </log>
  <optVariables href="H2O.s097.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6598e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2521
    reference variance = 0.338847
====================================================
  Execution time = 2.0505e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2161e-01
  Total weights = 1.956750936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300508334419
                                         uncertainty =       0.001945755578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300508334419
                                         uncertainty =       0.001945755578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387578465
  error estimate for blocks of size 2^( 2) =       0.000397660573
  error estimate for blocks of size 2^( 3) =       0.000406652021
  error estimate for blocks of size 2^( 4) =       0.000412981954
  error estimate for blocks of size 2^( 5) =       0.000417407071
  error estimate for blocks of size 2^( 6) =       0.000419512898
  error estimate for blocks of size 2^( 7) =       0.000419011629

      target function =                  N/A
              le_mean =     -17.216652968423
             les_mean =     296.734749956314
             stat err =       0.000417228388
             autocorr =       1.158853195649
              std dev =       0.548118721876
             le_variance =       0.300434133270


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665296842e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+81, overlap shift 9.5367e+82 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+81 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+82, overlap shift 3.8147e+83 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+82 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+83, overlap shift 1.5259e+84 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216652968471       residual = 5.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+83 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.445463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6716e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.166698
====================================================
  Execution time = 2.0543e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0716e-01
  Total weights = 1.9564e+06
  Execution time = 1.8225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383136898
  error estimate for blocks of size 2^( 2) =       0.000393189597
  error estimate for blocks of size 2^( 3) =       0.000402456210
  error estimate for blocks of size 2^( 4) =       0.000408846013
  error estimate for blocks of size 2^( 5) =       0.000412560768
  error estimate for blocks of size 2^( 6) =       0.000414989542
  error estimate for blocks of size 2^( 7) =       0.000415650870

      target function =                  N/A
              le_mean =     -17.216559012728
             les_mean =     296.717063181668
             stat err =       0.000413011798
             autocorr =       1.162028981313
              std dev =       0.541837396976
             le_variance =       0.293587764762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383136898
  error estimate for blocks of size 2^( 2) =       0.000393189597
  error estimate for blocks of size 2^( 3) =       0.000402456210
  error estimate for blocks of size 2^( 4) =       0.000408846013
  error estimate for blocks of size 2^( 5) =       0.000412560768
  error estimate for blocks of size 2^( 6) =       0.000414989542
  error estimate for blocks of size 2^( 7) =       0.000415650870

      target function =                  N/A
              le_mean =     -17.216559012728
             les_mean =     296.717063181668
             stat err =       0.000413011798
             autocorr =       1.162028981313
              std dev =       0.541837396976
             le_variance =       0.293587764762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383136898
  error estimate for blocks of size 2^( 2) =       0.000393189597
  error estimate for blocks of size 2^( 3) =       0.000402456210
  error estimate for blocks of size 2^( 4) =       0.000408846013
  error estimate for blocks of size 2^( 5) =       0.000412560768
  error estimate for blocks of size 2^( 6) =       0.000414989542
  error estimate for blocks of size 2^( 7) =       0.000415650870

      target function =                  N/A
              le_mean =     -17.216559012728
             les_mean =     296.717063181668
             stat err =       0.000413011798
             autocorr =       1.162028981313
              std dev =       0.541837396976
             le_variance =       0.293587764762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293558251808
                                         uncertainty =       0.001933373924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383136898
  error estimate for blocks of size 2^( 2) =       0.000393189597
  error estimate for blocks of size 2^( 3) =       0.000402456210
  error estimate for blocks of size 2^( 4) =       0.000408846013
  error estimate for blocks of size 2^( 5) =       0.000412560768
  error estimate for blocks of size 2^( 6) =       0.000414989542
  error estimate for blocks of size 2^( 7) =       0.000415650870

      target function =                  N/A
              le_mean =     -17.216559012728
             les_mean =     296.717063181668
             stat err =       0.000413011798
             autocorr =       1.162028981313
              std dev =       0.541837396976
             le_variance =       0.293587764762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216559012728        initial  <--
     9.5367e+81     9.5367e+82             0.0000e+00       -17.216559012728
     3.8147e+82     3.8147e+83             0.0000e+00       -17.216559012728
     1.5259e+83     1.5259e+84             0.0000e+00       -17.216559012728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7693
  </log>
  <optVariables href="H2O.s098.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.469555
====================================================
  Execution time = 2.2762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1133e-01
  Total weights = 1.956674042e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732861
                                         uncertainty =       0.002138618204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298307732861
                                         uncertainty =       0.002138618204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386178239
  error estimate for blocks of size 2^( 2) =       0.000396575068
  error estimate for blocks of size 2^( 3) =       0.000405444364
  error estimate for blocks of size 2^( 4) =       0.000412160870
  error estimate for blocks of size 2^( 5) =       0.000416160145
  error estimate for blocks of size 2^( 6) =       0.000417206366
  error estimate for blocks of size 2^( 7) =       0.000417849425

      target function =                  N/A
              le_mean =     -17.216917815332
             les_mean =     296.733591257301
             stat err =       0.000415844201
             autocorr =       1.159539918383
              std dev =       0.546138503028
             le_variance =       0.298267264490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691781533e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 119
Check correct_vf_var_size: 360, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+82, overlap shift 9.5367e+83 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 9.5367e+82 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.8147e+83, overlap shift 3.8147e+84 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 3.8147e+83 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.5259e+84, overlap shift 1.5259e+85 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216917815387       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 120 and evec_eigen.size(): 120
The largest weight on the derivative vector for shift 1.5259e+84 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.446709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 120 and numParams is: 119

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8886e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1532
    reference variance = 0.475495
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1231e-01
  Total weights = 1.9566e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240031
  error estimate for blocks of size 2^( 2) =       0.000396076291
  error estimate for blocks of size 2^( 3) =       0.000404832187
  error estimate for blocks of size 2^( 4) =       0.000412249936
  error estimate for blocks of size 2^( 5) =       0.000415020056
  error estimate for blocks of size 2^( 6) =       0.000415549237
  error estimate for blocks of size 2^( 7) =       0.000416970635

      target function =                  N/A
              le_mean =     -17.217026086025
             les_mean =     296.738299564226
             stat err =       0.000414947466
             autocorr =       1.154175011578
              std dev =       0.546225889903
             le_variance =       0.298362722800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240031
  error estimate for blocks of size 2^( 2) =       0.000396076291
  error estimate for blocks of size 2^( 3) =       0.000404832187
  error estimate for blocks of size 2^( 4) =       0.000412249936
  error estimate for blocks of size 2^( 5) =       0.000415020056
  error estimate for blocks of size 2^( 6) =       0.000415549237
  error estimate for blocks of size 2^( 7) =       0.000416970635

      target function =                  N/A
              le_mean =     -17.217026086025
             les_mean =     296.738299564226
             stat err =       0.000414947466
             autocorr =       1.154175011578
              std dev =       0.546225889903
             le_variance =       0.298362722800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240031
  error estimate for blocks of size 2^( 2) =       0.000396076291
  error estimate for blocks of size 2^( 3) =       0.000404832187
  error estimate for blocks of size 2^( 4) =       0.000412249936
  error estimate for blocks of size 2^( 5) =       0.000415020056
  error estimate for blocks of size 2^( 6) =       0.000415549237
  error estimate for blocks of size 2^( 7) =       0.000416970635

      target function =                  N/A
              le_mean =     -17.217026086025
             les_mean =     296.738299564226
             stat err =       0.000414947466
             autocorr =       1.154175011578
              std dev =       0.546225889903
             le_variance =       0.298362722800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298345436811
                                         uncertainty =       0.001671960378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386240031
  error estimate for blocks of size 2^( 2) =       0.000396076291
  error estimate for blocks of size 2^( 3) =       0.000404832187
  error estimate for blocks of size 2^( 4) =       0.000412249936
  error estimate for blocks of size 2^( 5) =       0.000415020056
  error estimate for blocks of size 2^( 6) =       0.000415549237
  error estimate for blocks of size 2^( 7) =       0.000416970635

      target function =                  N/A
              le_mean =     -17.217026086025
             les_mean =     296.738299564226
             stat err =       0.000414947466
             autocorr =       1.154175011578
              std dev =       0.546225889903
             le_variance =       0.298362722800


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217026086025        initial  <--
     9.5367e+82     9.5367e+83             0.0000e+00       -17.217026086025
     3.8147e+83     3.8147e+84             0.0000e+00       -17.217026086025
     1.5259e+84     1.5259e+85             0.0000e+00       -17.217026086025

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4965
  </log>
  <optVariables href="H2O.s099.opt.xml">
  uu_0                 2.036799e-01 1 1  ON 0
  uu_1                 4.370039e-02 1 1  ON 1
  uu_2                -4.751526e-02 1 1  ON 2
  uu_3                -9.904437e-02 1 1  ON 3
  uu_4                -1.294219e-01 1 1  ON 4
  uu_5                -1.342281e-01 1 1  ON 5
  uu_6                -1.118892e-01 1 1  ON 6
  uu_7                -3.803740e-02 1 1  ON 7
  uu_8                 1.008668e-01 1 1  ON 8
  uu_9                 1.201848e-01 1 1  ON 9
  ud_0                 3.471070e-01 1 1  ON 10
  ud_1                 8.998351e-02 1 1  ON 11
  ud_2                -1.727309e-02 1 1  ON 12
  ud_3                -7.538195e-02 1 1  ON 13
  ud_4                -1.203890e-01 1 1  ON 14
  ud_5                -1.507893e-01 1 1  ON 15
  ud_6                -1.541540e-01 1 1  ON 16
  ud_7                -1.094150e-01 1 1  ON 17
  ud_8                 5.948145e-03 1 1  ON 18
  ud_9                 9.251988e-02 1 1  ON 19
  eO_0                -7.402288e-01 1 1  ON 20
  eO_1                -4.286506e-01 1 1  ON 21
  eO_2                -3.455094e-02 1 1  ON 22
  eO_3                 2.024933e-01 1 1  ON 23
  eO_4                 2.802468e-01 1 1  ON 24
  eO_5                 3.038408e-01 1 1  ON 25
  eO_6                 2.493764e-01 1 1  ON 26
  eO_7                 1.108766e-01 1 1  ON 27
  eO_8                 2.771128e-02 1 1  ON 28
  eO_9                 1.834436e-02 1 1  ON 29
 eH1_0                -1.814830e-01 1 1  ON 30
 eH1_1                -1.020714e-01 1 1  ON 31
 eH1_2                -6.230086e-02 1 1  ON 32
 eH1_3                -2.601353e-02 1 1  ON 33
 eH1_4                 1.958756e-02 1 1  ON 34
 eH1_5                 3.568262e-02 1 1  ON 35
 eH1_6                 7.685546e-02 1 1  ON 36
 eH1_7                 1.104950e-01 1 1  ON 37
 eH1_8                 9.001468e-02 1 1  ON 38
 eH1_9                 2.406849e-02 1 1  ON 39
 eH2_0                -1.826253e-01 1 1  ON 40
 eH2_1                -1.036000e-01 1 1  ON 41
 eH2_2                -6.368918e-02 1 1  ON 42
 eH2_3                -2.766797e-02 1 1  ON 43
 eH2_4                 1.867338e-02 1 1  ON 44
 eH2_5                 3.506271e-02 1 1  ON 45
 eH2_6                 7.835838e-02 1 1  ON 46
 eH2_7                 1.139679e-01 1 1  ON 47
 eH2_8                 9.324184e-02 1 1  ON 48
 eH2_9                 2.614975e-02 1 1  ON 49
ci_001                -4.170935e-02 3 1  ON 50
ci_002                -3.012116e-02 3 1  ON 51
ci_003                -2.528621e-02 3 1  ON 52
ci_004                 2.147687e-02 3 1  ON 53
ci_005                 2.161793e-02 3 1  ON 54
ci_006                -1.879098e-02 3 1  ON 55
ci_007                -1.932299e-02 3 1  ON 56
ci_008                -1.805320e-02 3 1  ON 57
ci_009                -1.762700e-02 3 1  ON 58
ci_010                -1.791485e-02 3 1  ON 59
ci_011                -1.637397e-02 3 1  ON 60
ci_012                -1.648090e-02 3 1  ON 61
ci_013                -1.900036e-02 3 1  ON 62
ci_014                 1.377004e-02 3 1  ON 63
ci_015                 1.399673e-02 3 1  ON 64
ci_016                 1.631852e-02 3 1  ON 65
ci_017                 1.654880e-02 3 1  ON 66
ci_018                 1.257065e-02 3 1  ON 67
ci_019                 1.289724e-02 3 1  ON 68
ci_020                 1.326155e-02 3 1  ON 69
ci_021                 1.359724e-02 3 1  ON 70
ci_022                 1.177253e-02 3 1  ON 71
ci_023                 1.150961e-02 3 1  ON 72
ci_024                 1.252555e-02 3 1  ON 73
ci_025                 1.222743e-02 3 1  ON 74
ci_026                 1.110308e-02 3 1  ON 75
ci_027                 1.152038e-02 3 1  ON 76
ci_028                -1.444726e-02 3 1  ON 77
ci_029                -1.476227e-02 3 1  ON 78
ci_030                -1.102966e-02 3 1  ON 79
ci_031                -1.177170e-02 3 1  ON 80
ci_032                -1.332794e-02 3 1  ON 81
ci_033                 1.088271e-02 3 1  ON 82
ci_034                 1.077941e-02 3 1  ON 83
ci_035                -4.996215e-03 3 1  ON 84
ci_036                -1.089547e-02 3 1  ON 85
ci_037                -1.029889e-02 3 1  ON 86
ci_038                 1.622575e-03 3 1  ON 87
ci_039                 1.980857e-03 3 1  ON 88
ci_040                -4.113682e-03 3 1  ON 89
ci_041                 1.002085e-02 3 1  ON 90
ci_042                 9.730797e-03 3 1  ON 91
ci_043                -3.584680e-03 3 1  ON 92
ci_044                -1.543142e-02 3 1  ON 93
ci_045                -1.673338e-03 3 1  ON 94
ci_046                 5.223857e-03 3 1  ON 95
ci_047                 5.916204e-03 3 1  ON 96
ci_048                -1.129059e-02 3 1  ON 97
ci_049                -1.192615e-02 3 1  ON 98
ci_050                 7.727353e-03 3 1  ON 99
ci_051                 7.750240e-03 3 1  ON 100
ci_052                -7.010656e-03 3 1  ON 101
ci_053                -6.822691e-03 3 1  ON 102
ci_054                -2.931362e-03 3 1  ON 103
ci_055                -3.081086e-03 3 1  ON 104
ci_056                 4.766316e-03 3 1  ON 105
ci_057                 4.624480e-03 3 1  ON 106
ci_058                -6.912420e-03 3 1  ON 107
ci_059                -6.879359e-03 3 1  ON 108
ci_060                 8.399314e-03 3 1  ON 109
ci_061                 8.234594e-03 3 1  ON 110
ci_062                -3.046139e-03 3 1  ON 111
ci_063                -3.004048e-03 3 1  ON 112
ci_064                -2.988284e-03 3 1  ON 113
ci_065                -4.123297e-03 3 1  ON 114
ci_066                 6.044238e-03 3 1  ON 115
ci_067                 5.242513e-03 3 1  ON 116
ci_068                -5.350628e-03 3 1  ON 117
ci_069                -5.112306e-03 3 1  ON 118
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8389e+01 secs
  Total Execution time = 5.7007e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
