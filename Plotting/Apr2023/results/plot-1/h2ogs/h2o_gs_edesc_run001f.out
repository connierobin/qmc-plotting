Rank =    0  Free Memory = 90219 MB
Rank =    1  Free Memory = 90219 MB
Rank =    2  Free Memory = 90219 MB
Rank =    3  Free Memory = 90219 MB
Rank =    4  Free Memory = 90219 MB
Rank =    5  Free Memory = 90218 MB
Rank =    6  Free Memory = 90218 MB
Rank =    7  Free Memory = 90218 MB
Rank =    8  Free Memory = 90218 MB
Rank =    9  Free Memory = 90218 MB
Rank =   10  Free Memory = 90218 MB
Rank =   11  Free Memory = 90218 MB
Rank =   12  Free Memory = 90218 MB
Rank =   13  Free Memory = 90217 MB
Rank =   14  Free Memory = 90216 MB
Rank =   15  Free Memory = 90204 MB
Rank =   16  Free Memory = 90203 MB
Rank =   17  Free Memory = 90203 MB
Rank =   18  Free Memory = 90203 MB
Rank =   19  Free Memory = 90203 MB
Rank =   20  Free Memory = 90203 MB
Rank =   21  Free Memory = 90203 MB
Rank =   22  Free Memory = 90203 MB
Rank =   23  Free Memory = 90203 MB
Rank =   24  Free Memory = 90203 MB
Rank =   25  Free Memory = 90203 MB
Rank =   26  Free Memory = 90203 MB
Rank =   27  Free Memory = 90203 MB
Rank =   28  Free Memory = 90203 MB
Rank =   29  Free Memory = 90203 MB
Rank =   30  Free Memory = 90203 MB
Rank =   31  Free Memory = 90203 MB
Rank =   32  Free Memory = 90726 MB
Rank =   33  Free Memory = 90726 MB
Rank =   34  Free Memory = 90726 MB
Rank =   35  Free Memory = 90726 MB
Rank =   36  Free Memory = 90726 MB
Rank =   37  Free Memory = 90726 MB
Rank =   38  Free Memory = 90726 MB
Rank =   39  Free Memory = 90726 MB
Rank =   40  Free Memory = 90726 MB
Rank =   41  Free Memory = 90726 MB
Rank =   42  Free Memory = 90726 MB
Rank =   43  Free Memory = 90726 MB
Rank =   44  Free Memory = 90726 MB
Rank =   45  Free Memory = 90726 MB
Rank =   46  Free Memory = 90726 MB
Rank =   47  Free Memory = 90726 MB
Rank =   48  Free Memory = 90726 MB
Rank =   49  Free Memory = 90726 MB
Rank =   50  Free Memory = 90726 MB
Rank =   51  Free Memory = 90726 MB
Rank =   52  Free Memory = 90726 MB
Rank =   53  Free Memory = 90726 MB
Rank =   54  Free Memory = 90726 MB
Rank =   55  Free Memory = 90726 MB
Rank =   56  Free Memory = 90726 MB
Rank =   57  Free Memory = 90726 MB
Rank =   58  Free Memory = 90726 MB
Rank =   59  Free Memory = 90726 MB
Rank =   60  Free Memory = 90726 MB
Rank =   61  Free Memory = 90726 MB
Rank =   62  Free Memory = 90726 MB
Rank =   63  Free Memory = 90726 MB
Rank =   64  Free Memory = 90249 MB
Rank =   65  Free Memory = 90249 MB
Rank =   66  Free Memory = 90249 MB
Rank =   67  Free Memory = 90248 MB
Rank =   68  Free Memory = 90248 MB
Rank =   69  Free Memory = 90248 MB
Rank =   70  Free Memory = 90248 MB
Rank =   71  Free Memory = 90248 MB
Rank =   72  Free Memory = 90248 MB
Rank =   73  Free Memory = 90248 MB
Rank =   74  Free Memory = 90248 MB
Rank =   75  Free Memory = 90248 MB
Rank =   76  Free Memory = 90248 MB
Rank =   77  Free Memory = 90248 MB
Rank =   78  Free Memory = 90248 MB
Rank =   79  Free Memory = 90248 MB
Rank =   80  Free Memory = 90248 MB
Rank =   81  Free Memory = 90248 MB
Rank =   82  Free Memory = 90248 MB
Rank =   83  Free Memory = 90248 MB
Rank =   84  Free Memory = 90248 MB
Rank =   85  Free Memory = 90248 MB
Rank =   86  Free Memory = 90248 MB
Rank =   87  Free Memory = 90248 MB
Rank =   88  Free Memory = 90248 MB
Rank =   89  Free Memory = 90247 MB
Rank =   90  Free Memory = 90247 MB
Rank =   91  Free Memory = 90247 MB
Rank =   92  Free Memory = 90247 MB
Rank =   93  Free Memory = 90247 MB
Rank =   94  Free Memory = 90247 MB
Rank =   95  Free Memory = 90247 MB
Rank =   96  Free Memory = 89300 MB
Rank =   97  Free Memory = 89300 MB
Rank =   98  Free Memory = 89300 MB
Rank =   99  Free Memory = 89300 MB
Rank =  100  Free Memory = 89300 MB
Rank =  101  Free Memory = 89300 MB
Rank =  102  Free Memory = 89300 MB
Rank =  103  Free Memory = 89300 MB
Rank =  104  Free Memory = 89300 MB
Rank =  105  Free Memory = 89300 MB
Rank =  106  Free Memory = 89300 MB
Rank =  107  Free Memory = 89300 MB
Rank =  108  Free Memory = 89300 MB
Rank =  109  Free Memory = 89300 MB
Rank =  110  Free Memory = 89300 MB
Rank =  111  Free Memory = 89300 MB
Rank =  112  Free Memory = 89300 MB
Rank =  113  Free Memory = 89300 MB
Rank =  114  Free Memory = 89300 MB
Rank =  115  Free Memory = 89300 MB
Rank =  116  Free Memory = 89300 MB
Rank =  117  Free Memory = 89300 MB
Rank =  118  Free Memory = 89300 MB
Rank =  119  Free Memory = 89300 MB
Rank =  120  Free Memory = 89300 MB
Rank =  121  Free Memory = 89300 MB
Rank =  122  Free Memory = 89300 MB
Rank =  123  Free Memory = 89300 MB
Rank =  124  Free Memory = 89300 MB
Rank =  125  Free Memory = 89300 MB
Rank =  126  Free Memory = 89300 MB
Rank =  127  Free Memory = 89300 MB
  Input file(s): opt_h2o_gs_edesc_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_edesc_run001f.xml

  Project = H2O
  date    = 2023-03-06 13:50:39 PST
  host    = n0017.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 47

  Range of prime numbers to use as seeds over processors and threads = 227-1051


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.118251e-01    1         1  ON     0
     uu_1                 4.961922e-02    1         1  ON     1
     uu_2                -4.506550e-02    1         1  ON     2
     uu_3                -9.993802e-02    1         1  ON     3
     uu_4                -1.332601e-01    1         1  ON     4
     uu_5                -1.395322e-01    1         1  ON     5
     uu_6                -1.161234e-01    1         1  ON     6
     uu_7                -4.295244e-02    1         1  ON     7
     uu_8                 9.767386e-02    1         1  ON     8
     uu_9                 1.227530e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.521166e-01    1         1  ON     0
     ud_1                 9.375399e-02    1         1  ON     1
     ud_2                -1.536536e-02    1         1  ON     2
     ud_3                -7.563918e-02    1         1  ON     3
     ud_4                -1.226008e-01    1         1  ON     4
     ud_5                -1.535800e-01    1         1  ON     5
     ud_6                -1.546461e-01    1         1  ON     6
     ud_7                -1.114365e-01    1         1  ON     7
     ud_8                 5.099853e-04    1         1  ON     8
     ud_9                 9.261350e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.680168e-01    1         1  ON     0
     eO_1                -4.487200e-01    1         1  ON     1
     eO_2                -4.138440e-02    1         1  ON     2
     eO_3                 2.125370e-01    1         1  ON     3
     eO_4                 3.041810e-01    1         1  ON     4
     eO_5                 3.130157e-01    1         1  ON     5
     eO_6                 2.535804e-01    1         1  ON     6
     eO_7                 1.165987e-01    1         1  ON     7
     eO_8                 2.874814e-02    1         1  ON     8
     eO_9                 1.871805e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.826306e-01    1         1  ON     0
     eH1_1                -1.034588e-01    1         1  ON     1
     eH1_2                -6.247539e-02    1         1  ON     2
     eH1_3                -2.585376e-02    1         1  ON     3
     eH1_4                 1.924881e-02    1         1  ON     4
     eH1_5                 3.370856e-02    1         1  ON     5
     eH1_6                 7.737335e-02    1         1  ON     6
     eH1_7                 1.098388e-01    1         1  ON     7
     eH1_8                 9.354199e-02    1         1  ON     8
     eH1_9                 2.515173e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.841241e-01    1         1  ON     0
     eH2_1                -1.048605e-01    1         1  ON     1
     eH2_2                -6.388854e-02    1         1  ON     2
     eH2_3                -2.707294e-02    1         1  ON     3
     eH2_4                 1.823266e-02    1         1  ON     4
     eH2_5                 3.360837e-02    1         1  ON     5
     eH2_6                 7.881410e-02    1         1  ON     6
     eH2_7                 1.133491e-01    1         1  ON     7
     eH2_8                 9.645183e-02    1         1  ON     8
     eH2_9                 2.717107e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.700428e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.0212e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.43963
====================================================
  Execution time = 2.0720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1766e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317715266711
                                         uncertainty =       0.003352844898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317715266711
                                         uncertainty =       0.003352844898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398534809
  error estimate for blocks of size 2^( 2) =       0.000408119280
  error estimate for blocks of size 2^( 3) =       0.000417091481
  error estimate for blocks of size 2^( 4) =       0.000423307396
  error estimate for blocks of size 2^( 5) =       0.000428232679
  error estimate for blocks of size 2^( 6) =       0.000430276671
  error estimate for blocks of size 2^( 7) =       0.000430557066

      target function =                  N/A
              le_mean =     -17.216862810737
             les_mean =     296.738024872140
             stat err =       0.000428093453
             autocorr =       1.153837511630
              std dev =       0.563613331319
             le_variance =       0.317659987240


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721686281074e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862810737       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216865563960       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216864596507       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216864276237       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216860311417       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216861433389       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863067504       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216863711702       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216863697556       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216864308663       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.084130e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862810737       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863878597       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863587492       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863519498       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216862021428       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216862628808       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862847602       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216862912040       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.938311e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862810737       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863120390       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863050016       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863029127       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216862615033       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216862801009       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862820457       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216862824583       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.558248e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.362089 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7683e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.117518e-01                 1 1 ON  0
uu_1  4.966663e-02                 1 1 ON  1
uu_2  -4.499545e-02                1 1 ON  2
uu_3  -9.992165e-02                1 1 ON  3
uu_4  -1.332521e-01                1 1 ON  4
uu_5  -1.396544e-01                1 1 ON  5
uu_6  -1.161728e-01                1 1 ON  6
uu_7  -4.299665e-02                1 1 ON  7
uu_8  9.764040e-02                 1 1 ON  8
uu_9  1.228258e-01                 1 1 ON  9
ud_0  3.523249e-01                 1 1 ON  10
ud_1  9.394105e-02                 1 1 ON  11
ud_2  -1.551075e-02                1 1 ON  12
ud_3  -7.581699e-02                1 1 ON  13
ud_4  -1.227709e-01                1 1 ON  14
ud_5  -1.536613e-01                1 1 ON  15
ud_6  -1.545846e-01                1 1 ON  16
ud_7  -1.113524e-01                1 1 ON  17
ud_8  4.453233e-04                 1 1 ON  18
ud_9  9.262949e-02                 1 1 ON  19
eO_0  -7.686107e-01                1 1 ON  20
eO_1  -4.491059e-01                1 1 ON  21
eO_2  -4.143215e-02                1 1 ON  22
eO_3  2.126700e-01                 1 1 ON  23
eO_4  3.044992e-01                 1 1 ON  24
eO_5  3.132615e-01                 1 1 ON  25
eO_6  2.537000e-01                 1 1 ON  26
eO_7  1.167517e-01                 1 1 ON  27
eO_8  2.878160e-02                 1 1 ON  28
eO_9  1.872878e-02                 1 1 ON  29
eH1_0 -1.827414e-01                1 1 ON  30
eH1_1 -1.035200e-01                1 1 ON  31
eH1_2 -6.250675e-02                1 1 ON  32
eH1_3 -2.582424e-02                1 1 ON  33
eH1_4 1.920658e-02                 1 1 ON  34
eH1_5 3.373736e-02                 1 1 ON  35
eH1_6 7.742593e-02                 1 1 ON  36
eH1_7 1.098516e-01                 1 1 ON  37
eH1_8 9.362512e-02                 1 1 ON  38
eH1_9 2.518507e-02                 1 1 ON  39
eH2_0 -1.841333e-01                1 1 ON  40
eH2_1 -1.048774e-01                1 1 ON  41
eH2_2 -6.393523e-02                1 1 ON  42
eH2_3 -2.708404e-02                1 1 ON  43
eH2_4 1.823515e-02                 1 1 ON  44
eH2_5 3.360824e-02                 1 1 ON  45
eH2_6 7.878685e-02                 1 1 ON  46
eH2_7 1.133444e-01                 1 1 ON  47
eH2_8 9.652243e-02                 1 1 ON  48
eH2_9 2.719696e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1938
    reference variance = 0.15536
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1489e-01
  Total weights = 2.0000e+06
  Execution time = 1.9106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314763643712
                                         uncertainty =       0.003250368233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314763643712
                                         uncertainty =       0.003250368233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396675947
  error estimate for blocks of size 2^( 2) =       0.000406695252
  error estimate for blocks of size 2^( 3) =       0.000415814737
  error estimate for blocks of size 2^( 4) =       0.000422567496
  error estimate for blocks of size 2^( 5) =       0.000425905134
  error estimate for blocks of size 2^( 6) =       0.000429108470
  error estimate for blocks of size 2^( 7) =       0.000431810727

      target function =                  N/A
              le_mean =     -17.216882782432
             les_mean =     296.735756199862
             stat err =       0.000427347957
             autocorr =       1.160623955544
              std dev =       0.560984503535
             le_variance =       0.314703613206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315314662687
                                         uncertainty =       0.003256238084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315314662687
                                         uncertainty =       0.003256238084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397023160
  error estimate for blocks of size 2^( 2) =       0.000407018137
  error estimate for blocks of size 2^( 3) =       0.000416111434
  error estimate for blocks of size 2^( 4) =       0.000422840815
  error estimate for blocks of size 2^( 5) =       0.000426164700
  error estimate for blocks of size 2^( 6) =       0.000429364049
  error estimate for blocks of size 2^( 7) =       0.000432080489

      target function =                  N/A
              le_mean =     -17.216887746088
             les_mean =     296.736478283178
             stat err =       0.000427612513
             autocorr =       1.160029750475
              std dev =       0.561475537683
             le_variance =       0.315254779417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315144070644
                                         uncertainty =       0.003254298075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315144070644
                                         uncertainty =       0.003254298075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396915753
  error estimate for blocks of size 2^( 2) =       0.000406915282
  error estimate for blocks of size 2^( 3) =       0.000416015172
  error estimate for blocks of size 2^( 4) =       0.000422751131
  error estimate for blocks of size 2^( 5) =       0.000426079038
  error estimate for blocks of size 2^( 6) =       0.000429280845
  error estimate for blocks of size 2^( 7) =       0.000431996095

      target function =                  N/A
              le_mean =     -17.216886928431
             les_mean =     296.736279578587
             stat err =       0.000427526777
             autocorr =       1.160192277566
              std dev =       0.561323640825
             le_variance =       0.315084229749

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314813445214
                                         uncertainty =       0.003250877673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314813445214
                                         uncertainty =       0.003250877673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396707355
  error estimate for blocks of size 2^( 2) =       0.000406723631
  error estimate for blocks of size 2^( 3) =       0.000415840232
  error estimate for blocks of size 2^( 4) =       0.000422590527
  error estimate for blocks of size 2^( 5) =       0.000425926715
  error estimate for blocks of size 2^( 6) =       0.000429129913
  error estimate for blocks of size 2^( 7) =       0.000431834091

      target function =                  N/A
              le_mean =     -17.216883298893
             les_mean =     296.735823821828
             stat err =       0.000427370312
             autocorr =       1.160561591575
              std dev =       0.561028922176
             le_variance =       0.314753451518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216882782432        initial
     2.5000e-01     2.5000e+00             2.0841e-03       -17.216887746088  <--
     1.0000e+00     1.0000e+01             5.9383e-04       -17.216886928431
     4.0000e+00     4.0000e+01             1.5582e-04       -17.216883298893

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9631e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.117962e-01 1 1  ON 0
 uu_1                 4.977988e-02 1 1  ON 1
 uu_2                -4.487742e-02 1 1  ON 2
 uu_3                -9.990201e-02 1 1  ON 3
 uu_4                -1.333379e-01 1 1  ON 4
 uu_5                -1.399595e-01 1 1  ON 5
 uu_6                -1.163709e-01 1 1  ON 6
 uu_7                -4.314612e-02 1 1  ON 7
 uu_8                 9.753862e-02 1 1  ON 8
 uu_9                 1.230452e-01 1 1  ON 9
 ud_0                 3.527259e-01 1 1  ON 10
 ud_1                 9.421902e-02 1 1  ON 11
 ud_2                -1.564770e-02 1 1  ON 12
 ud_3                -7.614969e-02 1 1  ON 13
 ud_4                -1.231880e-01 1 1  ON 14
 ud_5                -1.539308e-01 1 1  ON 15
 ud_6                -1.544647e-01 1 1  ON 16
 ud_7                -1.111051e-01 1 1  ON 17
 ud_8                 2.576148e-04 1 1  ON 18
 ud_9                 9.267901e-02 1 1  ON 19
 eO_0                -7.701010e-01 1 1  ON 20
 eO_1                -4.501855e-01 1 1  ON 21
 eO_2                -4.181190e-02 1 1  ON 22
 eO_3                 2.129303e-01 1 1  ON 23
 eO_4                 3.054202e-01 1 1  ON 24
 eO_5                 3.140270e-01 1 1  ON 25
 eO_6                 2.540662e-01 1 1  ON 26
 eO_7                 1.172135e-01 1 1  ON 27
 eO_8                 2.888283e-02 1 1  ON 28
 eO_9                 1.876118e-02 1 1  ON 29
eH1_0                -1.830266e-01 1 1  ON 30
eH1_1                -1.036595e-01 1 1  ON 31
eH1_2                -6.259094e-02 1 1  ON 32
eH1_3                -2.583216e-02 1 1  ON 33
eH1_4                 1.911626e-02 1 1  ON 34
eH1_5                 3.378242e-02 1 1  ON 35
eH1_6                 7.757804e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.387637e-02 1 1  ON 38
eH1_9                 2.528572e-02 1 1  ON 39
eH2_0                -1.841867e-01 1 1  ON 40
eH2_1                -1.049642e-01 1 1  ON 41
eH2_2                -6.402246e-02 1 1  ON 42
eH2_3                -2.709781e-02 1 1  ON 43
eH2_4                 1.822873e-02 1 1  ON 44
eH2_5                 3.359788e-02 1 1  ON 45
eH2_6                 7.871319e-02 1 1  ON 46
eH2_7                 1.133336e-01 1 1  ON 47
eH2_8                 9.673566e-02 1 1  ON 48
eH2_9                 2.727518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7328e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7237e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2663
    reference variance = 0.242254
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2476e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324773536310
                                         uncertainty =       0.008120977601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324773536310
                                         uncertainty =       0.008120977601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402967208
  error estimate for blocks of size 2^( 2) =       0.000412572934
  error estimate for blocks of size 2^( 3) =       0.000421157582
  error estimate for blocks of size 2^( 4) =       0.000428201080
  error estimate for blocks of size 2^( 5) =       0.000432541518
  error estimate for blocks of size 2^( 6) =       0.000433834796
  error estimate for blocks of size 2^( 7) =       0.000435104685

      target function =                  N/A
              le_mean =     -17.216637404457
             les_mean =     296.737368496262
             stat err =       0.000432420520
             autocorr =       1.151524480869
              std dev =       0.569881691318
             le_variance =       0.324765142099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663740446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637404457       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216638838855       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216638932892       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216640864521       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216643172155       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216645221512       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216649013331       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216649363999       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216648650576       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216648611190       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216648814185       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216649221986       residual = 6.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 5.720060e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637404457       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216638165127       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216638204763       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216639292386       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216640672809       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216641153706       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216641618487       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216641600712       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216641391761       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216641450266       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.846168e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637404457       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637668691       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637686615       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216638077147       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216638549531       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216638611871       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216638598116       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216638616101       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.300696e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366595 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5736e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.121629e-01 1 1  ON 0
 uu_1                 4.979185e-02 1 1  ON 1
 uu_2                -4.486964e-02 1 1  ON 2
 uu_3                -9.991653e-02 1 1  ON 3
 uu_4                -1.333827e-01 1 1  ON 4
 uu_5                -1.400400e-01 1 1  ON 5
 uu_6                -1.164483e-01 1 1  ON 6
 uu_7                -4.349875e-02 1 1  ON 7
 uu_8                 9.721550e-02 1 1  ON 8
 uu_9                 1.232579e-01 1 1  ON 9
 ud_0                 3.531297e-01 1 1  ON 10
 ud_1                 9.452656e-02 1 1  ON 11
 ud_2                -1.559838e-02 1 1  ON 12
 ud_3                -7.643640e-02 1 1  ON 13
 ud_4                -1.233616e-01 1 1  ON 14
 ud_5                -1.538880e-01 1 1  ON 15
 ud_6                -1.546003e-01 1 1  ON 16
 ud_7                -1.111835e-01 1 1  ON 17
 ud_8                -1.361766e-04 1 1  ON 18
 ud_9                 9.267189e-02 1 1  ON 19
 eO_0                -7.719471e-01 1 1  ON 20
 eO_1                -4.513922e-01 1 1  ON 21
 eO_2                -4.217708e-02 1 1  ON 22
 eO_3                 2.134886e-01 1 1  ON 23
 eO_4                 3.061654e-01 1 1  ON 24
 eO_5                 3.150381e-01 1 1  ON 25
 eO_6                 2.545392e-01 1 1  ON 26
 eO_7                 1.177091e-01 1 1  ON 27
 eO_8                 2.896287e-02 1 1  ON 28
 eO_9                 1.879240e-02 1 1  ON 29
eH1_0                -1.831304e-01 1 1  ON 30
eH1_1                -1.038410e-01 1 1  ON 31
eH1_2                -6.267608e-02 1 1  ON 32
eH1_3                -2.576595e-02 1 1  ON 33
eH1_4                 1.924962e-02 1 1  ON 34
eH1_5                 3.364297e-02 1 1  ON 35
eH1_6                 7.753282e-02 1 1  ON 36
eH1_7                 1.098568e-01 1 1  ON 37
eH1_8                 9.413536e-02 1 1  ON 38
eH1_9                 2.536749e-02 1 1  ON 39
eH2_0                -1.844399e-01 1 1  ON 40
eH2_1                -1.051083e-01 1 1  ON 41
eH2_2                -6.390958e-02 1 1  ON 42
eH2_3                -2.715026e-02 1 1  ON 43
eH2_4                 1.801430e-02 1 1  ON 44
eH2_5                 3.353933e-02 1 1  ON 45
eH2_6                 7.882150e-02 1 1  ON 46
eH2_7                 1.134300e-01 1 1  ON 47
eH2_8                 9.705497e-02 1 1  ON 48
eH2_9                 2.735260e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2094
    reference variance = 0.416338
====================================================
  Execution time = 1.9870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2243e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322207392891
                                         uncertainty =       0.004525372198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322207392891
                                         uncertainty =       0.004525372198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401323056
  error estimate for blocks of size 2^( 2) =       0.000410887007
  error estimate for blocks of size 2^( 3) =       0.000419493168
  error estimate for blocks of size 2^( 4) =       0.000425830899
  error estimate for blocks of size 2^( 5) =       0.000428638352
  error estimate for blocks of size 2^( 6) =       0.000430902131
  error estimate for blocks of size 2^( 7) =       0.000433716220

      target function =                  N/A
              le_mean =     -17.216394156800
             les_mean =     296.726347992058
             stat err =       0.000429771900
             autocorr =       1.146800337486
              std dev =       0.567556508932
             le_variance =       0.322120390831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322944788942
                                         uncertainty =       0.004534613876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322944788942
                                         uncertainty =       0.004534613876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401781941
  error estimate for blocks of size 2^( 2) =       0.000411323572
  error estimate for blocks of size 2^( 3) =       0.000419904405
  error estimate for blocks of size 2^( 4) =       0.000426214693
  error estimate for blocks of size 2^( 5) =       0.000429000621
  error estimate for blocks of size 2^( 6) =       0.000431253161
  error estimate for blocks of size 2^( 7) =       0.000434093370

      target function =                  N/A
              le_mean =     -17.216392827378
             les_mean =     296.727039281952
             stat err =       0.000430140461
             autocorr =       1.146145535715
              std dev =       0.568205470566
             le_variance =       0.322857456781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322827466626
                                         uncertainty =       0.004533376602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322827466626
                                         uncertainty =       0.004533376602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401708983
  error estimate for blocks of size 2^( 2) =       0.000411255309
  error estimate for blocks of size 2^( 3) =       0.000419843364
  error estimate for blocks of size 2^( 4) =       0.000426158294
  error estimate for blocks of size 2^( 5) =       0.000428948250
  error estimate for blocks of size 2^( 6) =       0.000431204780
  error estimate for blocks of size 2^( 7) =       0.000434039658

      target function =                  N/A
              le_mean =     -17.216393749902
             les_mean =     296.726953803774
             stat err =       0.000430087745
             autocorr =       1.146280884520
              std dev =       0.568102291376
             le_variance =       0.322740213467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322304379123
                                         uncertainty =       0.004526678860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322304379123
                                         uncertainty =       0.004526678860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401383445
  error estimate for blocks of size 2^( 2) =       0.000410944357
  error estimate for blocks of size 2^( 3) =       0.000419547579
  error estimate for blocks of size 2^( 4) =       0.000425881323
  error estimate for blocks of size 2^( 5) =       0.000428685848
  error estimate for blocks of size 2^( 6) =       0.000430948906
  error estimate for blocks of size 2^( 7) =       0.000433765909

      target function =                  N/A
              le_mean =     -17.216393923817
             les_mean =     296.726436918917
             stat err =       0.000429820497
             autocorr =       1.146714570502
              std dev =       0.567641911758
             le_variance =       0.322217339984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216394156800        initial  <--
     6.2500e-02     6.2500e-01             5.7201e-03       -17.216392827378
     2.5000e-01     2.5000e+00             1.8462e-03       -17.216393749902
     1.0000e+00     1.0000e+01             5.3007e-04       -17.216393923817

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2931
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.117962e-01 1 1  ON 0
 uu_1                 4.977988e-02 1 1  ON 1
 uu_2                -4.487742e-02 1 1  ON 2
 uu_3                -9.990201e-02 1 1  ON 3
 uu_4                -1.333379e-01 1 1  ON 4
 uu_5                -1.399595e-01 1 1  ON 5
 uu_6                -1.163709e-01 1 1  ON 6
 uu_7                -4.314612e-02 1 1  ON 7
 uu_8                 9.753862e-02 1 1  ON 8
 uu_9                 1.230452e-01 1 1  ON 9
 ud_0                 3.527259e-01 1 1  ON 10
 ud_1                 9.421902e-02 1 1  ON 11
 ud_2                -1.564770e-02 1 1  ON 12
 ud_3                -7.614969e-02 1 1  ON 13
 ud_4                -1.231880e-01 1 1  ON 14
 ud_5                -1.539308e-01 1 1  ON 15
 ud_6                -1.544647e-01 1 1  ON 16
 ud_7                -1.111051e-01 1 1  ON 17
 ud_8                 2.576148e-04 1 1  ON 18
 ud_9                 9.267901e-02 1 1  ON 19
 eO_0                -7.701010e-01 1 1  ON 20
 eO_1                -4.501855e-01 1 1  ON 21
 eO_2                -4.181190e-02 1 1  ON 22
 eO_3                 2.129303e-01 1 1  ON 23
 eO_4                 3.054202e-01 1 1  ON 24
 eO_5                 3.140270e-01 1 1  ON 25
 eO_6                 2.540662e-01 1 1  ON 26
 eO_7                 1.172135e-01 1 1  ON 27
 eO_8                 2.888283e-02 1 1  ON 28
 eO_9                 1.876118e-02 1 1  ON 29
eH1_0                -1.830266e-01 1 1  ON 30
eH1_1                -1.036595e-01 1 1  ON 31
eH1_2                -6.259094e-02 1 1  ON 32
eH1_3                -2.583216e-02 1 1  ON 33
eH1_4                 1.911626e-02 1 1  ON 34
eH1_5                 3.378242e-02 1 1  ON 35
eH1_6                 7.757804e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.387637e-02 1 1  ON 38
eH1_9                 2.528572e-02 1 1  ON 39
eH2_0                -1.841867e-01 1 1  ON 40
eH2_1                -1.049642e-01 1 1  ON 41
eH2_2                -6.402246e-02 1 1  ON 42
eH2_3                -2.709781e-02 1 1  ON 43
eH2_4                 1.822873e-02 1 1  ON 44
eH2_5                 3.359788e-02 1 1  ON 45
eH2_6                 7.871319e-02 1 1  ON 46
eH2_7                 1.133336e-01 1 1  ON 47
eH2_8                 9.673566e-02 1 1  ON 48
eH2_9                 2.727518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5035e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7238e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.208909
====================================================
  Execution time = 1.9964e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1748e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317529549816
                                         uncertainty =       0.004791466451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317529549816
                                         uncertainty =       0.004791466451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398419602
  error estimate for blocks of size 2^( 2) =       0.000408111479
  error estimate for blocks of size 2^( 3) =       0.000417040072
  error estimate for blocks of size 2^( 4) =       0.000422615434
  error estimate for blocks of size 2^( 5) =       0.000426887730
  error estimate for blocks of size 2^( 6) =       0.000428439015
  error estimate for blocks of size 2^( 7) =       0.000429385274

      target function =                  N/A
              le_mean =     -17.216437696986
             les_mean =     296.723203173557
             stat err =       0.000426831863
             autocorr =       1.147710277071
              std dev =       0.563450404280
             le_variance =       0.317476358083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643769699e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437696986       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437610036       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216437538434       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216437854010       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216438543069       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216438197252       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216438930762       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216438795254       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.104494e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437696986       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437671464       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216437625381       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216437650064       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216437854322       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216437793227       residual = 7.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216437938339       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216437904360       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.113623e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216437696986       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216437690315       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216437675993       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216437676251       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216437727633       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216437715893       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216437748942       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216437741263       residual = 1.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.335246e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369358 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5442e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.118731e-01 1 1  ON 0
 uu_1                 4.980910e-02 1 1  ON 1
 uu_2                -4.488200e-02 1 1  ON 2
 uu_3                -9.991645e-02 1 1  ON 3
 uu_4                -1.333582e-01 1 1  ON 4
 uu_5                -1.400008e-01 1 1  ON 5
 uu_6                -1.164070e-01 1 1  ON 6
 uu_7                -4.316720e-02 1 1  ON 7
 uu_8                 9.751741e-02 1 1  ON 8
 uu_9                 1.230671e-01 1 1  ON 9
 ud_0                 3.528136e-01 1 1  ON 10
 ud_1                 9.424690e-02 1 1  ON 11
 ud_2                -1.566379e-02 1 1  ON 12
 ud_3                -7.617535e-02 1 1  ON 13
 ud_4                -1.232245e-01 1 1  ON 14
 ud_5                -1.539581e-01 1 1  ON 15
 ud_6                -1.544447e-01 1 1  ON 16
 ud_7                -1.111161e-01 1 1  ON 17
 ud_8                 2.109775e-04 1 1  ON 18
 ud_9                 9.267821e-02 1 1  ON 19
 eO_0                -7.703123e-01 1 1  ON 20
 eO_1                -4.503269e-01 1 1  ON 21
 eO_2                -4.179490e-02 1 1  ON 22
 eO_3                 2.129730e-01 1 1  ON 23
 eO_4                 3.054936e-01 1 1  ON 24
 eO_5                 3.141357e-01 1 1  ON 25
 eO_6                 2.541141e-01 1 1  ON 26
 eO_7                 1.172598e-01 1 1  ON 27
 eO_8                 2.889188e-02 1 1  ON 28
 eO_9                 1.876672e-02 1 1  ON 29
eH1_0                -1.830505e-01 1 1  ON 30
eH1_1                -1.036529e-01 1 1  ON 31
eH1_2                -6.259123e-02 1 1  ON 32
eH1_3                -2.582772e-02 1 1  ON 33
eH1_4                 1.913449e-02 1 1  ON 34
eH1_5                 3.373809e-02 1 1  ON 35
eH1_6                 7.757908e-02 1 1  ON 36
eH1_7                 1.098939e-01 1 1  ON 37
eH1_8                 9.390291e-02 1 1  ON 38
eH1_9                 2.529458e-02 1 1  ON 39
eH2_0                -1.842493e-01 1 1  ON 40
eH2_1                -1.050125e-01 1 1  ON 41
eH2_2                -6.400127e-02 1 1  ON 42
eH2_3                -2.708092e-02 1 1  ON 43
eH2_4                 1.825449e-02 1 1  ON 44
eH2_5                 3.358204e-02 1 1  ON 45
eH2_6                 7.872589e-02 1 1  ON 46
eH2_7                 1.133411e-01 1 1  ON 47
eH2_8                 9.676530e-02 1 1  ON 48
eH2_9                 2.728421e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2194
    reference variance = 0.245858
====================================================
  Execution time = 1.9944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1772e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317619712278
                                         uncertainty =       0.003777194718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317619712278
                                         uncertainty =       0.003777194718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398511339
  error estimate for blocks of size 2^( 2) =       0.000408438289
  error estimate for blocks of size 2^( 3) =       0.000417403520
  error estimate for blocks of size 2^( 4) =       0.000423675036
  error estimate for blocks of size 2^( 5) =       0.000427974519
  error estimate for blocks of size 2^( 6) =       0.000430713396
  error estimate for blocks of size 2^( 7) =       0.000431983068

      target function =                  N/A
              le_mean =     -17.216371064090
             les_mean =     296.721055032488
             stat err =       0.000428586505
             autocorr =       1.156633102702
              std dev =       0.563580140586
             le_variance =       0.317622574862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317913026037
                                         uncertainty =       0.003779937614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317913026037
                                         uncertainty =       0.003779937614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398695327
  error estimate for blocks of size 2^( 2) =       0.000408613427
  error estimate for blocks of size 2^( 3) =       0.000417569311
  error estimate for blocks of size 2^( 4) =       0.000423834560
  error estimate for blocks of size 2^( 5) =       0.000428129022
  error estimate for blocks of size 2^( 6) =       0.000430866782
  error estimate for blocks of size 2^( 7) =       0.000432136176

      target function =                  N/A
              le_mean =     -17.216370983321
             les_mean =     296.721345604300
             stat err =       0.000428741635
             autocorr =       1.156402517409
              std dev =       0.563840339019
             le_variance =       0.317915927905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317807642254
                                         uncertainty =       0.003778874213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317807642254
                                         uncertainty =       0.003778874213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398629232
  error estimate for blocks of size 2^( 2) =       0.000408550497
  error estimate for blocks of size 2^( 3) =       0.000417509937
  error estimate for blocks of size 2^( 4) =       0.000423777538
  error estimate for blocks of size 2^( 5) =       0.000428073796
  error estimate for blocks of size 2^( 6) =       0.000430812057
  error estimate for blocks of size 2^( 7) =       0.000432081890

      target function =                  N/A
              le_mean =     -17.216370951507
             les_mean =     296.721239110940
             stat err =       0.000428686320
             autocorr =       1.156487552832
              std dev =       0.563746866920
             le_variance =       0.317810529962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317645178863
                                         uncertainty =       0.003777418715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317645178863
                                         uncertainty =       0.003777418715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398527317
  error estimate for blocks of size 2^( 2) =       0.000408453492
  error estimate for blocks of size 2^( 3) =       0.000417417944
  error estimate for blocks of size 2^( 4) =       0.000423688931
  error estimate for blocks of size 2^( 5) =       0.000427987976
  error estimate for blocks of size 2^( 6) =       0.000430726773
  error estimate for blocks of size 2^( 7) =       0.000431996488

      target function =                  N/A
              le_mean =     -17.216371040864
             les_mean =     296.721079702724
             stat err =       0.000428600042
             autocorr =       1.156613421838
              std dev =       0.563602736735
             le_variance =       0.317648044856


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216371064090        initial  <--
     6.2500e-01     6.2500e+00             8.1045e-04       -17.216370983321
     2.5000e+00     2.5000e+01             2.1136e-04       -17.216370951507
     1.0000e+01     1.0000e+02             5.3352e-05       -17.216371040864

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4020
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.117962e-01 1 1  ON 0
 uu_1                 4.977988e-02 1 1  ON 1
 uu_2                -4.487742e-02 1 1  ON 2
 uu_3                -9.990201e-02 1 1  ON 3
 uu_4                -1.333379e-01 1 1  ON 4
 uu_5                -1.399595e-01 1 1  ON 5
 uu_6                -1.163709e-01 1 1  ON 6
 uu_7                -4.314612e-02 1 1  ON 7
 uu_8                 9.753862e-02 1 1  ON 8
 uu_9                 1.230452e-01 1 1  ON 9
 ud_0                 3.527259e-01 1 1  ON 10
 ud_1                 9.421902e-02 1 1  ON 11
 ud_2                -1.564770e-02 1 1  ON 12
 ud_3                -7.614969e-02 1 1  ON 13
 ud_4                -1.231880e-01 1 1  ON 14
 ud_5                -1.539308e-01 1 1  ON 15
 ud_6                -1.544647e-01 1 1  ON 16
 ud_7                -1.111051e-01 1 1  ON 17
 ud_8                 2.576148e-04 1 1  ON 18
 ud_9                 9.267901e-02 1 1  ON 19
 eO_0                -7.701010e-01 1 1  ON 20
 eO_1                -4.501855e-01 1 1  ON 21
 eO_2                -4.181190e-02 1 1  ON 22
 eO_3                 2.129303e-01 1 1  ON 23
 eO_4                 3.054202e-01 1 1  ON 24
 eO_5                 3.140270e-01 1 1  ON 25
 eO_6                 2.540662e-01 1 1  ON 26
 eO_7                 1.172135e-01 1 1  ON 27
 eO_8                 2.888283e-02 1 1  ON 28
 eO_9                 1.876118e-02 1 1  ON 29
eH1_0                -1.830266e-01 1 1  ON 30
eH1_1                -1.036595e-01 1 1  ON 31
eH1_2                -6.259094e-02 1 1  ON 32
eH1_3                -2.583216e-02 1 1  ON 33
eH1_4                 1.911626e-02 1 1  ON 34
eH1_5                 3.378242e-02 1 1  ON 35
eH1_6                 7.757804e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.387637e-02 1 1  ON 38
eH1_9                 2.528572e-02 1 1  ON 39
eH2_0                -1.841867e-01 1 1  ON 40
eH2_1                -1.049642e-01 1 1  ON 41
eH2_2                -6.402246e-02 1 1  ON 42
eH2_3                -2.709781e-02 1 1  ON 43
eH2_4                 1.822873e-02 1 1  ON 44
eH2_5                 3.359788e-02 1 1  ON 45
eH2_6                 7.871319e-02 1 1  ON 46
eH2_7                 1.133336e-01 1 1  ON 47
eH2_8                 9.673566e-02 1 1  ON 48
eH2_9                 2.727518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4851e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7232e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1892
    reference variance = 0.305466
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4556e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5474e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345566602958
                                         uncertainty =       0.032859471690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345566602958
                                         uncertainty =       0.032859471690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415667056
  error estimate for blocks of size 2^( 2) =       0.000425082125
  error estimate for blocks of size 2^( 3) =       0.000433748455
  error estimate for blocks of size 2^( 4) =       0.000440414680
  error estimate for blocks of size 2^( 5) =       0.000443784408
  error estimate for blocks of size 2^( 6) =       0.000446432139
  error estimate for blocks of size 2^( 7) =       0.000449484951

      target function =                  N/A
              le_mean =     -17.215824281365
             les_mean =     296.730163716502
             stat err =       0.000445029044
             autocorr =       1.146266238248
              std dev =       0.587841987652
             le_variance =       0.345558202447


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721582428136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215824281365       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215824249709       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215824256301       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215824438923       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215824290102       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215824337514       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215824356107       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215824354147       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.198659e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215824281365       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215824273306       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215824275098       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215824321923       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215824284433       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215824296237       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215824300560       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215824299969       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.807501e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215824281365       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215824279341       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215824279799       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215824291580       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215824282192       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215824285141       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215824286198       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215824286045       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.537209e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6093e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.118000e-01 1 1  ON 0
 uu_1                 4.978308e-02 1 1  ON 1
 uu_2                -4.487864e-02 1 1  ON 2
 uu_3                -9.990267e-02 1 1  ON 3
 uu_4                -1.333393e-01 1 1  ON 4
 uu_5                -1.399609e-01 1 1  ON 5
 uu_6                -1.163723e-01 1 1  ON 6
 uu_7                -4.314967e-02 1 1  ON 7
 uu_8                 9.753640e-02 1 1  ON 8
 uu_9                 1.230479e-01 1 1  ON 9
 ud_0                 3.527364e-01 1 1  ON 10
 ud_1                 9.422223e-02 1 1  ON 11
 ud_2                -1.564779e-02 1 1  ON 12
 ud_3                -7.615482e-02 1 1  ON 13
 ud_4                -1.231875e-01 1 1  ON 14
 ud_5                -1.539337e-01 1 1  ON 15
 ud_6                -1.544694e-01 1 1  ON 16
 ud_7                -1.111055e-01 1 1  ON 17
 ud_8                 2.541539e-04 1 1  ON 18
 ud_9                 9.267925e-02 1 1  ON 19
 eO_0                -7.701189e-01 1 1  ON 20
 eO_1                -4.502035e-01 1 1  ON 21
 eO_2                -4.181243e-02 1 1  ON 22
 eO_3                 2.129375e-01 1 1  ON 23
 eO_4                 3.054294e-01 1 1  ON 24
 eO_5                 3.140352e-01 1 1  ON 25
 eO_6                 2.540716e-01 1 1  ON 26
 eO_7                 1.172188e-01 1 1  ON 27
 eO_8                 2.888379e-02 1 1  ON 28
 eO_9                 1.876138e-02 1 1  ON 29
eH1_0                -1.830269e-01 1 1  ON 30
eH1_1                -1.036620e-01 1 1  ON 31
eH1_2                -6.259453e-02 1 1  ON 32
eH1_3                -2.583208e-02 1 1  ON 33
eH1_4                 1.911816e-02 1 1  ON 34
eH1_5                 3.378226e-02 1 1  ON 35
eH1_6                 7.757830e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.387908e-02 1 1  ON 38
eH1_9                 2.528703e-02 1 1  ON 39
eH2_0                -1.841886e-01 1 1  ON 40
eH2_1                -1.049633e-01 1 1  ON 41
eH2_2                -6.402076e-02 1 1  ON 42
eH2_3                -2.710087e-02 1 1  ON 43
eH2_4                 1.822960e-02 1 1  ON 44
eH2_5                 3.359372e-02 1 1  ON 45
eH2_6                 7.871432e-02 1 1  ON 46
eH2_7                 1.133345e-01 1 1  ON 47
eH2_8                 9.673836e-02 1 1  ON 48
eH2_9                 2.727598e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.383931
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8877e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333744266153
                                         uncertainty =       0.009123738487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333744266153
                                         uncertainty =       0.009123738487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408464276
  error estimate for blocks of size 2^( 2) =       0.000418045093
  error estimate for blocks of size 2^( 3) =       0.000426457011
  error estimate for blocks of size 2^( 4) =       0.000432719300
  error estimate for blocks of size 2^( 5) =       0.000437466209
  error estimate for blocks of size 2^( 6) =       0.000439137372
  error estimate for blocks of size 2^( 7) =       0.000439874086

      target function =                  N/A
              le_mean =     -17.216360052903
             les_mean =     296.736739433166
             stat err =       0.000437299241
             autocorr =       1.146170667728
              std dev =       0.577655718227
             le_variance =       0.333686128800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333782894899
                                         uncertainty =       0.009125508782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333782894899
                                         uncertainty =       0.009125508782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408487909
  error estimate for blocks of size 2^( 2) =       0.000418067768
  error estimate for blocks of size 2^( 3) =       0.000426478481
  error estimate for blocks of size 2^( 4) =       0.000432740157
  error estimate for blocks of size 2^( 5) =       0.000437486823
  error estimate for blocks of size 2^( 6) =       0.000439157244
  error estimate for blocks of size 2^( 7) =       0.000439894163

      target function =                  N/A
              le_mean =     -17.216360142956
             les_mean =     296.736781149386
             stat err =       0.000437319597
             autocorr =       1.146144737291
              std dev =       0.577689141574
             le_variance =       0.333724744292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333764182680
                                         uncertainty =       0.009124649032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333764182680
                                         uncertainty =       0.009124649032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408476461
  error estimate for blocks of size 2^( 2) =       0.000418056785
  error estimate for blocks of size 2^( 3) =       0.000426468082
  error estimate for blocks of size 2^( 4) =       0.000432730058
  error estimate for blocks of size 2^( 5) =       0.000437476844
  error estimate for blocks of size 2^( 6) =       0.000439147621
  error estimate for blocks of size 2^( 7) =       0.000439884452

      target function =                  N/A
              le_mean =     -17.216360102869
             les_mean =     296.736761063211
             stat err =       0.000437309744
             autocorr =       1.146157335630
              std dev =       0.577672951061
             le_variance =       0.333706038387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746774895
                                         uncertainty =       0.009123853126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333746774895
                                         uncertainty =       0.009123853126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408465810
  error estimate for blocks of size 2^( 2) =       0.000418046566
  error estimate for blocks of size 2^( 3) =       0.000426458405
  error estimate for blocks of size 2^( 4) =       0.000432720655
  error estimate for blocks of size 2^( 5) =       0.000437467548
  error estimate for blocks of size 2^( 6) =       0.000439138663
  error estimate for blocks of size 2^( 7) =       0.000439875392

      target function =                  N/A
              le_mean =     -17.216360059232
             les_mean =     296.736742158941
             stat err =       0.000437300564
             autocorr =       1.146168988865
              std dev =       0.577657888948
             le_variance =       0.333688636664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216360052903        initial
     6.2500e+00     6.2500e+01             7.1987e-05       -17.216360142956  <--
     2.5000e+01     2.5000e+02             1.8075e-05       -17.216360102869
     1.0000e+02     1.0000e+03             4.5372e-06       -17.216360059232

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9838e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5946e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.238
    reference variance = 0.203192
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1601e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315909425322
                                         uncertainty =       0.003867686605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315909425322
                                         uncertainty =       0.003867686605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397500576
  error estimate for blocks of size 2^( 2) =       0.000407477407
  error estimate for blocks of size 2^( 3) =       0.000416299412
  error estimate for blocks of size 2^( 4) =       0.000422903965
  error estimate for blocks of size 2^( 5) =       0.000426316492
  error estimate for blocks of size 2^( 6) =       0.000428825528
  error estimate for blocks of size 2^( 7) =       0.000429359062

      target function =                  N/A
              le_mean =     -17.216837180867
             les_mean =     296.735495770444
             stat err =       0.000426851262
             autocorr =       1.153128257095
              std dev =       0.562150705736
             le_variance =       0.316013415959


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683718087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216837180867       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216837369192       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216837331147       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216837649863       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216837996392       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216837926333       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216837974072       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216837918876       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.029608e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216837180867       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216837231193       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216837218571       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216837305035       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216837413802       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216837395217       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216837397242       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216837386486       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.728367e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216837180867       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216837193669       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216837190278       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216837212370       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216837241274       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216837236719       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216837236509       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216837234147       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.942028e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5761e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.118315e-01 1 1  ON 0
 uu_1                 4.979587e-02 1 1  ON 1
 uu_2                -4.487916e-02 1 1  ON 2
 uu_3                -9.990425e-02 1 1  ON 3
 uu_4                -1.333497e-01 1 1  ON 4
 uu_5                -1.399601e-01 1 1  ON 5
 uu_6                -1.163891e-01 1 1  ON 6
 uu_7                -4.318195e-02 1 1  ON 7
 uu_8                 9.751714e-02 1 1  ON 8
 uu_9                 1.230637e-01 1 1  ON 9
 ud_0                 3.528021e-01 1 1  ON 10
 ud_1                 9.423481e-02 1 1  ON 11
 ud_2                -1.564394e-02 1 1  ON 12
 ud_3                -7.618829e-02 1 1  ON 13
 ud_4                -1.231777e-01 1 1  ON 14
 ud_5                -1.539437e-01 1 1  ON 15
 ud_6                -1.545000e-01 1 1  ON 16
 ud_7                -1.111095e-01 1 1  ON 17
 ud_8                 2.229736e-04 1 1  ON 18
 ud_9                 9.267795e-02 1 1  ON 19
 eO_0                -7.702502e-01 1 1  ON 20
 eO_1                -4.503076e-01 1 1  ON 21
 eO_2                -4.182541e-02 1 1  ON 22
 eO_3                 2.129831e-01 1 1  ON 23
 eO_4                 3.054881e-01 1 1  ON 24
 eO_5                 3.141034e-01 1 1  ON 25
 eO_6                 2.541053e-01 1 1  ON 26
 eO_7                 1.172520e-01 1 1  ON 27
 eO_8                 2.888887e-02 1 1  ON 28
 eO_9                 1.876299e-02 1 1  ON 29
eH1_0                -1.830285e-01 1 1  ON 30
eH1_1                -1.036457e-01 1 1  ON 31
eH1_2                -6.261326e-02 1 1  ON 32
eH1_3                -2.583194e-02 1 1  ON 33
eH1_4                 1.910915e-02 1 1  ON 34
eH1_5                 3.377261e-02 1 1  ON 35
eH1_6                 7.757565e-02 1 1  ON 36
eH1_7                 1.098905e-01 1 1  ON 37
eH1_8                 9.389806e-02 1 1  ON 38
eH1_9                 2.529408e-02 1 1  ON 39
eH2_0                -1.841992e-01 1 1  ON 40
eH2_1                -1.049628e-01 1 1  ON 41
eH2_2                -6.400159e-02 1 1  ON 42
eH2_3                -2.710344e-02 1 1  ON 43
eH2_4                 1.822350e-02 1 1  ON 44
eH2_5                 3.356862e-02 1 1  ON 45
eH2_6                 7.871352e-02 1 1  ON 46
eH2_7                 1.133346e-01 1 1  ON 47
eH2_8                 9.675549e-02 1 1  ON 48
eH2_9                 2.728182e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1967
    reference variance = 0.212247
====================================================
  Execution time = 1.9671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1627e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316144931769
                                         uncertainty =       0.003164601816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316144931769
                                         uncertainty =       0.003164601816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397645028
  error estimate for blocks of size 2^( 2) =       0.000406894983
  error estimate for blocks of size 2^( 3) =       0.000415457292
  error estimate for blocks of size 2^( 4) =       0.000422779100
  error estimate for blocks of size 2^( 5) =       0.000426928587
  error estimate for blocks of size 2^( 6) =       0.000429009242
  error estimate for blocks of size 2^( 7) =       0.000427937773

      target function =                  N/A
              le_mean =     -17.216601481692
             les_mean =     296.727609557665
             stat err =       0.000426663675
             autocorr =       1.151278058112
              std dev =       0.562354991416
             le_variance =       0.316243136371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316252541079
                                         uncertainty =       0.003165508855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316252541079
                                         uncertainty =       0.003165508855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397712706
  error estimate for blocks of size 2^( 2) =       0.000406959831
  error estimate for blocks of size 2^( 3) =       0.000415518492
  error estimate for blocks of size 2^( 4) =       0.000422837695
  error estimate for blocks of size 2^( 5) =       0.000426985747
  error estimate for blocks of size 2^( 6) =       0.000429067606
  error estimate for blocks of size 2^( 7) =       0.000427993590

      target function =                  N/A
              le_mean =     -17.216600949025
             les_mean =     296.727698873273
             stat err =       0.000426721159
             autocorr =       1.151196403537
              std dev =       0.562450703156
             le_variance =       0.316350793481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316205971486
                                         uncertainty =       0.003165108739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316205971486
                                         uncertainty =       0.003165108739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397683419
  error estimate for blocks of size 2^( 2) =       0.000406931769
  error estimate for blocks of size 2^( 3) =       0.000415492029
  error estimate for blocks of size 2^( 4) =       0.000422812454
  error estimate for blocks of size 2^( 5) =       0.000426961148
  error estimate for blocks of size 2^( 6) =       0.000429042418
  error estimate for blocks of size 2^( 7) =       0.000427969594

      target function =                  N/A
              le_mean =     -17.216601130776
             les_mean =     296.727658541289
             stat err =       0.000426696404
             autocorr =       1.151232383246
              std dev =       0.562409284412
             le_variance =       0.316304203193

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316152816118
                                         uncertainty =       0.003164666961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316152816118
                                         uncertainty =       0.003164666961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397649987
  error estimate for blocks of size 2^( 2) =       0.000406899735
  error estimate for blocks of size 2^( 3) =       0.000415461779
  error estimate for blocks of size 2^( 4) =       0.000422783412
  error estimate for blocks of size 2^( 5) =       0.000426932796
  error estimate for blocks of size 2^( 6) =       0.000429013528
  error estimate for blocks of size 2^( 7) =       0.000427941888

      target function =                  N/A
              le_mean =     -17.216601433389
             les_mean =     296.727615782267
             stat err =       0.000426667906
             autocorr =       1.151272174409
              std dev =       0.562362004608
             le_variance =       0.316251024227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216601481692        initial  <--
     1.5625e+00     1.5625e+01             3.0296e-04       -17.216600949025
     6.2500e+00     6.2500e+01             7.7284e-05       -17.216601130776
     2.5000e+01     2.5000e+02             1.9420e-05       -17.216601433389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1041
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3238
    reference variance = 0.323155
====================================================
  Execution time = 2.0284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5711e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313137765677
                                         uncertainty =       0.003166738436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313137765677
                                         uncertainty =       0.003166738436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395610691
  error estimate for blocks of size 2^( 2) =       0.000405137669
  error estimate for blocks of size 2^( 3) =       0.000414080046
  error estimate for blocks of size 2^( 4) =       0.000420599039
  error estimate for blocks of size 2^( 5) =       0.000424783088
  error estimate for blocks of size 2^( 6) =       0.000429057788
  error estimate for blocks of size 2^( 7) =       0.000432216009

      target function =                  N/A
              le_mean =     -17.216587744264
             les_mean =     296.723909037031
             stat err =       0.000426663981
             autocorr =       1.163150531619
              std dev =       0.559478004563
             le_variance =       0.313015637590


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658774426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587744264       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587802269       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587830383       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587806325       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587751357       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587739233       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587753621       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.082016e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587744264       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587758997       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587766121       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587760278       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587746562       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587743287       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587746653       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 7.732452e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587744264       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587747962       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587749749       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216587748300       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216587744873       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216587744039       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216587744866       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.934857e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.377108 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5868e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.118128e-01 1 1  ON 0
 uu_1                 4.979415e-02 1 1  ON 1
 uu_2                -4.488207e-02 1 1  ON 2
 uu_3                -9.990368e-02 1 1  ON 3
 uu_4                -1.333433e-01 1 1  ON 4
 uu_5                -1.399665e-01 1 1  ON 5
 uu_6                -1.163786e-01 1 1  ON 6
 uu_7                -4.316200e-02 1 1  ON 7
 uu_8                 9.752820e-02 1 1  ON 8
 uu_9                 1.230566e-01 1 1  ON 9
 ud_0                 3.527707e-01 1 1  ON 10
 ud_1                 9.423152e-02 1 1  ON 11
 ud_2                -1.564765e-02 1 1  ON 12
 ud_3                -7.617145e-02 1 1  ON 13
 ud_4                -1.231871e-01 1 1  ON 14
 ud_5                -1.539416e-01 1 1  ON 15
 ud_6                -1.544847e-01 1 1  ON 16
 ud_7                -1.111071e-01 1 1  ON 17
 ud_8                 2.425243e-04 1 1  ON 18
 ud_9                 9.268017e-02 1 1  ON 19
 eO_0                -7.701807e-01 1 1  ON 20
 eO_1                -4.502600e-01 1 1  ON 21
 eO_2                -4.181571e-02 1 1  ON 22
 eO_3                 2.129614e-01 1 1  ON 23
 eO_4                 3.054597e-01 1 1  ON 24
 eO_5                 3.140626e-01 1 1  ON 25
 eO_6                 2.540891e-01 1 1  ON 26
 eO_7                 1.172370e-01 1 1  ON 27
 eO_8                 2.888700e-02 1 1  ON 28
 eO_9                 1.876218e-02 1 1  ON 29
eH1_0                -1.830283e-01 1 1  ON 30
eH1_1                -1.036699e-01 1 1  ON 31
eH1_2                -6.260430e-02 1 1  ON 32
eH1_3                -2.583177e-02 1 1  ON 33
eH1_4                 1.912408e-02 1 1  ON 34
eH1_5                 3.378014e-02 1 1  ON 35
eH1_6                 7.757870e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388841e-02 1 1  ON 38
eH1_9                 2.529135e-02 1 1  ON 39
eH2_0                -1.841937e-01 1 1  ON 40
eH2_1                -1.049622e-01 1 1  ON 41
eH2_2                -6.401586e-02 1 1  ON 42
eH2_3                -2.710955e-02 1 1  ON 43
eH2_4                 1.823076e-02 1 1  ON 44
eH2_5                 3.358214e-02 1 1  ON 45
eH2_6                 7.871809e-02 1 1  ON 46
eH2_7                 1.133365e-01 1 1  ON 47
eH2_8                 9.674740e-02 1 1  ON 48
eH2_9                 2.727868e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3171
    reference variance = 0.377616
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1639e-01
  Total weights = 2.0000e+06
  Execution time = 2.4596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316415504329
                                         uncertainty =       0.003611277934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316415504329
                                         uncertainty =       0.003611277934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397737899
  error estimate for blocks of size 2^( 2) =       0.000407698661
  error estimate for blocks of size 2^( 3) =       0.000416035368
  error estimate for blocks of size 2^( 4) =       0.000422748049
  error estimate for blocks of size 2^( 5) =       0.000425912178
  error estimate for blocks of size 2^( 6) =       0.000429011696
  error estimate for blocks of size 2^( 7) =       0.000431942806

      target function =                  N/A
              le_mean =     -17.216070968455
             les_mean =     296.709490305902
             stat err =       0.000427403682
             autocorr =       1.154735633111
              std dev =       0.562486331584
             le_variance =       0.316390873219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316430975827
                                         uncertainty =       0.003611469960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316430975827
                                         uncertainty =       0.003611469960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397747626
  error estimate for blocks of size 2^( 2) =       0.000407707909
  error estimate for blocks of size 2^( 3) =       0.000416044183
  error estimate for blocks of size 2^( 4) =       0.000422756672
  error estimate for blocks of size 2^( 5) =       0.000425920525
  error estimate for blocks of size 2^( 6) =       0.000429019830
  error estimate for blocks of size 2^( 7) =       0.000431950941

      target function =                  N/A
              le_mean =     -17.216070864330
             les_mean =     296.709502194785
             stat err =       0.000427411992
             autocorr =       1.154724059605
              std dev =       0.562500086550
             le_variance =       0.316406347369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423367711
                                         uncertainty =       0.003611375718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316423367711
                                         uncertainty =       0.003611375718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397742843
  error estimate for blocks of size 2^( 2) =       0.000407703361
  error estimate for blocks of size 2^( 3) =       0.000416039850
  error estimate for blocks of size 2^( 4) =       0.000422752434
  error estimate for blocks of size 2^( 5) =       0.000425916424
  error estimate for blocks of size 2^( 6) =       0.000429015832
  error estimate for blocks of size 2^( 7) =       0.000431946944

      target function =                  N/A
              le_mean =     -17.216070914904
             les_mean =     296.709496326766
             stat err =       0.000427407909
             autocorr =       1.154729766448
              std dev =       0.562493322592
             le_variance =       0.316398737961

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316416491221
                                         uncertainty =       0.003611290213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316416491221
                                         uncertainty =       0.003611290213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397738520
  error estimate for blocks of size 2^( 2) =       0.000407699251
  error estimate for blocks of size 2^( 3) =       0.000416035930
  error estimate for blocks of size 2^( 4) =       0.000422748599
  error estimate for blocks of size 2^( 5) =       0.000425912711
  error estimate for blocks of size 2^( 6) =       0.000429012215
  error estimate for blocks of size 2^( 7) =       0.000431943326

      target function =                  N/A
              le_mean =     -17.216070961703
             les_mean =     296.709491060472
             stat err =       0.000427404213
             autocorr =       1.154734897241
              std dev =       0.562487208994
             le_variance =       0.316391860282


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216070968455        initial  <--
     1.5625e+01     1.5625e+02             3.0820e-05       -17.216070864330
     6.2500e+01     6.2500e+02             7.7325e-06       -17.216070914904
     2.5000e+02     2.5000e+03             1.9349e-06       -17.216070961703

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6961
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7239e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.330268
====================================================
  Execution time = 2.0177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1477e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314741029575
                                         uncertainty =       0.002968369255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314741029575
                                         uncertainty =       0.002968369255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396719485
  error estimate for blocks of size 2^( 2) =       0.000406372119
  error estimate for blocks of size 2^( 3) =       0.000415629620
  error estimate for blocks of size 2^( 4) =       0.000421864155
  error estimate for blocks of size 2^( 5) =       0.000426806734
  error estimate for blocks of size 2^( 6) =       0.000428238215
  error estimate for blocks of size 2^( 7) =       0.000430445376

      target function =                  N/A
              le_mean =     -17.217364933161
             les_mean =     296.752427784184
             stat err =       0.000426838620
             autocorr =       1.157604884863
              std dev =       0.561046076486
             le_variance =       0.314772699940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736493316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217364933161       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217364937150       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217364940344       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217364938915       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217364938698       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217364942604       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217364942226       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.959229e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217364933161       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217364934159       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217364934959       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217364934601       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217364934547       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217364935522       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217364935428       residual = 7.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 7.399510e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217364933161       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217364933410       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217364933611       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217364933521       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217364933507       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217364933751       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217364933728       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 1.849967e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5756e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979224e-02 1 1  ON 1
 uu_2                -4.488158e-02 1 1  ON 2
 uu_3                -9.990482e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399651e-01 1 1  ON 5
 uu_6                -1.163766e-01 1 1  ON 6
 uu_7                -4.316041e-02 1 1  ON 7
 uu_8                 9.752966e-02 1 1  ON 8
 uu_9                 1.230560e-01 1 1  ON 9
 ud_0                 3.527671e-01 1 1  ON 10
 ud_1                 9.423186e-02 1 1  ON 11
 ud_2                -1.564790e-02 1 1  ON 12
 ud_3                -7.616950e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111069e-01 1 1  ON 17
 ud_8                 2.436276e-04 1 1  ON 18
 ud_9                 9.267994e-02 1 1  ON 19
 eO_0                -7.701737e-01 1 1  ON 20
 eO_1                -4.502571e-01 1 1  ON 21
 eO_2                -4.181499e-02 1 1  ON 22
 eO_3                 2.129591e-01 1 1  ON 23
 eO_4                 3.054575e-01 1 1  ON 24
 eO_5                 3.140603e-01 1 1  ON 25
 eO_6                 2.540877e-01 1 1  ON 26
 eO_7                 1.172351e-01 1 1  ON 27
 eO_8                 2.888668e-02 1 1  ON 28
 eO_9                 1.876200e-02 1 1  ON 29
eH1_0                -1.830281e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260497e-02 1 1  ON 32
eH1_3                -2.583186e-02 1 1  ON 33
eH1_4                 1.912360e-02 1 1  ON 34
eH1_5                 3.378196e-02 1 1  ON 35
eH1_6                 7.757923e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388722e-02 1 1  ON 38
eH1_9                 2.529099e-02 1 1  ON 39
eH2_0                -1.841943e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401580e-02 1 1  ON 42
eH2_3                -2.710951e-02 1 1  ON 43
eH2_4                 1.823183e-02 1 1  ON 44
eH2_5                 3.358121e-02 1 1  ON 45
eH2_6                 7.871773e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674654e-02 1 1  ON 48
eH2_9                 2.727842e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2142
    reference variance = 0.17653
====================================================
  Execution time = 1.9735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0999e-01
  Total weights = 2.0000e+06
  Execution time = 1.8793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267151819
                                         uncertainty =       0.002413946267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267151819
                                         uncertainty =       0.002413946267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694933
  error estimate for blocks of size 2^( 2) =       0.000403311279
  error estimate for blocks of size 2^( 3) =       0.000411602692
  error estimate for blocks of size 2^( 4) =       0.000418437116
  error estimate for blocks of size 2^( 5) =       0.000422440989
  error estimate for blocks of size 2^( 6) =       0.000425431723
  error estimate for blocks of size 2^( 7) =       0.000427018732

      target function =                  N/A
              le_mean =     -17.216915104240
             les_mean =     296.732156952260
             stat err =       0.000423332140
             autocorr =       1.156226272324
              std dev =       0.556768713787
             le_variance =       0.309991400652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309268116368
                                         uncertainty =       0.002413952822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309268116368
                                         uncertainty =       0.002413952822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393695547
  error estimate for blocks of size 2^( 2) =       0.000403311854
  error estimate for blocks of size 2^( 3) =       0.000411603236
  error estimate for blocks of size 2^( 4) =       0.000418437637
  error estimate for blocks of size 2^( 5) =       0.000422441510
  error estimate for blocks of size 2^( 6) =       0.000425432274
  error estimate for blocks of size 2^( 7) =       0.000427019262

      target function =                  N/A
              le_mean =     -17.216915099342
             les_mean =     296.732157750408
             stat err =       0.000423332671
             autocorr =       1.156225563994
              std dev =       0.556769582004
             le_variance =       0.309992367445

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267634553
                                         uncertainty =       0.002413949546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267634553
                                         uncertainty =       0.002413949546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393695240
  error estimate for blocks of size 2^( 2) =       0.000403311567
  error estimate for blocks of size 2^( 3) =       0.000411602964
  error estimate for blocks of size 2^( 4) =       0.000418437377
  error estimate for blocks of size 2^( 5) =       0.000422441250
  error estimate for blocks of size 2^( 6) =       0.000425431999
  error estimate for blocks of size 2^( 7) =       0.000427018997

      target function =                  N/A
              le_mean =     -17.216915101778
             les_mean =     296.732157351338
             stat err =       0.000423332406
             autocorr =       1.156225917990
              std dev =       0.556769148310
             le_variance =       0.309991884509

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267212174
                                         uncertainty =       0.002413946677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309267212174
                                         uncertainty =       0.002413946677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393694971
  error estimate for blocks of size 2^( 2) =       0.000403311315
  error estimate for blocks of size 2^( 3) =       0.000411602726
  error estimate for blocks of size 2^( 4) =       0.000418437149
  error estimate for blocks of size 2^( 5) =       0.000422441022
  error estimate for blocks of size 2^( 6) =       0.000425431757
  error estimate for blocks of size 2^( 7) =       0.000427018765

      target function =                  N/A
              le_mean =     -17.216915103932
             les_mean =     296.732157002141
             stat err =       0.000423332173
             autocorr =       1.156226228023
              std dev =       0.556768768114
             le_variance =       0.309991461147


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216915104240        initial  <--
     1.5625e+02     1.5625e+03             2.9592e-06       -17.216915099342
     6.2500e+02     6.2500e+03             7.3995e-07       -17.216915101778
     2.5000e+03     2.5000e+04             1.8500e-07       -17.216915103932

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1819
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4950e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1914
    reference variance = 0.229775
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2628e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324665252738
                                         uncertainty =       0.005330592235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324665252738
                                         uncertainty =       0.005330592235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403903079
  error estimate for blocks of size 2^( 2) =       0.000413766137
  error estimate for blocks of size 2^( 3) =       0.000422180886
  error estimate for blocks of size 2^( 4) =       0.000428310548
  error estimate for blocks of size 2^( 5) =       0.000432327241
  error estimate for blocks of size 2^( 6) =       0.000433682553
  error estimate for blocks of size 2^( 7) =       0.000433997067

      target function =                  N/A
              le_mean =     -17.216803228794
             les_mean =     296.744588650345
             stat err =       0.000432079352
             autocorr =       1.144386428076
              std dev =       0.571205212213
             le_variance =       0.326275394459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680322879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803228794       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803229368       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803229801       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803230073       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803230555       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803230532       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803230524       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.784974e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803228794       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803228938       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803229046       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803229114       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803229233       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803229229       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803229225       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 6.962537e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216803228794       residual = 7.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216803228830       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216803228857       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216803228852       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216803228904       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216803228903       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216803228919       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 1.740641e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5943e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316027e-02 1 1  ON 7
 uu_8                 9.752977e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423185e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616933e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438035e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701730e-01 1 1  ON 20
 eO_1                -4.502567e-01 1 1  ON 21
 eO_2                -4.181489e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540876e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260491e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912360e-02 1 1  ON 34
eH1_5                 3.378192e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388716e-02 1 1  ON 38
eH1_9                 2.529097e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710964e-02 1 1  ON 43
eH2_4                 1.823193e-02 1 1  ON 44
eH2_5                 3.358141e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674643e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.274495
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1888e-01
  Total weights = 2.0000e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568227295
                                         uncertainty =       0.004555959615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568227295
                                         uncertainty =       0.004555959615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399297451
  error estimate for blocks of size 2^( 2) =       0.000408690152
  error estimate for blocks of size 2^( 3) =       0.000417248182
  error estimate for blocks of size 2^( 4) =       0.000423243678
  error estimate for blocks of size 2^( 5) =       0.000426247753
  error estimate for blocks of size 2^( 6) =       0.000426959687
  error estimate for blocks of size 2^( 7) =       0.000427586044

      target function =                  N/A
              le_mean =     -17.216679859520
             les_mean =     296.732942134165
             stat err =       0.000426009290
             autocorr =       1.138269412352
              std dev =       0.564691870305
             le_variance =       0.318876908388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568318815
                                         uncertainty =       0.004555960780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568318815
                                         uncertainty =       0.004555960780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399297508
  error estimate for blocks of size 2^( 2) =       0.000408690206
  error estimate for blocks of size 2^( 3) =       0.000417248234
  error estimate for blocks of size 2^( 4) =       0.000423243727
  error estimate for blocks of size 2^( 5) =       0.000426247801
  error estimate for blocks of size 2^( 6) =       0.000426959732
  error estimate for blocks of size 2^( 7) =       0.000427586087

      target function =                  N/A
              le_mean =     -17.216679859341
             les_mean =     296.732942219570
             stat err =       0.000426009337
             autocorr =       1.138269331966
              std dev =       0.564691951409
             le_variance =       0.318876999986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568273059
                                         uncertainty =       0.004555960198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568273059
                                         uncertainty =       0.004555960198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399297479
  error estimate for blocks of size 2^( 2) =       0.000408690179
  error estimate for blocks of size 2^( 3) =       0.000417248208
  error estimate for blocks of size 2^( 4) =       0.000423243702
  error estimate for blocks of size 2^( 5) =       0.000426247777
  error estimate for blocks of size 2^( 6) =       0.000426959709
  error estimate for blocks of size 2^( 7) =       0.000427586065

      target function =                  N/A
              le_mean =     -17.216679859430
             les_mean =     296.732942176871
             stat err =       0.000426009314
             autocorr =       1.138269372153
              std dev =       0.564691910861
             le_variance =       0.318876954191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568233016
                                         uncertainty =       0.004555959688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568233016
                                         uncertainty =       0.004555959688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399297454
  error estimate for blocks of size 2^( 2) =       0.000408690155
  error estimate for blocks of size 2^( 3) =       0.000417248186
  error estimate for blocks of size 2^( 4) =       0.000423243681
  error estimate for blocks of size 2^( 5) =       0.000426247756
  error estimate for blocks of size 2^( 6) =       0.000426959689
  error estimate for blocks of size 2^( 7) =       0.000427586047

      target function =                  N/A
              le_mean =     -17.216679859509
             les_mean =     296.732942139504
             stat err =       0.000426009293
             autocorr =       1.138269407335
              std dev =       0.564691875374
             le_variance =       0.318876914114


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216679859520        initial  <--
     1.5625e+03     1.5625e+04             2.7850e-07       -17.216679859341
     6.2500e+03     6.2500e+04             6.9625e-08       -17.216679859430
     2.5000e+04     2.5000e+05             1.7406e-08       -17.216679859509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3498
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5303e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.153008
====================================================
  Execution time = 2.0338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1415e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313493856261
                                         uncertainty =       0.002536334681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313493856261
                                         uncertainty =       0.002536334681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396329392
  error estimate for blocks of size 2^( 2) =       0.000406285955
  error estimate for blocks of size 2^( 3) =       0.000414588777
  error estimate for blocks of size 2^( 4) =       0.000421384187
  error estimate for blocks of size 2^( 5) =       0.000425428934
  error estimate for blocks of size 2^( 6) =       0.000427905236
  error estimate for blocks of size 2^( 7) =       0.000427786924

      target function =                  N/A
              le_mean =     -17.216265623395
             les_mean =     296.713955831355
             stat err =       0.000425626320
             autocorr =       1.153305577246
              std dev =       0.560494400634
             le_variance =       0.314153973142


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626562339e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265623395       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265623412       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265623444       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265623394       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265623431       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265623435       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265623442       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.183883e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265623395       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265623399       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265623407       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265623364       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265623399       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265623381       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265623413       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+04 is 7.959734e-09

solving harmonic davidson linear method for identity shift 2.5000e+05, overlap shift 2.5000e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216265623395       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216265623396       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216265623398       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216265623395       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216265623592       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216265622820       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265623384       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+05 is 1.989936e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5856e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979221e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752977e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438171e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710964e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.231
    reference variance = 0.187471
====================================================
  Execution time = 1.9663e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1578e-01
  Total weights = 2.0000e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833439115
                                         uncertainty =       0.003595655948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833439115
                                         uncertainty =       0.003595655948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397356531
  error estimate for blocks of size 2^( 2) =       0.000407115541
  error estimate for blocks of size 2^( 3) =       0.000415560643
  error estimate for blocks of size 2^( 4) =       0.000421981469
  error estimate for blocks of size 2^( 5) =       0.000425893047
  error estimate for blocks of size 2^( 6) =       0.000429432616
  error estimate for blocks of size 2^( 7) =       0.000430260935

      target function =                  N/A
              le_mean =     -17.216488884793
             les_mean =     296.723273787453
             stat err =       0.000426892017
             autocorr =       1.154184814859
              std dev =       0.561946994954
             le_variance =       0.315784425138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833454122
                                         uncertainty =       0.003595656094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833454122
                                         uncertainty =       0.003595656094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397356540
  error estimate for blocks of size 2^( 2) =       0.000407115550
  error estimate for blocks of size 2^( 3) =       0.000415560651
  error estimate for blocks of size 2^( 4) =       0.000421981477
  error estimate for blocks of size 2^( 5) =       0.000425893056
  error estimate for blocks of size 2^( 6) =       0.000429432624
  error estimate for blocks of size 2^( 7) =       0.000430260944

      target function =                  N/A
              le_mean =     -17.216488884758
             les_mean =     296.723273801233
             stat err =       0.000426892025
             autocorr =       1.154184804852
              std dev =       0.561947008304
             le_variance =       0.315784440142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833446618
                                         uncertainty =       0.003595656021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833446618
                                         uncertainty =       0.003595656021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397356536
  error estimate for blocks of size 2^( 2) =       0.000407115546
  error estimate for blocks of size 2^( 3) =       0.000415560647
  error estimate for blocks of size 2^( 4) =       0.000421981473
  error estimate for blocks of size 2^( 5) =       0.000425893052
  error estimate for blocks of size 2^( 6) =       0.000429432620
  error estimate for blocks of size 2^( 7) =       0.000430260939

      target function =                  N/A
              le_mean =     -17.216488884775
             les_mean =     296.723273794343
             stat err =       0.000426892021
             autocorr =       1.154184809859
              std dev =       0.561947001629
             le_variance =       0.315784432640

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833440053
                                         uncertainty =       0.003595655957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315833440053
                                         uncertainty =       0.003595655957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397356531
  error estimate for blocks of size 2^( 2) =       0.000407115542
  error estimate for blocks of size 2^( 3) =       0.000415560643
  error estimate for blocks of size 2^( 4) =       0.000421981470
  error estimate for blocks of size 2^( 5) =       0.000425893048
  error estimate for blocks of size 2^( 6) =       0.000429432617
  error estimate for blocks of size 2^( 7) =       0.000430260936

      target function =                  N/A
              le_mean =     -17.216488884791
             les_mean =     296.723273788314
             stat err =       0.000426892017
             autocorr =       1.154184814234
              std dev =       0.561946995789
             le_variance =       0.315784426076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216488884793        initial  <--
     1.5625e+04     1.5625e+05             3.1839e-08       -17.216488884758
     6.2500e+04     6.2500e+05             7.9597e-09       -17.216488884775
     2.5000e+05     2.5000e+06             1.9899e-09       -17.216488884791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0932
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.497582
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318388342491
                                         uncertainty =       0.003368889585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318388342491
                                         uncertainty =       0.003368889585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399057271
  error estimate for blocks of size 2^( 2) =       0.000408707067
  error estimate for blocks of size 2^( 3) =       0.000417440239
  error estimate for blocks of size 2^( 4) =       0.000423839444
  error estimate for blocks of size 2^( 5) =       0.000428178275
  error estimate for blocks of size 2^( 6) =       0.000430086162
  error estimate for blocks of size 2^( 7) =       0.000429569075

      target function =                  N/A
              le_mean =     -17.216694481872
             les_mean =     296.733062133341
             stat err =       0.000427918239
             autocorr =       1.149876345489
              std dev =       0.564352204268
             le_variance =       0.318493410462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669448187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694481872       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694481873       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216694481880       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216694481938       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694481895       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216694481921       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216694481889       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 3.285527e-09

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694481872       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694481872       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216694481874       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216694481467       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694481555       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216694482258       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216694482249       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+05 is 8.213819e-10

solving harmonic davidson linear method for identity shift 2.5000e+06, overlap shift 2.5000e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216694481872       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216694481872       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216694481873       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216694481927       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216694481785       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216694481890       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216694484331       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+06 is 2.053454e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5682e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438187e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.298935
====================================================
  Execution time = 1.9963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1847e-01
  Total weights = 2.0000e+06
  Execution time = 1.8568e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416784539
                                         uncertainty =       0.003613211583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416784539
                                         uncertainty =       0.003613211583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399042426
  error estimate for blocks of size 2^( 2) =       0.000408629613
  error estimate for blocks of size 2^( 3) =       0.000416842288
  error estimate for blocks of size 2^( 4) =       0.000423514628
  error estimate for blocks of size 2^( 5) =       0.000427492295
  error estimate for blocks of size 2^( 6) =       0.000429883677
  error estimate for blocks of size 2^( 7) =       0.000430734992

      target function =                  N/A
              le_mean =     -17.216574651117
             les_mean =     296.728912273384
             stat err =       0.000427906398
             autocorr =       1.149898259776
              std dev =       0.564331210484
             le_variance =       0.318469715126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416786226
                                         uncertainty =       0.003613211595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416786226
                                         uncertainty =       0.003613211595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399042427
  error estimate for blocks of size 2^( 2) =       0.000408629614
  error estimate for blocks of size 2^( 3) =       0.000416842289
  error estimate for blocks of size 2^( 4) =       0.000423514629
  error estimate for blocks of size 2^( 5) =       0.000427492296
  error estimate for blocks of size 2^( 6) =       0.000429883678
  error estimate for blocks of size 2^( 7) =       0.000430734993

      target function =                  N/A
              le_mean =     -17.216574651107
             les_mean =     296.728912274707
             stat err =       0.000427906399
             autocorr =       1.149898258515
              std dev =       0.564331211980
             le_variance =       0.318469716815

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416785383
                                         uncertainty =       0.003613211589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416785383
                                         uncertainty =       0.003613211589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399042426
  error estimate for blocks of size 2^( 2) =       0.000408629614
  error estimate for blocks of size 2^( 3) =       0.000416842288
  error estimate for blocks of size 2^( 4) =       0.000423514629
  error estimate for blocks of size 2^( 5) =       0.000427492296
  error estimate for blocks of size 2^( 6) =       0.000429883678
  error estimate for blocks of size 2^( 7) =       0.000430734992

      target function =                  N/A
              le_mean =     -17.216574651112
             les_mean =     296.728912274045
             stat err =       0.000427906399
             autocorr =       1.149898259151
              std dev =       0.564331211232
             le_variance =       0.318469715971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416784645
                                         uncertainty =       0.003613211583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318416784645
                                         uncertainty =       0.003613211583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399042426
  error estimate for blocks of size 2^( 2) =       0.000408629613
  error estimate for blocks of size 2^( 3) =       0.000416842288
  error estimate for blocks of size 2^( 4) =       0.000423514628
  error estimate for blocks of size 2^( 5) =       0.000427492296
  error estimate for blocks of size 2^( 6) =       0.000429883678
  error estimate for blocks of size 2^( 7) =       0.000430734992

      target function =                  N/A
              le_mean =     -17.216574651117
             les_mean =     296.728912273467
             stat err =       0.000427906398
             autocorr =       1.149898259708
              std dev =       0.564331210578
             le_variance =       0.318469715232


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216574651117        initial  <--
     1.5625e+05     1.5625e+06             3.2855e-09       -17.216574651107
     6.2500e+05     6.2500e+06             8.2138e-10       -17.216574651112
     2.5000e+06     2.5000e+07             2.0535e-10       -17.216574651117

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3476
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5040e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.151734
====================================================
  Execution time = 2.0077e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320279027450
                                         uncertainty =       0.007250239321

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320279027450
                                         uncertainty =       0.007250239321

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400118079
  error estimate for blocks of size 2^( 2) =       0.000409790607
  error estimate for blocks of size 2^( 3) =       0.000418603632
  error estimate for blocks of size 2^( 4) =       0.000425916398
  error estimate for blocks of size 2^( 5) =       0.000429161905
  error estimate for blocks of size 2^( 6) =       0.000429355709
  error estimate for blocks of size 2^( 7) =       0.000430085532

      target function =                  N/A
              le_mean =     -17.216760565997
             les_mean =     296.737033181169
             stat err =       0.000428629886
             autocorr =       1.147594735855
              std dev =       0.565852413972
             le_variance =       0.320188954398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676056600e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760565997       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760565998       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216760565998       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760566184       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216760565469       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216760564129       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216760563648       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 2.940134e-10

solving harmonic davidson linear method for identity shift 6.2500e+06, overlap shift 6.2500e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760565997       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760565997       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216760565997       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760568355       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216760565997       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216760574070       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216760568218       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+06 is 7.350318e-11

solving harmonic davidson linear method for identity shift 2.5000e+07, overlap shift 2.5000e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216760565997       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216760565997       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216760565997       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216760567210       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216760554893       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216760565825       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216760559118       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+07 is 1.837585e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5667e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.416882
====================================================
  Execution time = 1.9839e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1671e-01
  Total weights = 2.0000e+06
  Execution time = 1.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762134
                                         uncertainty =       0.003760308881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762134
                                         uncertainty =       0.003760308881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397939016
  error estimate for blocks of size 2^( 2) =       0.000407676025
  error estimate for blocks of size 2^( 3) =       0.000416290584
  error estimate for blocks of size 2^( 4) =       0.000423009345
  error estimate for blocks of size 2^( 5) =       0.000426827002
  error estimate for blocks of size 2^( 6) =       0.000430337385
  error estimate for blocks of size 2^( 7) =       0.000433604319

      target function =                  N/A
              le_mean =     -17.217220361318
             les_mean =     296.749387732872
             stat err =       0.000428444513
             autocorr =       1.159194005111
              std dev =       0.562770753545
             le_variance =       0.316710921045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762206
                                         uncertainty =       0.003760308882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762206
                                         uncertainty =       0.003760308882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397939016
  error estimate for blocks of size 2^( 2) =       0.000407676026
  error estimate for blocks of size 2^( 3) =       0.000416290584
  error estimate for blocks of size 2^( 4) =       0.000423009345
  error estimate for blocks of size 2^( 5) =       0.000426827002
  error estimate for blocks of size 2^( 6) =       0.000430337385
  error estimate for blocks of size 2^( 7) =       0.000433604319

      target function =                  N/A
              le_mean =     -17.217220361318
             les_mean =     296.749387732934
             stat err =       0.000428444513
             autocorr =       1.159194005062
              std dev =       0.562770753608
             le_variance =       0.316710921117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762170
                                         uncertainty =       0.003760308882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762170
                                         uncertainty =       0.003760308882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397939016
  error estimate for blocks of size 2^( 2) =       0.000407676025
  error estimate for blocks of size 2^( 3) =       0.000416290584
  error estimate for blocks of size 2^( 4) =       0.000423009345
  error estimate for blocks of size 2^( 5) =       0.000426827002
  error estimate for blocks of size 2^( 6) =       0.000430337385
  error estimate for blocks of size 2^( 7) =       0.000433604319

      target function =                  N/A
              le_mean =     -17.217220361318
             les_mean =     296.749387732903
             stat err =       0.000428444513
             autocorr =       1.159194005086
              std dev =       0.562770753576
             le_variance =       0.316710921081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762139
                                         uncertainty =       0.003760308881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316670762139
                                         uncertainty =       0.003760308881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397939016
  error estimate for blocks of size 2^( 2) =       0.000407676025
  error estimate for blocks of size 2^( 3) =       0.000416290584
  error estimate for blocks of size 2^( 4) =       0.000423009345
  error estimate for blocks of size 2^( 5) =       0.000426827002
  error estimate for blocks of size 2^( 6) =       0.000430337385
  error estimate for blocks of size 2^( 7) =       0.000433604319

      target function =                  N/A
              le_mean =     -17.217220361318
             les_mean =     296.749387732876
             stat err =       0.000428444513
             autocorr =       1.159194005100
              std dev =       0.562770753548
             le_variance =       0.316710921050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217220361318        initial  <--
     1.5625e+06     1.5625e+07             2.9401e-10       -17.217220361318
     6.2500e+06     6.2500e+07             7.3503e-11       -17.217220361318
     2.5000e+07     2.5000e+08             1.8376e-11       -17.217220361318

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2167
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1904
    reference variance = 0.295201
====================================================
  Execution time = 2.2359e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2083e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320890589255
                                         uncertainty =       0.005958247348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320890589255
                                         uncertainty =       0.005958247348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400516003
  error estimate for blocks of size 2^( 2) =       0.000409877669
  error estimate for blocks of size 2^( 3) =       0.000418193598
  error estimate for blocks of size 2^( 4) =       0.000425048500
  error estimate for blocks of size 2^( 5) =       0.000429394532
  error estimate for blocks of size 2^( 6) =       0.000431879282
  error estimate for blocks of size 2^( 7) =       0.000434129501

      target function =                  N/A
              le_mean =     -17.217413148070
             les_mean =     296.760141488926
             stat err =       0.000430112954
             autocorr =       1.153254869959
              std dev =       0.566415163990
             le_variance =       0.320826137998


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721741314807e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+07, overlap shift 1.5625e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413148070       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413148070       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413148070       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413148070       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413147996       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413145054       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413141006       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+07 is 3.165032e-11

solving harmonic davidson linear method for identity shift 6.2500e+07, overlap shift 6.2500e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413148070       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413148070       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413148070       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413148070       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413148070       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413180388       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413148076       residual = 8.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+07 is 7.912503e-12

solving harmonic davidson linear method for identity shift 2.5000e+08, overlap shift 2.5000e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217413148070       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217413148070       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217413148070       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217413148070       residual = 9.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217413127190       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217413148070       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217413023059       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+08 is 1.978174e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.390873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7883e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2583
    reference variance = 0.208728
====================================================
  Execution time = 1.9968e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1987e-01
  Total weights = 2.0000e+06
  Execution time = 1.8569e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901932
                                         uncertainty =       0.004715500118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901932
                                         uncertainty =       0.004715500118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399919856
  error estimate for blocks of size 2^( 2) =       0.000409680407
  error estimate for blocks of size 2^( 3) =       0.000418536019
  error estimate for blocks of size 2^( 4) =       0.000425247178
  error estimate for blocks of size 2^( 5) =       0.000429510512
  error estimate for blocks of size 2^( 6) =       0.000431709191
  error estimate for blocks of size 2^( 7) =       0.000431062982

      target function =                  N/A
              le_mean =     -17.216218879877
             les_mean =     296.718064141905
             stat err =       0.000429382466
             autocorr =       1.152770031049
              std dev =       0.565572083838
             le_variance =       0.319871782017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901951
                                         uncertainty =       0.004715500119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901951
                                         uncertainty =       0.004715500119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399919856
  error estimate for blocks of size 2^( 2) =       0.000409680407
  error estimate for blocks of size 2^( 3) =       0.000418536019
  error estimate for blocks of size 2^( 4) =       0.000425247178
  error estimate for blocks of size 2^( 5) =       0.000429510512
  error estimate for blocks of size 2^( 6) =       0.000431709191
  error estimate for blocks of size 2^( 7) =       0.000431062982

      target function =                  N/A
              le_mean =     -17.216218879877
             les_mean =     296.718064141922
             stat err =       0.000429382466
             autocorr =       1.152770031041
              std dev =       0.565572083854
             le_variance =       0.319871782035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901941
                                         uncertainty =       0.004715500119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901941
                                         uncertainty =       0.004715500119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399919856
  error estimate for blocks of size 2^( 2) =       0.000409680407
  error estimate for blocks of size 2^( 3) =       0.000418536019
  error estimate for blocks of size 2^( 4) =       0.000425247178
  error estimate for blocks of size 2^( 5) =       0.000429510512
  error estimate for blocks of size 2^( 6) =       0.000431709191
  error estimate for blocks of size 2^( 7) =       0.000431062982

      target function =                  N/A
              le_mean =     -17.216218879877
             les_mean =     296.718064141913
             stat err =       0.000429382466
             autocorr =       1.152770031034
              std dev =       0.565572083846
             le_variance =       0.319871782026

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901933
                                         uncertainty =       0.004715500118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319914901933
                                         uncertainty =       0.004715500118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399919856
  error estimate for blocks of size 2^( 2) =       0.000409680407
  error estimate for blocks of size 2^( 3) =       0.000418536019
  error estimate for blocks of size 2^( 4) =       0.000425247178
  error estimate for blocks of size 2^( 5) =       0.000429510512
  error estimate for blocks of size 2^( 6) =       0.000431709191
  error estimate for blocks of size 2^( 7) =       0.000431062982

      target function =                  N/A
              le_mean =     -17.216218879877
             les_mean =     296.718064141906
             stat err =       0.000429382466
             autocorr =       1.152770031048
              std dev =       0.565572083839
             le_variance =       0.319871782018


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216218879877        initial  <--
     1.5625e+07     1.5625e+08             3.1650e-11       -17.216218879877
     6.2500e+07     6.2500e+08             7.9125e-12       -17.216218879877
     2.5000e+08     2.5000e+09             1.9782e-12       -17.216218879877

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3594
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.12897
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317405438713
                                         uncertainty =       0.003106353869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317405438713
                                         uncertainty =       0.003106353869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398376570
  error estimate for blocks of size 2^( 2) =       0.000408311107
  error estimate for blocks of size 2^( 3) =       0.000417619521
  error estimate for blocks of size 2^( 4) =       0.000424614869
  error estimate for blocks of size 2^( 5) =       0.000429412500
  error estimate for blocks of size 2^( 6) =       0.000432601461
  error estimate for blocks of size 2^( 7) =       0.000434877369

      target function =                  N/A
              le_mean =     -17.216658361181
             les_mean =     296.730732750201
             stat err =       0.000430376550
             autocorr =       1.167104175459
              std dev =       0.563389548434
             le_variance =       0.317407783284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721665836118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+08, overlap shift 1.5625e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658361181       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658361181       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658361181       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658355093       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658657763       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658327342       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658318890       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+08 is 3.048260e-12

solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658361181       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658361181       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658361181       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658319868       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658545134       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658183264       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658333306       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 7.620923e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216658361181       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216658361181       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216658361181       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216658361181       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216658281293       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216658348758       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216658508750       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+09 is 1.905379e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5913e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2003
    reference variance = 0.143848
====================================================
  Execution time = 1.9657e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1623e-01
  Total weights = 2.0000e+06
  Execution time = 1.8624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744140
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744140
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397635599
  error estimate for blocks of size 2^( 2) =       0.000407227837
  error estimate for blocks of size 2^( 3) =       0.000415867740
  error estimate for blocks of size 2^( 4) =       0.000422151773
  error estimate for blocks of size 2^( 5) =       0.000424894728
  error estimate for blocks of size 2^( 6) =       0.000427281409
  error estimate for blocks of size 2^( 7) =       0.000429803169

      target function =                  N/A
              le_mean =     -17.216606123321
             les_mean =     296.727754386052
             stat err =       0.000426032770
             autocorr =       1.147930235381
              std dev =       0.562341656463
             le_variance =       0.316228138593

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397635599
  error estimate for blocks of size 2^( 2) =       0.000407227837
  error estimate for blocks of size 2^( 3) =       0.000415867740
  error estimate for blocks of size 2^( 4) =       0.000422151773
  error estimate for blocks of size 2^( 5) =       0.000424894728
  error estimate for blocks of size 2^( 6) =       0.000427281409
  error estimate for blocks of size 2^( 7) =       0.000429803169

      target function =                  N/A
              le_mean =     -17.216606123321
             les_mean =     296.727754386053
             stat err =       0.000426032770
             autocorr =       1.147930235377
              std dev =       0.562341656463
             le_variance =       0.316228138594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397635599
  error estimate for blocks of size 2^( 2) =       0.000407227837
  error estimate for blocks of size 2^( 3) =       0.000415867740
  error estimate for blocks of size 2^( 4) =       0.000422151773
  error estimate for blocks of size 2^( 5) =       0.000424894728
  error estimate for blocks of size 2^( 6) =       0.000427281409
  error estimate for blocks of size 2^( 7) =       0.000429803169

      target function =                  N/A
              le_mean =     -17.216606123321
             les_mean =     296.727754386052
             stat err =       0.000426032770
             autocorr =       1.147930235382
              std dev =       0.562341656463
             le_variance =       0.316228138594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316316744141
                                         uncertainty =       0.003455587042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397635599
  error estimate for blocks of size 2^( 2) =       0.000407227837
  error estimate for blocks of size 2^( 3) =       0.000415867740
  error estimate for blocks of size 2^( 4) =       0.000422151773
  error estimate for blocks of size 2^( 5) =       0.000424894728
  error estimate for blocks of size 2^( 6) =       0.000427281409
  error estimate for blocks of size 2^( 7) =       0.000429803169

      target function =                  N/A
              le_mean =     -17.216606123321
             les_mean =     296.727754386052
             stat err =       0.000426032770
             autocorr =       1.147930235382
              std dev =       0.562341656463
             le_variance =       0.316228138593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216606123321        initial
     1.5625e+08     1.5625e+09             3.0483e-12       -17.216606123321
     6.2500e+08     6.2500e+09             7.6209e-13       -17.216606123321
     2.5000e+09     2.5000e+10             1.9054e-13       -17.216606123321  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+09     and shift_s =   2.5000e+10
*****************************************************************************

  Execution time = 2.9075e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4994e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1752
    reference variance = 0.179054
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1279e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312829934014
                                         uncertainty =       0.003484407755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312829934014
                                         uncertainty =       0.003484407755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395471044
  error estimate for blocks of size 2^( 2) =       0.000404827241
  error estimate for blocks of size 2^( 3) =       0.000413618807
  error estimate for blocks of size 2^( 4) =       0.000420525688
  error estimate for blocks of size 2^( 5) =       0.000425627307
  error estimate for blocks of size 2^( 6) =       0.000427056571
  error estimate for blocks of size 2^( 7) =       0.000427720458

      target function =                  N/A
              le_mean =     -17.216992540805
             les_mean =     296.737626686623
             stat err =       0.000425232506
             autocorr =       1.156174885634
              std dev =       0.559280513603
             le_variance =       0.312794692896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699254080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+08, overlap shift 6.2500e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992540805       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216992540805       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216992540805       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216992540805       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216992862224       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216992540805       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216992274790       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216992319963       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+08 is 6.892056e-13

solving harmonic davidson linear method for identity shift 2.5000e+09, overlap shift 2.5000e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992540805       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216992540805       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216992540805       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216990965782       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216990534144       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216992598900       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216992683996       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+09 is 1.691862e-13

solving harmonic davidson linear method for identity shift 1.0000e+10, overlap shift 1.0000e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216992540805       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216992540805       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216992540805       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216988186113       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216992766742       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990664792       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216991837147       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+10 is 4.233693e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.395624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5825e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1848
    reference variance = 0.283541
====================================================
  Execution time = 1.9996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1754e-01
  Total weights = 2.0000e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673820
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673820
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398456652
  error estimate for blocks of size 2^( 2) =       0.000408208994
  error estimate for blocks of size 2^( 3) =       0.000417101248
  error estimate for blocks of size 2^( 4) =       0.000423710133
  error estimate for blocks of size 2^( 5) =       0.000427291538
  error estimate for blocks of size 2^( 6) =       0.000429440611
  error estimate for blocks of size 2^( 7) =       0.000429653718

      target function =                  N/A
              le_mean =     -17.216547061097
             les_mean =     296.727027955530
             stat err =       0.000427524000
             autocorr =       1.151221354142
              std dev =       0.563502801527
             le_variance =       0.317535407329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673821
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673821
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398456652
  error estimate for blocks of size 2^( 2) =       0.000408208994
  error estimate for blocks of size 2^( 3) =       0.000417101248
  error estimate for blocks of size 2^( 4) =       0.000423710133
  error estimate for blocks of size 2^( 5) =       0.000427291538
  error estimate for blocks of size 2^( 6) =       0.000429440611
  error estimate for blocks of size 2^( 7) =       0.000429653718

      target function =                  N/A
              le_mean =     -17.216547061097
             les_mean =     296.727027955530
             stat err =       0.000427524000
             autocorr =       1.151221354136
              std dev =       0.563502801528
             le_variance =       0.317535407330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673821
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673821
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398456652
  error estimate for blocks of size 2^( 2) =       0.000408208994
  error estimate for blocks of size 2^( 3) =       0.000417101248
  error estimate for blocks of size 2^( 4) =       0.000423710133
  error estimate for blocks of size 2^( 5) =       0.000427291538
  error estimate for blocks of size 2^( 6) =       0.000429440611
  error estimate for blocks of size 2^( 7) =       0.000429653718

      target function =                  N/A
              le_mean =     -17.216547061097
             les_mean =     296.727027955530
             stat err =       0.000427524000
             autocorr =       1.151221354140
              std dev =       0.563502801528
             le_variance =       0.317535407330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673820
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317326673820
                                         uncertainty =       0.003706171663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398456652
  error estimate for blocks of size 2^( 2) =       0.000408208994
  error estimate for blocks of size 2^( 3) =       0.000417101248
  error estimate for blocks of size 2^( 4) =       0.000423710133
  error estimate for blocks of size 2^( 5) =       0.000427291538
  error estimate for blocks of size 2^( 6) =       0.000429440611
  error estimate for blocks of size 2^( 7) =       0.000429653718

      target function =                  N/A
              le_mean =     -17.216547061097
             les_mean =     296.727027955530
             stat err =       0.000427524000
             autocorr =       1.151221354139
              std dev =       0.563502801528
             le_variance =       0.317535407329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216547061097        initial  <--
     6.2500e+08     6.2500e+09             6.8921e-13       -17.216547061097
     2.5000e+09     2.5000e+10             1.6919e-13       -17.216547061097
     1.0000e+10     1.0000e+11             4.2337e-14       -17.216547061097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3714
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5203e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1698
    reference variance = 0.418166
====================================================
  Execution time = 2.0316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1730e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079355724
                                         uncertainty =       0.003875024911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079355724
                                         uncertainty =       0.003875024911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398307555
  error estimate for blocks of size 2^( 2) =       0.000408126303
  error estimate for blocks of size 2^( 3) =       0.000416590698
  error estimate for blocks of size 2^( 4) =       0.000423043420
  error estimate for blocks of size 2^( 5) =       0.000426869933
  error estimate for blocks of size 2^( 6) =       0.000430462242
  error estimate for blocks of size 2^( 7) =       0.000433156606

      target function =                  N/A
              le_mean =     -17.216805847385
             les_mean =     296.735701243890
             stat err =       0.000428383050
             autocorr =       1.156717939483
              std dev =       0.563291945599
             le_variance =       0.317297815977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680584739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+09, overlap shift 6.2500e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216805847385       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216805847385       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216805847385       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216805847385       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216805974603       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216805385250       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216805126998       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216805788892       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+09 is 7.680917e-14

solving harmonic davidson linear method for identity shift 2.5000e+10, overlap shift 2.5000e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216805847385       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216805847385       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216805847385       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216805847385       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216805847385       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216781566694       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216801464314       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216802338408       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+10 is 1.920063e-14

solving harmonic davidson linear method for identity shift 1.0000e+11, overlap shift 1.0000e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216805847385       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216805847385       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216805847385       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216805847385       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216872587490       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216848769612       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217074832277       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217091076318       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216682898559       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217185900942       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217417563904       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217650500025       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.218941634528       residual = 7.60e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213527347846       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217060852398       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215682105544       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.213192258472       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.218692158006       residual = 6.50e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216437359453       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.215344559221       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.207354743618       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.214967686716       residual = 7.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.232932785067       residual = 3.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.200752768539       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.221102320874       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.225031661801       residual = 9.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.231683920999       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.236949092810       residual = 6.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.214998835860       residual = 6.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.016875585166       residual = 6.18e+00           smallest_sin_value = 9.95e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.02e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+11 is 3.490117e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.413535 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5828e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2105
    reference variance = 0.229753
====================================================
  Execution time = 1.9729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1563e-01
  Total weights = 2.0000e+06
  Execution time = 1.8565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397259023
  error estimate for blocks of size 2^( 2) =       0.000407008133
  error estimate for blocks of size 2^( 3) =       0.000415939352
  error estimate for blocks of size 2^( 4) =       0.000422316089
  error estimate for blocks of size 2^( 5) =       0.000426348024
  error estimate for blocks of size 2^( 6) =       0.000428221468
  error estimate for blocks of size 2^( 7) =       0.000429342035

      target function =                  N/A
              le_mean =     -17.216991259881
             les_mean =     296.740417347750
             stat err =       0.000426556904
             autocorr =       1.152939214814
              std dev =       0.561809098125
             le_variance =       0.315629462736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397259023
  error estimate for blocks of size 2^( 2) =       0.000407008133
  error estimate for blocks of size 2^( 3) =       0.000415939352
  error estimate for blocks of size 2^( 4) =       0.000422316089
  error estimate for blocks of size 2^( 5) =       0.000426348024
  error estimate for blocks of size 2^( 6) =       0.000428221468
  error estimate for blocks of size 2^( 7) =       0.000429342035

      target function =                  N/A
              le_mean =     -17.216991259881
             les_mean =     296.740417347750
             stat err =       0.000426556904
             autocorr =       1.152939214821
              std dev =       0.561809098125
             le_variance =       0.315629462736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397259023
  error estimate for blocks of size 2^( 2) =       0.000407008133
  error estimate for blocks of size 2^( 3) =       0.000415939352
  error estimate for blocks of size 2^( 4) =       0.000422316089
  error estimate for blocks of size 2^( 5) =       0.000426348024
  error estimate for blocks of size 2^( 6) =       0.000428221468
  error estimate for blocks of size 2^( 7) =       0.000429342035

      target function =                  N/A
              le_mean =     -17.216991259881
             les_mean =     296.740417347750
             stat err =       0.000426556904
             autocorr =       1.152939214821
              std dev =       0.561809098125
             le_variance =       0.315629462736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315620057321
                                         uncertainty =       0.003492755794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397259023
  error estimate for blocks of size 2^( 2) =       0.000407008133
  error estimate for blocks of size 2^( 3) =       0.000415939352
  error estimate for blocks of size 2^( 4) =       0.000422316089
  error estimate for blocks of size 2^( 5) =       0.000426348024
  error estimate for blocks of size 2^( 6) =       0.000428221468
  error estimate for blocks of size 2^( 7) =       0.000429342035

      target function =                  N/A
              le_mean =     -17.216991259881
             les_mean =     296.740417347750
             stat err =       0.000426556904
             autocorr =       1.152939214814
              std dev =       0.561809098125
             le_variance =       0.315629462736


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216991259881        initial  <--
     6.2500e+09     6.2500e+10             7.6809e-14       -17.216991259881
     2.5000e+10     2.5000e+11             1.9201e-14       -17.216991259881
     1.0000e+11     1.0000e+12             3.4901e-15       -17.216991259881

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1210
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.208068
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320436148992
                                         uncertainty =       0.005083520700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320436148992
                                         uncertainty =       0.005083520700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400232921
  error estimate for blocks of size 2^( 2) =       0.000409816195
  error estimate for blocks of size 2^( 3) =       0.000418528025
  error estimate for blocks of size 2^( 4) =       0.000425203179
  error estimate for blocks of size 2^( 5) =       0.000430254888
  error estimate for blocks of size 2^( 6) =       0.000432813949
  error estimate for blocks of size 2^( 7) =       0.000432866695

      target function =                  N/A
              le_mean =     -17.216922184842
             les_mean =     296.742782140146
             stat err =       0.000430284678
             autocorr =       1.155809197925
              std dev =       0.566014824401
             le_variance =       0.320372781442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692218484e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+10, overlap shift 6.2500e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216922184842       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922184842       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216922184842       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922184842       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922184842       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216932141749       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216908830798       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216905730774       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216710544252       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216816876575       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217856212158       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218635524028       residual = 4.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216175111768       residual = 8.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215835692011       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.219569648730       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.222986709970       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217908090671       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.238927001739       residual = 7.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217257295736       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.212225458408       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213560399030       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.219476039546       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.198304082899       residual = 5.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.249183933729       residual = 1.66e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.237958738165       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.251511766750       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.329179192510       residual = 2.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.176410717345       residual = 2.76e-01           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.243454214945       residual = 1.07e-01           smallest_sin_value = 9.97e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.53e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+10 is 1.015889e-14

solving harmonic davidson linear method for identity shift 2.5000e+11, overlap shift 2.5000e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216922184842       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922184842       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216922184842       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922184842       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922484343       residual = 6.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217039332436       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216929641355       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216977757934       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215522128295       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216046291200       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218965858113       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.221375908649       residual = 3.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.209157787439       residual = 9.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217363953229       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213477693304       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.221519705738       residual = 3.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.228332230461       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.189777148683       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.182232917374       residual = 1.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.298842148635       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.217560727394       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.221682725091       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.176653859018       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.202046020834       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.240821701887       residual = 9.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.190429866770       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.267685396362       residual = 3.96e-01           smallest_sin_value = 9.99e-01
davidson iteration   27:   krylov dim =  28   energy =     -17.275207835073       residual = 5.21e-01           smallest_sin_value = 9.97e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.192195232025       residual = 1.06e-01           smallest_sin_value = 9.92e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.31e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+11 is 2.323630e-15

solving harmonic davidson linear method for identity shift 1.0000e+12, overlap shift 1.0000e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216922184842       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216922184842       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216922184842       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216922184842       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216747256142       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210227351024       residual = 7.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217056645194       residual = 9.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213845424932       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.205564308765       residual = 2.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.210870398716       residual = 4.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.246304148189       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.227679500999       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.224169456697       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.235581416964       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.149177787559       residual = 7.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.246374944859       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.210348823081       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.236390483628       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.048566704254       residual = 4.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.183717164131       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.237601873033       residual = 7.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.076937059099       residual = 2.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.695785861153       residual = 4.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.435240476642       residual = 7.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.391899050499       residual = 4.66e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.261162001687       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.837630468198       residual = 2.26e+01           smallest_sin_value = 9.99e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+12 is 2.499415e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.467584 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6460e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2594
    reference variance = 0.227347
====================================================
  Execution time = 2.0554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398208960
  error estimate for blocks of size 2^( 2) =       0.000408083461
  error estimate for blocks of size 2^( 3) =       0.000416804883
  error estimate for blocks of size 2^( 4) =       0.000423787883
  error estimate for blocks of size 2^( 5) =       0.000428046389
  error estimate for blocks of size 2^( 6) =       0.000430618040
  error estimate for blocks of size 2^( 7) =       0.000435037203

      target function =                  N/A
              le_mean =     -17.216657758685
             les_mean =     296.730444972171
             stat err =       0.000429372379
             autocorr =       1.162642384361
              std dev =       0.563152511366
             le_variance =       0.317140751058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398208960
  error estimate for blocks of size 2^( 2) =       0.000408083461
  error estimate for blocks of size 2^( 3) =       0.000416804883
  error estimate for blocks of size 2^( 4) =       0.000423787883
  error estimate for blocks of size 2^( 5) =       0.000428046389
  error estimate for blocks of size 2^( 6) =       0.000430618040
  error estimate for blocks of size 2^( 7) =       0.000435037203

      target function =                  N/A
              le_mean =     -17.216657758685
             les_mean =     296.730444972171
             stat err =       0.000429372379
             autocorr =       1.162642384366
              std dev =       0.563152511366
             le_variance =       0.317140751058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398208960
  error estimate for blocks of size 2^( 2) =       0.000408083461
  error estimate for blocks of size 2^( 3) =       0.000416804883
  error estimate for blocks of size 2^( 4) =       0.000423787883
  error estimate for blocks of size 2^( 5) =       0.000428046389
  error estimate for blocks of size 2^( 6) =       0.000430618040
  error estimate for blocks of size 2^( 7) =       0.000435037203

      target function =                  N/A
              le_mean =     -17.216657758685
             les_mean =     296.730444972171
             stat err =       0.000429372379
             autocorr =       1.162642384361
              std dev =       0.563152511366
             le_variance =       0.317140751058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317193420930
                                         uncertainty =       0.003246090192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398208960
  error estimate for blocks of size 2^( 2) =       0.000408083461
  error estimate for blocks of size 2^( 3) =       0.000416804883
  error estimate for blocks of size 2^( 4) =       0.000423787883
  error estimate for blocks of size 2^( 5) =       0.000428046389
  error estimate for blocks of size 2^( 6) =       0.000430618040
  error estimate for blocks of size 2^( 7) =       0.000435037203

      target function =                  N/A
              le_mean =     -17.216657758685
             les_mean =     296.730444972171
             stat err =       0.000429372379
             autocorr =       1.162642384362
              std dev =       0.563152511366
             le_variance =       0.317140751058


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216657758685        initial  <--
     6.2500e+10     6.2500e+11             1.0159e-14       -17.216657758685
     2.5000e+11     2.5000e+12             2.3236e-15       -17.216657758685
     1.0000e+12     1.0000e+13             2.4994e-16       -17.216657758685

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8926
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.21472
====================================================
  Execution time = 2.0461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2084e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320916533115
                                         uncertainty =       0.003898482828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320916533115
                                         uncertainty =       0.003898482828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400521669
  error estimate for blocks of size 2^( 2) =       0.000410263868
  error estimate for blocks of size 2^( 3) =       0.000419066992
  error estimate for blocks of size 2^( 4) =       0.000425859535
  error estimate for blocks of size 2^( 5) =       0.000429208691
  error estimate for blocks of size 2^( 6) =       0.000431827927
  error estimate for blocks of size 2^( 7) =       0.000433791743

      target function =                  N/A
              le_mean =     -17.216804719974
             les_mean =     296.739199819926
             stat err =       0.000430171974
             autocorr =       1.153538755043
              std dev =       0.566423176278
             le_variance =       0.320835214625


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680471997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+11, overlap shift 6.2500e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216804719974       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216804719974       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216804719974       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215980872176       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216718835908       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215203253487       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217186084705       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215963522165       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217006620316       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217463644109       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.220001084581       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216705653866       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.209326672046       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213347891321       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.239728424392       residual = 8.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.225428412433       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.221930051996       residual = 4.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.244925914635       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.186646139435       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.245148982208       residual = 1.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.469768151952       residual = 9.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.299359353084       residual = 9.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.230277121749       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.088305202761       residual = 2.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.064038830456       residual = 3.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.155115434948       residual = 5.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.219655933460       residual = 5.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.211675431171       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.185342708096       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.788657891457       residual = 5.82e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.409250774486       residual = 5.49e+00           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.331360923018       residual = 2.15e+00           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.21e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+11 is 3.133245e-16

solving harmonic davidson linear method for identity shift 2.5000e+12, overlap shift 2.5000e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216804719974       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216804719974       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216804719974       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211155324148       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215193751937       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.226950703968       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.204349831401       residual = 2.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.210259680420       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.239081021023       residual = 7.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.144720024115       residual = 8.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.191828867807       residual = 9.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.158837389995       residual = 4.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.240007996913       residual = 8.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.238697520124       residual = 7.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.177797447613       residual = 2.35e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.109429426481       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.180163112001       residual = 2.50e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.240642028012       residual = 8.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.083123310541       residual = 2.72e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.261080316456       residual = 3.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.236290196321       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.098895950848       residual = 2.22e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.007794938471       residual = 6.73e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.054161692087       residual = 4.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.513021648277       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.039159973346       residual = 5.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.739682258076       residual = 3.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -19.218252316549       residual = 6.52e+02           smallest_sin_value = 9.96e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.69e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+13, overlap shift 1.0000e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216804719974       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216804719974       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216804719974       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216804719974       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.237524986638       residual = 7.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216881024282       residual = 5.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.188685267756       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215337223655       residual = 4.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.207243617972       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.230642609311       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.285598557505       residual = 6.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.318606457288       residual = 1.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.295944627183       residual = 1.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.379536199839       residual = 3.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.867145230520       residual = 1.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.776494594085       residual = 3.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.951748669163       residual = 9.88e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.664349581450       residual = 4.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.211688901183       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.600900130517       residual = 4.11e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -13.959681276364       residual = 1.68e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -19.742482526260       residual = 1.05e+03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.652070786495       residual = 1.04e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -15.118041449594       residual = 8.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -18.047940180436       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.491394369547       residual = 8.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.828297772142       residual = 6.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -20.167696398122       residual = 1.32e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -18.024966300534       residual = 3.16e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -19.123028879695       residual = 6.79e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -18.783924614730       residual = 3.84e+02           smallest_sin_value = 1.00e+00
davidson iteration   31 stopping due to too large eigenvalue change
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+13 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.505416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5953e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.3431
    reference variance = 0.17328
====================================================
  Execution time = 2.2154e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1225e-01
  Total weights = 2.0000e+06
  Execution time = 1.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395128747
  error estimate for blocks of size 2^( 2) =       0.000404987317
  error estimate for blocks of size 2^( 3) =       0.000414134897
  error estimate for blocks of size 2^( 4) =       0.000421086375
  error estimate for blocks of size 2^( 5) =       0.000426391896
  error estimate for blocks of size 2^( 6) =       0.000428728651
  error estimate for blocks of size 2^( 7) =       0.000430042041

      target function =                  N/A
              le_mean =     -17.216852364884
             les_mean =     296.732258651128
             stat err =       0.000426562241
             autocorr =       1.165433679562
              std dev =       0.558796432553
             le_variance =       0.312253453034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395128747
  error estimate for blocks of size 2^( 2) =       0.000404987317
  error estimate for blocks of size 2^( 3) =       0.000414134897
  error estimate for blocks of size 2^( 4) =       0.000421086375
  error estimate for blocks of size 2^( 5) =       0.000426391896
  error estimate for blocks of size 2^( 6) =       0.000428728651
  error estimate for blocks of size 2^( 7) =       0.000430042041

      target function =                  N/A
              le_mean =     -17.216852364884
             les_mean =     296.732258651128
             stat err =       0.000426562241
             autocorr =       1.165433679566
              std dev =       0.558796432553
             le_variance =       0.312253453034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395128747
  error estimate for blocks of size 2^( 2) =       0.000404987317
  error estimate for blocks of size 2^( 3) =       0.000414134897
  error estimate for blocks of size 2^( 4) =       0.000421086375
  error estimate for blocks of size 2^( 5) =       0.000426391896
  error estimate for blocks of size 2^( 6) =       0.000428728651
  error estimate for blocks of size 2^( 7) =       0.000430042041

      target function =                  N/A
              le_mean =     -17.216852364884
             les_mean =     296.732258651128
             stat err =       0.000426562241
             autocorr =       1.165433679562
              std dev =       0.558796432553
             le_variance =       0.312253453034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312261592795
                                         uncertainty =       0.002881235411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395128747
  error estimate for blocks of size 2^( 2) =       0.000404987317
  error estimate for blocks of size 2^( 3) =       0.000414134897
  error estimate for blocks of size 2^( 4) =       0.000421086375
  error estimate for blocks of size 2^( 5) =       0.000426391896
  error estimate for blocks of size 2^( 6) =       0.000428728651
  error estimate for blocks of size 2^( 7) =       0.000430042041

      target function =                  N/A
              le_mean =     -17.216852364884
             les_mean =     296.732258651128
             stat err =       0.000426562241
             autocorr =       1.165433679562
              std dev =       0.558796432553
             le_variance =       0.312253453034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216852364884        initial  <--
     6.2500e+11     6.2500e+12             3.1332e-16       -17.216852364884
     2.5000e+12     2.5000e+13             0.0000e+00       -17.216852364884
     1.0000e+13     1.0000e+14             0.0000e+00       -17.216852364884

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5361
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7495e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2671
    reference variance = 0.216924
====================================================
  Execution time = 2.0612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1499e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4410e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315067862658
                                         uncertainty =       0.003052355206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315067862658
                                         uncertainty =       0.003052355206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396855280
  error estimate for blocks of size 2^( 2) =       0.000406778311
  error estimate for blocks of size 2^( 3) =       0.000415506431
  error estimate for blocks of size 2^( 4) =       0.000421894618
  error estimate for blocks of size 2^( 5) =       0.000426530846
  error estimate for blocks of size 2^( 6) =       0.000427729994
  error estimate for blocks of size 2^( 7) =       0.000429307008

      target function =                  N/A
              le_mean =     -17.216377288739
             les_mean =     296.718635017288
             stat err =       0.000426365617
             autocorr =       1.154250372789
              std dev =       0.561238119329
             le_variance =       0.314988226588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637728874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+12, overlap shift 6.2500e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+13, overlap shift 2.5000e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+14, overlap shift 1.0000e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216377288739       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.506467 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6063e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1384
    reference variance = 0.236883
====================================================
  Execution time = 1.9953e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1857e-01
  Total weights = 2.0000e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399106741
  error estimate for blocks of size 2^( 2) =       0.000409151108
  error estimate for blocks of size 2^( 3) =       0.000417813584
  error estimate for blocks of size 2^( 4) =       0.000424560833
  error estimate for blocks of size 2^( 5) =       0.000429404435
  error estimate for blocks of size 2^( 6) =       0.000432801560
  error estimate for blocks of size 2^( 7) =       0.000435194302

      target function =                  N/A
              le_mean =     -17.216146391414
             les_mean =     296.714268793462
             stat err =       0.000430490282
             autocorr =       1.163452286646
              std dev =       0.564422166614
             le_variance =       0.318572382165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399106741
  error estimate for blocks of size 2^( 2) =       0.000409151108
  error estimate for blocks of size 2^( 3) =       0.000417813584
  error estimate for blocks of size 2^( 4) =       0.000424560833
  error estimate for blocks of size 2^( 5) =       0.000429404435
  error estimate for blocks of size 2^( 6) =       0.000432801560
  error estimate for blocks of size 2^( 7) =       0.000435194302

      target function =                  N/A
              le_mean =     -17.216146391414
             les_mean =     296.714268793462
             stat err =       0.000430490282
             autocorr =       1.163452286646
              std dev =       0.564422166614
             le_variance =       0.318572382165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399106741
  error estimate for blocks of size 2^( 2) =       0.000409151108
  error estimate for blocks of size 2^( 3) =       0.000417813584
  error estimate for blocks of size 2^( 4) =       0.000424560833
  error estimate for blocks of size 2^( 5) =       0.000429404435
  error estimate for blocks of size 2^( 6) =       0.000432801560
  error estimate for blocks of size 2^( 7) =       0.000435194302

      target function =                  N/A
              le_mean =     -17.216146391414
             les_mean =     296.714268793462
             stat err =       0.000430490282
             autocorr =       1.163452286646
              std dev =       0.564422166614
             le_variance =       0.318572382165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318586226388
                                         uncertainty =       0.005228213417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399106741
  error estimate for blocks of size 2^( 2) =       0.000409151108
  error estimate for blocks of size 2^( 3) =       0.000417813584
  error estimate for blocks of size 2^( 4) =       0.000424560833
  error estimate for blocks of size 2^( 5) =       0.000429404435
  error estimate for blocks of size 2^( 6) =       0.000432801560
  error estimate for blocks of size 2^( 7) =       0.000435194302

      target function =                  N/A
              le_mean =     -17.216146391414
             les_mean =     296.714268793462
             stat err =       0.000430490282
             autocorr =       1.163452286646
              std dev =       0.564422166614
             le_variance =       0.318572382165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216146391414        initial  <--
     6.2500e+12     6.2500e+13             0.0000e+00       -17.216146391414
     2.5000e+13     2.5000e+14             0.0000e+00       -17.216146391414
     1.0000e+14     1.0000e+15             0.0000e+00       -17.216146391414

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3595
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.527431
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2264e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322622539383
                                         uncertainty =       0.004857862683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322622539383
                                         uncertainty =       0.004857862683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401647222
  error estimate for blocks of size 2^( 2) =       0.000411311508
  error estimate for blocks of size 2^( 3) =       0.000419550489
  error estimate for blocks of size 2^( 4) =       0.000426018241
  error estimate for blocks of size 2^( 5) =       0.000429666071
  error estimate for blocks of size 2^( 6) =       0.000432754169
  error estimate for blocks of size 2^( 7) =       0.000433199817

      target function =                  N/A
              le_mean =     -17.215953675345
             les_mean =     296.711701771483
             stat err =       0.000430409574
             autocorr =       1.148350101963
              std dev =       0.568014948026
             le_variance =       0.322640981181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595367534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+13, overlap shift 6.2500e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+14, overlap shift 2.5000e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+14 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+15, overlap shift 1.0000e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953675345       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+15 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5889e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.187217
====================================================
  Execution time = 2.0308e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2261e-01
  Total weights = 2.0000e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401625360
  error estimate for blocks of size 2^( 2) =       0.000411036145
  error estimate for blocks of size 2^( 3) =       0.000419892904
  error estimate for blocks of size 2^( 4) =       0.000425888193
  error estimate for blocks of size 2^( 5) =       0.000429756733
  error estimate for blocks of size 2^( 6) =       0.000432285833
  error estimate for blocks of size 2^( 7) =       0.000434726996

      target function =                  N/A
              le_mean =     -17.215823313495
             les_mean =     296.707178059758
             stat err =       0.000430664439
             autocorr =       1.149835648184
              std dev =       0.567984031097
             le_variance =       0.322605859582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401625360
  error estimate for blocks of size 2^( 2) =       0.000411036145
  error estimate for blocks of size 2^( 3) =       0.000419892904
  error estimate for blocks of size 2^( 4) =       0.000425888193
  error estimate for blocks of size 2^( 5) =       0.000429756733
  error estimate for blocks of size 2^( 6) =       0.000432285833
  error estimate for blocks of size 2^( 7) =       0.000434726996

      target function =                  N/A
              le_mean =     -17.215823313495
             les_mean =     296.707178059758
             stat err =       0.000430664439
             autocorr =       1.149835648184
              std dev =       0.567984031097
             le_variance =       0.322605859582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401625360
  error estimate for blocks of size 2^( 2) =       0.000411036145
  error estimate for blocks of size 2^( 3) =       0.000419892904
  error estimate for blocks of size 2^( 4) =       0.000425888193
  error estimate for blocks of size 2^( 5) =       0.000429756733
  error estimate for blocks of size 2^( 6) =       0.000432285833
  error estimate for blocks of size 2^( 7) =       0.000434726996

      target function =                  N/A
              le_mean =     -17.215823313495
             les_mean =     296.707178059758
             stat err =       0.000430664439
             autocorr =       1.149835648184
              std dev =       0.567984031097
             le_variance =       0.322605859582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713620548
                                         uncertainty =       0.004925776568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401625360
  error estimate for blocks of size 2^( 2) =       0.000411036145
  error estimate for blocks of size 2^( 3) =       0.000419892904
  error estimate for blocks of size 2^( 4) =       0.000425888193
  error estimate for blocks of size 2^( 5) =       0.000429756733
  error estimate for blocks of size 2^( 6) =       0.000432285833
  error estimate for blocks of size 2^( 7) =       0.000434726996

      target function =                  N/A
              le_mean =     -17.215823313495
             les_mean =     296.707178059758
             stat err =       0.000430664439
             autocorr =       1.149835648184
              std dev =       0.567984031097
             le_variance =       0.322605859582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215823313495        initial  <--
     6.2500e+13     6.2500e+14             0.0000e+00       -17.215823313495
     2.5000e+14     2.5000e+15             0.0000e+00       -17.215823313495
     1.0000e+15     1.0000e+16             0.0000e+00       -17.215823313495

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7097
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5605e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.141
    reference variance = 0.20759
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0893e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308925718155
                                         uncertainty =       0.002412297640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308925718155
                                         uncertainty =       0.002412297640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393020754
  error estimate for blocks of size 2^( 2) =       0.000403005251
  error estimate for blocks of size 2^( 3) =       0.000412282362
  error estimate for blocks of size 2^( 4) =       0.000418840238
  error estimate for blocks of size 2^( 5) =       0.000423983959
  error estimate for blocks of size 2^( 6) =       0.000426887039
  error estimate for blocks of size 2^( 7) =       0.000430298253

      target function =                  N/A
              le_mean =     -17.216131699423
             les_mean =     296.704121163696
             stat err =       0.000425002372
             autocorr =       1.169369436813
              std dev =       0.555815280722
             le_variance =       0.308930626284


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721613169942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+14, overlap shift 6.2500e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131699423       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131699423       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131699423       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.258848101577       residual = 4.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216131699423       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.495817839678       residual = 1.10e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -15.250727731174       residual = 5.39e+02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -20.022863911068       residual = 1.25e+03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.766204141447       residual = 8.52e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -15.680764314681       residual = 3.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -26.872941115201       residual = 1.28e+04           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+14 is 1.125917e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+15, overlap shift 2.5000e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131699423       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131699423       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131699423       residual = 3.44e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.218443817122       residual = 2.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -18.975121835435       residual = 4.16e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.114781622479       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -24.566277635840       residual = 9.32e+03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -23.021228806896       residual = 5.04e+03           smallest_sin_value = 1.00e+00
davidson iteration    8 stopping due to too large eigenvalue change
davidson solver did not converge after          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+15 is 2.814792e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+16, overlap shift 1.0000e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216131699423       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216131699423       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216131699423       residual = 9.15e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216131699423       residual = 7.28e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -11.367369839937       residual = 9.95e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -13.907901607037       residual = 4.56e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+16 is 7.036980e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.511157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5619e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.179948
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1963e-01
  Total weights = 2.0000e+06
  Execution time = 1.8549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768579
  error estimate for blocks of size 2^( 2) =       0.000409353500
  error estimate for blocks of size 2^( 3) =       0.000417449885
  error estimate for blocks of size 2^( 4) =       0.000423730488
  error estimate for blocks of size 2^( 5) =       0.000428246952
  error estimate for blocks of size 2^( 6) =       0.000429116212
  error estimate for blocks of size 2^( 7) =       0.000429273921

      target function =                  N/A
              le_mean =     -17.216978923247
             les_mean =     296.743992917577
             stat err =       0.000427591893
             autocorr =       1.144041061458
              std dev =       0.565358146530
             le_variance =       0.319629833848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768579
  error estimate for blocks of size 2^( 2) =       0.000409353500
  error estimate for blocks of size 2^( 3) =       0.000417449885
  error estimate for blocks of size 2^( 4) =       0.000423730488
  error estimate for blocks of size 2^( 5) =       0.000428246952
  error estimate for blocks of size 2^( 6) =       0.000429116212
  error estimate for blocks of size 2^( 7) =       0.000429273921

      target function =                  N/A
              le_mean =     -17.216978923247
             les_mean =     296.743992917577
             stat err =       0.000427591893
             autocorr =       1.144041061458
              std dev =       0.565358146530
             le_variance =       0.319629833848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768579
  error estimate for blocks of size 2^( 2) =       0.000409353500
  error estimate for blocks of size 2^( 3) =       0.000417449885
  error estimate for blocks of size 2^( 4) =       0.000423730488
  error estimate for blocks of size 2^( 5) =       0.000428246952
  error estimate for blocks of size 2^( 6) =       0.000429116212
  error estimate for blocks of size 2^( 7) =       0.000429273921

      target function =                  N/A
              le_mean =     -17.216978923247
             les_mean =     296.743992917577
             stat err =       0.000427591893
             autocorr =       1.144041061458
              std dev =       0.565358146530
             le_variance =       0.319629833848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319577908284
                                         uncertainty =       0.003423761818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399768579
  error estimate for blocks of size 2^( 2) =       0.000409353500
  error estimate for blocks of size 2^( 3) =       0.000417449885
  error estimate for blocks of size 2^( 4) =       0.000423730488
  error estimate for blocks of size 2^( 5) =       0.000428246952
  error estimate for blocks of size 2^( 6) =       0.000429116212
  error estimate for blocks of size 2^( 7) =       0.000429273921

      target function =                  N/A
              le_mean =     -17.216978923247
             les_mean =     296.743992917577
             stat err =       0.000427591893
             autocorr =       1.144041061458
              std dev =       0.565358146530
             le_variance =       0.319629833848


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216978923247        initial  <--
     6.2500e+14     6.2500e+15             1.1259e-19       -17.216978923247
     2.5000e+15     2.5000e+16             2.8148e-20       -17.216978923247
     1.0000e+16     1.0000e+17             7.0370e-21       -17.216978923247

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3291
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.128681
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1616e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316209234781
                                         uncertainty =       0.004419909479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316209234781
                                         uncertainty =       0.004419909479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397593813
  error estimate for blocks of size 2^( 2) =       0.000407219806
  error estimate for blocks of size 2^( 3) =       0.000415520397
  error estimate for blocks of size 2^( 4) =       0.000421628884
  error estimate for blocks of size 2^( 5) =       0.000425221859
  error estimate for blocks of size 2^( 6) =       0.000426584023
  error estimate for blocks of size 2^( 7) =       0.000426628284

      target function =                  N/A
              le_mean =     -17.216496640921
             les_mean =     296.723918109703
             stat err =       0.000425015762
             autocorr =       1.142696342678
              std dev =       0.562282563263
             le_variance =       0.316161680949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649664092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+15, overlap shift 6.2500e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496640921       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496640921       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216496640921       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216496640921       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.236039001370       residual = 1.49e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+15 is 2.201065e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+16, overlap shift 2.5000e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496640921       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496640921       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216496640921       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216496640921       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+16 is 7.128801e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+17, overlap shift 1.0000e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216496640921       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216496640921       residual = 5.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216496640921       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216496640921       residual = 3.92e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+17 is 1.375666e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.512910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5755e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.240992
====================================================
  Execution time = 1.9853e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2662e-01
  Total weights = 2.0000e+06
  Execution time = 1.8501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113457
  error estimate for blocks of size 2^( 2) =       0.000413598507
  error estimate for blocks of size 2^( 3) =       0.000422295920
  error estimate for blocks of size 2^( 4) =       0.000428534597
  error estimate for blocks of size 2^( 5) =       0.000432021556
  error estimate for blocks of size 2^( 6) =       0.000436066337
  error estimate for blocks of size 2^( 7) =       0.000438942912

      target function =                  N/A
              le_mean =     -17.215564865572
             les_mean =     296.702288849388
             stat err =       0.000433891351
             autocorr =       1.152803696588
              std dev =       0.571502731383
             le_variance =       0.326615371978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113457
  error estimate for blocks of size 2^( 2) =       0.000413598507
  error estimate for blocks of size 2^( 3) =       0.000422295920
  error estimate for blocks of size 2^( 4) =       0.000428534597
  error estimate for blocks of size 2^( 5) =       0.000432021556
  error estimate for blocks of size 2^( 6) =       0.000436066337
  error estimate for blocks of size 2^( 7) =       0.000438942912

      target function =                  N/A
              le_mean =     -17.215564865572
             les_mean =     296.702288849388
             stat err =       0.000433891351
             autocorr =       1.152803696588
              std dev =       0.571502731383
             le_variance =       0.326615371978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113457
  error estimate for blocks of size 2^( 2) =       0.000413598507
  error estimate for blocks of size 2^( 3) =       0.000422295920
  error estimate for blocks of size 2^( 4) =       0.000428534597
  error estimate for blocks of size 2^( 5) =       0.000432021556
  error estimate for blocks of size 2^( 6) =       0.000436066337
  error estimate for blocks of size 2^( 7) =       0.000438942912

      target function =                  N/A
              le_mean =     -17.215564865572
             les_mean =     296.702288849388
             stat err =       0.000433891351
             autocorr =       1.152803696588
              std dev =       0.571502731383
             le_variance =       0.326615371978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326721456085
                                         uncertainty =       0.010716647764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404113457
  error estimate for blocks of size 2^( 2) =       0.000413598507
  error estimate for blocks of size 2^( 3) =       0.000422295920
  error estimate for blocks of size 2^( 4) =       0.000428534597
  error estimate for blocks of size 2^( 5) =       0.000432021556
  error estimate for blocks of size 2^( 6) =       0.000436066337
  error estimate for blocks of size 2^( 7) =       0.000438942912

      target function =                  N/A
              le_mean =     -17.215564865572
             les_mean =     296.702288849388
             stat err =       0.000433891351
             autocorr =       1.152803696588
              std dev =       0.571502731383
             le_variance =       0.326615371978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215564865572        initial  <--
     6.2500e+15     6.2500e+16             2.2011e-20       -17.215564865572
     2.5000e+16     2.5000e+17             7.1288e-21       -17.215564865572
     1.0000e+17     1.0000e+18             1.3757e-21       -17.215564865572

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2220
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4983e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2329
    reference variance = 0.237025
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2227e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415404139
                                         uncertainty =       0.005086498952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322415404139
                                         uncertainty =       0.005086498952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401419301
  error estimate for blocks of size 2^( 2) =       0.000410909139
  error estimate for blocks of size 2^( 3) =       0.000419204233
  error estimate for blocks of size 2^( 4) =       0.000426491324
  error estimate for blocks of size 2^( 5) =       0.000431384138
  error estimate for blocks of size 2^( 6) =       0.000432448708
  error estimate for blocks of size 2^( 7) =       0.000434782855

      target function =                  N/A
              le_mean =     -17.216669346249
             les_mean =     296.735978127176
             stat err =       0.000431276756
             autocorr =       1.154291783467
              std dev =       0.567692619505
             le_variance =       0.322274910241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666934625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+16, overlap shift 6.2500e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669346249       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669346249       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216669346249       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.211664221399       residual = 4.64e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+16 is 5.873506e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+17, overlap shift 2.5000e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669346249       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669346249       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216669346249       residual = 6.41e+00           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.708815937399       residual = 3.93e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217991634336       residual = 4.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+17 is 1.468376e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+18, overlap shift 1.0000e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216669346249       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216669346249       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.514524 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6247e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2367
    reference variance = 0.17549
====================================================
  Execution time = 2.1106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1378e-01
  Total weights = 2.0000e+06
  Execution time = 1.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396093958
  error estimate for blocks of size 2^( 2) =       0.000406222899
  error estimate for blocks of size 2^( 3) =       0.000415265244
  error estimate for blocks of size 2^( 4) =       0.000422295266
  error estimate for blocks of size 2^( 5) =       0.000426766302
  error estimate for blocks of size 2^( 6) =       0.000429338820
  error estimate for blocks of size 2^( 7) =       0.000429763015

      target function =                  N/A
              le_mean =     -17.216569869494
             les_mean =     296.724058761939
             stat err =       0.000427040851
             autocorr =       1.162364687426
              std dev =       0.560161447859
             le_variance =       0.313780847668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396093958
  error estimate for blocks of size 2^( 2) =       0.000406222899
  error estimate for blocks of size 2^( 3) =       0.000415265244
  error estimate for blocks of size 2^( 4) =       0.000422295266
  error estimate for blocks of size 2^( 5) =       0.000426766302
  error estimate for blocks of size 2^( 6) =       0.000429338820
  error estimate for blocks of size 2^( 7) =       0.000429763015

      target function =                  N/A
              le_mean =     -17.216569869494
             les_mean =     296.724058761939
             stat err =       0.000427040851
             autocorr =       1.162364687426
              std dev =       0.560161447859
             le_variance =       0.313780847668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396093958
  error estimate for blocks of size 2^( 2) =       0.000406222899
  error estimate for blocks of size 2^( 3) =       0.000415265244
  error estimate for blocks of size 2^( 4) =       0.000422295266
  error estimate for blocks of size 2^( 5) =       0.000426766302
  error estimate for blocks of size 2^( 6) =       0.000429338820
  error estimate for blocks of size 2^( 7) =       0.000429763015

      target function =                  N/A
              le_mean =     -17.216569869494
             les_mean =     296.724058761939
             stat err =       0.000427040851
             autocorr =       1.162364687426
              std dev =       0.560161447859
             le_variance =       0.313780847668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313821193288
                                         uncertainty =       0.002754183102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396093958
  error estimate for blocks of size 2^( 2) =       0.000406222899
  error estimate for blocks of size 2^( 3) =       0.000415265244
  error estimate for blocks of size 2^( 4) =       0.000422295266
  error estimate for blocks of size 2^( 5) =       0.000426766302
  error estimate for blocks of size 2^( 6) =       0.000429338820
  error estimate for blocks of size 2^( 7) =       0.000429763015

      target function =                  N/A
              le_mean =     -17.216569869494
             les_mean =     296.724058761939
             stat err =       0.000427040851
             autocorr =       1.162364687426
              std dev =       0.560161447859
             le_variance =       0.313780847668


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216569869494        initial  <--
     6.2500e+16     6.2500e+17             5.8735e-22       -17.216569869494
     2.5000e+17     2.5000e+18             1.4684e-22       -17.216569869494
     1.0000e+18     1.0000e+19             0.0000e+00       -17.216569869494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 34.2316
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0503e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.188809
====================================================
  Execution time = 2.0673e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1642e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316475641750
                                         uncertainty =       0.003394656932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316475641750
                                         uncertainty =       0.003394656932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397757451
  error estimate for blocks of size 2^( 2) =       0.000407433035
  error estimate for blocks of size 2^( 3) =       0.000416015989
  error estimate for blocks of size 2^( 4) =       0.000422381911
  error estimate for blocks of size 2^( 5) =       0.000427294588
  error estimate for blocks of size 2^( 6) =       0.000428006655
  error estimate for blocks of size 2^( 7) =       0.000426666864

      target function =                  N/A
              le_mean =     -17.217400243843
             les_mean =     296.755292978203
             stat err =       0.000426087504
             autocorr =       1.147521809841
              std dev =       0.562513981806
             le_variance =       0.316421979727


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721740024384e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+17, overlap shift 6.2500e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217400243843       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+17 is 1.268450e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+18, overlap shift 2.5000e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217400243843       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+18 is 3.171125e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+19, overlap shift 1.0000e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217400243843       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217400243843       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+19 is 7.927813e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.515926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6237e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.3395
    reference variance = 1.96919
====================================================
  Execution time = 2.0060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1595e-01
  Total weights = 2.0000e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397458287
  error estimate for blocks of size 2^( 2) =       0.000406894417
  error estimate for blocks of size 2^( 3) =       0.000415915581
  error estimate for blocks of size 2^( 4) =       0.000422058966
  error estimate for blocks of size 2^( 5) =       0.000425511604
  error estimate for blocks of size 2^( 6) =       0.000428034504
  error estimate for blocks of size 2^( 7) =       0.000427266305

      target function =                  N/A
              le_mean =     -17.216989086382
             les_mean =     296.740659221946
             stat err =       0.000425717845
             autocorr =       1.147256685334
              std dev =       0.562090899513
             le_variance =       0.315946179316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397458287
  error estimate for blocks of size 2^( 2) =       0.000406894417
  error estimate for blocks of size 2^( 3) =       0.000415915581
  error estimate for blocks of size 2^( 4) =       0.000422058966
  error estimate for blocks of size 2^( 5) =       0.000425511604
  error estimate for blocks of size 2^( 6) =       0.000428034504
  error estimate for blocks of size 2^( 7) =       0.000427266305

      target function =                  N/A
              le_mean =     -17.216989086382
             les_mean =     296.740659221946
             stat err =       0.000425717845
             autocorr =       1.147256685334
              std dev =       0.562090899513
             le_variance =       0.315946179316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397458287
  error estimate for blocks of size 2^( 2) =       0.000406894417
  error estimate for blocks of size 2^( 3) =       0.000415915581
  error estimate for blocks of size 2^( 4) =       0.000422058966
  error estimate for blocks of size 2^( 5) =       0.000425511604
  error estimate for blocks of size 2^( 6) =       0.000428034504
  error estimate for blocks of size 2^( 7) =       0.000427266305

      target function =                  N/A
              le_mean =     -17.216989086382
             les_mean =     296.740659221946
             stat err =       0.000425717845
             autocorr =       1.147256685334
              std dev =       0.562090899513
             le_variance =       0.315946179316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315873120514
                                         uncertainty =       0.003220359505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397458287
  error estimate for blocks of size 2^( 2) =       0.000406894417
  error estimate for blocks of size 2^( 3) =       0.000415915581
  error estimate for blocks of size 2^( 4) =       0.000422058966
  error estimate for blocks of size 2^( 5) =       0.000425511604
  error estimate for blocks of size 2^( 6) =       0.000428034504
  error estimate for blocks of size 2^( 7) =       0.000427266305

      target function =                  N/A
              le_mean =     -17.216989086382
             les_mean =     296.740659221946
             stat err =       0.000425717845
             autocorr =       1.147256685334
              std dev =       0.562090899513
             le_variance =       0.315946179316


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216989086382        initial  <--
     6.2500e+17     6.2500e+18             1.2685e-22       -17.216989086382
     2.5000e+18     2.5000e+19             3.1711e-23       -17.216989086382
     1.0000e+19     1.0000e+20             7.9278e-24       -17.216989086382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4954
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1292
    reference variance = 0.344251
====================================================
  Execution time = 2.0577e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315176678046
                                         uncertainty =       0.003280356243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315176678046
                                         uncertainty =       0.003280356243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396971664
  error estimate for blocks of size 2^( 2) =       0.000406440194
  error estimate for blocks of size 2^( 3) =       0.000414662605
  error estimate for blocks of size 2^( 4) =       0.000421338314
  error estimate for blocks of size 2^( 5) =       0.000424422195
  error estimate for blocks of size 2^( 6) =       0.000426040062
  error estimate for blocks of size 2^( 7) =       0.000426814545

      target function =                  N/A
              le_mean =     -17.216379434887
             les_mean =     296.718893691980
             stat err =       0.000424653779
             autocorr =       1.144329177565
              std dev =       0.561402710700
             le_variance =       0.315173003581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637943489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+18, overlap shift 6.2500e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379434887       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+18 is 5.182453e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+19, overlap shift 2.5000e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379434887       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+19 is 1.295613e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+20, overlap shift 1.0000e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216379434887       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216379434887       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+20 is 3.239033e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.517301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2474
    reference variance = 0.225622
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1718e-01
  Total weights = 2.0000e+06
  Execution time = 1.8748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398235303
  error estimate for blocks of size 2^( 2) =       0.000408115528
  error estimate for blocks of size 2^( 3) =       0.000417185284
  error estimate for blocks of size 2^( 4) =       0.000422877402
  error estimate for blocks of size 2^( 5) =       0.000426950184
  error estimate for blocks of size 2^( 6) =       0.000428726205
  error estimate for blocks of size 2^( 7) =       0.000429868117

      target function =                  N/A
              le_mean =     -17.216018661013
             les_mean =     296.708481090248
             stat err =       0.000427105477
             autocorr =       1.150246095274
              std dev =       0.563189765956
             le_variance =       0.317182712478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398235303
  error estimate for blocks of size 2^( 2) =       0.000408115528
  error estimate for blocks of size 2^( 3) =       0.000417185284
  error estimate for blocks of size 2^( 4) =       0.000422877402
  error estimate for blocks of size 2^( 5) =       0.000426950184
  error estimate for blocks of size 2^( 6) =       0.000428726205
  error estimate for blocks of size 2^( 7) =       0.000429868117

      target function =                  N/A
              le_mean =     -17.216018661013
             les_mean =     296.708481090248
             stat err =       0.000427105477
             autocorr =       1.150246095274
              std dev =       0.563189765956
             le_variance =       0.317182712478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398235303
  error estimate for blocks of size 2^( 2) =       0.000408115528
  error estimate for blocks of size 2^( 3) =       0.000417185284
  error estimate for blocks of size 2^( 4) =       0.000422877402
  error estimate for blocks of size 2^( 5) =       0.000426950184
  error estimate for blocks of size 2^( 6) =       0.000428726205
  error estimate for blocks of size 2^( 7) =       0.000429868117

      target function =                  N/A
              le_mean =     -17.216018661013
             les_mean =     296.708481090248
             stat err =       0.000427105477
             autocorr =       1.150246095274
              std dev =       0.563189765956
             le_variance =       0.317182712478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317033808266
                                         uncertainty =       0.003330906403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398235303
  error estimate for blocks of size 2^( 2) =       0.000408115528
  error estimate for blocks of size 2^( 3) =       0.000417185284
  error estimate for blocks of size 2^( 4) =       0.000422877402
  error estimate for blocks of size 2^( 5) =       0.000426950184
  error estimate for blocks of size 2^( 6) =       0.000428726205
  error estimate for blocks of size 2^( 7) =       0.000429868117

      target function =                  N/A
              le_mean =     -17.216018661013
             les_mean =     296.708481090248
             stat err =       0.000427105477
             autocorr =       1.150246095274
              std dev =       0.563189765956
             le_variance =       0.317182712478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216018661013        initial  <--
     6.2500e+18     6.2500e+19             5.1825e-24       -17.216018661013
     2.5000e+19     2.5000e+20             1.2956e-24       -17.216018661013
     1.0000e+20     1.0000e+21             3.2390e-25       -17.216018661013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6076
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2723
    reference variance = 0.532253
====================================================
  Execution time = 2.0809e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1443e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314155441565
                                         uncertainty =       0.002800850381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314155441565
                                         uncertainty =       0.002800850381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396505864
  error estimate for blocks of size 2^( 2) =       0.000406296749
  error estimate for blocks of size 2^( 3) =       0.000414622398
  error estimate for blocks of size 2^( 4) =       0.000421092737
  error estimate for blocks of size 2^( 5) =       0.000425987639
  error estimate for blocks of size 2^( 6) =       0.000428548719
  error estimate for blocks of size 2^( 7) =       0.000433354076

      target function =                  N/A
              le_mean =     -17.216578751391
             les_mean =     296.725017546600
             stat err =       0.000427245793
             autocorr =       1.161064534137
              std dev =       0.560743970950
             le_variance =       0.314433800957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657875139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+19, overlap shift 6.2500e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+20, overlap shift 2.5000e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+21, overlap shift 1.0000e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216578751391       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518423 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6402e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2099
    reference variance = 0.302318
====================================================
  Execution time = 2.0214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1859e-01
  Total weights = 2.0000e+06
  Execution time = 1.8763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399119699
  error estimate for blocks of size 2^( 2) =       0.000408733056
  error estimate for blocks of size 2^( 3) =       0.000417609994
  error estimate for blocks of size 2^( 4) =       0.000423684978
  error estimate for blocks of size 2^( 5) =       0.000427735449
  error estimate for blocks of size 2^( 6) =       0.000429882859
  error estimate for blocks of size 2^( 7) =       0.000431190779

      target function =                  N/A
              le_mean =     -17.217002562417
             les_mean =     296.743770142446
             stat err =       0.000428123517
             autocorr =       1.150619797661
              std dev =       0.564440490631
             le_variance =       0.318593067464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399119699
  error estimate for blocks of size 2^( 2) =       0.000408733056
  error estimate for blocks of size 2^( 3) =       0.000417609994
  error estimate for blocks of size 2^( 4) =       0.000423684978
  error estimate for blocks of size 2^( 5) =       0.000427735449
  error estimate for blocks of size 2^( 6) =       0.000429882859
  error estimate for blocks of size 2^( 7) =       0.000431190779

      target function =                  N/A
              le_mean =     -17.217002562417
             les_mean =     296.743770142446
             stat err =       0.000428123517
             autocorr =       1.150619797661
              std dev =       0.564440490631
             le_variance =       0.318593067464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399119699
  error estimate for blocks of size 2^( 2) =       0.000408733056
  error estimate for blocks of size 2^( 3) =       0.000417609994
  error estimate for blocks of size 2^( 4) =       0.000423684978
  error estimate for blocks of size 2^( 5) =       0.000427735449
  error estimate for blocks of size 2^( 6) =       0.000429882859
  error estimate for blocks of size 2^( 7) =       0.000431190779

      target function =                  N/A
              le_mean =     -17.217002562417
             les_mean =     296.743770142446
             stat err =       0.000428123517
             autocorr =       1.150619797661
              std dev =       0.564440490631
             le_variance =       0.318593067464

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318618426384
                                         uncertainty =       0.005126996534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399119699
  error estimate for blocks of size 2^( 2) =       0.000408733056
  error estimate for blocks of size 2^( 3) =       0.000417609994
  error estimate for blocks of size 2^( 4) =       0.000423684978
  error estimate for blocks of size 2^( 5) =       0.000427735449
  error estimate for blocks of size 2^( 6) =       0.000429882859
  error estimate for blocks of size 2^( 7) =       0.000431190779

      target function =                  N/A
              le_mean =     -17.217002562417
             les_mean =     296.743770142446
             stat err =       0.000428123517
             autocorr =       1.150619797661
              std dev =       0.564440490631
             le_variance =       0.318593067464


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217002562417        initial  <--
     6.2500e+19     6.2500e+20             0.0000e+00       -17.217002562417
     2.5000e+20     2.5000e+21             0.0000e+00       -17.217002562417
     1.0000e+21     1.0000e+22             0.0000e+00       -17.217002562417

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7188
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6127e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2063
    reference variance = 0.168359
====================================================
  Execution time = 2.0846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319453303505
                                         uncertainty =       0.003954061010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319453303505
                                         uncertainty =       0.003954061010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399676846
  error estimate for blocks of size 2^( 2) =       0.000409220485
  error estimate for blocks of size 2^( 3) =       0.000417503830
  error estimate for blocks of size 2^( 4) =       0.000423350638
  error estimate for blocks of size 2^( 5) =       0.000427491953
  error estimate for blocks of size 2^( 6) =       0.000429846237
  error estimate for blocks of size 2^( 7) =       0.000429918191

      target function =                  N/A
              le_mean =     -17.216793506711
             les_mean =     296.737461655512
             stat err =       0.000427651755
             autocorr =       1.144886771573
              std dev =       0.565228416239
             le_variance =       0.319483162524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679350671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+20, overlap shift 6.2500e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+21, overlap shift 2.5000e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+22, overlap shift 1.0000e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793506711       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.519520 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6331e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1822
    reference variance = 0.264252
====================================================
  Execution time = 2.0178e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1979e-01
  Total weights = 2.0000e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399867880
  error estimate for blocks of size 2^( 2) =       0.000409634902
  error estimate for blocks of size 2^( 3) =       0.000418173830
  error estimate for blocks of size 2^( 4) =       0.000424801198
  error estimate for blocks of size 2^( 5) =       0.000429217770
  error estimate for blocks of size 2^( 6) =       0.000431424094
  error estimate for blocks of size 2^( 7) =       0.000432534589

      target function =                  N/A
              le_mean =     -17.216917402015
             les_mean =     296.742033311350
             stat err =       0.000429494413
             autocorr =       1.153671052881
              std dev =       0.565498579515
             le_variance =       0.319788643433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399867880
  error estimate for blocks of size 2^( 2) =       0.000409634902
  error estimate for blocks of size 2^( 3) =       0.000418173830
  error estimate for blocks of size 2^( 4) =       0.000424801198
  error estimate for blocks of size 2^( 5) =       0.000429217770
  error estimate for blocks of size 2^( 6) =       0.000431424094
  error estimate for blocks of size 2^( 7) =       0.000432534589

      target function =                  N/A
              le_mean =     -17.216917402015
             les_mean =     296.742033311350
             stat err =       0.000429494413
             autocorr =       1.153671052881
              std dev =       0.565498579515
             le_variance =       0.319788643433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399867880
  error estimate for blocks of size 2^( 2) =       0.000409634902
  error estimate for blocks of size 2^( 3) =       0.000418173830
  error estimate for blocks of size 2^( 4) =       0.000424801198
  error estimate for blocks of size 2^( 5) =       0.000429217770
  error estimate for blocks of size 2^( 6) =       0.000431424094
  error estimate for blocks of size 2^( 7) =       0.000432534589

      target function =                  N/A
              le_mean =     -17.216917402015
             les_mean =     296.742033311350
             stat err =       0.000429494413
             autocorr =       1.153671052881
              std dev =       0.565498579515
             le_variance =       0.319788643433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319657089967
                                         uncertainty =       0.003566684428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399867880
  error estimate for blocks of size 2^( 2) =       0.000409634902
  error estimate for blocks of size 2^( 3) =       0.000418173830
  error estimate for blocks of size 2^( 4) =       0.000424801198
  error estimate for blocks of size 2^( 5) =       0.000429217770
  error estimate for blocks of size 2^( 6) =       0.000431424094
  error estimate for blocks of size 2^( 7) =       0.000432534589

      target function =                  N/A
              le_mean =     -17.216917402015
             les_mean =     296.742033311350
             stat err =       0.000429494413
             autocorr =       1.153671052881
              std dev =       0.565498579515
             le_variance =       0.319788643433


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216917402015        initial  <--
     6.2500e+20     6.2500e+21             0.0000e+00       -17.216917402015
     2.5000e+21     2.5000e+22             0.0000e+00       -17.216917402015
     1.0000e+22     1.0000e+23             0.0000e+00       -17.216917402015

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7267
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6063e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1743
    reference variance = 0.168277
====================================================
  Execution time = 2.0435e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2017e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5041e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320268074712
                                         uncertainty =       0.004895166340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320268074712
                                         uncertainty =       0.004895166340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400109041
  error estimate for blocks of size 2^( 2) =       0.000409473269
  error estimate for blocks of size 2^( 3) =       0.000418323384
  error estimate for blocks of size 2^( 4) =       0.000424872734
  error estimate for blocks of size 2^( 5) =       0.000429638148
  error estimate for blocks of size 2^( 6) =       0.000432523140
  error estimate for blocks of size 2^( 7) =       0.000433719251

      target function =                  N/A
              le_mean =     -17.217448041543
             les_mean =     296.760691392528
             stat err =       0.000430188318
             autocorr =       1.156007084651
              std dev =       0.565839632208
             le_variance =       0.320174489377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721744804154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+21, overlap shift 6.2500e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+22, overlap shift 2.5000e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+23, overlap shift 1.0000e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217448041543       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.520629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5949e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.203791
====================================================
  Execution time = 2.0043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278953
  error estimate for blocks of size 2^( 2) =       0.000410189880
  error estimate for blocks of size 2^( 3) =       0.000419388366
  error estimate for blocks of size 2^( 4) =       0.000426367281
  error estimate for blocks of size 2^( 5) =       0.000429733116
  error estimate for blocks of size 2^( 6) =       0.000430790279
  error estimate for blocks of size 2^( 7) =       0.000430891407

      target function =                  N/A
              le_mean =     -17.216618475519
             les_mean =     296.732398051432
             stat err =       0.000429445521
             autocorr =       1.151040606286
              std dev =       0.566079923757
             le_variance =       0.320446480081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278953
  error estimate for blocks of size 2^( 2) =       0.000410189880
  error estimate for blocks of size 2^( 3) =       0.000419388366
  error estimate for blocks of size 2^( 4) =       0.000426367281
  error estimate for blocks of size 2^( 5) =       0.000429733116
  error estimate for blocks of size 2^( 6) =       0.000430790279
  error estimate for blocks of size 2^( 7) =       0.000430891407

      target function =                  N/A
              le_mean =     -17.216618475519
             les_mean =     296.732398051432
             stat err =       0.000429445521
             autocorr =       1.151040606286
              std dev =       0.566079923757
             le_variance =       0.320446480081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278953
  error estimate for blocks of size 2^( 2) =       0.000410189880
  error estimate for blocks of size 2^( 3) =       0.000419388366
  error estimate for blocks of size 2^( 4) =       0.000426367281
  error estimate for blocks of size 2^( 5) =       0.000429733116
  error estimate for blocks of size 2^( 6) =       0.000430790279
  error estimate for blocks of size 2^( 7) =       0.000430891407

      target function =                  N/A
              le_mean =     -17.216618475519
             les_mean =     296.732398051432
             stat err =       0.000429445521
             autocorr =       1.151040606286
              std dev =       0.566079923757
             le_variance =       0.320446480081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320098487228
                                         uncertainty =       0.004494734046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400278953
  error estimate for blocks of size 2^( 2) =       0.000410189880
  error estimate for blocks of size 2^( 3) =       0.000419388366
  error estimate for blocks of size 2^( 4) =       0.000426367281
  error estimate for blocks of size 2^( 5) =       0.000429733116
  error estimate for blocks of size 2^( 6) =       0.000430790279
  error estimate for blocks of size 2^( 7) =       0.000430891407

      target function =                  N/A
              le_mean =     -17.216618475519
             les_mean =     296.732398051432
             stat err =       0.000429445521
             autocorr =       1.151040606286
              std dev =       0.566079923757
             le_variance =       0.320446480081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216618475519        initial  <--
     6.2500e+21     6.2500e+22             0.0000e+00       -17.216618475519
     2.5000e+22     2.5000e+23             0.0000e+00       -17.216618475519
     1.0000e+23     1.0000e+24             0.0000e+00       -17.216618475519

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5470
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5502e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2837
    reference variance = 0.255753
====================================================
  Execution time = 2.2573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318978720782
                                         uncertainty =       0.003560601902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318978720782
                                         uncertainty =       0.003560601902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399361401
  error estimate for blocks of size 2^( 2) =       0.000409147417
  error estimate for blocks of size 2^( 3) =       0.000417495799
  error estimate for blocks of size 2^( 4) =       0.000423495652
  error estimate for blocks of size 2^( 5) =       0.000426817746
  error estimate for blocks of size 2^( 6) =       0.000429197839
  error estimate for blocks of size 2^( 7) =       0.000429711906

      target function =                  N/A
              le_mean =     -17.217571240532
             les_mean =     296.763738320496
             stat err =       0.000427305786
             autocorr =       1.144841522242
              std dev =       0.564782309557
             le_variance =       0.318979057189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721757124053e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+22, overlap shift 6.2500e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571240532       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571240532       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571240532       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+23, overlap shift 2.5000e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571240532       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571240532       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571240532       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+23 is 6.367595e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+24, overlap shift 1.0000e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217571240532       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217571240532       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217571240532       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.521974 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8158e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.161481
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1510e-01
  Total weights = 2.0000e+06
  Execution time = 1.8758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396928298
  error estimate for blocks of size 2^( 2) =       0.000407052283
  error estimate for blocks of size 2^( 3) =       0.000415915712
  error estimate for blocks of size 2^( 4) =       0.000422514543
  error estimate for blocks of size 2^( 5) =       0.000427340000
  error estimate for blocks of size 2^( 6) =       0.000428132857
  error estimate for blocks of size 2^( 7) =       0.000430431822

      target function =                  N/A
              le_mean =     -17.217482162101
             les_mean =     296.756795992170
             stat err =       0.000427104806
             autocorr =       1.157829984281
              std dev =       0.561341382268
             le_variance =       0.315104147447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396928298
  error estimate for blocks of size 2^( 2) =       0.000407052283
  error estimate for blocks of size 2^( 3) =       0.000415915712
  error estimate for blocks of size 2^( 4) =       0.000422514543
  error estimate for blocks of size 2^( 5) =       0.000427340000
  error estimate for blocks of size 2^( 6) =       0.000428132857
  error estimate for blocks of size 2^( 7) =       0.000430431822

      target function =                  N/A
              le_mean =     -17.217482162101
             les_mean =     296.756795992170
             stat err =       0.000427104806
             autocorr =       1.157829984281
              std dev =       0.561341382268
             le_variance =       0.315104147447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396928298
  error estimate for blocks of size 2^( 2) =       0.000407052283
  error estimate for blocks of size 2^( 3) =       0.000415915712
  error estimate for blocks of size 2^( 4) =       0.000422514543
  error estimate for blocks of size 2^( 5) =       0.000427340000
  error estimate for blocks of size 2^( 6) =       0.000428132857
  error estimate for blocks of size 2^( 7) =       0.000430431822

      target function =                  N/A
              le_mean =     -17.217482162101
             les_mean =     296.756795992170
             stat err =       0.000427104806
             autocorr =       1.157829984281
              std dev =       0.561341382268
             le_variance =       0.315104147447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315007003515
                                         uncertainty =       0.003038360281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396928298
  error estimate for blocks of size 2^( 2) =       0.000407052283
  error estimate for blocks of size 2^( 3) =       0.000415915712
  error estimate for blocks of size 2^( 4) =       0.000422514543
  error estimate for blocks of size 2^( 5) =       0.000427340000
  error estimate for blocks of size 2^( 6) =       0.000428132857
  error estimate for blocks of size 2^( 7) =       0.000430431822

      target function =                  N/A
              le_mean =     -17.217482162101
             les_mean =     296.756795992170
             stat err =       0.000427104806
             autocorr =       1.157829984281
              std dev =       0.561341382268
             le_variance =       0.315104147447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217482162101        initial  <--
     6.2500e+22     6.2500e+23             0.0000e+00       -17.217482162101
     2.5000e+23     2.5000e+24             6.3676e-28       -17.217482162101
     1.0000e+24     1.0000e+25             0.0000e+00       -17.217482162101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4191
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7584e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.3016
    reference variance = 0.374133
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5469e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329293090124
                                         uncertainty =       0.008996901062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329293090124
                                         uncertainty =       0.008996901062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405718967
  error estimate for blocks of size 2^( 2) =       0.000414684525
  error estimate for blocks of size 2^( 3) =       0.000423368266
  error estimate for blocks of size 2^( 4) =       0.000429621290
  error estimate for blocks of size 2^( 5) =       0.000434833385
  error estimate for blocks of size 2^( 6) =       0.000436458500
  error estimate for blocks of size 2^( 7) =       0.000438378656

      target function =                  N/A
              le_mean =     -17.216339436922
             les_mean =     296.731559202399
             stat err =       0.000434822958
             autocorr =       1.148614544050
              std dev =       0.573773265066
             le_variance =       0.329215759704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633943692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+23, overlap shift 6.2500e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339436922       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339436922       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339436922       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+23 is 3.834658e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+24, overlap shift 2.5000e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339436922       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339436922       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339436922       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+24 is 9.586645e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+25, overlap shift 1.0000e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216339436922       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216339436922       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216339436920       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+25 is 2.396661e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.523397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6113e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2379
    reference variance = 0.128659
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1376e-01
  Total weights = 2.0000e+06
  Execution time = 1.8738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396081546
  error estimate for blocks of size 2^( 2) =       0.000405911414
  error estimate for blocks of size 2^( 3) =       0.000414764157
  error estimate for blocks of size 2^( 4) =       0.000421493192
  error estimate for blocks of size 2^( 5) =       0.000424902295
  error estimate for blocks of size 2^( 6) =       0.000426367602
  error estimate for blocks of size 2^( 7) =       0.000426604355

      target function =                  N/A
              le_mean =     -17.217167568536
             les_mean =     296.744620108269
             stat err =       0.000424841861
             autocorr =       1.150496730153
              std dev =       0.560143894111
             le_variance =       0.313761182110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396081546
  error estimate for blocks of size 2^( 2) =       0.000405911414
  error estimate for blocks of size 2^( 3) =       0.000414764157
  error estimate for blocks of size 2^( 4) =       0.000421493192
  error estimate for blocks of size 2^( 5) =       0.000424902295
  error estimate for blocks of size 2^( 6) =       0.000426367602
  error estimate for blocks of size 2^( 7) =       0.000426604355

      target function =                  N/A
              le_mean =     -17.217167568536
             les_mean =     296.744620108269
             stat err =       0.000424841861
             autocorr =       1.150496730153
              std dev =       0.560143894111
             le_variance =       0.313761182110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396081546
  error estimate for blocks of size 2^( 2) =       0.000405911414
  error estimate for blocks of size 2^( 3) =       0.000414764157
  error estimate for blocks of size 2^( 4) =       0.000421493192
  error estimate for blocks of size 2^( 5) =       0.000424902295
  error estimate for blocks of size 2^( 6) =       0.000426367602
  error estimate for blocks of size 2^( 7) =       0.000426604355

      target function =                  N/A
              le_mean =     -17.217167568536
             les_mean =     296.744620108269
             stat err =       0.000424841861
             autocorr =       1.150496730153
              std dev =       0.560143894111
             le_variance =       0.313761182110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313806127426
                                         uncertainty =       0.002596160296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396081546
  error estimate for blocks of size 2^( 2) =       0.000405911414
  error estimate for blocks of size 2^( 3) =       0.000414764157
  error estimate for blocks of size 2^( 4) =       0.000421493192
  error estimate for blocks of size 2^( 5) =       0.000424902295
  error estimate for blocks of size 2^( 6) =       0.000426367602
  error estimate for blocks of size 2^( 7) =       0.000426604355

      target function =                  N/A
              le_mean =     -17.217167568536
             les_mean =     296.744620108269
             stat err =       0.000424841861
             autocorr =       1.150496730153
              std dev =       0.560143894111
             le_variance =       0.313761182110


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217167568536        initial  <--
     6.2500e+23     6.2500e+24             3.8347e-29       -17.217167568536
     2.5000e+24     2.5000e+25             9.5866e-30       -17.217167568536
     1.0000e+25     1.0000e+26             2.3967e-30       -17.217167568536

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6565
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.240795
====================================================
  Execution time = 2.0784e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1594e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5300e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316018632773
                                         uncertainty =       0.002655924836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316018632773
                                         uncertainty =       0.002655924836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397452862
  error estimate for blocks of size 2^( 2) =       0.000407667807
  error estimate for blocks of size 2^( 3) =       0.000416801528
  error estimate for blocks of size 2^( 4) =       0.000422879047
  error estimate for blocks of size 2^( 5) =       0.000426791408
  error estimate for blocks of size 2^( 6) =       0.000428353290
  error estimate for blocks of size 2^( 7) =       0.000430282835

      target function =                  N/A
              le_mean =     -17.216849004598
             les_mean =     296.735827044810
             stat err =       0.000427076645
             autocorr =       1.154623483512
              std dev =       0.562083228409
             le_variance =       0.315937555658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721684900460e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+24, overlap shift 6.2500e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+24 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.5000e+25, overlap shift 2.5000e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+25 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.0000e+26, overlap shift 1.0000e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216849004598       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+26 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.524398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6324e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.304514
====================================================
  Execution time = 2.0034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1883e-01
  Total weights = 2.0000e+06
  Execution time = 1.8782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399270316
  error estimate for blocks of size 2^( 2) =       0.000409226491
  error estimate for blocks of size 2^( 3) =       0.000418269532
  error estimate for blocks of size 2^( 4) =       0.000424942661
  error estimate for blocks of size 2^( 5) =       0.000428311560
  error estimate for blocks of size 2^( 6) =       0.000429805505
  error estimate for blocks of size 2^( 7) =       0.000431896670

      target function =                  N/A
              le_mean =     -17.216433104166
             les_mean =     296.724402241155
             stat err =       0.000428739099
             autocorr =       1.153060606789
              std dev =       0.564653495837
             le_variance =       0.318833570361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399270316
  error estimate for blocks of size 2^( 2) =       0.000409226491
  error estimate for blocks of size 2^( 3) =       0.000418269532
  error estimate for blocks of size 2^( 4) =       0.000424942661
  error estimate for blocks of size 2^( 5) =       0.000428311560
  error estimate for blocks of size 2^( 6) =       0.000429805505
  error estimate for blocks of size 2^( 7) =       0.000431896670

      target function =                  N/A
              le_mean =     -17.216433104166
             les_mean =     296.724402241155
             stat err =       0.000428739099
             autocorr =       1.153060606789
              std dev =       0.564653495837
             le_variance =       0.318833570361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399270316
  error estimate for blocks of size 2^( 2) =       0.000409226491
  error estimate for blocks of size 2^( 3) =       0.000418269532
  error estimate for blocks of size 2^( 4) =       0.000424942661
  error estimate for blocks of size 2^( 5) =       0.000428311560
  error estimate for blocks of size 2^( 6) =       0.000429805505
  error estimate for blocks of size 2^( 7) =       0.000431896670

      target function =                  N/A
              le_mean =     -17.216433104166
             les_mean =     296.724402241155
             stat err =       0.000428739099
             autocorr =       1.153060606789
              std dev =       0.564653495837
             le_variance =       0.318833570361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318814473920
                                         uncertainty =       0.003762495058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399270316
  error estimate for blocks of size 2^( 2) =       0.000409226491
  error estimate for blocks of size 2^( 3) =       0.000418269532
  error estimate for blocks of size 2^( 4) =       0.000424942661
  error estimate for blocks of size 2^( 5) =       0.000428311560
  error estimate for blocks of size 2^( 6) =       0.000429805505
  error estimate for blocks of size 2^( 7) =       0.000431896670

      target function =                  N/A
              le_mean =     -17.216433104166
             les_mean =     296.724402241155
             stat err =       0.000428739099
             autocorr =       1.153060606789
              std dev =       0.564653495837
             le_variance =       0.318833570361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216433104166        initial  <--
     6.2500e+24     6.2500e+25             0.0000e+00       -17.216433104166
     2.5000e+25     2.5000e+26             0.0000e+00       -17.216433104166
     1.0000e+26     1.0000e+27             0.0000e+00       -17.216433104166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6318
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5962e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1829
    reference variance = 0.308305
====================================================
  Execution time = 2.0368e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1964e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319765284844
                                         uncertainty =       0.005409645510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319765284844
                                         uncertainty =       0.005409645510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399775339
  error estimate for blocks of size 2^( 2) =       0.000409607093
  error estimate for blocks of size 2^( 3) =       0.000418504342
  error estimate for blocks of size 2^( 4) =       0.000424175391
  error estimate for blocks of size 2^( 5) =       0.000427731598
  error estimate for blocks of size 2^( 6) =       0.000429967544
  error estimate for blocks of size 2^( 7) =       0.000432658988

      target function =                  N/A
              le_mean =     -17.216681991514
             les_mean =     296.733779279794
             stat err =       0.000428633381
             autocorr =       1.149582064311
              std dev =       0.565367705732
             le_variance =       0.319640642685


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668199151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+25, overlap shift 6.2500e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+26, overlap shift 2.5000e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+27, overlap shift 1.0000e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216681991514       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.525453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5922e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.195749
====================================================
  Execution time = 2.0144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399642175
  error estimate for blocks of size 2^( 2) =       0.000409702021
  error estimate for blocks of size 2^( 3) =       0.000418584808
  error estimate for blocks of size 2^( 4) =       0.000424322047
  error estimate for blocks of size 2^( 5) =       0.000428729608
  error estimate for blocks of size 2^( 6) =       0.000430362344
  error estimate for blocks of size 2^( 7) =       0.000430670731

      target function =                  N/A
              le_mean =     -17.216869665657
             les_mean =     296.740028661382
             stat err =       0.000428521183
             autocorr =       1.149746141344
              std dev =       0.565179384675
             le_variance =       0.319427736861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399642175
  error estimate for blocks of size 2^( 2) =       0.000409702021
  error estimate for blocks of size 2^( 3) =       0.000418584808
  error estimate for blocks of size 2^( 4) =       0.000424322047
  error estimate for blocks of size 2^( 5) =       0.000428729608
  error estimate for blocks of size 2^( 6) =       0.000430362344
  error estimate for blocks of size 2^( 7) =       0.000430670731

      target function =                  N/A
              le_mean =     -17.216869665657
             les_mean =     296.740028661382
             stat err =       0.000428521183
             autocorr =       1.149746141344
              std dev =       0.565179384675
             le_variance =       0.319427736861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399642175
  error estimate for blocks of size 2^( 2) =       0.000409702021
  error estimate for blocks of size 2^( 3) =       0.000418584808
  error estimate for blocks of size 2^( 4) =       0.000424322047
  error estimate for blocks of size 2^( 5) =       0.000428729608
  error estimate for blocks of size 2^( 6) =       0.000430362344
  error estimate for blocks of size 2^( 7) =       0.000430670731

      target function =                  N/A
              le_mean =     -17.216869665657
             les_mean =     296.740028661382
             stat err =       0.000428521183
             autocorr =       1.149746141344
              std dev =       0.565179384675
             le_variance =       0.319427736861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418918785
                                         uncertainty =       0.004487695511

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399642175
  error estimate for blocks of size 2^( 2) =       0.000409702021
  error estimate for blocks of size 2^( 3) =       0.000418584808
  error estimate for blocks of size 2^( 4) =       0.000424322047
  error estimate for blocks of size 2^( 5) =       0.000428729608
  error estimate for blocks of size 2^( 6) =       0.000430362344
  error estimate for blocks of size 2^( 7) =       0.000430670731

      target function =                  N/A
              le_mean =     -17.216869665657
             les_mean =     296.740028661382
             stat err =       0.000428521183
             autocorr =       1.149746141344
              std dev =       0.565179384675
             le_variance =       0.319427736861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216869665657        initial  <--
     6.2500e+25     6.2500e+26             0.0000e+00       -17.216869665657
     2.5000e+26     2.5000e+27             0.0000e+00       -17.216869665657
     1.0000e+27     1.0000e+28             0.0000e+00       -17.216869665657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6365
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5564e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.291626
====================================================
  Execution time = 2.0236e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1865e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318646538213
                                         uncertainty =       0.004193147994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318646538213
                                         uncertainty =       0.004193147994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399156333
  error estimate for blocks of size 2^( 2) =       0.000408516029
  error estimate for blocks of size 2^( 3) =       0.000417431266
  error estimate for blocks of size 2^( 4) =       0.000423979958
  error estimate for blocks of size 2^( 5) =       0.000427651575
  error estimate for blocks of size 2^( 6) =       0.000429049057
  error estimate for blocks of size 2^( 7) =       0.000431589977

      target function =                  N/A
              le_mean =     -17.216906031253
             les_mean =     296.740504685358
             stat err =       0.000428067642
             autocorr =       1.150108339648
              std dev =       0.564492299047
             le_variance =       0.318651555684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690603125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+26, overlap shift 6.2500e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906031253       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906031253       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906031244       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+26 is 4.831975e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+27, overlap shift 2.5000e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906031253       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906031253       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906031252       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+27 is 1.207994e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+28, overlap shift 1.0000e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216906031253       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216906031253       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216906031361       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+28 is 3.019984e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.526802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5726e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2079
    reference variance = 0.187666
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2442e-01
  Total weights = 2.0000e+06
  Execution time = 1.8837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402754524
  error estimate for blocks of size 2^( 2) =       0.000412641208
  error estimate for blocks of size 2^( 3) =       0.000421867117
  error estimate for blocks of size 2^( 4) =       0.000427979064
  error estimate for blocks of size 2^( 5) =       0.000432591325
  error estimate for blocks of size 2^( 6) =       0.000434182406
  error estimate for blocks of size 2^( 7) =       0.000436284856

      target function =                  N/A
              le_mean =     -17.216865589978
             les_mean =     296.744882993820
             stat err =       0.000432759413
             autocorr =       1.154548526180
              std dev =       0.569580909685
             le_variance =       0.324422412678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402754524
  error estimate for blocks of size 2^( 2) =       0.000412641208
  error estimate for blocks of size 2^( 3) =       0.000421867117
  error estimate for blocks of size 2^( 4) =       0.000427979064
  error estimate for blocks of size 2^( 5) =       0.000432591325
  error estimate for blocks of size 2^( 6) =       0.000434182406
  error estimate for blocks of size 2^( 7) =       0.000436284856

      target function =                  N/A
              le_mean =     -17.216865589978
             les_mean =     296.744882993820
             stat err =       0.000432759413
             autocorr =       1.154548526180
              std dev =       0.569580909685
             le_variance =       0.324422412678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402754524
  error estimate for blocks of size 2^( 2) =       0.000412641208
  error estimate for blocks of size 2^( 3) =       0.000421867117
  error estimate for blocks of size 2^( 4) =       0.000427979064
  error estimate for blocks of size 2^( 5) =       0.000432591325
  error estimate for blocks of size 2^( 6) =       0.000434182406
  error estimate for blocks of size 2^( 7) =       0.000436284856

      target function =                  N/A
              le_mean =     -17.216865589978
             les_mean =     296.744882993820
             stat err =       0.000432759413
             autocorr =       1.154548526180
              std dev =       0.569580909685
             le_variance =       0.324422412678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492814631
                                         uncertainty =       0.009189818096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402754524
  error estimate for blocks of size 2^( 2) =       0.000412641208
  error estimate for blocks of size 2^( 3) =       0.000421867117
  error estimate for blocks of size 2^( 4) =       0.000427979064
  error estimate for blocks of size 2^( 5) =       0.000432591325
  error estimate for blocks of size 2^( 6) =       0.000434182406
  error estimate for blocks of size 2^( 7) =       0.000436284856

      target function =                  N/A
              le_mean =     -17.216865589978
             les_mean =     296.744882993820
             stat err =       0.000432759413
             autocorr =       1.154548526180
              std dev =       0.569580909685
             le_variance =       0.324422412678


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216865589978        initial  <--
     6.2500e+26     6.2500e+27             4.8320e-32       -17.216865589978
     2.5000e+27     2.5000e+28             1.2080e-32       -17.216865589978
     1.0000e+28     1.0000e+29             3.0200e-33       -17.216865589978

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5211
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5253e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1926
    reference variance = 0.281023
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1170e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311757828727
                                         uncertainty =       0.003251928409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311757828727
                                         uncertainty =       0.003251928409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394780453
  error estimate for blocks of size 2^( 2) =       0.000404313628
  error estimate for blocks of size 2^( 3) =       0.000413128146
  error estimate for blocks of size 2^( 4) =       0.000419465003
  error estimate for blocks of size 2^( 5) =       0.000423947319
  error estimate for blocks of size 2^( 6) =       0.000425411694
  error estimate for blocks of size 2^( 7) =       0.000425903580

      target function =                  N/A
              le_mean =     -17.216528651730
             les_mean =     296.720561871553
             stat err =       0.000423681899
             autocorr =       1.151777364501
              std dev =       0.558303870290
             le_variance =       0.311703211580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652865173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+27, overlap shift 6.2500e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+28, overlap shift 2.5000e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+29, overlap shift 1.0000e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216528651730       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.527921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5798e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1654
    reference variance = 0.198557
====================================================
  Execution time = 2.1995e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1369e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396036193
  error estimate for blocks of size 2^( 2) =       0.000405884475
  error estimate for blocks of size 2^( 3) =       0.000414664558
  error estimate for blocks of size 2^( 4) =       0.000421044039
  error estimate for blocks of size 2^( 5) =       0.000425086157
  error estimate for blocks of size 2^( 6) =       0.000428388372
  error estimate for blocks of size 2^( 7) =       0.000428213590

      target function =                  N/A
              le_mean =     -17.216484060000
             les_mean =     296.721012562931
             stat err =       0.000425683040
             autocorr =       1.155321727007
              std dev =       0.560079754639
             le_variance =       0.313689331556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396036193
  error estimate for blocks of size 2^( 2) =       0.000405884475
  error estimate for blocks of size 2^( 3) =       0.000414664558
  error estimate for blocks of size 2^( 4) =       0.000421044039
  error estimate for blocks of size 2^( 5) =       0.000425086157
  error estimate for blocks of size 2^( 6) =       0.000428388372
  error estimate for blocks of size 2^( 7) =       0.000428213590

      target function =                  N/A
              le_mean =     -17.216484060000
             les_mean =     296.721012562931
             stat err =       0.000425683040
             autocorr =       1.155321727007
              std dev =       0.560079754639
             le_variance =       0.313689331556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396036193
  error estimate for blocks of size 2^( 2) =       0.000405884475
  error estimate for blocks of size 2^( 3) =       0.000414664558
  error estimate for blocks of size 2^( 4) =       0.000421044039
  error estimate for blocks of size 2^( 5) =       0.000425086157
  error estimate for blocks of size 2^( 6) =       0.000428388372
  error estimate for blocks of size 2^( 7) =       0.000428213590

      target function =                  N/A
              le_mean =     -17.216484060000
             les_mean =     296.721012562931
             stat err =       0.000425683040
             autocorr =       1.155321727007
              std dev =       0.560079754639
             le_variance =       0.313689331556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662434461
                                         uncertainty =       0.002765385134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396036193
  error estimate for blocks of size 2^( 2) =       0.000405884475
  error estimate for blocks of size 2^( 3) =       0.000414664558
  error estimate for blocks of size 2^( 4) =       0.000421044039
  error estimate for blocks of size 2^( 5) =       0.000425086157
  error estimate for blocks of size 2^( 6) =       0.000428388372
  error estimate for blocks of size 2^( 7) =       0.000428213590

      target function =                  N/A
              le_mean =     -17.216484060000
             les_mean =     296.721012562931
             stat err =       0.000425683040
             autocorr =       1.155321727007
              std dev =       0.560079754639
             le_variance =       0.313689331556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216484060000        initial  <--
     6.2500e+27     6.2500e+28             0.0000e+00       -17.216484060000
     2.5000e+28     2.5000e+29             0.0000e+00       -17.216484060000
     1.0000e+29     1.0000e+30             0.0000e+00       -17.216484060000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4665
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7270e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1824
    reference variance = 0.176909
====================================================
  Execution time = 2.0266e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5655e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311026322238
                                         uncertainty =       0.002371723470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311026322238
                                         uncertainty =       0.002371723470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394566866
  error estimate for blocks of size 2^( 2) =       0.000404193027
  error estimate for blocks of size 2^( 3) =       0.000412556357
  error estimate for blocks of size 2^( 4) =       0.000419052585
  error estimate for blocks of size 2^( 5) =       0.000423193506
  error estimate for blocks of size 2^( 6) =       0.000425606867
  error estimate for blocks of size 2^( 7) =       0.000428927810

      target function =                  N/A
              le_mean =     -17.216606115250
             les_mean =     296.722891995528
             stat err =       0.000424195192
             autocorr =       1.155820142581
              std dev =       0.558001813206
             le_variance =       0.311366023541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660611525e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+28, overlap shift 6.2500e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+29, overlap shift 2.5000e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+30, overlap shift 1.0000e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606115250       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.529035 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5842e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.339534
====================================================
  Execution time = 1.9947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2309e-01
  Total weights = 2.0000e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401926394
  error estimate for blocks of size 2^( 2) =       0.000411048070
  error estimate for blocks of size 2^( 3) =       0.000419462793
  error estimate for blocks of size 2^( 4) =       0.000425602927
  error estimate for blocks of size 2^( 5) =       0.000431651560
  error estimate for blocks of size 2^( 6) =       0.000433151657
  error estimate for blocks of size 2^( 7) =       0.000436470448

      target function =                  N/A
              le_mean =     -17.216579182573
             les_mean =     296.733688240901
             stat err =       0.000431719148
             autocorr =       1.153744301842
              std dev =       0.568409757688
             le_variance =       0.323089652635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401926394
  error estimate for blocks of size 2^( 2) =       0.000411048070
  error estimate for blocks of size 2^( 3) =       0.000419462793
  error estimate for blocks of size 2^( 4) =       0.000425602927
  error estimate for blocks of size 2^( 5) =       0.000431651560
  error estimate for blocks of size 2^( 6) =       0.000433151657
  error estimate for blocks of size 2^( 7) =       0.000436470448

      target function =                  N/A
              le_mean =     -17.216579182573
             les_mean =     296.733688240901
             stat err =       0.000431719148
             autocorr =       1.153744301842
              std dev =       0.568409757688
             le_variance =       0.323089652635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401926394
  error estimate for blocks of size 2^( 2) =       0.000411048070
  error estimate for blocks of size 2^( 3) =       0.000419462793
  error estimate for blocks of size 2^( 4) =       0.000425602927
  error estimate for blocks of size 2^( 5) =       0.000431651560
  error estimate for blocks of size 2^( 6) =       0.000433151657
  error estimate for blocks of size 2^( 7) =       0.000436470448

      target function =                  N/A
              le_mean =     -17.216579182573
             les_mean =     296.733688240901
             stat err =       0.000431719148
             autocorr =       1.153744301842
              std dev =       0.568409757688
             le_variance =       0.323089652635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322954087351
                                         uncertainty =       0.005915163306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401926394
  error estimate for blocks of size 2^( 2) =       0.000411048070
  error estimate for blocks of size 2^( 3) =       0.000419462793
  error estimate for blocks of size 2^( 4) =       0.000425602927
  error estimate for blocks of size 2^( 5) =       0.000431651560
  error estimate for blocks of size 2^( 6) =       0.000433151657
  error estimate for blocks of size 2^( 7) =       0.000436470448

      target function =                  N/A
              le_mean =     -17.216579182573
             les_mean =     296.733688240901
             stat err =       0.000431719148
             autocorr =       1.153744301842
              std dev =       0.568409757688
             le_variance =       0.323089652635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216579182573        initial  <--
     6.2500e+28     6.2500e+29             0.0000e+00       -17.216579182573
     2.5000e+29     2.5000e+30             0.0000e+00       -17.216579182573
     1.0000e+30     1.0000e+31             0.0000e+00       -17.216579182573

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5362
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.233197
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315872685230
                                         uncertainty =       0.003192603293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315872685230
                                         uncertainty =       0.003192603293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397363392
  error estimate for blocks of size 2^( 2) =       0.000407052905
  error estimate for blocks of size 2^( 3) =       0.000415699704
  error estimate for blocks of size 2^( 4) =       0.000421810963
  error estimate for blocks of size 2^( 5) =       0.000426080274
  error estimate for blocks of size 2^( 6) =       0.000428980427
  error estimate for blocks of size 2^( 7) =       0.000431944283

      target function =                  N/A
              le_mean =     -17.216513512225
             les_mean =     296.724132689684
             stat err =       0.000427203987
             autocorr =       1.155832455880
              std dev =       0.561956698481
             le_variance =       0.315795330967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651351222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+29, overlap shift 6.2500e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513512225       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513512225       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216513512220       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+29 is 4.475272e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+30, overlap shift 2.5000e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513512225       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513512225       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216513512249       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+30 is 1.118818e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+31, overlap shift 1.0000e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216513512225       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216513512225       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216513512190       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+31 is 2.797045e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.530407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5753e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.318814
====================================================
  Execution time = 2.0264e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1783e-01
  Total weights = 2.0000e+06
  Execution time = 1.8692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398644135
  error estimate for blocks of size 2^( 2) =       0.000408413365
  error estimate for blocks of size 2^( 3) =       0.000417017315
  error estimate for blocks of size 2^( 4) =       0.000423290709
  error estimate for blocks of size 2^( 5) =       0.000429101052
  error estimate for blocks of size 2^( 6) =       0.000431182570
  error estimate for blocks of size 2^( 7) =       0.000430301378

      target function =                  N/A
              le_mean =     -17.217042072968
             les_mean =     296.744371876279
             stat err =       0.000428468927
             autocorr =       1.155228530000
              std dev =       0.563767942368
             le_variance =       0.317834292842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398644135
  error estimate for blocks of size 2^( 2) =       0.000408413365
  error estimate for blocks of size 2^( 3) =       0.000417017315
  error estimate for blocks of size 2^( 4) =       0.000423290709
  error estimate for blocks of size 2^( 5) =       0.000429101052
  error estimate for blocks of size 2^( 6) =       0.000431182570
  error estimate for blocks of size 2^( 7) =       0.000430301378

      target function =                  N/A
              le_mean =     -17.217042072968
             les_mean =     296.744371876279
             stat err =       0.000428468927
             autocorr =       1.155228530000
              std dev =       0.563767942368
             le_variance =       0.317834292842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398644135
  error estimate for blocks of size 2^( 2) =       0.000408413365
  error estimate for blocks of size 2^( 3) =       0.000417017315
  error estimate for blocks of size 2^( 4) =       0.000423290709
  error estimate for blocks of size 2^( 5) =       0.000429101052
  error estimate for blocks of size 2^( 6) =       0.000431182570
  error estimate for blocks of size 2^( 7) =       0.000430301378

      target function =                  N/A
              le_mean =     -17.217042072968
             les_mean =     296.744371876279
             stat err =       0.000428468927
             autocorr =       1.155228530000
              std dev =       0.563767942368
             le_variance =       0.317834292842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611111499
                                         uncertainty =       0.003866270352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398644135
  error estimate for blocks of size 2^( 2) =       0.000408413365
  error estimate for blocks of size 2^( 3) =       0.000417017315
  error estimate for blocks of size 2^( 4) =       0.000423290709
  error estimate for blocks of size 2^( 5) =       0.000429101052
  error estimate for blocks of size 2^( 6) =       0.000431182570
  error estimate for blocks of size 2^( 7) =       0.000430301378

      target function =                  N/A
              le_mean =     -17.217042072968
             les_mean =     296.744371876279
             stat err =       0.000428468927
             autocorr =       1.155228530000
              std dev =       0.563767942368
             le_variance =       0.317834292842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217042072968        initial  <--
     6.2500e+29     6.2500e+30             4.4753e-35       -17.217042072968
     2.5000e+30     2.5000e+31             1.1188e-35       -17.217042072968
     1.0000e+31     1.0000e+32             2.7970e-36       -17.217042072968

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7393
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1923
    reference variance = 0.280234
====================================================
  Execution time = 2.0226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1758e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611921469
                                         uncertainty =       0.004678213219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611921469
                                         uncertainty =       0.004678213219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398486152
  error estimate for blocks of size 2^( 2) =       0.000408033082
  error estimate for blocks of size 2^( 3) =       0.000416658428
  error estimate for blocks of size 2^( 4) =       0.000423763722
  error estimate for blocks of size 2^( 5) =       0.000427450053
  error estimate for blocks of size 2^( 6) =       0.000429073494
  error estimate for blocks of size 2^( 7) =       0.000430796213

      target function =                  N/A
              le_mean =     -17.216718629561
             les_mean =     296.732982636804
             stat err =       0.000427770871
             autocorr =       1.152380627172
              std dev =       0.563544520098
             le_variance =       0.317582426132


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671862956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+30, overlap shift 6.2500e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+31, overlap shift 2.5000e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+32, overlap shift 1.0000e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718629561       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.531515 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5769e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2848
    reference variance = 0.483617
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4984e-01
  Total weights = 2.0000e+06
  Execution time = 1.8929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418237189
  error estimate for blocks of size 2^( 2) =       0.000427696572
  error estimate for blocks of size 2^( 3) =       0.000436036236
  error estimate for blocks of size 2^( 4) =       0.000442527350
  error estimate for blocks of size 2^( 5) =       0.000446001778
  error estimate for blocks of size 2^( 6) =       0.000448721408
  error estimate for blocks of size 2^( 7) =       0.000448223690

      target function =                  N/A
              le_mean =     -17.216209445798
             les_mean =     296.747712199544
             stat err =       0.000446368557
             autocorr =       1.139047653893
              std dev =       0.591476705275
             le_variance =       0.349844692882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418237189
  error estimate for blocks of size 2^( 2) =       0.000427696572
  error estimate for blocks of size 2^( 3) =       0.000436036236
  error estimate for blocks of size 2^( 4) =       0.000442527350
  error estimate for blocks of size 2^( 5) =       0.000446001778
  error estimate for blocks of size 2^( 6) =       0.000448721408
  error estimate for blocks of size 2^( 7) =       0.000448223690

      target function =                  N/A
              le_mean =     -17.216209445798
             les_mean =     296.747712199544
             stat err =       0.000446368557
             autocorr =       1.139047653893
              std dev =       0.591476705275
             le_variance =       0.349844692882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418237189
  error estimate for blocks of size 2^( 2) =       0.000427696572
  error estimate for blocks of size 2^( 3) =       0.000436036236
  error estimate for blocks of size 2^( 4) =       0.000442527350
  error estimate for blocks of size 2^( 5) =       0.000446001778
  error estimate for blocks of size 2^( 6) =       0.000448721408
  error estimate for blocks of size 2^( 7) =       0.000448223690

      target function =                  N/A
              le_mean =     -17.216209445798
             les_mean =     296.747712199544
             stat err =       0.000446368557
             autocorr =       1.139047653893
              std dev =       0.591476705275
             le_variance =       0.349844692882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349874562445
                                         uncertainty =       0.033132161637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418237189
  error estimate for blocks of size 2^( 2) =       0.000427696572
  error estimate for blocks of size 2^( 3) =       0.000436036236
  error estimate for blocks of size 2^( 4) =       0.000442527350
  error estimate for blocks of size 2^( 5) =       0.000446001778
  error estimate for blocks of size 2^( 6) =       0.000448721408
  error estimate for blocks of size 2^( 7) =       0.000448223690

      target function =                  N/A
              le_mean =     -17.216209445798
             les_mean =     296.747712199544
             stat err =       0.000446368557
             autocorr =       1.139047653893
              std dev =       0.591476705275
             le_variance =       0.349844692882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216209445798        initial  <--
     6.2500e+30     6.2500e+31             0.0000e+00       -17.216209445798
     2.5000e+31     2.5000e+32             0.0000e+00       -17.216209445798
     1.0000e+32     1.0000e+33             0.0000e+00       -17.216209445798

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4076
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2515
    reference variance = 0.290423
====================================================
  Execution time = 2.0228e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4690e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311185050981
                                         uncertainty =       0.002836077060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311185050981
                                         uncertainty =       0.002836077060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394406462
  error estimate for blocks of size 2^( 2) =       0.000404182234
  error estimate for blocks of size 2^( 3) =       0.000413857202
  error estimate for blocks of size 2^( 4) =       0.000420346815
  error estimate for blocks of size 2^( 5) =       0.000424288457
  error estimate for blocks of size 2^( 6) =       0.000428655561
  error estimate for blocks of size 2^( 7) =       0.000428786829

      target function =                  N/A
              le_mean =     -17.217048106358
             les_mean =     296.737858255186
             stat err =       0.000425519416
             autocorr =       1.163993937928
              std dev =       0.557774967255
             le_variance =       0.311112914096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704810636e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+31, overlap shift 6.2500e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+32, overlap shift 2.5000e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+33, overlap shift 1.0000e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217048106358       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.532608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5706e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2188
    reference variance = 0.214052
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1619e-01
  Total weights = 2.0000e+06
  Execution time = 1.8843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397613156
  error estimate for blocks of size 2^( 2) =       0.000407433607
  error estimate for blocks of size 2^( 3) =       0.000416247472
  error estimate for blocks of size 2^( 4) =       0.000422740353
  error estimate for blocks of size 2^( 5) =       0.000426521407
  error estimate for blocks of size 2^( 6) =       0.000428909331
  error estimate for blocks of size 2^( 7) =       0.000429181705

      target function =                  N/A
              le_mean =     -17.216392351180
             les_mean =     296.720357875209
             stat err =       0.000426838199
             autocorr =       1.152404819445
              std dev =       0.562309917687
             le_variance =       0.316192443529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397613156
  error estimate for blocks of size 2^( 2) =       0.000407433607
  error estimate for blocks of size 2^( 3) =       0.000416247472
  error estimate for blocks of size 2^( 4) =       0.000422740353
  error estimate for blocks of size 2^( 5) =       0.000426521407
  error estimate for blocks of size 2^( 6) =       0.000428909331
  error estimate for blocks of size 2^( 7) =       0.000429181705

      target function =                  N/A
              le_mean =     -17.216392351180
             les_mean =     296.720357875209
             stat err =       0.000426838199
             autocorr =       1.152404819445
              std dev =       0.562309917687
             le_variance =       0.316192443529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397613156
  error estimate for blocks of size 2^( 2) =       0.000407433607
  error estimate for blocks of size 2^( 3) =       0.000416247472
  error estimate for blocks of size 2^( 4) =       0.000422740353
  error estimate for blocks of size 2^( 5) =       0.000426521407
  error estimate for blocks of size 2^( 6) =       0.000428909331
  error estimate for blocks of size 2^( 7) =       0.000429181705

      target function =                  N/A
              le_mean =     -17.216392351180
             les_mean =     296.720357875209
             stat err =       0.000426838199
             autocorr =       1.152404819445
              std dev =       0.562309917687
             le_variance =       0.316192443529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316188531366
                                         uncertainty =       0.002786612320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397613156
  error estimate for blocks of size 2^( 2) =       0.000407433607
  error estimate for blocks of size 2^( 3) =       0.000416247472
  error estimate for blocks of size 2^( 4) =       0.000422740353
  error estimate for blocks of size 2^( 5) =       0.000426521407
  error estimate for blocks of size 2^( 6) =       0.000428909331
  error estimate for blocks of size 2^( 7) =       0.000429181705

      target function =                  N/A
              le_mean =     -17.216392351180
             les_mean =     296.720357875209
             stat err =       0.000426838199
             autocorr =       1.152404819445
              std dev =       0.562309917687
             le_variance =       0.316192443529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216392351180        initial  <--
     6.2500e+31     6.2500e+32             0.0000e+00       -17.216392351180
     2.5000e+32     2.5000e+33             0.0000e+00       -17.216392351180
     1.0000e+33     1.0000e+34             0.0000e+00       -17.216392351180

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5250
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2081
    reference variance = 0.172519
====================================================
  Execution time = 2.0170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318760022959
                                         uncertainty =       0.004899923701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318760022959
                                         uncertainty =       0.004899923701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399162170
  error estimate for blocks of size 2^( 2) =       0.000408960026
  error estimate for blocks of size 2^( 3) =       0.000418307276
  error estimate for blocks of size 2^( 4) =       0.000425242897
  error estimate for blocks of size 2^( 5) =       0.000429830329
  error estimate for blocks of size 2^( 6) =       0.000431812802
  error estimate for blocks of size 2^( 7) =       0.000433994660

      target function =                  N/A
              le_mean =     -17.216929839559
             les_mean =     296.741333816183
             stat err =       0.000430220172
             autocorr =       1.161670043352
              std dev =       0.564500553785
             le_variance =       0.318660875223


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692983956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+32, overlap shift 6.2500e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+33, overlap shift 2.5000e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+34, overlap shift 1.0000e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216929839559       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.533738 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5813e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2483
    reference variance = 0.463094
====================================================
  Execution time = 2.0041e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1881e-01
  Total weights = 2.0000e+06
  Execution time = 1.8636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252948
  error estimate for blocks of size 2^( 2) =       0.000408929796
  error estimate for blocks of size 2^( 3) =       0.000417449226
  error estimate for blocks of size 2^( 4) =       0.000423859492
  error estimate for blocks of size 2^( 5) =       0.000427753816
  error estimate for blocks of size 2^( 6) =       0.000429200908
  error estimate for blocks of size 2^( 7) =       0.000430424369

      target function =                  N/A
              le_mean =     -17.216526796457
             les_mean =     296.727600607217
             stat err =       0.000427809646
             autocorr =       1.148166527679
              std dev =       0.564628934357
             le_variance =       0.318805833513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252948
  error estimate for blocks of size 2^( 2) =       0.000408929796
  error estimate for blocks of size 2^( 3) =       0.000417449226
  error estimate for blocks of size 2^( 4) =       0.000423859492
  error estimate for blocks of size 2^( 5) =       0.000427753816
  error estimate for blocks of size 2^( 6) =       0.000429200908
  error estimate for blocks of size 2^( 7) =       0.000430424369

      target function =                  N/A
              le_mean =     -17.216526796457
             les_mean =     296.727600607217
             stat err =       0.000427809646
             autocorr =       1.148166527679
              std dev =       0.564628934357
             le_variance =       0.318805833513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252948
  error estimate for blocks of size 2^( 2) =       0.000408929796
  error estimate for blocks of size 2^( 3) =       0.000417449226
  error estimate for blocks of size 2^( 4) =       0.000423859492
  error estimate for blocks of size 2^( 5) =       0.000427753816
  error estimate for blocks of size 2^( 6) =       0.000429200908
  error estimate for blocks of size 2^( 7) =       0.000430424369

      target function =                  N/A
              le_mean =     -17.216526796457
             les_mean =     296.727600607217
             stat err =       0.000427809646
             autocorr =       1.148166527679
              std dev =       0.564628934357
             le_variance =       0.318805833513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318865689361
                                         uncertainty =       0.003779813986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252948
  error estimate for blocks of size 2^( 2) =       0.000408929796
  error estimate for blocks of size 2^( 3) =       0.000417449226
  error estimate for blocks of size 2^( 4) =       0.000423859492
  error estimate for blocks of size 2^( 5) =       0.000427753816
  error estimate for blocks of size 2^( 6) =       0.000429200908
  error estimate for blocks of size 2^( 7) =       0.000430424369

      target function =                  N/A
              le_mean =     -17.216526796457
             les_mean =     296.727600607217
             stat err =       0.000427809646
             autocorr =       1.148166527679
              std dev =       0.564628934357
             le_variance =       0.318805833513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216526796457        initial  <--
     6.2500e+32     6.2500e+33             0.0000e+00       -17.216526796457
     2.5000e+33     2.5000e+34             0.0000e+00       -17.216526796457
     1.0000e+34     1.0000e+35             0.0000e+00       -17.216526796457

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4870
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2307
    reference variance = 0.159415
====================================================
  Execution time = 2.2221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3832e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428456863
                                         uncertainty =       0.013783417183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338428456863
                                         uncertainty =       0.013783417183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411289532
  error estimate for blocks of size 2^( 2) =       0.000421114057
  error estimate for blocks of size 2^( 3) =       0.000429290819
  error estimate for blocks of size 2^( 4) =       0.000436565007
  error estimate for blocks of size 2^( 5) =       0.000440032615
  error estimate for blocks of size 2^( 6) =       0.000441336461
  error estimate for blocks of size 2^( 7) =       0.000441712752

      target function =                  N/A
              le_mean =     -17.216613861374
             les_mean =     296.750110841418
             stat err =       0.000439911709
             autocorr =       1.144025565450
              std dev =       0.581651234778
             le_variance =       0.338318158918


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721661386137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+33, overlap shift 6.2500e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+34, overlap shift 2.5000e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+35, overlap shift 1.0000e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216613861374       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.534844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7839e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.21255
====================================================
  Execution time = 1.9901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1486e-01
  Total weights = 2.0000e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396776023
  error estimate for blocks of size 2^( 2) =       0.000406840703
  error estimate for blocks of size 2^( 3) =       0.000415715116
  error estimate for blocks of size 2^( 4) =       0.000422901843
  error estimate for blocks of size 2^( 5) =       0.000427393785
  error estimate for blocks of size 2^( 6) =       0.000429466939
  error estimate for blocks of size 2^( 7) =       0.000429026888

      target function =                  N/A
              le_mean =     -17.216768320534
             les_mean =     296.731973670504
             stat err =       0.000427197364
             autocorr =       1.159221128186
              std dev =       0.561126033086
             le_variance =       0.314862425007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396776023
  error estimate for blocks of size 2^( 2) =       0.000406840703
  error estimate for blocks of size 2^( 3) =       0.000415715116
  error estimate for blocks of size 2^( 4) =       0.000422901843
  error estimate for blocks of size 2^( 5) =       0.000427393785
  error estimate for blocks of size 2^( 6) =       0.000429466939
  error estimate for blocks of size 2^( 7) =       0.000429026888

      target function =                  N/A
              le_mean =     -17.216768320534
             les_mean =     296.731973670504
             stat err =       0.000427197364
             autocorr =       1.159221128186
              std dev =       0.561126033086
             le_variance =       0.314862425007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396776023
  error estimate for blocks of size 2^( 2) =       0.000406840703
  error estimate for blocks of size 2^( 3) =       0.000415715116
  error estimate for blocks of size 2^( 4) =       0.000422901843
  error estimate for blocks of size 2^( 5) =       0.000427393785
  error estimate for blocks of size 2^( 6) =       0.000429466939
  error estimate for blocks of size 2^( 7) =       0.000429026888

      target function =                  N/A
              le_mean =     -17.216768320534
             les_mean =     296.731973670504
             stat err =       0.000427197364
             autocorr =       1.159221128186
              std dev =       0.561126033086
             le_variance =       0.314862425007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314431590591
                                         uncertainty =       0.003345969867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396776023
  error estimate for blocks of size 2^( 2) =       0.000406840703
  error estimate for blocks of size 2^( 3) =       0.000415715116
  error estimate for blocks of size 2^( 4) =       0.000422901843
  error estimate for blocks of size 2^( 5) =       0.000427393785
  error estimate for blocks of size 2^( 6) =       0.000429466939
  error estimate for blocks of size 2^( 7) =       0.000429026888

      target function =                  N/A
              le_mean =     -17.216768320534
             les_mean =     296.731973670504
             stat err =       0.000427197364
             autocorr =       1.159221128186
              std dev =       0.561126033086
             le_variance =       0.314862425007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216768320534        initial  <--
     6.2500e+33     6.2500e+34             0.0000e+00       -17.216768320534
     2.5000e+34     2.5000e+35             0.0000e+00       -17.216768320534
     1.0000e+35     1.0000e+36             0.0000e+00       -17.216768320534

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3845
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.606023
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2067e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320548346916
                                         uncertainty =       0.003488204096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320548346916
                                         uncertainty =       0.003488204096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400420366
  error estimate for blocks of size 2^( 2) =       0.000410135078
  error estimate for blocks of size 2^( 3) =       0.000418736409
  error estimate for blocks of size 2^( 4) =       0.000425801060
  error estimate for blocks of size 2^( 5) =       0.000428918690
  error estimate for blocks of size 2^( 6) =       0.000431595341
  error estimate for blocks of size 2^( 7) =       0.000432340052

      target function =                  N/A
              le_mean =     -17.216049008565
             les_mean =     296.713016244364
             stat err =       0.000429663786
             autocorr =       1.151397241001
              std dev =       0.566279912584
             le_variance =       0.320672939396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604900856e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+34, overlap shift 6.2500e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.5000e+35, overlap shift 2.5000e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.0000e+36, overlap shift 1.0000e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216049008565       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.535958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6058e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1136
    reference variance = 0.689351
====================================================
  Execution time = 1.9829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1424e-01
  Total weights = 2.0000e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396383899
  error estimate for blocks of size 2^( 2) =       0.000406309974
  error estimate for blocks of size 2^( 3) =       0.000415316825
  error estimate for blocks of size 2^( 4) =       0.000421713532
  error estimate for blocks of size 2^( 5) =       0.000425379908
  error estimate for blocks of size 2^( 6) =       0.000429267825
  error estimate for blocks of size 2^( 7) =       0.000429435015

      target function =                  N/A
              le_mean =     -17.215922649124
             les_mean =     296.702232894380
             stat err =       0.000426449070
             autocorr =       1.157450248878
              std dev =       0.560571485981
             le_variance =       0.314240390895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396383899
  error estimate for blocks of size 2^( 2) =       0.000406309974
  error estimate for blocks of size 2^( 3) =       0.000415316825
  error estimate for blocks of size 2^( 4) =       0.000421713532
  error estimate for blocks of size 2^( 5) =       0.000425379908
  error estimate for blocks of size 2^( 6) =       0.000429267825
  error estimate for blocks of size 2^( 7) =       0.000429435015

      target function =                  N/A
              le_mean =     -17.215922649124
             les_mean =     296.702232894380
             stat err =       0.000426449070
             autocorr =       1.157450248878
              std dev =       0.560571485981
             le_variance =       0.314240390895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396383899
  error estimate for blocks of size 2^( 2) =       0.000406309974
  error estimate for blocks of size 2^( 3) =       0.000415316825
  error estimate for blocks of size 2^( 4) =       0.000421713532
  error estimate for blocks of size 2^( 5) =       0.000425379908
  error estimate for blocks of size 2^( 6) =       0.000429267825
  error estimate for blocks of size 2^( 7) =       0.000429435015

      target function =                  N/A
              le_mean =     -17.215922649124
             les_mean =     296.702232894380
             stat err =       0.000426449070
             autocorr =       1.157450248878
              std dev =       0.560571485981
             le_variance =       0.314240390895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314092007107
                                         uncertainty =       0.002790292407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396383899
  error estimate for blocks of size 2^( 2) =       0.000406309974
  error estimate for blocks of size 2^( 3) =       0.000415316825
  error estimate for blocks of size 2^( 4) =       0.000421713532
  error estimate for blocks of size 2^( 5) =       0.000425379908
  error estimate for blocks of size 2^( 6) =       0.000429267825
  error estimate for blocks of size 2^( 7) =       0.000429435015

      target function =                  N/A
              le_mean =     -17.215922649124
             les_mean =     296.702232894380
             stat err =       0.000426449070
             autocorr =       1.157450248878
              std dev =       0.560571485981
             le_variance =       0.314240390895


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215922649124        initial  <--
     6.2500e+34     6.2500e+35             0.0000e+00       -17.215922649124
     2.5000e+35     2.5000e+36             0.0000e+00       -17.215922649124
     1.0000e+36     1.0000e+37             0.0000e+00       -17.215922649124

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3297
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.118112e-01 1 1  ON 0
 uu_1                 4.979220e-02 1 1  ON 1
 uu_2                -4.488178e-02 1 1  ON 2
 uu_3                -9.990481e-02 1 1  ON 3
 uu_4                -1.333435e-01 1 1  ON 4
 uu_5                -1.399650e-01 1 1  ON 5
 uu_6                -1.163765e-01 1 1  ON 6
 uu_7                -4.316025e-02 1 1  ON 7
 uu_8                 9.752978e-02 1 1  ON 8
 uu_9                 1.230559e-01 1 1  ON 9
 ud_0                 3.527667e-01 1 1  ON 10
 ud_1                 9.423184e-02 1 1  ON 11
 ud_2                -1.564791e-02 1 1  ON 12
 ud_3                -7.616931e-02 1 1  ON 13
 ud_4                -1.231865e-01 1 1  ON 14
 ud_5                -1.539418e-01 1 1  ON 15
 ud_6                -1.544835e-01 1 1  ON 16
 ud_7                -1.111068e-01 1 1  ON 17
 ud_8                 2.438189e-04 1 1  ON 18
 ud_9                 9.267996e-02 1 1  ON 19
 eO_0                -7.701729e-01 1 1  ON 20
 eO_1                -4.502566e-01 1 1  ON 21
 eO_2                -4.181488e-02 1 1  ON 22
 eO_3                 2.129590e-01 1 1  ON 23
 eO_4                 3.054571e-01 1 1  ON 24
 eO_5                 3.140599e-01 1 1  ON 25
 eO_6                 2.540875e-01 1 1  ON 26
 eO_7                 1.172350e-01 1 1  ON 27
 eO_8                 2.888666e-02 1 1  ON 28
 eO_9                 1.876199e-02 1 1  ON 29
eH1_0                -1.830280e-01 1 1  ON 30
eH1_1                -1.036695e-01 1 1  ON 31
eH1_2                -6.260492e-02 1 1  ON 32
eH1_3                -2.583180e-02 1 1  ON 33
eH1_4                 1.912359e-02 1 1  ON 34
eH1_5                 3.378193e-02 1 1  ON 35
eH1_6                 7.757912e-02 1 1  ON 36
eH1_7                 1.098937e-01 1 1  ON 37
eH1_8                 9.388715e-02 1 1  ON 38
eH1_9                 2.529096e-02 1 1  ON 39
eH2_0                -1.841942e-01 1 1  ON 40
eH2_1                -1.049605e-01 1 1  ON 41
eH2_2                -6.401591e-02 1 1  ON 42
eH2_3                -2.710965e-02 1 1  ON 43
eH2_4                 1.823192e-02 1 1  ON 44
eH2_5                 3.358142e-02 1 1  ON 45
eH2_6                 7.871771e-02 1 1  ON 46
eH2_7                 1.133369e-01 1 1  ON 47
eH2_8                 9.674642e-02 1 1  ON 48
eH2_9                 2.727839e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5393e+01 secs
  Total Execution time = 2.2337e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
